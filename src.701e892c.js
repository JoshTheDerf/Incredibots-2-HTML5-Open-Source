parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"IHN5":[function(require,module,exports) {
var global = arguments[3];
var define;
var t,n=arguments[3];!function(n){var e=n.Promise,o=e&&"resolve"in e&&"reject"in e&&"all"in e&&"race"in e&&function(){var t;return new e(function(n){t=n}),"function"==typeof t}();"undefined"!=typeof exports&&exports?(exports.Promise=o?e:b,exports.Polyfill=b):"function"==typeof t&&t.amd?t(function(){return o?e:b}):o||(n.Promise=b);var r="pending",i="sealed",c="fulfilled",f="rejected",u=function(){};function a(t){return"[object Array]"===Object.prototype.toString.call(t)}var s,h="undefined"!=typeof setImmediate?setImmediate:setTimeout,l=[];function p(){for(var t=0;t<l.length;t++)l[t][0](l[t][1]);l=[],s=!1}function d(t,n){l.push([t,n]),s||(s=!0,h(p,0))}function y(t){var n=t.owner,e=n.state_,o=n.data_,r=t[e],i=t.then;if("function"==typeof r){e=c;try{o=r(o)}catch(u){_(i,u)}}w(i,o)||(e===c&&m(i,o),e===f&&_(i,o))}function w(t,n){var e;try{if(t===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"==typeof n||"object"==typeof n)){var o=n.then;if("function"==typeof o)return o.call(n,function(o){e||(e=!0,n!==o?m(t,o):v(t,o))},function(n){e||(e=!0,_(t,n))}),!0}}catch(r){return e||_(t,r),!0}return!1}function m(t,n){t!==n&&w(t,n)||v(t,n)}function v(t,n){t.state_===r&&(t.state_=i,t.data_=n,d(P,t))}function _(t,n){t.state_===r&&(t.state_=i,t.data_=n,d(g,t))}function j(t){var n=t.then_;t.then_=void 0;for(var e=0;e<n.length;e++)y(n[e])}function P(t){t.state_=c,j(t)}function g(t){t.state_=f,j(t)}function b(t){if("function"!=typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof b==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(t,n){function e(t){_(n,t)}try{t(function(t){m(n,t)},e)}catch(o){e(o)}}(t,this)}b.prototype={constructor:b,state_:r,then_:null,data_:void 0,then:function(t,n){var e={owner:this,then:new this.constructor(u),fulfilled:t,rejected:n};return this.state_===c||this.state_===f?d(y,e):this.then_.push(e),e.then},catch:function(t){return this.then(null,t)}},b.all=function(t){if(!a(t))throw new TypeError("You must pass an array to Promise.all().");return new this(function(n,e){var o=[],r=0;function i(t){return r++,function(e){o[t]=e,--r||n(o)}}for(var c,f=0;f<t.length;f++)(c=t[f])&&"function"==typeof c.then?c.then(i(f),e):o[f]=c;r||n(o)})},b.race=function(t){if(!a(t))throw new TypeError("You must pass an array to Promise.race().");return new this(function(n,e){for(var o,r=0;r<t.length;r++)(o=t[r])&&"function"==typeof o.then?o.then(n,e):n(o)})},b.resolve=function(t){return t&&"object"==typeof t&&t.constructor===this?t:new this(function(n){n(t)})},b.reject=function(t){return new this(function(n,e){e(t)})}}("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this);
},{}],"YOwE":[function(require,module,exports) {
"use strict";var r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,e=Object.prototype.propertyIsEnumerable;function n(r){if(null==r)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function o(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de","5"===Object.getOwnPropertyNames(r)[0])return!1;for(var t={},e=0;e<10;e++)t["_"+String.fromCharCode(e)]=e;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(r){return t[r]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(r){n[r]=r}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(o){return!1}}module.exports=o()?Object.assign:function(o,c){for(var a,i,s=n(o),f=1;f<arguments.length;f++){for(var u in a=Object(arguments[f]))t.call(a,u)&&(s[u]=a[u]);if(r){i=r(a);for(var b=0;b<i.length;b++)e.call(a,i[b])&&(s[i[b]]=a[i[b]])}}return s};
},{}],"jbXN":[function(require,module,exports) {
"use strict";var n=require("es6-promise-polyfill"),r=e(require("object-assign"));function e(n){return n&&n.__esModule?n:{default:n}}window.Promise||(window.Promise=n.Polyfill),Object.assign||(Object.assign=r.default);var i=16;if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!window.performance||!window.performance.now){var o=Date.now();window.performance||(window.performance={}),window.performance.now=function(){return Date.now()-o}}for(var t=Date.now(),a=["ms","moz","webkit","o"],w=0;w<a.length&&!window.requestAnimationFrame;++w){var m=a[w];window.requestAnimationFrame=window[m+"RequestAnimationFrame"],window.cancelAnimationFrame=window[m+"CancelAnimationFrame"]||window[m+"CancelRequestAnimationFrame"]}window.requestAnimationFrame||(window.requestAnimationFrame=function(n){if("function"!=typeof n)throw new TypeError(n+"is not a function");var r=Date.now(),e=i+t-r;return e<0&&(e=0),t=r,window.setTimeout(function(){t=Date.now(),n(performance.now())},e)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){return clearTimeout(n)}),Math.sign||(Math.sign=function(n){return 0===(n=Number(n))||isNaN(n)?n:n>0?1:-1}),Number.isInteger||(Number.isInteger=function(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n}),window.ArrayBuffer||(window.ArrayBuffer=Array),window.Float32Array||(window.Float32Array=Array),window.Uint32Array||(window.Uint32Array=Array),window.Uint16Array||(window.Uint16Array=Array),window.Uint8Array||(window.Uint8Array=Array),window.Int32Array||(window.Int32Array=Array);
},{"es6-promise-polyfill":"IHN5","object-assign":"YOwE"}],"Hp9w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=m;var e=/iPhone/i,i=/iPod/i,o=/iPad/i,t=/\biOS-universal(?:.+)Mac\b/i,n=/\bAndroid(?:.+)Mobile\b/i,r=/Android/i,a=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,d=/Silk/i,l=/Windows Phone/i,p=/\bWindows(?:.+)ARM\b/i,s=/BlackBerry/i,u=/BB10/i,b=/Opera Mini/i,c=/\b(CriOS|Chrome)(?:.+)Mobile/i,h=/Mobile(?:.+)Firefox\b/i,v=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function f(e){return function(i){return i.test(e)}}function m(m){var g={userAgent:"",platform:"",maxTouchPoints:0};m||"undefined"==typeof navigator?"string"==typeof m?g.userAgent=m:m&&m.userAgent&&(g={userAgent:m.userAgent,platform:m.platform,maxTouchPoints:m.maxTouchPoints||0}):g={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var A=g.userAgent,P=A.split("[FBAN");void 0!==P[1]&&(A=P[0]),void 0!==(P=A.split("Twitter"))[1]&&(A=P[0]);var w=f(A),x={apple:{phone:w(e)&&!w(l),ipod:w(i),tablet:!w(e)&&(w(o)||v(g))&&!w(l),universal:w(t),device:(w(e)||w(i)||w(o)||w(t)||v(g))&&!w(l)},amazon:{phone:w(a),tablet:!w(a)&&w(d),device:w(a)||w(d)},android:{phone:!w(l)&&w(a)||!w(l)&&w(n),tablet:!w(l)&&!w(a)&&!w(n)&&(w(d)||w(r)),device:!w(l)&&(w(a)||w(d)||w(n)||w(r))||w(/\bokhttp\b/i)},windows:{phone:w(l),tablet:w(p),device:w(l)||w(p)},other:{blackberry:w(s),blackberry10:w(u),opera:w(b),firefox:w(h),chrome:w(c),device:w(s)||w(u)||w(b)||w(h)||w(c)},any:!1,phone:!1,tablet:!1};return x.any=x.apple.device||x.android.device||x.windows.device||x.other.device,x.phone=x.apple.phone||x.android.phone||x.windows.phone,x.tablet=x.apple.tablet||x.android.tablet||x.windows.tablet,x}
},{}],"uJg3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={};Object.defineProperty(exports,"default",{enumerable:!0,get:function(){return t.default}});var t=n(require("./isMobile"));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function n(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if(Object.prototype.hasOwnProperty.call(e,u)){var f=o?Object.getOwnPropertyDescriptor(e,u):null;f&&(f.get||f.set)?Object.defineProperty(n,u,f):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===t[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});
},{"./isMobile":"Hp9w"}],"Xe2x":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.settings=exports.isMobile=void 0;var e=r(require("ismobilejs"));function r(e){return e&&e.__esModule?e:{default:e}}var i=(0,e.default)(window.navigator);function t(e){var r=!0;if(i.tablet||i.phone){var t;if(i.apple.device)if(t=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(t[1],10)<11&&(r=!1);if(i.android.device)if(t=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(t[1],10)<7&&(r=!1)}return r?e:4}function a(){return!i.apple.device}exports.isMobile=i;var n={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:t(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:i.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:a(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};exports.settings=n;
},{"ismobilejs":"uJg3"}],"LqgX":[function(require,module,exports) {
"use strict";var e=Object.prototype.hasOwnProperty,t="~";function n(){}function r(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function o(e,n,o,s,i){if("function"!=typeof o)throw new TypeError("The listener must be a function");var c=new r(o,s||e,i),f=t?t+n:n;return e._events[f]?e._events[f].fn?e._events[f]=[e._events[f],c]:e._events[f].push(c):(e._events[f]=c,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function i(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(t=!1)),i.prototype.eventNames=function(){var n,r,o=[];if(0===this._eventsCount)return o;for(r in n=this._events)e.call(n,r)&&o.push(t?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(n)):o},i.prototype.listeners=function(e){var n=t?t+e:e,r=this._events[n];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,s=r.length,i=new Array(s);o<s;o++)i[o]=r[o].fn;return i},i.prototype.listenerCount=function(e){var n=t?t+e:e,r=this._events[n];return r?r.fn?1:r.length:0},i.prototype.emit=function(e,n,r,o,s,i){var c=t?t+e:e;if(!this._events[c])return!1;var f,u,a=this._events[c],l=arguments.length;if(a.fn){switch(a.once&&this.removeListener(e,a.fn,void 0,!0),l){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,n),!0;case 3:return a.fn.call(a.context,n,r),!0;case 4:return a.fn.call(a.context,n,r,o),!0;case 5:return a.fn.call(a.context,n,r,o,s),!0;case 6:return a.fn.call(a.context,n,r,o,s,i),!0}for(u=1,f=new Array(l-1);u<l;u++)f[u-1]=arguments[u];a.fn.apply(a.context,f)}else{var v,h=a.length;for(u=0;u<h;u++)switch(a[u].once&&this.removeListener(e,a[u].fn,void 0,!0),l){case 1:a[u].fn.call(a[u].context);break;case 2:a[u].fn.call(a[u].context,n);break;case 3:a[u].fn.call(a[u].context,n,r);break;case 4:a[u].fn.call(a[u].context,n,r,o);break;default:if(!f)for(v=1,f=new Array(l-1);v<l;v++)f[v-1]=arguments[v];a[u].fn.apply(a[u].context,f)}}return!0},i.prototype.on=function(e,t,n){return o(this,e,t,n,!1)},i.prototype.once=function(e,t,n){return o(this,e,t,n,!0)},i.prototype.removeListener=function(e,n,r,o){var i=t?t+e:e;if(!this._events[i])return this;if(!n)return s(this,i),this;var c=this._events[i];if(c.fn)c.fn!==n||o&&!c.once||r&&c.context!==r||s(this,i);else{for(var f=0,u=[],a=c.length;f<a;f++)(c[f].fn!==n||o&&!c[f].once||r&&c[f].context!==r)&&u.push(c[f]);u.length?this._events[i]=1===u.length?u[0]:u:s(this,i)}return this},i.prototype.removeAllListeners=function(e){var r;return e?(r=t?t+e:e,this._events[r]&&s(this,r)):(this._events=new n,this._eventsCount=0),this},i.prototype.off=i.prototype.removeListener,i.prototype.addListener=i.prototype.on,i.prefixed=t,i.EventEmitter=i,"undefined"!=typeof module&&(module.exports=i);
},{}],"d3f1":[function(require,module,exports) {
"use strict";function e(e,t,x){x=x||2;var i,u,v,y,o,p,a,l=t&&t.length,h=l?t[0]*x:e.length,s=n(e,0,h,x,!0),c=[];if(!s||s.next===s.prev)return c;if(l&&(s=f(e,t,s,x)),e.length>80*x){i=v=e[0],u=y=e[1];for(var Z=x;Z<h;Z+=x)(o=e[Z])<i&&(i=o),(p=e[Z+1])<u&&(u=p),o>v&&(v=o),p>y&&(y=p);a=0!==(a=Math.max(v-i,y-u))?1/a:0}return r(s,c,x,i,u,a),c}function n(e,n,t,r,x){var i,u;if(x===D(e,n,t,r)>0)for(i=n;i<t;i+=r)u=A(i,e[i],e[i+1],u);else for(i=t-r;i>=n;i-=r)u=A(i,e[i],e[i+1],u);return u&&w(u,u.next)&&(B(u),u=u.next),u}function t(e,n){if(!e)return e;n||(n=e);var t,r=e;do{if(t=!1,r.steiner||!w(r,r.next)&&0!==g(r.prev,r,r.next))r=r.next;else{if(B(r),(r=n=r.prev)===r.next)break;t=!0}}while(t||r!==n);return n}function r(e,n,f,y,o,p,a){if(e){!a&&p&&l(e,y,o,p);for(var h,s,c=e;e.prev!==e.next;)if(h=e.prev,s=e.next,p?i(e,y,o,p):x(e))n.push(h.i/f),n.push(e.i/f),n.push(s.i/f),B(e),e=s.next,c=s.next;else if((e=s)===c){a?1===a?r(e=u(t(e),n,f),n,f,y,o,p,2):2===a&&v(e,n,f,y,o,p):r(t(e),n,f,y,o,p,1);break}}}function x(e){var n=e.prev,t=e,r=e.next;if(g(n,t,r)>=0)return!1;for(var x=e.next.next;x!==e.prev;){if(Z(n.x,n.y,t.x,t.y,r.x,r.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function i(e,n,t,r){var x=e.prev,i=e,u=e.next;if(g(x,i,u)>=0)return!1;for(var v=x.x<i.x?x.x<u.x?x.x:u.x:i.x<u.x?i.x:u.x,f=x.y<i.y?x.y<u.y?x.y:u.y:i.y<u.y?i.y:u.y,y=x.x>i.x?x.x>u.x?x.x:u.x:i.x>u.x?i.x:u.x,o=x.y>i.y?x.y>u.y?x.y:u.y:i.y>u.y?i.y:u.y,p=s(v,f,n,t,r),a=s(y,o,n,t,r),l=e.prevZ,h=e.nextZ;l&&l.z>=p&&h&&h.z<=a;){if(l!==e.prev&&l!==e.next&&Z(x.x,x.y,i.x,i.y,u.x,u.y,l.x,l.y)&&g(l.prev,l,l.next)>=0)return!1;if(l=l.prevZ,h!==e.prev&&h!==e.next&&Z(x.x,x.y,i.x,i.y,u.x,u.y,h.x,h.y)&&g(h.prev,h,h.next)>=0)return!1;h=h.nextZ}for(;l&&l.z>=p;){if(l!==e.prev&&l!==e.next&&Z(x.x,x.y,i.x,i.y,u.x,u.y,l.x,l.y)&&g(l.prev,l,l.next)>=0)return!1;l=l.prevZ}for(;h&&h.z<=a;){if(h!==e.prev&&h!==e.next&&Z(x.x,x.y,i.x,i.y,u.x,u.y,h.x,h.y)&&g(h.prev,h,h.next)>=0)return!1;h=h.nextZ}return!0}function u(e,n,r){var x=e;do{var i=x.prev,u=x.next.next;!w(i,u)&&M(i,x,x.next,u)&&k(i,u)&&k(u,i)&&(n.push(i.i/r),n.push(x.i/r),n.push(u.i/r),B(x),B(x.next),x=e=u),x=x.next}while(x!==e);return t(x)}function v(e,n,x,i,u,v){var f=e;do{for(var y=f.next.next;y!==f.prev;){if(f.i!==y.i&&d(f,y)){var o=q(f,y);return f=t(f,f.next),o=t(o,o.next),r(f,n,x,i,u,v),void r(o,n,x,i,u,v)}y=y.next}f=f.next}while(f!==e)}function f(e,r,x,i){var u,v,f,p=[];for(u=0,v=r.length;u<v;u++)(f=n(e,r[u]*i,u<v-1?r[u+1]*i:e.length,i,!1))===f.next&&(f.steiner=!0),p.push(c(f));for(p.sort(y),u=0;u<p.length;u++)o(p[u],x),x=t(x,x.next);return x}function y(e,n){return e.x-n.x}function o(e,n){if(n=p(e,n)){var r=q(n,e);t(n,n.next),t(r,r.next)}}function p(e,n){var t,r=n,x=e.x,i=e.y,u=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var v=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(v<=x&&v>u){if(u=v,v===x){if(i===r.y)return r;if(i===r.next.y)return r.next}t=r.x<r.next.x?r:r.next}}r=r.next}while(r!==n);if(!t)return null;if(x===u)return t;var f,y=t,o=t.x,p=t.y,l=1/0;r=t;do{x>=r.x&&r.x>=o&&x!==r.x&&Z(i<p?x:u,i,o,p,i<p?u:x,i,r.x,r.y)&&(f=Math.abs(i-r.y)/(x-r.x),k(r,e)&&(f<l||f===l&&(r.x>t.x||r.x===t.x&&a(t,r)))&&(t=r,l=f)),r=r.next}while(r!==y);return t}function a(e,n){return g(e.prev,e,n.prev)<0&&g(n.next,e,e.next)<0}function l(e,n,t,r){var x=e;do{null===x.z&&(x.z=s(x.x,x.y,n,t,r)),x.prevZ=x.prev,x.nextZ=x.next,x=x.next}while(x!==e);x.prevZ.nextZ=null,x.prevZ=null,h(x)}function h(e){var n,t,r,x,i,u,v,f,y=1;do{for(t=e,e=null,i=null,u=0;t;){for(u++,r=t,v=0,n=0;n<y&&(v++,r=r.nextZ);n++);for(f=y;v>0||f>0&&r;)0!==v&&(0===f||!r||t.z<=r.z)?(x=t,t=t.nextZ,v--):(x=r,r=r.nextZ,f--),i?i.nextZ=x:e=x,x.prevZ=i,i=x;t=r}i.nextZ=null,y*=2}while(u>1);return e}function s(e,n,t,r,x){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-t)*x)|e<<8))|e<<4))|e<<2))|e<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-r)*x)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function c(e){var n=e,t=e;do{(n.x<t.x||n.x===t.x&&n.y<t.y)&&(t=n),n=n.next}while(n!==e);return t}function Z(e,n,t,r,x,i,u,v){return(x-u)*(n-v)-(e-u)*(i-v)>=0&&(e-u)*(r-v)-(t-u)*(n-v)>=0&&(t-u)*(i-v)-(x-u)*(r-v)>=0}function d(e,n){return e.next.i!==n.i&&e.prev.i!==n.i&&!b(e,n)&&(k(e,n)&&k(n,e)&&j(e,n)&&(g(e.prev,e,n.prev)||g(e,n.prev,n))||w(e,n)&&g(e.prev,e,e.next)>0&&g(n.prev,n,n.next)>0)}function g(e,n,t){return(n.y-e.y)*(t.x-n.x)-(n.x-e.x)*(t.y-n.y)}function w(e,n){return e.x===n.x&&e.y===n.y}function M(e,n,t,r){var x=m(g(e,n,t)),i=m(g(e,n,r)),u=m(g(t,r,e)),v=m(g(t,r,n));return x!==i&&u!==v||(!(0!==x||!z(e,t,n))||(!(0!==i||!z(e,r,n))||(!(0!==u||!z(t,e,r))||!(0!==v||!z(t,n,r)))))}function z(e,n,t){return n.x<=Math.max(e.x,t.x)&&n.x>=Math.min(e.x,t.x)&&n.y<=Math.max(e.y,t.y)&&n.y>=Math.min(e.y,t.y)}function m(e){return e>0?1:e<0?-1:0}function b(e,n){var t=e;do{if(t.i!==e.i&&t.next.i!==e.i&&t.i!==n.i&&t.next.i!==n.i&&M(t,t.next,e,n))return!0;t=t.next}while(t!==e);return!1}function k(e,n){return g(e.prev,e,e.next)<0?g(e,n,e.next)>=0&&g(e,e.prev,n)>=0:g(e,n,e.prev)<0||g(e,e.next,n)<0}function j(e,n){var t=e,r=!1,x=(e.x+n.x)/2,i=(e.y+n.y)/2;do{t.y>i!=t.next.y>i&&t.next.y!==t.y&&x<(t.next.x-t.x)*(i-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next}while(t!==e);return r}function q(e,n){var t=new C(e.i,e.x,e.y),r=new C(n.i,n.x,n.y),x=e.next,i=n.prev;return e.next=n,n.prev=e,t.next=x,x.prev=t,r.next=t,t.prev=r,i.next=r,r.prev=i,r}function A(e,n,t,r){var x=new C(e,n,t);return r?(x.next=r.next,x.prev=r,r.next.prev=x,r.next=x):(x.prev=x,x.next=x),x}function B(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function C(e,n,t){this.i=e,this.x=n,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function D(e,n,t,r){for(var x=0,i=n,u=t-r;i<t;i+=r)x+=(e[u]-e[i])*(e[i+1]+e[u+1]),u=i;return x}module.exports=e,module.exports.default=e,e.deviation=function(e,n,t,r){var x=n&&n.length,i=x?n[0]*t:e.length,u=Math.abs(D(e,0,i,t));if(x)for(var v=0,f=n.length;v<f;v++){var y=n[v]*t,o=v<f-1?n[v+1]*t:e.length;u-=Math.abs(D(e,y,o,t))}var p=0;for(v=0;v<r.length;v+=3){var a=r[v]*t,l=r[v+1]*t,h=r[v+2]*t;p+=Math.abs((e[a]-e[h])*(e[l+1]-e[a+1])-(e[a]-e[l])*(e[h+1]-e[a+1]))}return 0===u&&0===p?0:Math.abs((p-u)/u)},e.flatten=function(e){for(var n=e[0][0].length,t={vertices:[],holes:[],dimensions:n},r=0,x=0;x<e.length;x++){for(var i=0;i<e[x].length;i++)for(var u=0;u<n;u++)t.vertices.push(e[x][i][u]);x>0&&(r+=e[x-1].length,t.holes.push(r))}return t};
},{}],"GVK8":[function(require,module,exports) {
var global = arguments[3];
var define;
var o,e=arguments[3];!function(n){var r="object"==typeof exports&&exports&&!exports.nodeType&&exports,t="object"==typeof module&&module&&!module.nodeType&&module,u="object"==typeof e&&e;u.global!==u&&u.window!==u&&u.self!==u||(n=u);var i,f,c=2147483647,l=36,s=1,p=26,a=38,d=700,h=72,v=128,g="-",w=/^xn--/,x=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=l-s,b=Math.floor,j=String.fromCharCode;function A(o){throw new RangeError(m[o])}function I(o,e){for(var n=o.length,r=[];n--;)r[n]=e(o[n]);return r}function E(o,e){var n=o.split("@"),r="";return n.length>1&&(r=n[0]+"@",o=n[1]),r+I((o=o.replace(y,".")).split("."),e).join(".")}function F(o){for(var e,n,r=[],t=0,u=o.length;t<u;)(e=o.charCodeAt(t++))>=55296&&e<=56319&&t<u?56320==(64512&(n=o.charCodeAt(t++)))?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),t--):r.push(e);return r}function O(o){return I(o,function(o){var e="";return o>65535&&(e+=j((o-=65536)>>>10&1023|55296),o=56320|1023&o),e+=j(o)}).join("")}function S(o,e){return o+22+75*(o<26)-((0!=e)<<5)}function T(o,e,n){var r=0;for(o=n?b(o/d):o>>1,o+=b(o/e);o>C*p>>1;r+=l)o=b(o/C);return b(r+(C+1)*o/(o+a))}function L(o){var e,n,r,t,u,i,f,a,d,w,x,y=[],m=o.length,C=0,j=v,I=h;for((n=o.lastIndexOf(g))<0&&(n=0),r=0;r<n;++r)o.charCodeAt(r)>=128&&A("not-basic"),y.push(o.charCodeAt(r));for(t=n>0?n+1:0;t<m;){for(u=C,i=1,f=l;t>=m&&A("invalid-input"),((a=(x=o.charCodeAt(t++))-48<10?x-22:x-65<26?x-65:x-97<26?x-97:l)>=l||a>b((c-C)/i))&&A("overflow"),C+=a*i,!(a<(d=f<=I?s:f>=I+p?p:f-I));f+=l)i>b(c/(w=l-d))&&A("overflow"),i*=w;I=T(C-u,e=y.length+1,0==u),b(C/e)>c-j&&A("overflow"),j+=b(C/e),C%=e,y.splice(C++,0,j)}return O(y)}function M(o){var e,n,r,t,u,i,f,a,d,w,x,y,m,C,I,E=[];for(y=(o=F(o)).length,e=v,n=0,u=h,i=0;i<y;++i)(x=o[i])<128&&E.push(j(x));for(r=t=E.length,t&&E.push(g);r<y;){for(f=c,i=0;i<y;++i)(x=o[i])>=e&&x<f&&(f=x);for(f-e>b((c-n)/(m=r+1))&&A("overflow"),n+=(f-e)*m,e=f,i=0;i<y;++i)if((x=o[i])<e&&++n>c&&A("overflow"),x==e){for(a=n,d=l;!(a<(w=d<=u?s:d>=u+p?p:d-u));d+=l)I=a-w,C=l-w,E.push(j(S(w+I%C,0))),a=b(I/C);E.push(j(S(a,0))),u=T(n,m,r==t),n=0,++r}++n,++e}return E.join("")}if(i={version:"1.4.1",ucs2:{decode:F,encode:O},decode:L,encode:M,toASCII:function(o){return E(o,function(o){return x.test(o)?"xn--"+M(o):o})},toUnicode:function(o){return E(o,function(o){return w.test(o)?L(o.slice(4).toLowerCase()):o})}},"function"==typeof o&&"object"==typeof o.amd&&o.amd)o("punycode",function(){return i});else if(r&&t)if(module.exports==r)t.exports=i;else for(f in i)i.hasOwnProperty(f)&&(r[f]=i[f]);else n.punycode=i}(this);
},{}],"oHuK":[function(require,module,exports) {
"use strict";module.exports={isString:function(n){return"string"==typeof n},isObject:function(n){return"object"==typeof n&&null!==n},isNull:function(n){return null===n},isNullOrUndefined:function(n){return null==n}};
},{}],"ObZ4":[function(require,module,exports) {
"use strict";function r(r,e){return Object.prototype.hasOwnProperty.call(r,e)}module.exports=function(t,n,o,a){n=n||"&",o=o||"=";var s={};if("string"!=typeof t||0===t.length)return s;var p=/\+/g;t=t.split(n);var u=1e3;a&&"number"==typeof a.maxKeys&&(u=a.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var i=0;i<c;++i){var y,l,f,v,b=t[i].replace(p,"%20"),d=b.indexOf(o);d>=0?(y=b.substr(0,d),l=b.substr(d+1)):(y=b,l=""),f=decodeURIComponent(y),v=decodeURIComponent(l),r(s,f)?e(s[f])?s[f].push(v):s[f]=[s[f],v]:s[f]=v}return s};var e=Array.isArray||function(r){return"[object Array]"===Object.prototype.toString.call(r)};
},{}],"XK8a":[function(require,module,exports) {
"use strict";var n=function(n){switch(typeof n){case"string":return n;case"boolean":return n?"true":"false";case"number":return isFinite(n)?n:"";default:return""}};module.exports=function(o,u,c,a){return u=u||"&",c=c||"=",null===o&&(o=void 0),"object"==typeof o?r(t(o),function(t){var a=encodeURIComponent(n(t))+c;return e(o[t])?r(o[t],function(e){return a+encodeURIComponent(n(e))}).join(u):a+encodeURIComponent(n(o[t]))}).join(u):a?encodeURIComponent(n(a))+c+encodeURIComponent(n(o)):""};var e=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function r(n,e){if(n.map)return n.map(e);for(var r=[],t=0;t<n.length;t++)r.push(e(n[t],t));return r}var t=Object.keys||function(n){var e=[];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.push(r);return e};
},{}],"SF0R":[function(require,module,exports) {
"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode");
},{"./decode":"ObZ4","./encode":"XK8a"}],"j37I":[function(require,module,exports) {
"use strict";var t=require("punycode"),s=require("./util");function h(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}exports.parse=b,exports.resolve=O,exports.resolveObject=d,exports.format=q,exports.Url=h;var e=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,r=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,o=["<",">",'"',"`"," ","\r","\n","\t"],n=["{","}","|","\\","^","`"].concat(o),i=["'"].concat(n),l=["%","/","?",";","#"].concat(i),p=["/","?","#"],c=255,u=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=require("querystring");function b(t,e,a){if(t&&s.isObject(t)&&t instanceof h)return t;var r=new h;return r.parse(t,e,a),r}function q(t){return s.isString(t)&&(t=b(t)),t instanceof h?t.format():h.prototype.format.call(t)}function O(t,s){return b(t,!1,!0).resolve(s)}function d(t,s){return t?b(t,!1,!0).resolveObject(s):s}h.prototype.parse=function(h,a,o){if(!s.isString(h))throw new TypeError("Parameter 'url' must be a string, not "+typeof h);var n=h.indexOf("?"),b=-1!==n&&n<h.indexOf("#")?"?":"#",q=h.split(b);q[0]=q[0].replace(/\\/g,"/");var O=h=q.join(b);if(O=O.trim(),!o&&1===h.split("#").length){var d=r.exec(O);if(d)return this.path=O,this.href=O,this.pathname=d[1],d[2]?(this.search=d[2],this.query=a?y.parse(this.search.substr(1)):this.search.substr(1)):a&&(this.search="",this.query={}),this}var j=e.exec(O);if(j){var x=(j=j[0]).toLowerCase();this.protocol=x,O=O.substr(j.length)}if(o||j||O.match(/^\/\/[^@\/]+@[^@\/]+/)){var A="//"===O.substr(0,2);!A||j&&v[j]||(O=O.substr(2),this.slashes=!0)}if(!v[j]&&(A||j&&!g[j])){for(var C,I,w=-1,U=0;U<p.length;U++){-1!==(k=O.indexOf(p[U]))&&(-1===w||k<w)&&(w=k)}-1!==(I=-1===w?O.lastIndexOf("@"):O.lastIndexOf("@",w))&&(C=O.slice(0,I),O=O.slice(I+1),this.auth=decodeURIComponent(C)),w=-1;for(U=0;U<l.length;U++){var k;-1!==(k=O.indexOf(l[U]))&&(-1===w||k<w)&&(w=k)}-1===w&&(w=O.length),this.host=O.slice(0,w),O=O.slice(w),this.parseHost(),this.hostname=this.hostname||"";var N="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!N)for(var R=this.hostname.split(/\./),S=(U=0,R.length);U<S;U++){var $=R[U];if($&&!$.match(u)){for(var z="",H=0,L=$.length;H<L;H++)$.charCodeAt(H)>127?z+="x":z+=$[H];if(!z.match(u)){var Z=R.slice(0,U),_=R.slice(U+1),E=$.match(f);E&&(Z.push(E[1]),_.unshift(E[2])),_.length&&(O="/"+_.join(".")+O),this.hostname=Z.join(".");break}}}this.hostname.length>c?this.hostname="":this.hostname=this.hostname.toLowerCase(),N||(this.hostname=t.toASCII(this.hostname));var P=this.port?":"+this.port:"",T=this.hostname||"";this.host=T+P,this.href+=this.host,N&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==O[0]&&(O="/"+O))}if(!m[x])for(U=0,S=i.length;U<S;U++){var B=i[U];if(-1!==O.indexOf(B)){var D=encodeURIComponent(B);D===B&&(D=escape(B)),O=O.split(B).join(D)}}var F=O.indexOf("#");-1!==F&&(this.hash=O.substr(F),O=O.slice(0,F));var G=O.indexOf("?");if(-1!==G?(this.search=O.substr(G),this.query=O.substr(G+1),a&&(this.query=y.parse(this.query)),O=O.slice(0,G)):a&&(this.search="",this.query={}),O&&(this.pathname=O),g[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){P=this.pathname||"";var J=this.search||"";this.path=P+J}return this.href=this.format(),this},h.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var h=this.protocol||"",e=this.pathname||"",a=this.hash||"",r=!1,o="";this.host?r=t+this.host:this.hostname&&(r=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(r+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(o=y.stringify(this.query));var n=this.search||o&&"?"+o||"";return h&&":"!==h.substr(-1)&&(h+=":"),this.slashes||(!h||g[h])&&!1!==r?(r="//"+(r||""),e&&"/"!==e.charAt(0)&&(e="/"+e)):r||(r=""),a&&"#"!==a.charAt(0)&&(a="#"+a),n&&"?"!==n.charAt(0)&&(n="?"+n),h+r+(e=e.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(n=n.replace("#","%23"))+a},h.prototype.resolve=function(t){return this.resolveObject(b(t,!1,!0)).format()},h.prototype.resolveObject=function(t){if(s.isString(t)){var e=new h;e.parse(t,!1,!0),t=e}for(var a=new h,r=Object.keys(this),o=0;o<r.length;o++){var n=r[o];a[n]=this[n]}if(a.hash=t.hash,""===t.href)return a.href=a.format(),a;if(t.slashes&&!t.protocol){for(var i=Object.keys(t),l=0;l<i.length;l++){var p=i[l];"protocol"!==p&&(a[p]=t[p])}return g[a.protocol]&&a.hostname&&!a.pathname&&(a.path=a.pathname="/"),a.href=a.format(),a}if(t.protocol&&t.protocol!==a.protocol){if(!g[t.protocol]){for(var c=Object.keys(t),u=0;u<c.length;u++){var f=c[u];a[f]=t[f]}return a.href=a.format(),a}if(a.protocol=t.protocol,t.host||v[t.protocol])a.pathname=t.pathname;else{for(var m=(t.pathname||"").split("/");m.length&&!(t.host=m.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),a.pathname=m.join("/")}if(a.search=t.search,a.query=t.query,a.host=t.host||"",a.auth=t.auth,a.hostname=t.hostname||t.host,a.port=t.port,a.pathname||a.search){var y=a.pathname||"",b=a.search||"";a.path=y+b}return a.slashes=a.slashes||t.slashes,a.href=a.format(),a}var q=a.pathname&&"/"===a.pathname.charAt(0),O=t.host||t.pathname&&"/"===t.pathname.charAt(0),d=O||q||a.host&&t.pathname,j=d,x=a.pathname&&a.pathname.split("/")||[],A=(m=t.pathname&&t.pathname.split("/")||[],a.protocol&&!g[a.protocol]);if(A&&(a.hostname="",a.port=null,a.host&&(""===x[0]?x[0]=a.host:x.unshift(a.host)),a.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===m[0]?m[0]=t.host:m.unshift(t.host)),t.host=null),d=d&&(""===m[0]||""===x[0])),O)a.host=t.host||""===t.host?t.host:a.host,a.hostname=t.hostname||""===t.hostname?t.hostname:a.hostname,a.search=t.search,a.query=t.query,x=m;else if(m.length)x||(x=[]),x.pop(),x=x.concat(m),a.search=t.search,a.query=t.query;else if(!s.isNullOrUndefined(t.search)){if(A)a.hostname=a.host=x.shift(),(k=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=k.shift(),a.host=a.hostname=k.shift());return a.search=t.search,a.query=t.query,s.isNull(a.pathname)&&s.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=a.format(),a}if(!x.length)return a.pathname=null,a.search?a.path="/"+a.search:a.path=null,a.href=a.format(),a;for(var C=x.slice(-1)[0],I=(a.host||t.host||x.length>1)&&("."===C||".."===C)||""===C,w=0,U=x.length;U>=0;U--)"."===(C=x[U])?x.splice(U,1):".."===C?(x.splice(U,1),w++):w&&(x.splice(U,1),w--);if(!d&&!j)for(;w--;w)x.unshift("..");!d||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),I&&"/"!==x.join("/").substr(-1)&&x.push("");var k,N=""===x[0]||x[0]&&"/"===x[0].charAt(0);A&&(a.hostname=a.host=N?"":x.length?x.shift():"",(k=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=k.shift(),a.host=a.hostname=k.shift()));return(d=d||a.host&&x.length)&&!N&&x.unshift(""),x.length?a.pathname=x.join("/"):(a.pathname=null,a.path=null),s.isNull(a.pathname)&&s.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=t.auth||a.auth,a.slashes=a.slashes||t.slashes,a.href=a.format(),a},h.prototype.parseHost=function(){var t=this.host,s=a.exec(t);s&&(":"!==(s=s[0])&&(this.port=s.substr(1)),t=t.substr(0,t.length-s.length)),t&&(this.hostname=t)};
},{"punycode":"GVK8","./util":"oHuK","querystring":"SF0R"}],"djkr":[function(require,module,exports) {
"use strict";var E,_,T,A,R,N,O,S,L,I,P,M,U,D,C,o,t;Object.defineProperty(exports,"__esModule",{value:!0}),exports.WRAP_MODES=exports.TYPES=exports.TARGETS=exports.SCALE_MODES=exports.RENDERER_TYPE=exports.PRECISION=exports.MSAA_QUALITY=exports.MIPMAP_MODES=exports.MASK_TYPES=exports.GC_MODES=exports.FORMATS=exports.ENV=exports.DRAW_MODES=exports.CLEAR_MODES=exports.BUFFER_BITS=exports.BLEND_MODES=exports.ALPHA_MODES=void 0,exports.ENV=E,function(E){E[E.WEBGL_LEGACY=0]="WEBGL_LEGACY",E[E.WEBGL=1]="WEBGL",E[E.WEBGL2=2]="WEBGL2"}(E||(exports.ENV=E={})),exports.RENDERER_TYPE=_,function(E){E[E.UNKNOWN=0]="UNKNOWN",E[E.WEBGL=1]="WEBGL",E[E.CANVAS=2]="CANVAS"}(_||(exports.RENDERER_TYPE=_={})),exports.BUFFER_BITS=T,function(E){E[E.COLOR=16384]="COLOR",E[E.DEPTH=256]="DEPTH",E[E.STENCIL=1024]="STENCIL"}(T||(exports.BUFFER_BITS=T={})),exports.BLEND_MODES=A,function(E){E[E.NORMAL=0]="NORMAL",E[E.ADD=1]="ADD",E[E.MULTIPLY=2]="MULTIPLY",E[E.SCREEN=3]="SCREEN",E[E.OVERLAY=4]="OVERLAY",E[E.DARKEN=5]="DARKEN",E[E.LIGHTEN=6]="LIGHTEN",E[E.COLOR_DODGE=7]="COLOR_DODGE",E[E.COLOR_BURN=8]="COLOR_BURN",E[E.HARD_LIGHT=9]="HARD_LIGHT",E[E.SOFT_LIGHT=10]="SOFT_LIGHT",E[E.DIFFERENCE=11]="DIFFERENCE",E[E.EXCLUSION=12]="EXCLUSION",E[E.HUE=13]="HUE",E[E.SATURATION=14]="SATURATION",E[E.COLOR=15]="COLOR",E[E.LUMINOSITY=16]="LUMINOSITY",E[E.NORMAL_NPM=17]="NORMAL_NPM",E[E.ADD_NPM=18]="ADD_NPM",E[E.SCREEN_NPM=19]="SCREEN_NPM",E[E.NONE=20]="NONE",E[E.SRC_OVER=0]="SRC_OVER",E[E.SRC_IN=21]="SRC_IN",E[E.SRC_OUT=22]="SRC_OUT",E[E.SRC_ATOP=23]="SRC_ATOP",E[E.DST_OVER=24]="DST_OVER",E[E.DST_IN=25]="DST_IN",E[E.DST_OUT=26]="DST_OUT",E[E.DST_ATOP=27]="DST_ATOP",E[E.ERASE=26]="ERASE",E[E.SUBTRACT=28]="SUBTRACT",E[E.XOR=29]="XOR"}(A||(exports.BLEND_MODES=A={})),exports.DRAW_MODES=R,function(E){E[E.POINTS=0]="POINTS",E[E.LINES=1]="LINES",E[E.LINE_LOOP=2]="LINE_LOOP",E[E.LINE_STRIP=3]="LINE_STRIP",E[E.TRIANGLES=4]="TRIANGLES",E[E.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",E[E.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(R||(exports.DRAW_MODES=R={})),exports.FORMATS=N,function(E){E[E.RGBA=6408]="RGBA",E[E.RGB=6407]="RGB",E[E.ALPHA=6406]="ALPHA",E[E.LUMINANCE=6409]="LUMINANCE",E[E.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",E[E.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",E[E.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(N||(exports.FORMATS=N={})),exports.TARGETS=O,function(E){E[E.TEXTURE_2D=3553]="TEXTURE_2D",E[E.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",E[E.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",E[E.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",E[E.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",E[E.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",E[E.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",E[E.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",E[E.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(O||(exports.TARGETS=O={})),exports.TYPES=S,function(E){E[E.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",E[E.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",E[E.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",E[E.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",E[E.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",E[E.FLOAT=5126]="FLOAT",E[E.HALF_FLOAT=36193]="HALF_FLOAT"}(S||(exports.TYPES=S={})),exports.SCALE_MODES=L,function(E){E[E.NEAREST=0]="NEAREST",E[E.LINEAR=1]="LINEAR"}(L||(exports.SCALE_MODES=L={})),exports.WRAP_MODES=I,function(E){E[E.CLAMP=33071]="CLAMP",E[E.REPEAT=10497]="REPEAT",E[E.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(I||(exports.WRAP_MODES=I={})),exports.MIPMAP_MODES=P,function(E){E[E.OFF=0]="OFF",E[E.POW2=1]="POW2",E[E.ON=2]="ON"}(P||(exports.MIPMAP_MODES=P={})),exports.ALPHA_MODES=M,function(E){E[E.NPM=0]="NPM",E[E.UNPACK=1]="UNPACK",E[E.PMA=2]="PMA",E[E.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",E[E.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",E[E.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(M||(exports.ALPHA_MODES=M={})),exports.CLEAR_MODES=U,function(E){E[E.NO=0]="NO",E[E.YES=1]="YES",E[E.AUTO=2]="AUTO",E[E.BLEND=0]="BLEND",E[E.CLEAR=1]="CLEAR",E[E.BLIT=2]="BLIT"}(U||(exports.CLEAR_MODES=U={})),exports.GC_MODES=D,function(E){E[E.AUTO=0]="AUTO",E[E.MANUAL=1]="MANUAL"}(D||(exports.GC_MODES=D={})),exports.PRECISION=C,function(E){E.LOW="lowp",E.MEDIUM="mediump",E.HIGH="highp"}(C||(exports.PRECISION=C={})),exports.MASK_TYPES=o,function(E){E[E.NONE=0]="NONE",E[E.SCISSOR=1]="SCISSOR",E[E.STENCIL=2]="STENCIL",E[E.SPRITE=3]="SPRITE"}(o||(exports.MASK_TYPES=o={})),exports.MSAA_QUALITY=t,function(E){E[E.NONE=0]="NONE",E[E.LOW=2]="LOW",E[E.MEDIUM=4]="MEDIUM",E[E.HIGH=8]="HIGH"}(t||(exports.MSAA_QUALITY=t={}));
},{}],"X4iF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clearTextureCache=W,exports.correctBlendMode=b,exports.createIndicesForQuads=D,exports.decomposeDataUri=z,exports.deprecation=I,exports.destroyTextureCache=k,exports.determineCrossOrigin=H,exports.getBufferType=O,exports.getResolutionOfUrl=V,exports.hex2rgb=g,exports.hex2string=x,exports.interleaveTypedArrays=M,exports.isPow2=P,exports.isWebGLSupported=d,exports.log2=N,exports.nextPow2=C,exports.premultiplyRgba=w,exports.premultiplyTint=A,exports.premultiplyTintToRgba=m,exports.removeItems=R,exports.rgb2hex=v,exports.sayHello=p,exports.sign=L,exports.skipHello=f,exports.string2hex=h,exports.trimCanvas=q,exports.uid=S,Object.defineProperty(exports,"isMobile",{enumerable:!0,get:function(){return e.isMobile}}),Object.defineProperty(exports,"EventEmitter",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(exports,"earcut",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(exports,"url",{enumerable:!0,get:function(){return n.default}}),exports.premultiplyBlendMode=exports.TextureCache=exports.ProgramCache=exports.DATA_URI=exports.CanvasRenderTarget=exports.BaseTextureCache=void 0;var e=require("@pixi/settings"),t=s(require("eventemitter3")),r=s(require("earcut")),n=a(require("url")),o=require("@pixi/constants");function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var a=n?Object.getOwnPropertyDescriptor(e,o):null;a&&(a.get||a.set)?Object.defineProperty(r,o,a):r[o]=e[o]}return r.default=e,t&&t.set(e,r),r}function s(e){return e&&e.__esModule?e:{default:e}}e.settings.RETINA_PREFIX=/@([0-9\.]+)x/,e.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var c,u=!1,l="5.3.6";function f(){u=!0}function p(e){var t;if(!u){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var r=["\n %c %c %c PixiJS "+l+" - ✰ "+e+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=window.console).log.apply(t,r)}else window.console&&window.console.log("PixiJS "+l+" - "+e+" - http://www.pixijs.com/");u=!0}}function d(){return void 0===c&&(c=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:e.settings.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var r=document.createElement("canvas"),n=r.getContext("webgl",t)||r.getContext("experimental-webgl",t),o=!(!n||!n.getContextAttributes().stencil);if(n){var i=n.getExtension("WEBGL_lose_context");i&&i.loseContext()}return n=null,o}catch(a){return!1}}()),c}function g(e,t){return void 0===t&&(t=[]),t[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function x(e){var t=e.toString(16);return"#"+(t="000000".substr(0,6-t.length)+t)}function h(e){return"string"==typeof e&&"#"===e[0]&&(e=e.substr(1)),parseInt(e,16)}function v(e){return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}function E(){for(var e=[],t=[],r=0;r<32;r++)e[r]=r,t[r]=r;e[o.BLEND_MODES.NORMAL_NPM]=o.BLEND_MODES.NORMAL,e[o.BLEND_MODES.ADD_NPM]=o.BLEND_MODES.ADD,e[o.BLEND_MODES.SCREEN_NPM]=o.BLEND_MODES.SCREEN,t[o.BLEND_MODES.NORMAL]=o.BLEND_MODES.NORMAL_NPM,t[o.BLEND_MODES.ADD]=o.BLEND_MODES.ADD_NPM,t[o.BLEND_MODES.SCREEN]=o.BLEND_MODES.SCREEN_NPM;var n=[];return n.push(t),n.push(e),n}var y=E();function b(e,t){return y[t?1:0][e]}function w(e,t,r,n){return r=r||new Float32Array(4),n||void 0===n?(r[0]=e[0]*t,r[1]=e[1]*t,r[2]=e[2]*t):(r[0]=e[0],r[1]=e[1],r[2]=e[2]),r[3]=t,r}function A(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var r=e>>16&255,n=e>>8&255,o=255&e;return(255*t<<24)+((r=r*t+.5|0)<<16)+((n=n*t+.5|0)<<8)+(o=o*t+.5|0)}function m(e,t,r,n){return(r=r||new Float32Array(4))[0]=(e>>16&255)/255,r[1]=(e>>8&255)/255,r[2]=(255&e)/255,(n||void 0===n)&&(r[0]*=t,r[1]*=t,r[2]*=t),r[3]=t,r}function D(e,t){void 0===t&&(t=null);var r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+r);for(var n=0,o=0;n<r;n+=6,o+=4)t[n+0]=o+0,t[n+1]=o+1,t[n+2]=o+2,t[n+3]=o+0,t[n+4]=o+2,t[n+5]=o+3;return t}function O(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}exports.premultiplyBlendMode=y;var _={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function M(e,t){for(var r=0,n=0,o={},i=0;i<e.length;i++)n+=t[i],r+=e[i].length;var a=new ArrayBuffer(4*r),s=null,c=0;for(i=0;i<e.length;i++){var u=t[i],l=e[i],f=O(l);o[f]||(o[f]=new _[f](a)),s=o[f];for(var p=0;p<l.length;p++){s[(p/u|0)*n+c+p%u]=l[p]}c+=u}return new Float32Array(a)}function C(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function P(e){return!(e&e-1||!e)}function N(e){var t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return t|=r,t|=r=((e>>>=r)>15?1:0)<<2,(t|=r=((e>>>=r)>3?1:0)<<1)|(e>>>=r)>>1}function R(e,t,r){var n,o=e.length;if(!(t>=o||0===r)){var i=o-(r=t+r>o?o-t:r);for(n=t;n<i;++n)e[n]=e[n+r];e.length=i}}function L(e){return 0===e?0:e<0?-1:1}var T=0;function S(){return++T}var B={};function I(e,t,r){if(void 0===r&&(r=3),!B[t]){var n=(new Error).stack;void 0===n?console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e):(n=n.split("\n").splice(r).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+"\nDeprecated since v"+e),console.warn(n),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e),console.warn(n))),B[t]=!0}}var j={};exports.ProgramCache=j;var F=Object.create(null);exports.TextureCache=F;var U=Object.create(null);function k(){var e;for(e in F)F[e].destroy();for(e in U)U[e].destroy()}function W(){var e;for(e in F)delete F[e];for(e in U)delete U[e]}exports.BaseTextureCache=U;var J=function(){function t(t,r,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||e.settings.RESOLUTION,this.resize(t,r)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!1,configurable:!0}),t}();function q(e){var t,r,n,o=e.width,i=e.height,a=e.getContext("2d"),s=a.getImageData(0,0,o,i).data,c=s.length,u={top:null,left:null,right:null,bottom:null},l=null;for(t=0;t<c;t+=4)0!==s[t+3]&&(r=t/4%o,n=~~(t/4/o),null===u.top&&(u.top=n),null===u.left?u.left=r:r<u.left&&(u.left=r),null===u.right?u.right=r+1:u.right<r&&(u.right=r+1),null===u.bottom?u.bottom=n:u.bottom<n&&(u.bottom=n));return null!==u.top&&(o=u.right-u.left,i=u.bottom-u.top+1,l=a.getImageData(u.left,u.top,o,i)),{height:i,width:o,data:l}}exports.CanvasRenderTarget=J;var G,Y=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function z(e){var t=Y.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function H(e,t){if(void 0===t&&(t=window.location),0===e.indexOf("data:"))return"";t=t||window.location,G||(G=document.createElement("a")),G.href=e;var r=(0,n.parse)(G.href),o=!r.port&&""===t.port||r.port===t.port;return r.hostname===t.hostname&&o&&r.protocol===t.protocol?"":"anonymous"}function V(t,r){var n=e.settings.RETINA_PREFIX.exec(t);return n?parseFloat(n[1]):void 0!==r?r:1}exports.DATA_URI=Y;
},{"@pixi/settings":"Xe2x","eventemitter3":"LqgX","earcut":"d3f1","url":"j37I","@pixi/constants":"djkr"}],"w9h1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.groupD8=exports.Transform=exports.SHAPES=exports.RoundedRectangle=exports.Rectangle=exports.RAD_TO_DEG=exports.Polygon=exports.Point=exports.PI_2=exports.ObservablePoint=exports.Matrix=exports.Ellipse=exports.DEG_TO_RAD=exports.Circle=void 0;var t=2*Math.PI;exports.PI_2=t;var i=180/Math.PI;exports.RAD_TO_DEG=i;var s,h=Math.PI/180;exports.DEG_TO_RAD=h,exports.SHAPES=s,function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(s||(exports.SHAPES=s={}));var o=function(){function t(t,i,h,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===h&&(h=0),void 0===o&&(o=0),this.x=Number(t),this.y=Number(i),this.width=Number(h),this.height=Number(o),this.type=s.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,i){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height)},t.prototype.pad=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x-=t,this.y-=i,this.width+=2*t,this.height+=2*i,this},t.prototype.fit=function(t){var i=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),h=Math.max(this.y,t.y),o=Math.min(this.y+this.height,t.y+t.height);return this.x=i,this.width=Math.max(s-i,0),this.y=h,this.height=Math.max(o-h,0),this},t.prototype.ceil=function(t,i){void 0===t&&(t=1),void 0===i&&(i=.001);var s=Math.ceil((this.x+this.width-i)*t)/t,h=Math.ceil((this.y+this.height-i)*t)/t;return this.x=Math.floor((this.x+i)*t)/t,this.y=Math.floor((this.y+i)*t)/t,this.width=s-this.x,this.height=h-this.y,this},t.prototype.enlarge=function(t){var i=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),h=Math.min(this.y,t.y),o=Math.max(this.y+this.height,t.y+t.height);return this.x=i,this.width=s-i,this.y=h,this.height=o-h,this},t}();exports.Rectangle=o;var r=function(){function t(t,i,h){void 0===t&&(t=0),void 0===i&&(i=0),void 0===h&&(h=0),this.x=t,this.y=i,this.radius=h,this.type=s.CIRC}return t.prototype.clone=function(){return new t(this.x,this.y,this.radius)},t.prototype.contains=function(t,i){if(this.radius<=0)return!1;var s=this.radius*this.radius,h=this.x-t,o=this.y-i;return(h*=h)+(o*=o)<=s},t.prototype.getBounds=function(){return new o(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},t}();exports.Circle=r;var e=function(){function t(t,i,h,o){void 0===t&&(t=0),void 0===i&&(i=0),void 0===h&&(h=0),void 0===o&&(o=0),this.x=t,this.y=i,this.width=h,this.height=o,this.type=s.ELIP}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;var s=(t-this.x)/this.width,h=(i-this.y)/this.height;return(s*=s)+(h*=h)<=1},t.prototype.getBounds=function(){return new o(this.x-this.width,this.y-this.height,this.width,this.height)},t}();exports.Ellipse=e;var n=function(){function t(){for(var t=arguments,i=[],h=0;h<arguments.length;h++)i[h]=t[h];var o=Array.isArray(i[0])?i[0]:i;if("number"!=typeof o[0]){for(var r=[],e=0,n=o.length;e<n;e++)r.push(o[e].x,o[e].y);o=r}this.points=o,this.type=s.POLY,this.closeStroke=!0}return t.prototype.clone=function(){var i=new t(this.points.slice());return i.closeStroke=this.closeStroke,i},t.prototype.contains=function(t,i){for(var s=!1,h=this.points.length/2,o=0,r=h-1;o<h;r=o++){var e=this.points[2*o],n=this.points[2*o+1],a=this.points[2*r],c=this.points[2*r+1];n>i!=c>i&&t<(i-n)/(c-n)*(a-e)+e&&(s=!s)}return s},t}();exports.Polygon=n;var a=function(){function t(t,i,h,o,r){void 0===t&&(t=0),void 0===i&&(i=0),void 0===h&&(h=0),void 0===o&&(o=0),void 0===r&&(r=20),this.x=t,this.y=i,this.width=h,this.height=o,this.radius=r,this.type=s.RREC}return t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height,this.radius)},t.prototype.contains=function(t,i){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&i>=this.y&&i<=this.y+this.height){if(i>=this.y+this.radius&&i<=this.y+this.height-this.radius||t>=this.x+this.radius&&t<=this.x+this.width-this.radius)return!0;var s=t-(this.x+this.radius),h=i-(this.y+this.radius),o=this.radius*this.radius;if(s*s+h*h<=o)return!0;if((s=t-(this.x+this.width-this.radius))*s+h*h<=o)return!0;if(s*s+(h=i-(this.y+this.height-this.radius))*h<=o)return!0;if((s=t-(this.x+this.radius))*s+h*h<=o)return!0}return!1},t}();exports.RoundedRectangle=a;var c=function(){function t(t,i){void 0===t&&(t=0),void 0===i&&(i=0),this.x=t,this.y=i}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this.x=t,this.y=i,this},t}();exports.Point=c;var u=function(){function t(t,i,s,h){void 0===s&&(s=0),void 0===h&&(h=0),this._x=s,this._y=h,this.cb=t,this.scope=i}return t.prototype.clone=function(i,s){return void 0===i&&(i=this.cb),void 0===s&&(s=this.scope),new t(i,s,this._x,this._y)},t.prototype.set=function(t,i){return void 0===t&&(t=0),void 0===i&&(i=t),this._x===t&&this._y===i||(this._x=t,this._y=i,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}();exports.ObservablePoint=u;var p=function(){function i(t,i,s,h,o,r){void 0===t&&(t=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===h&&(h=1),void 0===o&&(o=0),void 0===r&&(r=0),this.array=null,this.a=t,this.b=i,this.c=s,this.d=h,this.tx=o,this.ty=r}return i.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},i.prototype.set=function(t,i,s,h,o,r){return this.a=t,this.b=i,this.c=s,this.d=h,this.tx=o,this.ty=r,this},i.prototype.toArray=function(t,i){this.array||(this.array=new Float32Array(9));var s=i||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s},i.prototype.apply=function(t,i){i=i||new c;var s=t.x,h=t.y;return i.x=this.a*s+this.c*h+this.tx,i.y=this.b*s+this.d*h+this.ty,i},i.prototype.applyInverse=function(t,i){i=i||new c;var s=1/(this.a*this.d+this.c*-this.b),h=t.x,o=t.y;return i.x=this.d*s*h+-this.c*s*o+(this.ty*this.c-this.tx*this.d)*s,i.y=this.a*s*o+-this.b*s*h+(-this.ty*this.a+this.tx*this.b)*s,i},i.prototype.translate=function(t,i){return this.tx+=t,this.ty+=i,this},i.prototype.scale=function(t,i){return this.a*=t,this.d*=i,this.c*=t,this.b*=i,this.tx*=t,this.ty*=i,this},i.prototype.rotate=function(t){var i=Math.cos(t),s=Math.sin(t),h=this.a,o=this.c,r=this.tx;return this.a=h*i-this.b*s,this.b=h*s+this.b*i,this.c=o*i-this.d*s,this.d=o*s+this.d*i,this.tx=r*i-this.ty*s,this.ty=r*s+this.ty*i,this},i.prototype.append=function(t){var i=this.a,s=this.b,h=this.c,o=this.d;return this.a=t.a*i+t.b*h,this.b=t.a*s+t.b*o,this.c=t.c*i+t.d*h,this.d=t.c*s+t.d*o,this.tx=t.tx*i+t.ty*h+this.tx,this.ty=t.tx*s+t.ty*o+this.ty,this},i.prototype.setTransform=function(t,i,s,h,o,r,e,n,a){return this.a=Math.cos(e+a)*o,this.b=Math.sin(e+a)*o,this.c=-Math.sin(e-n)*r,this.d=Math.cos(e-n)*r,this.tx=t-(s*this.a+h*this.c),this.ty=i-(s*this.b+h*this.d),this},i.prototype.prepend=function(t){var i=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var s=this.a,h=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=h*t.a+this.d*t.c,this.d=h*t.b+this.d*t.d}return this.tx=i*t.a+this.ty*t.c+t.tx,this.ty=i*t.b+this.ty*t.d+t.ty,this},i.prototype.decompose=function(i){var s=this.a,h=this.b,o=this.c,r=this.d,e=-Math.atan2(-o,r),n=Math.atan2(h,s),a=Math.abs(e+n);return a<1e-5||Math.abs(t-a)<1e-5?(i.rotation=n,i.skew.x=i.skew.y=0):(i.rotation=0,i.skew.x=e,i.skew.y=n),i.scale.x=Math.sqrt(s*s+h*h),i.scale.y=Math.sqrt(o*o+r*r),i.position.x=this.tx,i.position.y=this.ty,i},i.prototype.invert=function(){var t=this.a,i=this.b,s=this.c,h=this.d,o=this.tx,r=t*h-i*s;return this.a=h/r,this.b=-i/r,this.c=-s/r,this.d=t/r,this.tx=(s*this.ty-h*o)/r,this.ty=-(t*this.ty-i*o)/r,this},i.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},i.prototype.clone=function(){var t=new i;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},i.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},i.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(i,"IDENTITY",{get:function(){return new i},enumerable:!1,configurable:!0}),Object.defineProperty(i,"TEMP_MATRIX",{get:function(){return new i},enumerable:!1,configurable:!0}),i}();exports.Matrix=p;var y=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],d=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],x=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],f=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],l=[],v=[],b=Math.sign;function _(){for(var t=0;t<16;t++){var i=[];l.push(i);for(var s=0;s<16;s++)for(var h=b(y[t]*y[s]+x[t]*d[s]),o=b(d[t]*y[s]+f[t]*d[s]),r=b(y[t]*x[s]+x[t]*f[s]),e=b(d[t]*x[s]+f[t]*f[s]),n=0;n<16;n++)if(y[n]===h&&d[n]===o&&x[n]===r&&f[n]===e){i.push(n);break}}for(t=0;t<16;t++){var a=new p;a.set(y[t],d[t],x[t],f[t],0,0),v.push(a)}}_();var w={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return y[t]},uY:function(t){return d[t]},vX:function(t){return x[t]},vY:function(t){return f[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,i){return l[t][i]},sub:function(t,i){return l[t][w.inv(i)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,i){return 2*Math.abs(t)<=Math.abs(i)?i>=0?w.S:w.N:2*Math.abs(i)<=Math.abs(t)?t>0?w.E:w.W:i>0?t>0?w.SE:w.SW:t>0?w.NE:w.NW},matrixAppendRotationInv:function(t,i,s,h){void 0===s&&(s=0),void 0===h&&(h=0);var o=v[w.inv(i)];o.tx=s,o.ty=h,t.append(o)}};exports.groupD8=w;var g=function(){function t(){this.worldTransform=new p,this.localTransform=new p,this.position=new u(this.onChange,this,0,0),this.scale=new u(this.onChange,this,1,1),this.pivot=new u(this.onChange,this,0,0),this.skew=new u(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var i=this.localTransform;if(this._localID!==this._currentLocalID&&(i.a=this._cx*this.scale.x,i.b=this._sx*this.scale.x,i.c=this._cy*this.scale.y,i.d=this._sy*this.scale.y,i.tx=this.position.x-(this.pivot.x*i.a+this.pivot.y*i.c),i.ty=this.position.y-(this.pivot.x*i.b+this.pivot.y*i.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var s=t.worldTransform,h=this.worldTransform;h.a=i.a*s.a+i.b*s.c,h.b=i.a*s.b+i.b*s.d,h.c=i.c*s.a+i.d*s.c,h.d=i.c*s.b+i.d*s.d,h.tx=i.tx*s.a+i.ty*s.c+s.tx,h.ty=i.tx*s.b+i.ty*s.d+s.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();exports.Transform=g;
},{}],"qvzw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TemporaryDisplayObject=exports.DisplayObject=exports.Container=exports.Bounds=void 0;var t=require("@pixi/settings"),e=require("@pixi/math"),i=require("@pixi/utils");t.settings.SORTABLE_CHILDREN=!1;var n=function(){function t(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return t.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},t.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},t.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?e.Rectangle.EMPTY:((t=t||new e.Rectangle(0,0,1,1)).x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},t.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},t.prototype.addQuad=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY,s=t[0],o=t[1];e=s<e?s:e,i=o<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[2])<e?s:e,i=(o=t[3])<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[4])<e?s:e,i=(o=t[5])<i?o:i,n=s>n?s:n,r=o>r?o:r,e=(s=t[6])<e?s:e,i=(o=t[7])<i?o:i,n=s>n?s:n,r=o>r?o:r,this.minX=e,this.minY=i,this.maxX=n,this.maxY=r},t.prototype.addFrame=function(t,e,i,n,r){this.addFrameMatrix(t.worldTransform,e,i,n,r)},t.prototype.addFrameMatrix=function(t,e,i,n,r){var s=t.a,o=t.b,a=t.c,h=t.d,l=t.tx,d=t.ty,p=this.minX,m=this.minY,u=this.maxX,c=this.maxY,f=s*e+a*i+l,y=o*e+h*i+d;p=f<p?f:p,m=y<m?y:m,u=f>u?f:u,c=y>c?y:c,p=(f=s*n+a*i+l)<p?f:p,m=(y=o*n+h*i+d)<m?y:m,u=f>u?f:u,c=y>c?y:c,p=(f=s*e+a*r+l)<p?f:p,m=(y=o*e+h*r+d)<m?y:m,u=f>u?f:u,c=y>c?y:c,p=(f=s*n+a*r+l)<p?f:p,m=(y=o*n+h*r+d)<m?y:m,u=f>u?f:u,c=y>c?y:c,this.minX=p,this.minY=m,this.maxX=u,this.maxY=c},t.prototype.addVertexData=function(t,e,i){for(var n=this.minX,r=this.minY,s=this.maxX,o=this.maxY,a=e;a<i;a+=2){var h=t[a],l=t[a+1];n=h<n?h:n,r=l<r?l:r,s=h>s?h:s,o=l>o?l:o}this.minX=n,this.minY=r,this.maxX=s,this.maxY=o},t.prototype.addVertices=function(t,e,i,n){this.addVerticesMatrix(t.worldTransform,e,i,n)},t.prototype.addVerticesMatrix=function(t,e,i,n,r,s){void 0===r&&(r=0),void 0===s&&(s=r);for(var o=t.a,a=t.b,h=t.c,l=t.d,d=t.tx,p=t.ty,m=this.minX,u=this.minY,c=this.maxX,f=this.maxY,y=i;y<n;y+=2){var b=e[y],x=e[y+1],v=o*b+h*x+d,_=l*x+a*b+p;m=Math.min(m,v-r),c=Math.max(c,v+r),u=Math.min(u,_-s),f=Math.max(f,_+s)}this.minX=m,this.minY=u,this.maxX=c,this.maxY=f},t.prototype.addBounds=function(t){var e=this.minX,i=this.minY,n=this.maxX,r=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<i?t.minY:i,this.maxX=t.maxX>n?t.maxX:n,this.maxY=t.maxY>r?t.maxY:r},t.prototype.addBoundsMask=function(t,e){var i=t.minX>e.minX?t.minX:e.minX,n=t.minY>e.minY?t.minY:e.minY,r=t.maxX<e.maxX?t.maxX:e.maxX,s=t.maxY<e.maxY?t.maxY:e.maxY;if(i<=r&&n<=s){var o=this.minX,a=this.minY,h=this.maxX,l=this.maxY;this.minX=i<o?i:o,this.minY=n<a?n:a,this.maxX=r>h?r:h,this.maxY=s>l?s:l}},t.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},t.prototype.addBoundsArea=function(t,e){var i=t.minX>e.x?t.minX:e.x,n=t.minY>e.y?t.minY:e.y,r=t.maxX<e.x+e.width?t.maxX:e.x+e.width,s=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(i<=r&&n<=s){var o=this.minX,a=this.minY,h=this.maxX,l=this.maxY;this.minX=i<o?i:o,this.minY=n<a?n:a,this.maxX=r>h?r:h,this.maxY=s>l?s:l}},t.prototype.pad=function(t,e){void 0===t&&(t=0),void 0===e&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},t.prototype.addFramePad=function(t,e,i,n,r,s){t-=r,e-=s,i+=r,n+=s,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>i?this.maxX:i,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>n?this.maxY:n},t}();exports.Bounds=n;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function s(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(t){function i(){var i=t.call(this)||this;return i.tempDisplayObjectParent=null,i.transform=new e.Transform,i.alpha=1,i.visible=!0,i.renderable=!0,i.parent=null,i.worldAlpha=1,i._lastSortedIndex=0,i._zIndex=0,i.filterArea=null,i.filters=null,i._enabledFilters=null,i._bounds=new n,i._localBounds=null,i._boundsID=0,i._boundsRect=null,i._localBoundsRect=null,i._mask=null,i._destroyed=!1,i.isSprite=!1,i.isMask=!1,i}return s(i,t),i.mixin=function(t){for(var e=Object.keys(t),n=0;n<e.length;++n){var r=e[n];Object.defineProperty(i.prototype,r,Object.getOwnPropertyDescriptor(t,r))}},i.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},i.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},i.prototype.getBounds=function(t,i){return t||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),i||(this._boundsRect||(this._boundsRect=new e.Rectangle),i=this._boundsRect),this._bounds.getRectangle(i)},i.prototype.getLocalBounds=function(t){t||(this._localBoundsRect||(this._localBoundsRect=new e.Rectangle),t=this._localBoundsRect),this._localBounds||(this._localBounds=new n);var i=this.transform,r=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var s=this._bounds,o=this._boundsID;this._bounds=this._localBounds;var a=this.getBounds(!1,t);return this.parent=r,this.transform=i,this._bounds=s,this._bounds.updateID+=this._boundsID-o,a},i.prototype.toGlobal=function(t,e,i){return void 0===i&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(t,e)},i.prototype.toLocal=function(t,e,i,n){return e&&(t=e.toGlobal(t,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(t,i)},i.prototype.setParent=function(t){if(!t||!t.addChild)throw new Error("setParent: Argument must be a Container");return t.addChild(this),t},i.prototype.setTransform=function(t,e,i,n,r,s,o,a,h){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),void 0===r&&(r=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===a&&(a=0),void 0===h&&(h=0),this.position.x=t,this.position.y=e,this.scale.x=i||1,this.scale.y=n||1,this.rotation=r,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=h,this},i.prototype.destroy=function(t){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},Object.defineProperty(i.prototype,"_tempDisplayObjectParent",{get:function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new a),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),i.prototype.enableTempParent=function(){var t=this.parent;return this.parent=this._tempDisplayObjectParent,t},i.prototype.disableTempParent=function(t){this.parent=t},Object.defineProperty(i.prototype,"x",{get:function(){return this.position.x},set:function(t){this.transform.position.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this.position.y},set:function(t){this.transform.position.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.transform.position},set:function(t){this.transform.position.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scale",{get:function(){return this.transform.scale},set:function(t){this.transform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(t){this.transform.pivot.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"skew",{get:function(){return this.transform.skew},set:function(t){this.transform.skew.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(t){this.transform.rotation=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"angle",{get:function(){return this.transform.rotation*e.RAD_TO_DEG},set:function(t){this.transform.rotation=t*e.DEG_TO_RAD},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"zIndex",{get:function(){return this._zIndex},set:function(t){this._zIndex=t,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"worldVisible",{get:function(){var t=this;do{if(!t.visible)return!1;t=t.parent}while(t);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"mask",{get:function(){return this._mask},set:function(t){var e;this._mask&&((e=this._mask.maskObject||this._mask).renderable=!0,e.isMask=!1);(this._mask=t,this._mask)&&((e=this._mask.maskObject||this._mask).renderable=!1,e.isMask=!0)},enumerable:!1,configurable:!0}),i}(i.EventEmitter);exports.DisplayObject=o;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sortDirty=null,e}return s(e,t),e}(o);function h(t,e){return t.zIndex===e.zIndex?t._lastSortedIndex-e._lastSortedIndex:t.zIndex-e.zIndex}exports.TemporaryDisplayObject=a,o.prototype.displayObjectUpdateTransform=o.prototype.updateTransform;var l=function(e){function n(){var i=e.call(this)||this;return i.children=[],i.sortableChildren=t.settings.SORTABLE_CHILDREN,i.sortDirty=!1,i}return s(n,e),n.prototype.onChildrenChange=function(t){},n.prototype.addChild=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(e.length>1)for(var n=0;n<e.length;n++)this.addChild(e[n]);else{var r=e[0];r.parent&&r.parent.removeChild(r),r.parent=this,this.sortDirty=!0,r.transform._parentID=-1,this.children.push(r),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",r,this,this.children.length-1),r.emit("added",this)}return e[0]},n.prototype.addChildAt=function(t,e){if(e<0||e>this.children.length)throw new Error(t+"addChildAt: The index "+e+" supplied is out of bounds "+this.children.length);return t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.splice(e,0,t),this._boundsID++,this.onChildrenChange(e),t.emit("added",this),this.emit("childAdded",t,this,e),t},n.prototype.swapChildren=function(t,e){if(t!==e){var i=this.getChildIndex(t),n=this.getChildIndex(e);this.children[i]=e,this.children[n]=t,this.onChildrenChange(i<n?i:n)}},n.prototype.getChildIndex=function(t){var e=this.children.indexOf(t);if(-1===e)throw new Error("The supplied DisplayObject must be a child of the caller");return e},n.prototype.setChildIndex=function(t,e){if(e<0||e>=this.children.length)throw new Error("The index "+e+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(t);(0,i.removeItems)(this.children,n,1),this.children.splice(e,0,t),this.onChildrenChange(e)},n.prototype.getChildAt=function(t){if(t<0||t>=this.children.length)throw new Error("getChildAt: Index ("+t+") does not exist.");return this.children[t]},n.prototype.removeChild=function(){for(var t=arguments,e=[],n=0;n<arguments.length;n++)e[n]=t[n];if(e.length>1)for(var r=0;r<e.length;r++)this.removeChild(e[r]);else{var s=e[0],o=this.children.indexOf(s);if(-1===o)return null;s.parent=null,s.transform._parentID=-1,(0,i.removeItems)(this.children,o,1),this._boundsID++,this.onChildrenChange(o),s.emit("removed",this),this.emit("childRemoved",s,this,o)}return e[0]},n.prototype.removeChildAt=function(t){var e=this.getChildAt(t);return e.parent=null,e.transform._parentID=-1,(0,i.removeItems)(this.children,t,1),this._boundsID++,this.onChildrenChange(t),e.emit("removed",this),this.emit("childRemoved",e,this,t),e},n.prototype.removeChildren=function(t,e){void 0===t&&(t=0),void 0===e&&(e=this.children.length);var i,n=t,r=e-n;if(r>0&&r<=e){i=this.children.splice(n,r);for(var s=0;s<i.length;++s)i[s].parent=null,i[s].transform&&(i[s].transform._parentID=-1);this._boundsID++,this.onChildrenChange(t);for(s=0;s<i.length;++s)i[s].emit("removed",this),this.emit("childRemoved",i[s],this,s);return i}if(0===r&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},n.prototype.sortChildren=function(){for(var t=!1,e=0,i=this.children.length;e<i;++e){var n=this.children[e];n._lastSortedIndex=e,t||0===n.zIndex||(t=!0)}t&&this.children.length>1&&this.children.sort(h),this.sortDirty=!1},n.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var t=0,e=this.children.length;t<e;++t){var i=this.children[t];i.visible&&i.updateTransform()}},n.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var t=0;t<this.children.length;t++){var e=this.children[t];if(e.visible&&e.renderable)if(e.calculateBounds(),e._mask){var i=e._mask.maskObject||e._mask;i.calculateBounds(),this._bounds.addBoundsMask(e._bounds,i._bounds)}else e.filterArea?this._bounds.addBoundsArea(e._bounds,e.filterArea):this._bounds.addBounds(e._bounds)}this._bounds.updateID=this._boundsID},n.prototype.getLocalBounds=function(t,i){void 0===i&&(i=!1);var n=e.prototype.getLocalBounds.call(this,t);if(!i)for(var r=0,s=this.children.length;r<s;++r){var o=this.children[r];o.visible&&o.updateTransform()}return n},n.prototype._calculateBounds=function(){},n.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(t);else{this._render(t);for(var e=0,i=this.children.length;e<i;++e)this.children[e].render(t)}},n.prototype.renderAdvanced=function(t){t.batch.flush();var e=this.filters,i=this._mask;if(e){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<e.length;n++)e[n].enabled&&this._enabledFilters.push(e[n]);this._enabledFilters.length&&t.filter.push(this,this._enabledFilters)}i&&t.mask.push(this,this._mask),this._render(t);n=0;for(var r=this.children.length;n<r;n++)this.children[n].render(t);t.batch.flush(),i&&t.mask.pop(this),e&&this._enabledFilters&&this._enabledFilters.length&&t.filter.pop()},n.prototype._render=function(t){},n.prototype.destroy=function(t){e.prototype.destroy.call(this),this.sortDirty=!1;var i="boolean"==typeof t?t:t&&t.children,n=this.removeChildren(0,this.children.length);if(i)for(var r=0;r<n.length;++r)n[r].destroy(t)},Object.defineProperty(n.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(t){var e=this.getLocalBounds().width;this.scale.x=0!==e?t/e:1,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(t){var e=this.getLocalBounds().height;this.scale.y=0!==e?t/e:1,this._height=t},enumerable:!1,configurable:!0}),n}(o);exports.Container=l,l.prototype.containerUpdateTransform=l.prototype.updateTransform;
},{"@pixi/settings":"Xe2x","@pixi/math":"w9h1","@pixi/utils":"X4iF"}],"JMFw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.accessibleTarget=exports.AccessibilityManager=void 0;var e=require("@pixi/display"),t=require("@pixi/utils"),i={accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1};exports.accessibleTarget=i,e.DisplayObject.mixin(i);var s=9,n=100,o=0,r=0,l=2,a=1,c=-1e3,d=-1e3,h=2,p=function(){function e(e){this._hookDiv=null,(t.isMobile.tablet||t.isMobile.phone)&&this.createTouchHook();var i=document.createElement("div");i.style.width=n+"px",i.style.height=n+"px",i.style.position="absolute",i.style.top=o+"px",i.style.left=r+"px",i.style.zIndex=l.toString(),this.div=i,this.pool=[],this.renderId=0,this.debug=!1,this.renderer=e,this.children=[],this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._isActive=!1,this._isMobileAccessibility=!1,this.androidUpdateCount=0,this.androidUpdateFrequency=500,window.addEventListener("keydown",this._onKeyDown,!1)}return Object.defineProperty(e.prototype,"isActive",{get:function(){return this._isActive},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isMobileAccessibility",{get:function(){return this._isMobileAccessibility},enumerable:!1,configurable:!0}),e.prototype.createTouchHook=function(){var e=this,t=document.createElement("button");t.style.width=a+"px",t.style.height=a+"px",t.style.position="absolute",t.style.top=c+"px",t.style.left=d+"px",t.style.zIndex=h.toString(),t.style.backgroundColor="#FF0000",t.title="select to enable accessability for this content",t.addEventListener("focus",function(){e._isMobileAccessibility=!0,e.activate(),e.destroyTouchHook()}),document.body.appendChild(t),this._hookDiv=t},e.prototype.destroyTouchHook=function(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)},e.prototype.activate=function(){this._isActive||(this._isActive=!0,window.document.addEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode&&this.renderer.view.parentNode.appendChild(this.div))},e.prototype.deactivate=function(){this._isActive&&!this._isMobileAccessibility&&(this._isActive=!1,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode&&this.div.parentNode.removeChild(this.div))},e.prototype.updateAccessibleObjects=function(e){if(e.visible&&e.accessibleChildren){e.accessible&&e.interactive&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);for(var t=e.children,i=0;i<t.length;i++)this.updateAccessibleObjects(t[i])}},e.prototype.update=function(){var e=performance.now();if(!(t.isMobile.android.device&&e<this.androidUpdateCount)&&(this.androidUpdateCount=e+this.androidUpdateFrequency,this.renderer.renderingToScreen)){this.renderer._lastObjectRendered&&this.updateAccessibleObjects(this.renderer._lastObjectRendered);var i=this.renderer.view.getBoundingClientRect(),s=this.renderer.resolution,n=i.width/this.renderer.width*s,o=i.height/this.renderer.height*s,r=this.div;r.style.left=i.left+"px",r.style.top=i.top+"px",r.style.width=this.renderer.width+"px",r.style.height=this.renderer.height+"px";for(var l=0;l<this.children.length;l++){var a=this.children[l];if(a.renderId!==this.renderId)a._accessibleActive=!1,(0,t.removeItems)(this.children,l,1),this.div.removeChild(a._accessibleDiv),this.pool.push(a._accessibleDiv),a._accessibleDiv=null,l--;else{r=a._accessibleDiv;var c=a.hitArea,d=a.worldTransform;a.hitArea?(r.style.left=(d.tx+c.x*d.a)*n+"px",r.style.top=(d.ty+c.y*d.d)*o+"px",r.style.width=c.width*d.a*n+"px",r.style.height=c.height*d.d*o+"px"):(c=a.getBounds(),this.capHitArea(c),r.style.left=c.x*n+"px",r.style.top=c.y*o+"px",r.style.width=c.width*n+"px",r.style.height=c.height*o+"px",r.title!==a.accessibleTitle&&null!==a.accessibleTitle&&(r.title=a.accessibleTitle),r.getAttribute("aria-label")!==a.accessibleHint&&null!==a.accessibleHint&&r.setAttribute("aria-label",a.accessibleHint)),a.accessibleTitle===r.title&&a.tabIndex===r.tabIndex||(r.title=a.accessibleTitle,r.tabIndex=a.tabIndex,this.debug&&this.updateDebugHTML(r))}}this.renderId++}},e.prototype.updateDebugHTML=function(e){e.innerHTML="type: "+e.type+"</br> title : "+e.title+"</br> tabIndex: "+e.tabIndex},e.prototype.capHitArea=function(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0),e.x+e.width>this.renderer.width&&(e.width=this.renderer.width-e.x),e.y+e.height>this.renderer.height&&(e.height=this.renderer.height-e.y)},e.prototype.addChild=function(e){var t=this.pool.pop();t||((t=document.createElement("button")).style.width=n+"px",t.style.height=n+"px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=l.toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().indexOf("chrome")>-1?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title="displayObject "+e.tabIndex),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex},e.prototype._onClick=function(e){var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"click",t.eventData),t.dispatchEvent(e.target.displayObject,"pointertap",t.eventData),t.dispatchEvent(e.target.displayObject,"tap",t.eventData)},e.prototype._onFocus=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseover",t.eventData)},e.prototype._onFocusOut=function(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite");var t=this.renderer.plugins.interaction;t.dispatchEvent(e.target.displayObject,"mouseout",t.eventData)},e.prototype._onKeyDown=function(e){e.keyCode===s&&this.activate()},e.prototype._onMouseMove=function(e){0===e.movementX&&0===e.movementY||this.deactivate()},e.prototype.destroy=function(){this.destroyTouchHook(),this.div=null,window.document.removeEventListener("mousemove",this._onMouseMove,!0),window.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null},e}();exports.AccessibilityManager=p;
},{"@pixi/display":"qvzw","@pixi/utils":"X4iF"}],"AWzT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.UPDATE_PRIORITY=exports.TickerPlugin=exports.Ticker=void 0;var t,e=require("@pixi/settings");e.settings.TARGET_FPMS=.06,exports.UPDATE_PRIORITY=t,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(t||(exports.UPDATE_PRIORITY=t={}));var i=function(){function t(t,e,i,s){void 0===e&&(e=null),void 0===i&&(i=0),void 0===s&&(s=!1),this.fn=t,this.context=e,this.priority=i,this.once=s,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),s=function(){function s(){var t=this;this._head=new i(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/e.settings.TARGET_FPMS,this.elapsedMS=1/e.settings.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return s.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},s.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},s.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},s.prototype.add=function(e,s,r){return void 0===r&&(r=t.NORMAL),this._addListener(new i(e,s,r))},s.prototype.addOnce=function(e,s,r){return void 0===r&&(r=t.NORMAL),this._addListener(new i(e,s,r,!0))},s.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},s.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(s.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),s.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},s.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},s.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},s.prototype.update=function(t){var i;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((i=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(i=this._maxElapsedMS),i*=this.speed,this._minElapsedMS){var s=t-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=t-s%this._minElapsedMS}this.deltaMS=i,this.deltaTime=this.deltaMS*e.settings.TARGET_FPMS;for(var r=this._head,n=r.next;n;)n=n.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(s.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var i=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,i)/1e3,e.settings.TARGET_FPMS);this._maxElapsedMS=1/s},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(s,"shared",{get:function(){if(!s._shared){var t=s._shared=new s;t.autoStart=!0,t._protected=!0}return s._shared},enumerable:!1,configurable:!0}),Object.defineProperty(s,"system",{get:function(){if(!s._system){var t=s._system=new s;t.autoStart=!0,t._protected=!0}return s._system},enumerable:!1,configurable:!0}),s}();exports.Ticker=s;var r=function(){function e(){}return e.init=function(e){var i=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,t.LOW)},get:function(){return this._ticker}}),this.stop=function(){i._ticker.stop()},this.start=function(){i._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?s.shared:new s,e.autoStart&&this.start()},e.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},e}();exports.TickerPlugin=r;
},{"@pixi/settings":"Xe2x"}],"hG98":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.interactiveTarget=exports.InteractionTrackingData=exports.InteractionManager=exports.InteractionEvent=exports.InteractionData=void 0;var t=require("@pixi/math"),e=require("@pixi/ticker"),i=require("@pixi/display"),n=require("@pixi/utils"),o=function(){function e(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new t.Point,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(e.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),e.prototype.getLocalPosition=function(t,e,i){return t.worldTransform.applyInverse(i||this.global,e)},e.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},e.prototype.reset=function(){this.isPrimary=!1},e}();exports.InteractionData=o;var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function s(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var a=function(){function t(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return t.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},t.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},t}();exports.InteractionEvent=a;var h=function(){function t(e){this._pointerId=e,this._flags=t.FLAGS.NONE}return t.prototype._doSet=function(t,e){this._flags=e?this._flags|t:this._flags&~t},Object.defineProperty(t.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"none",{get:function(){return this._flags===t.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"over",{get:function(){return 0!=(this._flags&t.FLAGS.OVER)},set:function(e){this._doSet(t.FLAGS.OVER,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rightDown",{get:function(){return 0!=(this._flags&t.FLAGS.RIGHT_DOWN)},set:function(e){this._doSet(t.FLAGS.RIGHT_DOWN,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leftDown",{get:function(){return 0!=(this._flags&t.FLAGS.LEFT_DOWN)},set:function(e){this._doSet(t.FLAGS.LEFT_DOWN,e)},enumerable:!1,configurable:!0}),t.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),t}();exports.InteractionTrackingData=h;var c=function(){function e(){this._tempPoint=new t.Point}return e.prototype.recursiveFindHit=function(t,e,i,n,o){if(!e||!e.visible)return!1;var r=t.data.global,s=!1,a=o=e.interactive||o,h=!0;if(e.hitArea?(n&&(e.worldTransform.applyInverse(r,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?s=!0:(n=!1,h=!1)),a=!1):e._mask&&n&&(e._mask.containsPoint&&e._mask.containsPoint(r)||(n=!1)),h&&e.interactiveChildren&&e.children)for(var c=e.children,p=c.length-1;p>=0;p--){var u=c[p],l=this.recursiveFindHit(t,u,i,n,a);if(l){if(!u.parent)continue;a=!1,l&&(t.target&&(n=!1),s=!0)}}return o&&(n&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(r)&&(s=!0),e.interactive&&(s&&!t.target&&(t.target=e),i&&i(t,e,!!s))),s},e.prototype.findHit=function(t,e,i,n){this.recursiveFindHit(t,e,i,n,!1)},e}(),p={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return"pointer"===this.cursor},set buttonMode(t){t?this.cursor="pointer":"pointer"===this.cursor&&(this.cursor=null)},cursor:null,get trackedPointers(){return void 0===this._trackedPointers&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};exports.interactiveTarget=p,i.DisplayObject.mixin(p);var u=1,l={target:null,data:{global:null}},d=function(t){function n(e,n){var r=t.call(this)||this;return n=n||{},r.renderer=e,r.autoPreventDefault=void 0===n.autoPreventDefault||n.autoPreventDefault,r.interactionFrequency=n.interactionFrequency||10,r.mouse=new o,r.mouse.identifier=u,r.mouse.global.set(-999999),r.activeInteractionData={},r.activeInteractionData[u]=r.mouse,r.interactionDataPool=[],r.eventData=new a,r.interactionDOMElement=null,r.moveWhenInside=!1,r.eventsAdded=!1,r.tickerAdded=!1,r.mouseOverRenderer=!1,r.supportsTouchEvents="ontouchstart"in window,r.supportsPointerEvents=!!window.PointerEvent,r.onPointerUp=r.onPointerUp.bind(r),r.processPointerUp=r.processPointerUp.bind(r),r.onPointerCancel=r.onPointerCancel.bind(r),r.processPointerCancel=r.processPointerCancel.bind(r),r.onPointerDown=r.onPointerDown.bind(r),r.processPointerDown=r.processPointerDown.bind(r),r.onPointerMove=r.onPointerMove.bind(r),r.processPointerMove=r.processPointerMove.bind(r),r.onPointerOut=r.onPointerOut.bind(r),r.processPointerOverOut=r.processPointerOverOut.bind(r),r.onPointerOver=r.onPointerOver.bind(r),r.cursorStyles={default:"inherit",pointer:"pointer"},r.currentCursorMode=null,r.cursor=null,r.resolution=1,r.delayedEvents=[],r.search=new c,r._tempDisplayObject=new i.TemporaryDisplayObject,r._useSystemTicker=void 0===n.useSystemTicker||n.useSystemTicker,r.setTargetElement(r.renderer.view,r.renderer.resolution),r}return s(n,t),Object.defineProperty(n.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(t){this._useSystemTicker=t,t?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),n.prototype.hitTest=function(t,e){return l.target=null,l.data.global=t,e||(e=this.lastObjectRendered),this.processInteractive(l,e,null,!0),l.target},n.prototype.setTargetElement=function(t,e){void 0===e&&(e=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=t,this.resolution=e,this.addEvents(),this.addTickerListener()},n.prototype.addTickerListener=function(){!this.tickerAdded&&this.interactionDOMElement&&this._useSystemTicker&&(e.Ticker.system.add(this.tickerUpdate,this,e.UPDATE_PRIORITY.INTERACTION),this.tickerAdded=!0)},n.prototype.removeTickerListener=function(){this.tickerAdded&&(e.Ticker.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},n.prototype.addEvents=function(){if(!this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="none",t.msTouchAction="none"):this.supportsPointerEvents&&(t.touchAction="none"),this.supportsPointerEvents?(window.document.addEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,!0),window.addEventListener("pointercancel",this.onPointerCancel,!0),window.addEventListener("pointerup",this.onPointerUp,!0)):(window.document.addEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,!0),window.addEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,!0)),this.eventsAdded=!0}},n.prototype.removeEvents=function(){if(this.eventsAdded&&this.interactionDOMElement){var t=this.interactionDOMElement.style;window.navigator.msPointerEnabled?(t.msContentZooming="",t.msTouchAction=""):this.supportsPointerEvents&&(t.touchAction=""),this.supportsPointerEvents?(window.document.removeEventListener("pointermove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,!0),window.removeEventListener("pointercancel",this.onPointerCancel,!0),window.removeEventListener("pointerup",this.onPointerUp,!0)):(window.document.removeEventListener("mousemove",this.onPointerMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,!0),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,!0),window.removeEventListener("mouseup",this.onPointerUp,!0)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,!0),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,!0),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,!0)),this.interactionDOMElement=null,this.eventsAdded=!1}},n.prototype.tickerUpdate=function(t){this._deltaTime+=t,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())},n.prototype.update=function(){if(this.interactionDOMElement)if(this._didMove)this._didMove=!1;else{for(var t in this.cursor=null,this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(t)){var e=this.activeInteractionData[t];if(e.originalEvent&&"touch"!==e.pointerType){var i=this.configureInteractionEventForDOMEvent(this.eventData,e.originalEvent,e);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},n.prototype.setCursorMode=function(t){if(t=t||"default",this.currentCursorMode!==t){this.currentCursorMode=t;var e=this.cursorStyles[t];if(e)switch(typeof e){case"string":this.interactionDOMElement.style.cursor=e;break;case"function":e(t);break;case"object":Object.assign(this.interactionDOMElement.style,e)}else"string"!=typeof t||Object.prototype.hasOwnProperty.call(this.cursorStyles,t)||(this.interactionDOMElement.style.cursor=t)}},n.prototype.dispatchEvent=function(t,e,i){i.stopPropagationHint&&t!==i.stopsPropagatingAt||(i.currentTarget=t,i.type=e,t.emit(e,i),t[e]&&t[e](i))},n.prototype.delayDispatchEvent=function(t,e,i){this.delayedEvents.push({displayObject:t,eventString:e,eventData:i})},n.prototype.mapPositionToPoint=function(t,e,i){var n;n=this.interactionDOMElement.parentElement?this.interactionDOMElement.getBoundingClientRect():{x:0,y:0,width:0,height:0};var o=1/this.resolution;t.x=(e-n.left)*(this.interactionDOMElement.width/n.width)*o,t.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*o},n.prototype.processInteractive=function(t,e,i,n){var o=this.search.findHit(t,e,i,n),r=this.delayedEvents;if(!r.length)return o;t.stopPropagationHint=!1;var s=r.length;this.delayedEvents=[];for(var a=0;a<s;a++){var h=r[a],c=h.displayObject,p=h.eventString,u=h.eventData;u.stopsPropagatingAt===c&&(u.stopPropagationHint=!0),this.dispatchEvent(c,p,u)}return o},n.prototype.onPointerDown=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);if(this.autoPreventDefault&&e[0].isNormalized)(t.cancelable||!("cancelable"in t))&&t.preventDefault();for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);if(s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",s),"touch"===o.pointerType)this.emit("touchstart",s);else if("mouse"===o.pointerType||"pen"===o.pointerType){var a=2===o.button;this.emit(a?"rightdown":"mousedown",this.eventData)}}}},n.prototype.processPointerDown=function(t,e,i){var n=t.data,o=t.data.identifier;if(i)if(e.trackedPointers[o]||(e.trackedPointers[o]=new h(o)),this.dispatchEvent(e,"pointerdown",t),"touch"===n.pointerType)this.dispatchEvent(e,"touchstart",t);else if("mouse"===n.pointerType||"pen"===n.pointerType){var r=2===n.button;r?e.trackedPointers[o].rightDown=!0:e.trackedPointers[o].leftDown=!0,this.dispatchEvent(e,r?"rightdown":"mousedown",t)}},n.prototype.onPointerComplete=function(t,e,i){for(var n=this.normalizeToPointerData(t),o=n.length,r=t.target!==this.interactionDOMElement?"outside":"",s=0;s<o;s++){var a=n[s],h=this.getInteractionDataForPointerId(a),c=this.configureInteractionEventForDOMEvent(this.eventData,a,h);if(c.data.originalEvent=t,this.processInteractive(c,this.lastObjectRendered,i,e||!r),this.emit(e?"pointercancel":"pointerup"+r,c),"mouse"===a.pointerType||"pen"===a.pointerType){var p=2===a.button;this.emit(p?"rightup"+r:"mouseup"+r,c)}else"touch"===a.pointerType&&(this.emit(e?"touchcancel":"touchend"+r,c),this.releaseInteractionDataForPointerId(a.pointerId))}},n.prototype.onPointerCancel=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!0,this.processPointerCancel)},n.prototype.processPointerCancel=function(t,e){var i=t.data,n=t.data.identifier;void 0!==e.trackedPointers[n]&&(delete e.trackedPointers[n],this.dispatchEvent(e,"pointercancel",t),"touch"===i.pointerType&&this.dispatchEvent(e,"touchcancel",t))},n.prototype.onPointerUp=function(t){this.supportsTouchEvents&&"touch"===t.pointerType||this.onPointerComplete(t,!1,this.processPointerUp)},n.prototype.processPointerUp=function(t,e,i){var n=t.data,o=t.data.identifier,r=e.trackedPointers[o],s="touch"===n.pointerType,a="mouse"===n.pointerType||"pen"===n.pointerType,c=!1;if(a){var p=2===n.button,u=h.FLAGS,l=p?u.RIGHT_DOWN:u.LEFT_DOWN,d=void 0!==r&&r.flags&l;i?(this.dispatchEvent(e,p?"rightup":"mouseup",t),d&&(this.dispatchEvent(e,p?"rightclick":"click",t),c=!0)):d&&this.dispatchEvent(e,p?"rightupoutside":"mouseupoutside",t),r&&(p?r.rightDown=!1:r.leftDown=!1)}i?(this.dispatchEvent(e,"pointerup",t),s&&this.dispatchEvent(e,"touchend",t),r&&(a&&!c||this.dispatchEvent(e,"pointertap",t),s&&(this.dispatchEvent(e,"tap",t),r.over=!1))):r&&(this.dispatchEvent(e,"pointerupoutside",t),s&&this.dispatchEvent(e,"touchendoutside",t)),r&&r.none&&delete e.trackedPointers[o]},n.prototype.onPointerMove=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t);"mouse"!==e[0].pointerType&&"pen"!==e[0].pointerType||(this._didMove=!0,this.cursor=null);for(var i=e.length,n=0;n<i;n++){var o=e[n],r=this.getInteractionDataForPointerId(o),s=this.configureInteractionEventForDOMEvent(this.eventData,o,r);s.data.originalEvent=t,this.processInteractive(s,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",s),"touch"===o.pointerType&&this.emit("touchmove",s),"mouse"!==o.pointerType&&"pen"!==o.pointerType||this.emit("mousemove",s)}"mouse"===e[0].pointerType&&this.setCursorMode(this.cursor)}},n.prototype.processPointerMove=function(t,e,i){var n=t.data,o="touch"===n.pointerType,r="mouse"===n.pointerType||"pen"===n.pointerType;r&&this.processPointerOverOut(t,e,i),this.moveWhenInside&&!i||(this.dispatchEvent(e,"pointermove",t),o&&this.dispatchEvent(e,"touchmove",t),r&&this.dispatchEvent(e,"mousemove",t))},n.prototype.onPointerOut=function(t){if(!this.supportsTouchEvents||"touch"!==t.pointerType){var e=this.normalizeToPointerData(t)[0];"mouse"===e.pointerType&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,this.processInteractive(n,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",n),"mouse"===e.pointerType||"pen"===e.pointerType?this.emit("mouseout",n):this.releaseInteractionDataForPointerId(i.identifier)}},n.prototype.processPointerOverOut=function(t,e,i){var n=t.data,o=t.data.identifier,r="mouse"===n.pointerType||"pen"===n.pointerType,s=e.trackedPointers[o];i&&!s&&(s=e.trackedPointers[o]=new h(o)),void 0!==s&&(i&&this.mouseOverRenderer?(s.over||(s.over=!0,this.delayDispatchEvent(e,"pointerover",t),r&&this.delayDispatchEvent(e,"mouseover",t)),r&&null===this.cursor&&(this.cursor=e.cursor)):s.over&&(s.over=!1,this.dispatchEvent(e,"pointerout",this.eventData),r&&this.dispatchEvent(e,"mouseout",t),s.none&&delete e.trackedPointers[o]))},n.prototype.onPointerOver=function(t){var e=this.normalizeToPointerData(t)[0],i=this.getInteractionDataForPointerId(e),n=this.configureInteractionEventForDOMEvent(this.eventData,e,i);n.data.originalEvent=e,"mouse"===e.pointerType&&(this.mouseOverRenderer=!0),this.emit("pointerover",n),"mouse"!==e.pointerType&&"pen"!==e.pointerType||this.emit("mouseover",n)},n.prototype.getInteractionDataForPointerId=function(t){var e,i=t.pointerId;return i===u||"mouse"===t.pointerType?e=this.mouse:this.activeInteractionData[i]?e=this.activeInteractionData[i]:((e=this.interactionDataPool.pop()||new o).identifier=i,this.activeInteractionData[i]=e),e.copyEvent(t),e},n.prototype.releaseInteractionDataForPointerId=function(t){var e=this.activeInteractionData[t];e&&(delete this.activeInteractionData[t],e.reset(),this.interactionDataPool.push(e))},n.prototype.configureInteractionEventForDOMEvent=function(t,e,i){return t.data=i,this.mapPositionToPoint(i.global,e.clientX,e.clientY),"touch"===e.pointerType&&(e.globalX=i.global.x,e.globalY=i.global.y),i.originalEvent=e,t.reset(),t},n.prototype.normalizeToPointerData=function(t){var e=[];if(this.supportsTouchEvents&&t instanceof TouchEvent)for(var i=0,n=t.changedTouches.length;i<n;i++){var o=t.changedTouches[i];void 0===o.button&&(o.button=t.touches.length?1:0),void 0===o.buttons&&(o.buttons=t.touches.length?1:0),void 0===o.isPrimary&&(o.isPrimary=1===t.touches.length&&"touchstart"===t.type),void 0===o.width&&(o.width=o.radiusX||1),void 0===o.height&&(o.height=o.radiusY||1),void 0===o.tiltX&&(o.tiltX=0),void 0===o.tiltY&&(o.tiltY=0),void 0===o.pointerType&&(o.pointerType="touch"),void 0===o.pointerId&&(o.pointerId=o.identifier||0),void 0===o.pressure&&(o.pressure=o.force||.5),void 0===o.twist&&(o.twist=0),void 0===o.tangentialPressure&&(o.tangentialPressure=0),void 0===o.layerX&&(o.layerX=o.offsetX=o.clientX),void 0===o.layerY&&(o.layerY=o.offsetY=o.clientY),o.isNormalized=!0,e.push(o)}else if(!(t instanceof MouseEvent)||this.supportsPointerEvents&&t instanceof window.PointerEvent)e.push(t);else{var r=t;void 0===r.isPrimary&&(r.isPrimary=!0),void 0===r.width&&(r.width=1),void 0===r.height&&(r.height=1),void 0===r.tiltX&&(r.tiltX=0),void 0===r.tiltY&&(r.tiltY=0),void 0===r.pointerType&&(r.pointerType="mouse"),void 0===r.pointerId&&(r.pointerId=u),void 0===r.pressure&&(r.pressure=.5),void 0===r.twist&&(r.twist=0),void 0===r.tangentialPressure&&(r.tangentialPressure=0),r.isNormalized=!0,e.push(r)}return e},n.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},n}(n.EventEmitter);exports.InteractionManager=d;
},{"@pixi/math":"w9h1","@pixi/ticker":"AWzT","@pixi/display":"qvzw","@pixi/utils":"X4iF"}],"KLq2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Runner=void 0;var t=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,i,s,n,r,o,u){if(arguments.length>8)throw new Error("max arguments reached");var h=this.name,a=this.items;this._aliasCount++;for(var m=0,p=a.length;m<p;m++)a[m][h](t,e,i,s,n,r,o,u);return a===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();exports.Runner=t,Object.defineProperties(t.prototype,{dispatch:{value:t.prototype.emit},run:{value:t.prototype.emit}});
},{}],"lj2a":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.autoDetectRenderer=At,exports.checkMaxIfStatementsInShader=Oe,exports.uniformParsers=exports.systems=exports.resources=exports.defaultVertex=exports.defaultFilterVertex=exports.ViewableBuffer=exports.UniformGroup=exports.TextureUvs=exports.TextureMatrix=exports.Texture=exports.System=exports.State=exports.SpriteMaskFilter=exports.Shader=exports.Renderer=exports.RenderTexturePool=exports.RenderTexture=exports.QuadUv=exports.Quad=exports.Program=exports.ObjectRenderer=exports.MaskData=exports.IGLUniformData=exports.Geometry=exports.GLTexture=exports.GLProgram=exports.GLFramebuffer=exports.Framebuffer=exports.FilterState=exports.Filter=exports.Buffer=exports.BatchTextureArray=exports.BatchShaderGenerator=exports.BatchRenderer=exports.BatchPluginFactory=exports.BatchGeometry=exports.BatchDrawCall=exports.BaseTexture=exports.BaseRenderTexture=exports.Attribute=exports.AbstractRenderer=exports.AbstractBatchRenderer=void 0;var e=require("@pixi/settings"),t=require("@pixi/constants"),r=require("@pixi/utils"),i=require("@pixi/runner"),n=require("@pixi/ticker"),o=require("@pixi/math");e.settings.PREFER_ENV=r.isMobile.any?t.ENV.WEBGL:t.ENV.WEBGL2,e.settings.STRICT_TEXTURE_CACHE=!1;var s=[];function a(e,t){if(!e)return null;var r="";if("string"==typeof e){var i=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);i&&(r=i[1].toLowerCase())}for(var n=s.length-1;n>=0;--n){var o=s[n];if(o.test&&o.test(e,r))return new o(e,t)}throw new Error("Unrecognized source type to auto-detect Resource")}var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function h(e,t){function r(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var l=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new i.Runner("setRealSize"),this.onUpdate=new i.Runner("update"),this.onError=new i.Runner("onError")}return e.prototype.bind=function(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},e.prototype.unbind=function(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},e.prototype.resize=function(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.emit(e,t))},Object.defineProperty(e.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),e.prototype.update=function(){this.destroyed||this.onUpdate.emit()},e.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),e.prototype.style=function(e,t,r){return!1},e.prototype.dispose=function(){},e.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},e.test=function(e,t){return!1},e}(),d=function(e){function r(t,r){var i=this,n=r||{},o=n.width,s=n.height;if(!o||!s)throw new Error("BufferResource width or height invalid");return(i=e.call(this,o,s)||this).data=t,i}return h(r,e),r.prototype.upload=function(e,r,i){var n=e.gl;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===t.ALPHA_MODES.UNPACK),i.width===r.width&&i.height===r.height?n.texSubImage2D(r.target,0,0,0,r.width,r.height,r.format,r.type,this.data):(i.width=r.width,i.height=r.height,n.texImage2D(r.target,0,i.internalFormat,r.width,r.height,0,r.format,i.type,this.data)),!0},r.prototype.dispose=function(){this.data=null},r.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},r}(l),c={scaleMode:t.SCALE_MODES.NEAREST,format:t.FORMATS.RGBA,alphaMode:t.ALPHA_MODES.NPM},f=function(i){function n(n,o){void 0===n&&(n=null),void 0===o&&(o=null);var s=i.call(this)||this,u=(o=o||{}).alphaMode,h=o.mipmap,d=o.anisotropicLevel,c=o.scaleMode,f=o.width,p=o.height,m=o.wrapMode,v=o.format,g=o.type,y=o.target,x=o.resolution,_=o.resourceOptions;return!n||n instanceof l||((n=a(n,_)).internal=!0),s.width=f||0,s.height=p||0,s.resolution=x||e.settings.RESOLUTION,s.mipmap=void 0!==h?h:e.settings.MIPMAP_TEXTURES,s.anisotropicLevel=void 0!==d?d:e.settings.ANISOTROPIC_LEVEL,s.wrapMode=m||e.settings.WRAP_MODE,s.scaleMode=void 0!==c?c:e.settings.SCALE_MODE,s.format=v||t.FORMATS.RGBA,s.type=g||t.TYPES.UNSIGNED_BYTE,s.target=y||t.TARGETS.TEXTURE_2D,s.alphaMode=void 0!==u?u:t.ALPHA_MODES.UNPACK,void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),s.uid=(0,r.uid)(),s.touched=0,s.isPowerOfTwo=!1,s._refreshPOT(),s._glTextures={},s.dirtyId=0,s.dirtyStyleId=0,s.cacheId=null,s.valid=f>0&&p>0,s.textureCacheIds=[],s.destroyed=!1,s.resource=null,s._batchEnabled=0,s._batchLocation=0,s.parentTextureArray=null,s.setResource(n),s}return h(n,i),Object.defineProperty(n.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),n.prototype.setStyle=function(e,t){var r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this},n.prototype.setSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},n.prototype.setRealSize=function(e,t,r){return this.resolution=r||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},n.prototype._refreshPOT=function(){this.isPowerOfTwo=(0,r.isPow2)(this.realWidth)&&(0,r.isPow2)(this.realHeight)},n.prototype.setResolution=function(e){var t=this.resolution;return t===e?this:(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT(),this)},n.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},n.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},n.prototype.onError=function(e){this.emit("error",this,e)},n.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete r.BaseTextureCache[this.cacheId],delete r.TextureCache[this.cacheId],this.cacheId=null),this.dispose(),n.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},n.prototype.dispose=function(){this.emit("dispose",this)},n.prototype.castToBaseTexture=function(){return this},n.from=function(t,i,o){void 0===o&&(o=e.settings.STRICT_TEXTURE_CACHE);var s="string"==typeof t,a=null;s?a=t:(t._pixiId||(t._pixiId="pixiid_"+(0,r.uid)()),a=t._pixiId);var u=r.BaseTextureCache[a];if(s&&o&&!u)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return u||((u=new n(t,i)).cacheId=a,n.addToCache(u,a)),u},n.fromBuffer=function(e,r,i,o){e=e||new Float32Array(r*i*4);var s=new d(e,{width:r,height:i}),a=e instanceof Float32Array?t.TYPES.FLOAT:t.TYPES.UNSIGNED_BYTE;return new n(s,Object.assign(c,o||{width:r,height:i,type:a}))},n.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),r.BaseTextureCache[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),r.BaseTextureCache[t]=e)},n.removeFromCache=function(e){if("string"==typeof e){var t=r.BaseTextureCache[e];if(t){var i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete r.BaseTextureCache[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)delete r.BaseTextureCache[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},n._globalBatch=0,n}(r.EventEmitter);exports.BaseTexture=f;var p=function(e){function t(t,r){var i=this,n=r||{},o=n.width,s=n.height;(i=e.call(this,o,s)||this).items=[],i.itemDirtyIds=[];for(var a=0;a<t;a++){var u=new f;i.items.push(u),i.itemDirtyIds.push(-2)}return i.length=t,i._load=null,i.baseTexture=null,i}return h(t,e),t.prototype.initFromArray=function(e,t){for(var r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof l?this.addResourceAt(e[r],r):this.addResourceAt(a(e[r],t),r))},t.prototype.dispose=function(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},t.prototype.bind=function(t){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");e.prototype.bind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=t,this.items[r].on("update",t.update,t)},t.prototype.unbind=function(t){e.prototype.unbind.call(this,t);for(var r=0;r<this.length;r++)this.items[r].parentTextureArray=null,this.items[r].off("update",t.update,t)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.items.map(function(e){return e.resource}).filter(function(e){return e}).map(function(e){return e.load()});return this._load=Promise.all(t).then(function(){var t=e.items[0],r=t.realWidth,i=t.realHeight;return e.resize(r,i),Promise.resolve(e)}),this._load},t}(l),m=function(e){function r(t,r){var i,n,o=this,s=r||{},a=s.width,u=s.height;return Array.isArray(t)?(i=t,n=t.length):n=t,o=e.call(this,n,{width:a,height:u})||this,i&&o.initFromArray(i,r),o}return h(r,e),r.prototype.addBaseTextureAt=function(e,t){if(!e.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(e.resource,t),this},r.prototype.bind=function(r){e.prototype.bind.call(this,r),r.target=t.TARGETS.TEXTURE_2D_ARRAY},r.prototype.upload=function(e,t,r){var i=this.length,n=this.itemDirtyIds,o=this.items,s=e.gl;r.dirtyId<0&&s.texImage3D(s.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,i,0,t.format,t.type,null);for(var a=0;a<i;a++){var u=o[a];n[a]<u.dirtyId&&(n[a]=u.dirtyId,u.valid&&s.texSubImage3D(s.TEXTURE_2D_ARRAY,0,0,0,a,u.resource.width,u.resource.height,1,t.format,t.type,u.resource.source))}return!0},r}(p),v=function(e){function i(t){var r=this,i=t,n=i.naturalWidth||i.videoWidth||i.width,o=i.naturalHeight||i.videoHeight||i.height;return(r=e.call(this,n,o)||this).source=t,r.noSubImage=!1,r}return h(i,e),i.crossOrigin=function(e,t,i){void 0===i&&0!==t.indexOf("data:")?e.crossOrigin=(0,r.determineCrossOrigin)(t):!1!==i&&(e.crossOrigin="string"==typeof i?i:"anonymous")},i.prototype.upload=function(e,r,i,n){var o=e.gl,s=r.realWidth,a=r.realHeight;return n=n||this.source,o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===t.ALPHA_MODES.UNPACK),this.noSubImage||r.target!==o.TEXTURE_2D||i.width!==s||i.height!==a?(i.width=s,i.height=a,o.texImage2D(r.target,0,r.format,r.format,r.type,n)):o.texSubImage2D(o.TEXTURE_2D,0,0,0,r.format,r.type,n),!0},i.prototype.update=function(){if(!this.destroyed){var t=this.source,r=t.naturalWidth||t.videoWidth||t.width,i=t.naturalHeight||t.videoHeight||t.height;this.resize(r,i),e.prototype.update.call(this)}},i.prototype.dispose=function(){this.source=null},i}(l),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.test=function(e){var t=window.OffscreenCanvas;return!!(t&&e instanceof t)||e instanceof HTMLCanvasElement},t}(v),y=function(e){function r(i,n){var o=this,s=n||{},a=s.width,u=s.height,h=s.autoLoad,l=s.linkBaseTexture;if(i&&i.length!==r.SIDES)throw new Error("Invalid length. Got "+i.length+", expected 6");o=e.call(this,6,{width:a,height:u})||this;for(var d=0;d<r.SIDES;d++)o.items[d].target=t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+d;return o.linkBaseTexture=!1!==l,i&&o.initFromArray(i,n),!1!==h&&o.load(),o}return h(r,e),r.prototype.bind=function(r){e.prototype.bind.call(this,r),r.target=t.TARGETS.TEXTURE_CUBE_MAP},r.prototype.addBaseTextureAt=function(e,r,i){if(void 0===i&&(i=this.linkBaseTexture),!this.items[r])throw new Error("Index "+r+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(!e.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(e.resource,r)}else e.target=t.TARGETS.TEXTURE_CUBE_MAP_POSITIVE_X+r,e.parentTextureArray=this.baseTexture,this.items[r]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[r]=e,this},r.prototype.upload=function(e,t,i){for(var n=this.itemDirtyIds,o=0;o<r.SIDES;o++){var s=this.items[o];n[o]<s.dirtyId&&(s.valid&&s.resource?(s.resource.upload(e,s,i),n[o]=s.dirtyId):n[o]<-1&&(e.gl.texImage2D(s.target,0,i.internalFormat,t.realWidth,t.realHeight,0,t.format,i.type,null),n[o]=-1))}return!0},r.test=function(e){return Array.isArray(e)&&e.length===r.SIDES},r.SIDES=6,r}(p),x=function(r){function i(t,i){var n=this;if(i=i||{},!(t instanceof HTMLImageElement)){var o=new Image;v.crossOrigin(o,t,i.crossorigin),o.src=t,t=o}return n=r.call(this,t)||this,!t.complete&&n._width&&n._height&&(n._width=0,n._height=0),n.url=t.src,n._process=null,n.preserveBitmap=!1,n.createBitmap=(void 0!==i.createBitmap?i.createBitmap:e.settings.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,n.alphaMode="number"==typeof i.alphaMode?i.alphaMode:null,void 0!==i.premultiplyAlpha&&(n.premultiplyAlpha=i.premultiplyAlpha),n.bitmap=null,n._load=null,!1!==i.autoLoad&&n.load(),n}return h(i,r),i.prototype.load=function(e){var t=this;return this._load?this._load:(void 0!==e&&(this.createBitmap=e),this._load=new Promise(function(e,r){var i=t.source;t.url=i.src;var n=function(){t.destroyed||(i.onload=null,i.onerror=null,t.resize(i.width,i.height),t._load=null,t.createBitmap?e(t.process()):e(t))};i.complete&&i.src?n():(i.onload=n,i.onerror=function(e){r(e),t.onError.emit(e)})}),this._load)},i.prototype.process=function(){var e=this,r=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(r,0,0,r.width,r.height,{premultiplyAlpha:this.alphaMode===t.ALPHA_MODES.UNPACK?"premultiply":"none"}).then(function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))}),this._process):Promise.resolve(this)},i.prototype.upload=function(e,t,i){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return r.prototype.upload.call(this,e,t,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(r.prototype.upload.call(this,e,t,i,this.bitmap),!this.preserveBitmap){var n=!0,o=t._glTextures;for(var s in o){var a=o[s];if(a!==i&&a.dirtyId!==t.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},i.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,r.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},i.test=function(e){return"string"==typeof e||e instanceof HTMLImageElement},i}(v),_=function(e){function t(t,r){var i=this;return r=r||{},(i=e.call(this,document.createElement("canvas"))||this)._width=0,i._height=0,i.svg=t,i.scale=r.scale||1,i._overrideWidth=r.width,i._overrideHeight=r.height,i._resolve=null,i._crossorigin=r.crossorigin,i._load=null,!1!==r.autoLoad&&i.load(),i}return h(t,e),t.prototype.load=function(){var e=this;return this._load?this._load:(this._load=new Promise(function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var e=this,t=new Image;v.crossOrigin(t,this.svg,this._crossorigin),t.src=this.svg,t.onerror=function(r){e._resolve&&(t.onerror=null,e.onError.emit(r))},t.onload=function(){if(e._resolve){var i=t.width,n=t.height;if(!i||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var o=i*e.scale,s=n*e.scale;(e._overrideWidth||e._overrideHeight)&&(o=e._overrideWidth||e._overrideHeight/n*i,s=e._overrideHeight||e._overrideWidth/i*n),o=Math.round(o),s=Math.round(s);var a=e.source;a.width=o,a.height=s,a._pixiId="canvas_"+(0,r.uid)(),a.getContext("2d").drawImage(t,0,0,i,n,0,0,o,s),e._resolve(),e._resolve=null}}},t.getSize=function(e){var r=t.SVG_SIZE.exec(e),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,t){return"svg"===t||"string"==typeof e&&/^data:image\/svg\+xml(;(charset=utf8|utf8))?;base64/.test(e)||"string"==typeof e&&0===e.indexOf("<svg")},t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(v),E=function(e){function t(r,i){var n=this;if(i=i||{},!(r instanceof HTMLVideoElement)){var o=document.createElement("video");o.setAttribute("preload","auto"),o.setAttribute("webkit-playsinline",""),o.setAttribute("playsinline",""),"string"==typeof r&&(r=[r]);var s=r[0].src||r[0];v.crossOrigin(o,s,i.crossorigin);for(var a=0;a<r.length;++a){var u=document.createElement("source"),h=r[a],l=h.src,d=h.mime,c=(l=l||r[a]).split("?").shift().toLowerCase(),f=c.substr(c.lastIndexOf(".")+1);d=d||t.MIME_TYPES[f]||"video/"+f,u.src=l,u.type=d,o.appendChild(u)}r=o}return(n=e.call(this,r)||this).noSubImage=!0,n._autoUpdate=!0,n._isConnectedToTicker=!1,n._updateFPS=i.updateFPS||0,n._msToNextUpdate=0,n.autoPlay=!1!==i.autoPlay,n._load=null,n._resolve=null,n._onCanPlay=n._onCanPlay.bind(n),n._onError=n._onError.bind(n),!1!==i.autoLoad&&n.load(),n}return h(t,e),t.prototype.update=function(t){if(void 0===t&&(t=0),!this.destroyed){var r=n.Ticker.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-r),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise(function(r){e.valid?r(e):(e._resolve=r,t.load())}),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},t.prototype._isSourceReady=function(){var e=this.source;return 3===e.readyState||4===e.readyState},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(n.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&n.Ticker.shared.remove(this.update,this);var t=this.source;t&&(t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),e.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(n.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(n.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,r){return e instanceof HTMLVideoElement||t.TYPES.indexOf(r)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(v),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return h(t,e),t.test=function(e){return!!window.createImageBitmap&&e instanceof ImageBitmap},t}(v);s.push(x,T,g,E,_,d,y,m);var b={Resource:l,BaseImageResource:v,INSTALLED:s,autoDetectResource:a,AbstractMultiResource:p,ArrayResource:m,BufferResource:d,CanvasResource:g,CubeResource:y,ImageResource:x,SVGResource:_,VideoResource:E,ImageBitmapResource:T};exports.resources=b;var S=function(){function e(e){this.renderer=e}return e.prototype.destroy=function(){this.renderer=null},e}();exports.System=S;var w=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return h(r,e),r.prototype.upload=function(e,r,i){var n=e.gl;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.alphaMode===t.ALPHA_MODES.UNPACK),i.width===r.width&&i.height===r.height?n.texSubImage2D(r.target,0,0,0,r.width,r.height,r.format,r.type,this.data):(i.width=r.width,i.height=r.height,n.texImage2D(r.target,0,1===e.context.webGLVersion?n.DEPTH_COMPONENT:n.DEPTH_COMPONENT16,r.width,r.height,0,r.format,r.type,this.data)),!0},r}(d),A=function(){function e(e,r){this.width=Math.ceil(e||100),this.height=Math.ceil(r||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new i.Runner("disposeFramebuffer"),this.multisample=t.MSAA_QUALITY.NONE}return Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),e.prototype.addColorTexture=function(e,r){return void 0===e&&(e=0),this.colorTextures[e]=r||new f(null,{scaleMode:t.SCALE_MODES.NEAREST,resolution:1,mipmap:t.MIPMAP_MODES.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.addDepthTexture=function(e){return this.depthTexture=e||new f(new w(null,{width:this.width,height:this.height}),{scaleMode:t.SCALE_MODES.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:t.MIPMAP_MODES.OFF,format:t.FORMATS.DEPTH_COMPONENT,type:t.TYPES.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},e.prototype.resize=function(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var r=0;r<this.colorTextures.length;r++){var i=this.colorTextures[r],n=i.resolution;i.setSize(e/n,t/n)}if(this.depthTexture){n=this.depthTexture.resolution;this.depthTexture.setSize(e/n,t/n)}}},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},e}();exports.Framebuffer=A;var C=function(e){function t(t){var r=this;"number"==typeof t&&(t={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});r=e.call(this,null,t)||this;var i=t||{},n=i.width,o=i.height;return r.mipmap=0,r.width=Math.ceil(n)||100,r.height=Math.ceil(o)||100,r.valid=!0,r.clearColor=[0,0,0,0],r.framebuffer=new A(r.width*r.resolution,r.height*r.resolution).addColorTexture(0,r),r.maskStack=[],r.filterStack=[{}],r}return h(t,e),t.prototype.resize=function(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},t.prototype.dispose=function(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(f);exports.BaseRenderTexture=C;var R=function(){function e(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return e.prototype.set=function(e,t,r){var i=t.width,n=t.height;if(r){var s=e.width/2/i,a=e.height/2/n,u=e.x/i+s,h=e.y/n+a;r=o.groupD8.add(r,o.groupD8.NW),this.x0=u+s*o.groupD8.uX(r),this.y0=h+a*o.groupD8.uY(r),r=o.groupD8.add(r,2),this.x1=u+s*o.groupD8.uX(r),this.y1=h+a*o.groupD8.uY(r),r=o.groupD8.add(r,2),this.x2=u+s*o.groupD8.uX(r),this.y2=h+a*o.groupD8.uY(r),r=o.groupD8.add(r,2),this.x3=u+s*o.groupD8.uX(r),this.y3=h+a*o.groupD8.uY(r)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},e}();exports.TextureUvs=R;var I=new R,O=function(t){function i(e,r,n,s,a,u){var h=t.call(this)||this;if(h.noFrame=!1,r||(h.noFrame=!0,r=new o.Rectangle(0,0,1,1)),e instanceof i&&(e=e.baseTexture),h.baseTexture=e,h._frame=r,h.trim=s,h.valid=!1,h._uvs=I,h.uvMatrix=null,h.orig=n||r,h._rotate=Number(a||0),!0===a)h._rotate=2;else if(h._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=u?new o.Point(u.x,u.y):new o.Point(0,0),h._updateID=0,h.textureCacheIds=[],e.valid?h.noFrame?e.valid&&h.onBaseTextureUpdated(e):h.frame=r:e.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&e.on("update",h.onBaseTextureUpdated,h),h}return h(i,t),i.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},i.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},i.prototype.destroy=function(e){if(this.baseTexture){if(e){var t=this.baseTexture;t&&t.url&&r.TextureCache[t.url]&&i.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,i.removeFromCache(this),this.textureCacheIds=null},i.prototype.clone=function(){return new i(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},i.prototype.updateUvs=function(){this._uvs===I&&(this._uvs=new R),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},i.from=function(t,n,o){void 0===n&&(n={}),void 0===o&&(o=e.settings.STRICT_TEXTURE_CACHE);var s="string"==typeof t,a=null;s?a=t:(t._pixiId||(t._pixiId="pixiid_"+(0,r.uid)()),a=t._pixiId);var u=r.TextureCache[a];if(s&&o&&!u)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return u||(n.resolution||(n.resolution=(0,r.getResolutionOfUrl)(t)),(u=new i(new f(t,n))).baseTexture.cacheId=a,f.addToCache(u.baseTexture,a),i.addToCache(u,a)),u},i.fromURL=function(e,t){var r=Object.assign({autoLoad:!1},null==t?void 0:t.resourceOptions),n=i.from(e,Object.assign({resourceOptions:r},t),!1),o=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):o.load().then(function(){return Promise.resolve(n)})},i.fromBuffer=function(e,t,r,n){return new i(f.fromBuffer(e,t,r,n))},i.fromLoader=function(t,n,o){var s=new x(t);s.url=n;var a=new i(new f(s,{scaleMode:e.settings.SCALE_MODE,resolution:(0,r.getResolutionOfUrl)(n)}));return o||(o=n),f.addToCache(a.baseTexture,o),i.addToCache(a,o),o!==n&&(f.addToCache(a.baseTexture,n),i.addToCache(a,n)),a},i.addToCache=function(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),r.TextureCache[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),r.TextureCache[t]=e)},i.removeFromCache=function(e){if("string"==typeof e){var t=r.TextureCache[e];if(t){var i=t.textureCacheIds.indexOf(e);return i>-1&&t.textureCacheIds.splice(i,1),delete r.TextureCache[e],t}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)r.TextureCache[e.textureCacheIds[n]]===e&&delete r.TextureCache[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(i.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var t=e.x,r=e.y,i=e.width,n=e.height,o=t+i>this.baseTexture.width,s=r+n>this.baseTexture.height;if(o||s){var a=o&&s?"and":"or",u="X: "+t+" + "+i+" = "+(t+i)+" > "+this.baseTexture.width,h="Y: "+r+" + "+n+" = "+(r+n)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+u+" "+a+" "+h)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),i.prototype.castToBaseTexture=function(){return this.baseTexture},i}(r.EventEmitter);function P(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new O(new f(new g(e)))}function M(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}exports.Texture=O,O.EMPTY=new O(new f),M(O.EMPTY),M(O.EMPTY.baseTexture),O.WHITE=P(),M(O.WHITE),M(O.WHITE.baseTexture);var D=function(e){function t(t,r){var i=this,n=null;if(!(t instanceof C)){var o=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4];console.warn("Please use RenderTexture.create("+o+", "+s+") instead of the ctor directly."),n=arguments[0],r=null,t=new C({width:o,height:s,scaleMode:a,resolution:u})}return(i=e.call(this,t,r)||this).legacyRenderer=n,i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return h(t,e),Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,t,r){void 0===r&&(r=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,r&&this.baseTexture.resize(e,t),this.updateUvs()},t.prototype.setResolution=function(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},t.create=function(e){return"number"==typeof e&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new t(new C(e))},t}(O);exports.RenderTexture=D;var F=function(){function e(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return e.prototype.createTexture=function(e,t){var r=new C(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new D(r)},e.prototype.getOptimalTexture=function(t,i,n){void 0===n&&(n=1);var o=e.SCREEN_KEY;t*=n,i*=n,this.enableFullScreen&&t===this._pixelsWidth&&i===this._pixelsHeight||(o=(65535&(t=(0,r.nextPow2)(t)))<<16|65535&(i=(0,r.nextPow2)(i))),this.texturePool[o]||(this.texturePool[o]=[]);var s=this.texturePool[o].pop();return s||(s=this.createTexture(t,i)),s.filterPoolKey=o,s.setResolution(n),s},e.prototype.getFilterTexture=function(e,t){var r=this.getOptimalTexture(e.width,e.height,t||e.resolution);return r.filterFrame=e.filterFrame,r},e.prototype.returnTexture=function(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},e.prototype.returnFilterTexture=function(e){this.returnTexture(e)},e.prototype.clear=function(e){if(e=!1!==e)for(var t in this.texturePool){var r=this.texturePool[t];if(r)for(var i=0;i<r.length;i++)r[i].destroy(!0)}this.texturePool={}},e.prototype.setScreenSize=function(t){if(t.width!==this._pixelsWidth||t.height!==this._pixelsHeight){var r=e.SCREEN_KEY,i=this.texturePool[r];if(this.enableFullScreen=t.width>0&&t.height>0,i)for(var n=0;n<i.length;n++)i[n].destroy(!0);this.texturePool[r]=[],this._pixelsWidth=t.width,this._pixelsHeight=t.height}},e.SCREEN_KEY="screen",e}();exports.RenderTexturePool=F;var N=function(){function e(e,t,r,i,n,o,s){void 0===t&&(t=0),void 0===r&&(r=!1),void 0===i&&(i=5126),this.buffer=e,this.size=t,this.normalized=r,this.type=i,this.stride=n,this.start=o,this.instance=s}return e.prototype.destroy=function(){this.buffer=null},e.from=function(t,r,i,n,o){return new e(t,r,i,n,o)},e}();exports.Attribute=N;var L=0,B=function(){function e(e,t,r){void 0===t&&(t=!0),void 0===r&&(r=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=L++,this.disposeRunner=new i.Runner("disposeBuffer")}return e.prototype.update=function(e){this.data=e||this.data,this._updateID++},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.data=null},e.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new e(t)},e}();function U(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}exports.Buffer=B;var k={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function G(e,t){for(var r=0,i=0,n={},o=0;o<e.length;o++)i+=t[o],r+=e[o].length;var s=new ArrayBuffer(4*r),a=null,u=0;for(o=0;o<e.length;o++){var h=t[o],l=e[o],d=U(l);n[d]||(n[d]=new k[d](s)),a=n[d];for(var c=0;c<l.length;c++){a[(c/h|0)*i+u+c%h]=l[c]}u+=h}return new Float32Array(s)}var V={5126:4,5123:2,5121:1},X=0,H={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},z=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=X++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new i.Runner("disposeGeometry"),this.refCount=0}return e.prototype.addAttribute=function(e,t,r,i,n,o,s,a){if(void 0===r&&(r=0),void 0===i&&(i=!1),void 0===a&&(a=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t instanceof B||(t instanceof Array&&(t=new Float32Array(t)),t=new B(t));var u=e.split("|");if(u.length>1){for(var h=0;h<u.length;h++)this.addAttribute(u[h],t,r,i,n);return this}var l=this.buffers.indexOf(t);return-1===l&&(this.buffers.push(t),l=this.buffers.length-1),this.attributes[e]=new N(l,r,i,n,o,s,a),this.instanced=this.instanced||a,this},e.prototype.getAttribute=function(e){return this.attributes[e]},e.prototype.getBuffer=function(e){return this.buffers[this.getAttribute(e).buffer]},e.prototype.addIndex=function(e){return e instanceof B||(e instanceof Array&&(e=new Uint16Array(e)),e=new B(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},e.prototype.getIndex=function(){return this.indexBuffer},e.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],r=[],i=new B;for(e in this.attributes){var n=this.attributes[e],o=this.buffers[n.buffer];t.push(o.data),r.push(n.size*V[n.type]/4),n.buffer=0}for(i.data=G(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},e.prototype.getSize=function(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},e.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},e.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},e.prototype.clone=function(){for(var t=new e,r=0;r<this.buffers.length;r++)t.buffers[r]=new B(this.buffers[r].data.slice(0));for(var r in this.attributes){var i=this.attributes[r];t.attributes[r]=new N(i.buffer,i.size,i.normalized,i.type,i.stride,i.start,i.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.index=!0),t},e.merge=function(t){for(var r,i=new e,n=[],o=[],s=[],a=0;a<t.length;a++){r=t[a];for(var u=0;u<r.buffers.length;u++)o[u]=o[u]||0,o[u]+=r.buffers[u].data.length,s[u]=0}for(a=0;a<r.buffers.length;a++)n[a]=new(H[U(r.buffers[a].data)])(o[a]),i.buffers[a]=new B(n[a]);for(a=0;a<t.length;a++){r=t[a];for(u=0;u<r.buffers.length;u++)n[u].set(r.buffers[u].data,s[u]),s[u]+=r.buffers[u].data.length}if(i.attributes=r.attributes,r.indexBuffer){i.indexBuffer=i.buffers[r.buffers.indexOf(r.indexBuffer)],i.indexBuffer.index=!0;var h=0,l=0,d=0,c=0;for(a=0;a<r.buffers.length;a++)if(r.buffers[a]!==r.indexBuffer){c=a;break}for(var a in r.attributes){var f=r.attributes[a];(0|f.buffer)===c&&(l+=f.size*V[f.type]/4)}for(a=0;a<t.length;a++){var p=t[a].indexBuffer.data;for(u=0;u<p.length;u++)i.indexBuffer.data[u+d]+=h;h+=r.buffers[c].data.length/l,d+=p.length}}return i},e}();exports.Geometry=z;var j=function(e){function t(){var t=e.call(this)||this;return t.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),t}return h(t,e),t}(z);exports.Quad=j;var Y=function(e){function t(){var t=e.call(this)||this;return t.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.vertexBuffer=new B(t.vertices),t.uvBuffer=new B(t.uvs),t.addAttribute("aVertexPosition",t.vertexBuffer).addAttribute("aTextureCoord",t.uvBuffer).addIndex([0,1,2,0,2,3]),t}return h(t,e),t.prototype.map=function(e,t){var r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+t.width/e.width,this.uvs[3]=i,this.uvs[4]=r+t.width/e.width,this.uvs[5]=i+t.height/e.height,this.uvs[6]=r,this.uvs[7]=i+t.height/e.height,r=t.x,i=t.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+t.width,this.vertices[3]=i,this.vertices[4]=r+t.width,this.vertices[5]=i+t.height,this.vertices[6]=r,this.vertices[7]=i+t.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}(z);exports.QuadUv=Y;var W=0,K=function(){function e(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=W++,this.static=!!t}return e.prototype.update=function(){this.dirtyId++},e.prototype.add=function(t,r,i){this.uniforms[t]=new e(r,i)},e.from=function(t,r){return new e(t,r)},e}();exports.UniformGroup=K;var q=function(){function e(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new o.Rectangle,this.destinationFrame=new o.Rectangle,this.filters=[]}return e.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},e}();exports.FilterState=q;var Q=function(e){function i(t){var r=e.call(this,t)||this;return r.defaultFilterStack=[{}],r.texturePool=new F,r.texturePool.setScreenSize(t.view),r.statePool=[],r.quad=new j,r.quadUv=new Y,r.tempRect=new o.Rectangle,r.activeState={},r.globalUniforms=new K({outputFrame:r.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),r.forceClear=!1,r.useMaxPadding=!1,r}return h(i,e),i.prototype.push=function(e,t){for(var r=this.renderer,i=this.defaultFilterStack,n=this.statePool.pop()||new q,o=t[0].resolution,s=t[0].padding,a=t[0].autoFit,u=t[0].legacy,h=1;h<t.length;h++){var l=t[h];o=Math.min(o,l.resolution),s=this.useMaxPadding?Math.max(s,l.padding):s+l.padding,a=a&&l.autoFit,u=u||l.legacy}1===i.length&&(this.defaultFilterStack[0].renderTexture=r.renderTexture.current),i.push(n),n.resolution=o,n.legacy=u,n.target=e,n.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),n.sourceFrame.pad(s),a&&n.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),n.sourceFrame.ceil(o),n.renderTexture=this.getOptimalFilterTexture(n.sourceFrame.width,n.sourceFrame.height,o),n.filters=t,n.destinationFrame.width=n.renderTexture.width,n.destinationFrame.height=n.renderTexture.height;var d=this.tempRect;d.width=n.sourceFrame.width,d.height=n.sourceFrame.height,n.renderTexture.filterFrame=n.sourceFrame,r.renderTexture.bind(n.renderTexture,n.sourceFrame,d),r.renderTexture.clear()},i.prototype.pop=function(){var e=this.defaultFilterStack,r=e.pop(),i=r.filters;this.activeState=r;var n=this.globalUniforms.uniforms;n.outputFrame=r.sourceFrame,n.resolution=r.resolution;var o=n.inputSize,s=n.inputPixel,a=n.inputClamp;if(o[0]=r.destinationFrame.width,o[1]=r.destinationFrame.height,o[2]=1/o[0],o[3]=1/o[1],s[0]=o[0]*r.resolution,s[1]=o[1]*r.resolution,s[2]=1/s[0],s[3]=1/s[1],a[0]=.5*s[2],a[1]=.5*s[3],a[2]=r.sourceFrame.width*o[2]-.5*s[2],a[3]=r.sourceFrame.height*o[3]-.5*s[3],r.legacy){var u=n.filterArea;u[0]=r.destinationFrame.width,u[1]=r.destinationFrame.height,u[2]=r.sourceFrame.x,u[3]=r.sourceFrame.y,n.filterClamp=n.inputClamp}this.globalUniforms.update();var h=e[e.length-1];if(r.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,r.renderTexture,h.renderTexture,t.CLEAR_MODES.BLEND,r),this.returnFilterTexture(r.renderTexture);else{var l=r.renderTexture,d=this.getOptimalFilterTexture(l.width,l.height,r.resolution);d.filterFrame=l.filterFrame;var c=0;for(c=0;c<i.length-1;++c){i[c].apply(this,l,d,t.CLEAR_MODES.CLEAR,r);var f=l;l=d,d=f}i[c].apply(this,l,h.renderTexture,t.CLEAR_MODES.BLEND,r),this.returnFilterTexture(l),this.returnFilterTexture(d)}r.clear(),this.statePool.push(r)},i.prototype.bindAndClear=function(e,i){if(void 0===i&&(i=t.CLEAR_MODES.CLEAR),e&&e.filterFrame){var n=this.tempRect;n.width=e.filterFrame.width,n.height=e.filterFrame.height,this.renderer.renderTexture.bind(e,e.filterFrame,n)}else this.renderer.renderTexture.bind(e);"boolean"==typeof i&&(i=i?t.CLEAR_MODES.CLEAR:t.CLEAR_MODES.BLEND,(0,r.deprecation)("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(i===t.CLEAR_MODES.CLEAR||i===t.CLEAR_MODES.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},i.prototype.applyFilter=function(e,r,i,n){var o=this.renderer;this.bindAndClear(i,n),e.uniforms.uSampler=r,e.uniforms.filterGlobals=this.globalUniforms,o.state.set(e.state),o.shader.bind(e),e.legacy?(this.quadUv.map(r._frame,r.filterFrame),o.geometry.bind(this.quadUv),o.geometry.draw(t.DRAW_MODES.TRIANGLES)):(o.geometry.bind(this.quad),o.geometry.draw(t.DRAW_MODES.TRIANGLE_STRIP))},i.prototype.calculateSpriteMatrix=function(e,t){var r=this.activeState,i=r.sourceFrame,n=r.destinationFrame,s=t._texture.orig,a=e.set(n.width,0,0,n.height,i.x,i.y),u=t.worldTransform.copyTo(o.Matrix.TEMP_MATRIX);return u.invert(),a.prepend(u),a.scale(1/s.width,1/s.height),a.translate(t.anchor.x,t.anchor.y),a},i.prototype.destroy=function(){this.texturePool.clear(!1)},i.prototype.getOptimalFilterTexture=function(e,t,r){return void 0===r&&(r=1),this.texturePool.getOptimalTexture(e,t,r)},i.prototype.getFilterTexture=function(e,t){if("number"==typeof e){var r=e;e=t,t=r}e=e||this.activeState.renderTexture;var i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return i.filterFrame=e.filterFrame,i},i.prototype.returnFilterTexture=function(e){this.texturePool.returnTexture(e)},i.prototype.emptyPool=function(){this.texturePool.clear(!0)},i.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},i}(S),Z=function(){function e(e){this.renderer=e}return e.prototype.flush=function(){},e.prototype.destroy=function(){this.renderer=null},e.prototype.start=function(){},e.prototype.stop=function(){this.flush()},e.prototype.render=function(e){},e}();exports.ObjectRenderer=Z;var $=function(e){function t(t){var r=e.call(this,t)||this;return r.emptyRenderer=new Z(t),r.currentRenderer=r.emptyRenderer,r}return h(t,e),t.prototype.setObjectRenderer=function(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},t.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},t.prototype.copyBoundTextures=function(e,t){for(var r=this.renderer.texture.boundTextures,i=t-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)},t.prototype.boundArray=function(e,t,r,i){for(var n=e.elements,o=e.ids,s=e.count,a=0,u=0;u<s;u++){var h=n[u],l=h._batchLocation;if(l>=0&&l<i&&t[l]===h)o[u]=l;else for(;a<i;){var d=t[a];if(!d||d._batchEnabled!==r||d._batchLocation!==a){o[u]=a,h._batchLocation=a,t[a]=h;break}a++}}},t}(S),J=0,ee=function(r){function i(e){var t=r.call(this,e)||this;return t.webGLVersion=1,t.extensions={},t.supports={uint32Indices:!1},t.handleContextLost=t.handleContextLost.bind(t),t.handleContextRestored=t.handleContextRestored.bind(t),e.view.addEventListener("webglcontextlost",t.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",t.handleContextRestored,!1),t}return h(i,r),Object.defineProperty(i.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),i.prototype.contextChange=function(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=J++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},i.prototype.initFromContext=function(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=J++,this.renderer.runners.contextChange.emit(e)},i.prototype.initFromOptions=function(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},i.prototype.createContext=function(r,i){var n;if(e.settings.PREFER_ENV>=t.ENV.WEBGL2&&(n=r.getContext("webgl2",i)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=r.getContext("webgl",i)||r.getContext("experimental-webgl",i)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),this.gl},i.prototype.getExtensions=function(){var e=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:e.getExtension("EXT_color_buffer_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear")})},i.prototype.handleContextLost=function(e){e.preventDefault()},i.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},i.prototype.destroy=function(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},i.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},i.prototype.validateContext=function(e){var t=e.getContextAttributes(),r="WebGL2RenderingContext"in window&&e instanceof window.WebGL2RenderingContext;r&&(this.webGLVersion=2),t.stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},i}(S),te=function(){return function(e){this.framebuffer=e,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=t.MSAA_QUALITY.NONE,this.msaaBuffer=null,this.blitFramebuffer=null}}();exports.GLFramebuffer=te;var re=new o.Rectangle,ie=function(r){function i(e){var t=r.call(this,e)||this;return t.managedFramebuffers=[],t.unknownFramebuffer=new A(10,10),t.msaaSamples=null,t}return h(i,r),i.prototype.contextChange=function(){var r=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new o.Rectangle,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var i=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;e.settings.PREFER_ENV===t.ENV.WEBGL_LEGACY&&(i=null,n=null),i?r.drawBuffers=function(e){return i.drawBuffersWEBGL(e)}:(this.hasMRT=!1,r.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}else this.msaaSamples=r.getInternalformatParameter(r.RENDERBUFFER,r.RGBA8,r.SAMPLES)},i.prototype.bind=function(e,t){var r=this.gl;if(e){var i=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,r.bindFramebuffer(r.FRAMEBUFFER,i.framebuffer)),i.dirtyId!==e.dirtyId&&(i.dirtyId=e.dirtyId,i.dirtyFormat!==e.dirtyFormat?(i.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):i.dirtySize!==e.dirtySize&&(i.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var n=0;n<e.colorTextures.length;n++){var o=e.colorTextures[n];this.renderer.texture.unbind(o.parentTextureArray||o)}e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,r.bindFramebuffer(r.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},i.prototype.setViewport=function(e,t,r,i){var n=this.viewport;n.width===r&&n.height===i&&n.x===e&&n.y===t||(n.x=e,n.y=t,n.width=r,n.height=i,this.gl.viewport(e,t,r,i))},Object.defineProperty(i.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),i.prototype.clear=function(e,r,i,n,o){void 0===o&&(o=t.BUFFER_BITS.COLOR|t.BUFFER_BITS.DEPTH);var s=this.gl;s.clearColor(e,r,i,n),s.clear(o)},i.prototype.initFramebuffer=function(e){var t=this.gl,r=new te(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r},i.prototype.resizeFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID];r.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var i=e.colorTextures,n=0;n<i.length;n++)this.renderer.texture.bind(i[n],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},i.prototype.updateFramebuffer=function(e){var t=this.gl,r=e.glFramebuffers[this.CONTEXT_UID],i=e.colorTextures.length;t.drawBuffers||(i=Math.min(i,1)),r.multisample>1&&(r.msaaBuffer=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,t.RGBA8,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,r.msaaBuffer));for(var n=[],o=0;o<i;o++)if(!(0===o&&r.multisample>1)){var s=e.colorTextures[o],a=s.parentTextureArray||s;this.renderer.texture.bind(a,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+o,s.target,a._glTextures[this.CONTEXT_UID].texture,0),n.push(t.COLOR_ATTACHMENT0+o)}if((n.length>1&&t.drawBuffers(n),e.depthTexture)&&this.writeDepthTexture){var u=e.depthTexture;this.renderer.texture.bind(u,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,u._glTextures[this.CONTEXT_UID].texture,0)}r.stencil||!e.stencil&&!e.depth||(r.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r.stencil))},i.prototype.detectSamples=function(e){var r=this.msaaSamples,i=t.MSAA_QUALITY.NONE;if(e<=1||null===r)return i;for(var n=0;n<r.length;n++)if(r[n]<=e){i=r[n];break}return 1===i&&(i=t.MSAA_QUALITY.NONE),i},i.prototype.blit=function(e,t,r){var i=this.current,n=this.renderer,o=this.gl,s=this.CONTEXT_UID;if(2===n.context.webGLVersion&&i){var a=i.glFramebuffers[s];if(a){if(!e){if(a.multisample<=1)return;a.blitFramebuffer||(a.blitFramebuffer=new A(i.width,i.height),a.blitFramebuffer.addColorTexture(0,i.colorTextures[0])),(e=a.blitFramebuffer).width=i.width,e.height=i.height}t||((t=re).width=i.width,t.height=i.height),r||(r=t);var u=t.width===r.width&&t.height===r.height;this.bind(e),o.bindFramebuffer(o.READ_FRAMEBUFFER,a.framebuffer),o.blitFramebuffer(t.x,t.y,t.width,t.height,r.x,r.y,r.width,r.height,o.COLOR_BUFFER_BIT,u?o.NEAREST:o.LINEAR)}}},i.prototype.disposeFramebuffer=function(e,t){var r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(r){delete e.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),t||(i.deleteFramebuffer(r.framebuffer),r.stencil&&i.deleteRenderbuffer(r.stencil))}},i.prototype.disposeAll=function(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)},i.prototype.forceStencil=function(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var r=e.width,i=e.height,n=this.gl,o=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,o),n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,r,i),t.stencil=o,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,o)}}},i.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new o.Rectangle},i}(S),ne=function(){return function(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}(),oe={5126:4,5123:2,5121:1},se=function(r){function i(e){var t=r.call(this,e)||this;return t._activeGeometry=null,t._activeVao=null,t.hasVao=!0,t.hasInstance=!0,t.canUseUInt32ElementIndex=!1,t.managedGeometries={},t.managedBuffers={},t}return h(i,r),i.prototype.contextChange=function(){this.disposeAll(!0);var r=this.gl=this.renderer.gl,i=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==i.webGLVersion){var n=this.renderer.context.extensions.vertexArrayObject;e.settings.PREFER_ENV===t.ENV.WEBGL_LEGACY&&(n=null),n?(r.createVertexArray=function(){return n.createVertexArrayOES()},r.bindVertexArray=function(e){return n.bindVertexArrayOES(e)},r.deleteVertexArray=function(e){return n.deleteVertexArrayOES(e)}):(this.hasVao=!1,r.createVertexArray=function(){return null},r.bindVertexArray=function(){return null},r.deleteVertexArray=function(){return null})}if(2!==i.webGLVersion){var o=r.getExtension("ANGLE_instanced_arrays");o?(r.vertexAttribDivisor=function(e,t){return o.vertexAttribDivisorANGLE(e,t)},r.drawElementsInstanced=function(e,t,r,i,n){return o.drawElementsInstancedANGLE(e,t,r,i,n)},r.drawArraysInstanced=function(e,t,r,i){return o.drawArraysInstancedANGLE(e,t,r,i)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===i.webGLVersion||!!i.extensions.uint32ElementIndex},i.prototype.bind=function(e,t){t=t||this.renderer.shader.shader;var r=this.gl,i=e.glVertexArrayObjects[this.CONTEXT_UID];i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={});var n=i[t.program.id]||this.initGeometryVao(e,t.program);this._activeGeometry=e,this._activeVao!==n&&(this._activeVao=n,this.hasVao?r.bindVertexArray(n):this.activateVao(e,t.program)),this.updateBuffers()},i.prototype.reset=function(){this.unbind()},i.prototype.updateBuffers=function(){for(var e=this._activeGeometry,t=this.gl,r=0;r<e.buffers.length;r++){var i=e.buffers[r],n=i._glBuffers[this.CONTEXT_UID];if(i._updateID!==n.updateID){n.updateID=i._updateID;var o=i.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(o,n.buffer),this._boundBuffer=n,n.byteLength>=i.data.byteLength)t.bufferSubData(o,0,i.data);else{var s=i.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;n.byteLength=i.data.byteLength,t.bufferData(o,i.data,s)}}}},i.prototype.checkCompatibility=function(e,t){var r=e.attributes,i=t.attributeData;for(var n in i)if(!r[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},i.prototype.getSignature=function(e,t){var r=e.attributes,i=t.attributeData,n=["g",e.id];for(var o in r)i[o]&&n.push(o);return n.join("-")},i.prototype.initGeometryVao=function(e,t){this.checkCompatibility(e,t);var r=this.gl,i=this.CONTEXT_UID,n=this.getSignature(e,t),o=e.glVertexArrayObjects[this.CONTEXT_UID],s=o[n];if(s)return o[t.id]=s,s;var a=e.buffers,u=e.attributes,h={},l={};for(var d in a)h[d]=0,l[d]=0;for(var d in u)!u[d].size&&t.attributeData[d]?u[d].size=t.attributeData[d].size:u[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),h[u[d].buffer]+=u[d].size*oe[u[d].type];for(var d in u){var c=u[d],f=c.size;void 0===c.stride&&(h[c.buffer]===f*oe[c.type]?c.stride=0:c.stride=h[c.buffer]),void 0===c.start&&(c.start=l[c.buffer],l[c.buffer]+=f*oe[c.type])}s=r.createVertexArray(),r.bindVertexArray(s);for(var p=0;p<a.length;p++){var m=a[p];m._glBuffers[i]||(m._glBuffers[i]=new ne(r.createBuffer()),this.managedBuffers[m.id]=m,m.disposeRunner.add(this)),m._glBuffers[i].refCount++}return this.activateVao(e,t),this._activeVao=s,o[t.id]=s,o[n]=s,s},i.prototype.disposeBuffer=function(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(t||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}},i.prototype.disposeGeometry=function(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=e.buffers;if(e.disposeRunner.remove(this),r){for(var o=0;o<n.length;o++){var s=n[o]._glBuffers[this.CONTEXT_UID];s.refCount--,0!==s.refCount||t||this.disposeBuffer(n[o],t)}if(!t)for(var a in r)if("g"===a[0]){var u=r[a];this._activeVao===u&&this.unbind(),i.deleteVertexArray(u)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},i.prototype.disposeAll=function(e){for(var t=Object.keys(this.managedGeometries),r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e);t=Object.keys(this.managedBuffers);for(r=0;r<t.length;r++)this.disposeBuffer(this.managedBuffers[t[r]],e)},i.prototype.activateVao=function(e,t){var r=this.gl,i=this.CONTEXT_UID,n=e.buffers,o=e.attributes;e.indexBuffer&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[i].buffer);var s=null;for(var a in o){var u=o[a],h=n[u.buffer]._glBuffers[i];if(t.attributeData[a]){s!==h&&(r.bindBuffer(r.ARRAY_BUFFER,h.buffer),s=h);var l=t.attributeData[a].location;if(r.enableVertexAttribArray(l),r.vertexAttribPointer(l,u.size,u.type||r.FLOAT,u.normalized,u.stride,u.start),u.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(l,1)}}}},i.prototype.draw=function(e,t,r,i){var n=this.gl,o=this._activeGeometry;if(o.indexBuffer){var s=o.indexBuffer.data.BYTES_PER_ELEMENT,a=2===s?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===s||4===s&&this.canUseUInt32ElementIndex?o.instanced?n.drawElementsInstanced(e,t||o.indexBuffer.data.length,a,(r||0)*s,i||1):n.drawElements(e,t||o.indexBuffer.data.length,a,(r||0)*s):console.warn("unsupported index buffer type: uint32")}else o.instanced?n.drawArraysInstanced(e,r,t||o.getSize(),i||1):n.drawArrays(e,r,t||o.getSize());return this},i.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},i}(S),ae=function(){function e(e){void 0===e&&(e=null),this.type=t.MASK_TYPES.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return e.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=t.MASK_TYPES.NONE,this.autoDetect=!0),this._target=null},e.prototype.copyCountersOrReset=function(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},e}();function ue(e,t,r){var i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function he(e,t,r,i){var n=ue(e,e.VERTEX_SHADER,t),o=ue(e,e.FRAGMENT_SHADER,r),s=e.createProgram();if(e.attachShader(s,n),e.attachShader(s,o),i)for(var a in i)e.bindAttribLocation(s,i[a],a);return e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||(e.getShaderParameter(n,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(n))),e.getShaderParameter(o,e.COMPILE_STATUS)||(console.warn(r),console.error(e.getShaderInfoLog(o))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(s,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(s)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(s)),e.deleteProgram(s),s=null),e.deleteShader(n),e.deleteShader(o),s}function le(e){for(var t=new Array(e),r=0;r<t.length;r++)t[r]=!1;return t}function de(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return le(2*t);case"bvec3":return le(3*t);case"bvec4":return le(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}exports.MaskData=ae;var ce,fe={},pe=fe;function me(){if(pe===fe||pe&&pe.isContextLost()){var r=document.createElement("canvas"),i=void 0;e.settings.PREFER_ENV>=t.ENV.WEBGL2&&(i=r.getContext("webgl2",{})),i||((i=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}))?i.getExtension("WEBGL_draw_buffers"):i=null),pe=i}return pe}function ve(){if(!ce){ce=t.PRECISION.MEDIUM;var e=me();if(e&&e.getShaderPrecisionFormat){var r=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);ce=r.precision?t.PRECISION.HIGH:t.PRECISION.MEDIUM}}return ce}function ge(e,r,i){if("precision"!==e.substring(0,9)){var n=r;return r===t.PRECISION.HIGH&&i!==t.PRECISION.HIGH&&(n=t.PRECISION.MEDIUM),"precision "+n+" float;\n"+e}return i!==t.PRECISION.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var ye={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function xe(e){return ye[e]}var _e=null,Ee={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function Te(e,t){if(!_e){var r=Object.keys(Ee);_e={};for(var i=0;i<r.length;++i){var n=r[i];_e[e[n]]=Ee[n]}}return _e[t]}var be=[{test:function(e){return"float"===e.type&&1===e.size},code:function(e){return'\n            if(uv["'+e+'"] !== ud["'+e+'"].value)\n            {\n                ud["'+e+'"].value = uv["'+e+'"]\n                gl.uniform1f(ud["'+e+'"].location, uv["'+e+'"])\n            }\n            '}},{test:function(e){return("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray},code:function(e){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+e+'"], t);\n\n            if(ud["'+e+'"].value !== t)\n            {\n                ud["'+e+'"].value = t;\n                gl.uniform1i(ud["'+e+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(e,t){return"mat3"===e.type&&1===e.size&&void 0!==t.a},code:function(e){return'\n            gl.uniformMatrix3fv(ud["'+e+'"].location, false, uv["'+e+'"].toArray(true));\n            '}},{test:function(e,t){return"vec2"===e.type&&1===e.size&&void 0!==t.x},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+e+'"].location, v.x, v.y);\n                }'}},{test:function(e){return"vec2"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+e+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(e,t){return"vec4"===e.type&&1===e.size&&void 0!==t.width},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+e+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(e){return"vec4"===e.type&&1===e.size},code:function(e){return'\n                cv = ud["'+e+'"].value;\n                v = uv["'+e+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+e+'"].location, v[0], v[1], v[2], v[3])\n                }'}}];exports.uniformParsers=be;var Se={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},we={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function Ae(e,t){var r=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var i in e.uniforms){var n=t[i];if(n){for(var o=e.uniforms[i],s=!1,a=0;a<be.length;a++)if(be[a].test(n,o)){r.push(be[a].code(i,o)),s=!0;break}if(!s){var u=(1===n.size?Se:we)[n.type].replace("location",'ud["'+i+'"].location');r.push('\n            cv = ud["'+i+'"].value;\n            v = uv["'+i+'"];\n            '+u+";")}}else e.uniforms[i].group&&r.push('\n                    renderer.shader.syncUniformGroup(uv["'+i+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",r.join("\n"))}var Ce,Re=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function Ie(e){for(var t="",r=0;r<e;++r)r>0&&(t+="\nelse "),r<e-1&&(t+="if(test == "+r+".0){}");return t}function Oe(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var r=t.createShader(t.FRAGMENT_SHADER);;){var i=Re.replace(/%forloop%/gi,Ie(e));if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}function Pe(){if("boolean"==typeof Ce)return Ce;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");Ce=!0===e({a:"b"},"a","b")}catch(t){Ce=!1}return Ce}var Me="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",De="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n",Fe=0,Ne={},Le=function(){function i(r,n,o){void 0===o&&(o="pixi-shader"),this.id=Fe++,this.vertexSrc=r||i.defaultVertexSrc,this.fragmentSrc=n||i.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(o=o.replace(/\s+/g,"-"),Ne[o]?(Ne[o]++,o+="-"+Ne[o]):Ne[o]=1,this.vertexSrc="#define SHADER_NAME "+o+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+o+"\n"+this.fragmentSrc,this.vertexSrc=ge(this.vertexSrc,e.settings.PRECISION_VERTEX,t.PRECISION.HIGH),this.fragmentSrc=ge(this.fragmentSrc,e.settings.PRECISION_FRAGMENT,ve())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return i.prototype.extractData=function(e,t){var r=me();if(r){var i=he(r,e,t);this.attributeData=this.getAttributeData(i,r),this.uniformData=this.getUniformData(i,r),r.deleteProgram(i)}else this.uniformData={},this.attributeData={}},i.prototype.getAttributeData=function(e,t){for(var r={},i=[],n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),o=0;o<n;o++){var s=t.getActiveAttrib(e,o),a=Te(t,s.type),u={type:a,name:s.name,size:xe(a),location:0};r[s.name]=u,i.push(u)}i.sort(function(e,t){return e.name>t.name?1:-1});for(o=0;o<i.length;o++)i[o].location=o;return r},i.prototype.getUniformData=function(e,t){for(var r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=0;n<i;n++){var o=t.getActiveUniform(e,n),s=o.name.replace(/\[.*?\]$/,""),a=o.name.match(/\[.*?\]$/),u=Te(t,o.type);r[s]={type:u,size:o.size,isArray:a,value:de(u,o.size)}}return r},Object.defineProperty(i,"defaultVertexSrc",{get:function(){return De},enumerable:!1,configurable:!0}),Object.defineProperty(i,"defaultFragmentSrc",{get:function(){return Me},enumerable:!1,configurable:!0}),i.from=function(e,t,n){var o=e+t,s=r.ProgramCache[o];return s||(r.ProgramCache[o]=s=new i(e,t,n)),s},i}();exports.Program=Le;var Be=function(){function e(e,t){for(var r in this.program=e,this.uniformGroup=t?t instanceof K?t:new K(t):new K({}),e.uniformData)this.uniformGroup.uniforms[r]instanceof Array&&(this.uniformGroup.uniforms[r]=new Float32Array(this.uniformGroup.uniforms[r]))}return e.prototype.checkUniformExists=function(e,t){if(t.uniforms[e])return!0;for(var r in t.uniforms){var i=t.uniforms[r];if(i.group&&this.checkUniformExists(e,i))return!0}return!1},e.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(e.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),e.from=function(t,r,i){return new e(Le.from(t,r),i)},e}();exports.Shader=Be;var Ue=0,ke=1,Ge=2,Ve=3,Xe=4,He=function(){function e(){this.data=0,this.blendMode=t.BLEND_MODES.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(e.prototype,"blend",{get:function(){return!!(this.data&1<<Ue)},set:function(e){!!(this.data&1<<Ue)!==e&&(this.data^=1<<Ue)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offsets",{get:function(){return!!(this.data&1<<ke)},set:function(e){!!(this.data&1<<ke)!==e&&(this.data^=1<<ke)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culling",{get:function(){return!!(this.data&1<<Ge)},set:function(e){!!(this.data&1<<Ge)!==e&&(this.data^=1<<Ge)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depthTest",{get:function(){return!!(this.data&1<<Ve)},set:function(e){!!(this.data&1<<Ve)!==e&&(this.data^=1<<Ve)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<Xe)},set:function(e){!!(this.data&1<<Xe)!==e&&(this.data^=1<<Xe)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blendMode",{get:function(){return this._blendMode},set:function(e){this.blend=e!==t.BLEND_MODES.NONE,this._blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(e){this.offsets=!!e,this._polygonOffset=e},enumerable:!1,configurable:!0}),e.for2d=function(){var t=new e;return t.depthTest=!1,t.blend=!0,t},e}();exports.State=He;var ze="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",je="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",Ye=function(t){function r(i,n,o){var s=this,a=Le.from(i||r.defaultVertexSrc,n||r.defaultFragmentSrc);return(s=t.call(this,a,o)||this).padding=0,s.resolution=e.settings.FILTER_RESOLUTION,s.enabled=!0,s.autoFit=!0,s.legacy=!!s.program.attributeData.aTextureCoord,s.state=new He,s}return h(r,t),r.prototype.apply=function(e,t,r,i,n){e.applyFilter(this,t,r,i)},Object.defineProperty(r.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultVertexSrc",{get:function(){return ze},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentSrc",{get:function(){return je},enumerable:!1,configurable:!0}),r}(Be);exports.Filter=Ye;var We="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",Ke="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",qe=new o.Matrix,Qe=function(){function e(e,t){this._texture=e,this.mapCoord=new o.Matrix,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1}return Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture=e,this._textureID=-1},enumerable:!1,configurable:!0}),e.prototype.multiplyUvs=function(e,t){void 0===t&&(t=e);for(var r=this.mapCoord,i=0;i<e.length;i+=2){var n=e[i],o=e[i+1];t[i]=n*r.a+o*r.c+r.tx,t[i+1]=n*r.b+o*r.d+r.ty}return t},e.prototype.update=function(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;var r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);var i=t.orig,n=t.trim;n&&(qe.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(qe));var o=t.baseTexture,s=this.uClampFrame,a=this.clampMargin/o.resolution,u=this.clampOffset;return s[0]=(t._frame.x+a+u)/o.width,s[1]=(t._frame.y+a+u)/o.height,s[2]=(t._frame.x+t._frame.width-a+u)/o.width,s[3]=(t._frame.y+t._frame.height-a+u)/o.height,this.uClampOffset[0]=u/o.realWidth,this.uClampOffset[1]=u/o.realHeight,this.isSimple=t._frame.width===o.width&&t._frame.height===o.height&&0===t.rotate,!0},e}();exports.TextureMatrix=Qe;var Ze=function(e){function t(t){var r=this,i=new o.Matrix;return r=e.call(this,We,Ke)||this,t.renderable=!1,r.maskSprite=t,r.maskMatrix=i,r}return h(t,e),t.prototype.apply=function(e,t,r,i){var n=this.maskSprite,o=n._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new Qe(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,t,r,i))},t}(Ye);exports.SpriteMaskFilter=Ze;var $e=function(e){function r(t){var r=e.call(this,t)||this;return r.enableScissor=!1,r.alphaMaskPool=[],r.maskDataPool=[],r.maskStack=[],r.alphaMaskIndex=0,r}return h(r,e),r.prototype.setMaskStack=function(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},r.prototype.push=function(e,r){var i=r;if(!i.isMaskData){var n=this.maskDataPool.pop()||new ae;n.pooled=!0,n.maskObject=r,i=n}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=e,i.type){case t.MASK_TYPES.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case t.MASK_TYPES.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case t.MASK_TYPES.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i)}},r.prototype.pop=function(e){var r=this.maskStack.pop();if(r&&r._target===e){switch(r.type){case t.MASK_TYPES.SCISSOR:this.renderer.scissor.pop();break;case t.MASK_TYPES.STENCIL:this.renderer.stencil.pop(r.maskObject);break;case t.MASK_TYPES.SPRITE:this.popSpriteMask()}r.reset(),r.pooled&&this.maskDataPool.push(r)}},r.prototype.detect=function(e){var r=e.maskObject;if(r.isSprite)e.type=t.MASK_TYPES.SPRITE;else if(e.type=t.MASK_TYPES.STENCIL,this.enableScissor&&r.isFastRect&&r.isFastRect()){var i=r.worldTransform,n=Math.atan2(i.b,i.a),o=Math.atan2(i.d,i.c);n=Math.round(n*(180/Math.PI)*100),o=((o=Math.round(o*(180/Math.PI)*100)-n)%18e3+18e3)%18e3,0===(n=(n%9e3+9e3)%9e3)&&9e3===o&&(e.type=t.MASK_TYPES.SCISSOR)}},r.prototype.pushSpriteMask=function(e){var t=e.maskObject,r=e._target,i=this.alphaMaskPool[this.alphaMaskIndex];i||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new Ze(t)]),i[0].resolution=this.renderer.resolution,i[0].maskSprite=t;var n=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,this.alphaMaskIndex++},r.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},r}(S),Je=function(e){function t(t){var r=e.call(this,t)||this;return r.maskStack=[],r.glConst=0,r}return h(t,e),t.prototype.getStackLength=function(){return this.maskStack.length},t.prototype.setMaskStack=function(e){var t=this.renderer.gl,r=this.getStackLength();this.maskStack=e;var i=this.getStackLength();i!==r&&(0===i?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},t.prototype._useCurrent=function(){},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.maskStack=null},t}(S),et=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.SCISSOR_TEST,r}return h(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.push=function(e){var t=e.maskObject;t.renderable=!0;var r=e._scissorRect,i=t.getBounds(!0),n=this.renderer.gl;t.renderable=!1,r?i.fit(r):n.enable(n.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=i,this._useCurrent()},t.prototype.pop=function(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,r=this.renderer.projection,i=r.transform,n=r.sourceFrame,o=r.destinationFrame,s=t?t.resolution:this.renderer.resolution,a=(e.x-n.x)*s+o.x,u=(e.y-n.y)*s+o.y,h=e.width*s,l=e.height*s;i&&(a+=i.tx*s,u+=i.ty*s),t||(u=this.renderer.height-l-u),this.renderer.gl.scissor(a,u,h,l)},t}(Je),tt=function(e){function t(t){var r=e.call(this,t)||this;return r.glConst=WebGLRenderingContext.STENCIL_TEST,r}return h(t,e),t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var t=e.maskObject,r=this.renderer.gl,i=e._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.enable(r.STENCIL_TEST)),e._stencilCounter++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,i,this._getBitwiseMask()),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},t.prototype.pop=function(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},t}(Je),rt=function(e){function t(t){var r=e.call(this,t)||this;return r.destinationFrame=null,r.sourceFrame=null,r.defaultFrame=null,r.projectionMatrix=new o.Matrix,r.transform=null,r}return h(t,e),t.prototype.update=function(e,t,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},t.prototype.calculateProjection=function(e,t,r,i){var n=this.projectionMatrix,o=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=o*(1/t.height*2),n.tx=-1-t.x*n.a,n.ty=-o-t.y*n.d},t.prototype.setTransform=function(e){},t}(S),it=new o.Rectangle,nt=new o.Rectangle,ot=new o.Rectangle,st=function(e){function t(t){var r=e.call(this,t)||this;return r.clearColor=t._backgroundColorRgba,r.defaultMaskStack=[],r.current=null,r.sourceFrame=new o.Rectangle,r.destinationFrame=new o.Rectangle,r}return h(t,e),t.prototype.bind=function(e,t,r){void 0===e&&(e=null);var i,n,o,s=this.renderer;this.current=e,e?(o=(i=e.baseTexture).resolution,t||(it.width=e.frame.width,it.height=e.frame.height,t=it),r||(nt.x=e.frame.x,nt.y=e.frame.y,nt.width=t.width,nt.height=t.height,r=nt),n=i.framebuffer):(o=s.resolution,t||(it.width=s.screen.width,it.height=s.screen.height,t=it),r||((r=it).width=t.width,r.height=t.height)),ot.x=r.x*o,ot.y=r.y*o,ot.width=r.width*o,ot.height=r.height*o,this.renderer.framebuffer.bind(n,ot),this.renderer.projection.update(r,t,o,!n),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)},t.prototype.clear=function(e,t){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3],t)},t.prototype.resize=function(){this.bind(null)},t.prototype.reset=function(){this.bind(null)},t}(S),at=function(){return function(){}}();exports.IGLUniformData=at;var ut=function(){function e(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}}return e.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},e}();exports.GLProgram=ut;var ht=0,lt={textureCount:0},dt=function(e){function t(t){var r=e.call(this,t)||this;return r.destroyed=!1,r.systemCheck(),r.gl=null,r.shader=null,r.program=null,r.cache={},r.id=ht++,r}return h(t,e),t.prototype.systemCheck=function(){if(!Pe())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},t.prototype.contextChange=function(e){this.gl=e,this.reset()},t.prototype.bind=function(e,t){e.uniforms.globals=this.renderer.globalUniforms;var r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),t||(lt.textureCount=0,this.syncUniformGroup(e.uniformGroup,lt)),i},t.prototype.setUniforms=function(e){var t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)},t.prototype.syncUniformGroup=function(e,t){var r=this.getglProgram();e.static&&e.dirtyId===r.uniformGroups[e.id]||(r.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))},t.prototype.syncUniforms=function(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)},t.prototype.createSyncGroups=function(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=Ae(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},t.prototype.getSignature=function(e,t){var r=e.uniforms,i=[];for(var n in r)i.push(n),t[n]&&i.push(t[n].type);return i.join("-")},t.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},t.prototype.generateShader=function(e){var t=this.gl,r=e.program,i={};for(var n in r.attributeData)i[n]=r.attributeData[n].location;var o=he(t,r.vertexSrc,r.fragmentSrc,i),s={};for(var n in r.uniformData){var a=r.uniformData[n];s[n]={location:t.getUniformLocation(o,n),value:de(a.type,a.size)}}var u=new ut(o,s);return r.glPrograms[this.renderer.CONTEXT_UID]=u,u},t.prototype.reset=function(){this.program=null,this.shader=null},t.prototype.destroy=function(){this.destroyed=!0},t}(S);function ct(e,r){return void 0===r&&(r=[]),r[t.BLEND_MODES.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.ADD]=[e.ONE,e.ONE],r[t.BLEND_MODES.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.NONE]=[0,0],r[t.BLEND_MODES.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],r[t.BLEND_MODES.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SRC_IN]=[e.DST_ALPHA,e.ZERO],r[t.BLEND_MODES.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],r[t.BLEND_MODES.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],r[t.BLEND_MODES.DST_IN]=[e.ZERO,e.SRC_ALPHA],r[t.BLEND_MODES.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],r[t.BLEND_MODES.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],r[t.BLEND_MODES.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],r}var ft=0,pt=1,mt=2,vt=3,gt=4,yt=function(e){function r(r){var i=e.call(this,r)||this;return i.gl=null,i.stateId=0,i.polygonOffset=0,i.blendMode=t.BLEND_MODES.NONE,i._blendEq=!1,i.map=[],i.map[ft]=i.setBlend,i.map[pt]=i.setOffset,i.map[mt]=i.setCullFace,i.map[vt]=i.setDepthTest,i.map[gt]=i.setFrontFace,i.checks=[],i.defaultState=new He,i.defaultState.blend=!0,i}return h(r,e),r.prototype.contextChange=function(e){this.gl=e,this.blendModes=ct(e),this.set(this.defaultState),this.reset()},r.prototype.set=function(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,r=0;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(r=0;r<this.checks.length;r++)this.checks[r](this,e)},r.prototype.forceState=function(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data},r.prototype.setBlend=function(e){this.updateCheck(r.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},r.prototype.setOffset=function(e){this.updateCheck(r.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},r.prototype.setDepthTest=function(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},r.prototype.setCullFace=function(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},r.prototype.setFrontFace=function(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},r.prototype.setBlendMode=function(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}},r.prototype.setPolygonOffset=function(e,t){this.gl.polygonOffset(e,t)},r.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},r.prototype.updateCheck=function(e,t){var r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)},r.checkBlendMode=function(e,t){e.setBlendMode(t.blendMode)},r.checkPolygonOffset=function(e,t){e.setPolygonOffset(1,t.polygonOffset)},r}(S),xt=function(r){function i(t){var i=r.call(this,t)||this;return i.count=0,i.checkCount=0,i.maxIdle=e.settings.GC_MAX_IDLE,i.checkCountMax=e.settings.GC_MAX_CHECK_COUNT,i.mode=e.settings.GC_MODE,i}return h(i,r),i.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==t.GC_MODES.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},i.prototype.run=function(){for(var e=this.renderer.texture,t=e.managedTextures,r=!1,i=0;i<t.length;i++){var n=t[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){var o=0;for(i=0;i<t.length;i++)null!==t[i]&&(t[o++]=t[i]);t.length=o}},i.prototype.unload=function(e){var t,r=this.renderer.texture;(null===(t=e._texture)||void 0===t?void 0:t.framebuffer)&&r.destroyTexture(e._texture);for(var i=e.children.length-1;i>=0;i--)this.unload(e.children[i])},i}(S),_t=function(){return function(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}}();exports.GLTexture=_t;var Et=function(e){function i(t){var r=e.call(this,t)||this;return r.boundTextures=[],r.currentLocation=-1,r.managedTextures=[],r._unknownBoundTextures=!1,r.unknownTexture=new f,r}return h(i,e),i.prototype.contextChange=function(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var r=0;r<t;r++)this.boundTextures[r]=null;this.emptyTextures={};var i=new _t(e.createTexture());e.bindTexture(e.TEXTURE_2D,i.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=i,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new _t(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(r=0;r<6;r++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(r=0;r<this.boundTextures.length;r++)this.bind(null,r)},i.prototype.bind=function(e,t){void 0===t&&(t=0);var r=this.gl;if(e){if((e=e.castToBaseTexture()).parentTextureArray)return;if(e.valid){e.touched=this.renderer.textureGC.count;var i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null},i.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},i.prototype.unbind=function(e){var t=this.gl,r=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var i=0;i<r.length;i++)r[i]===this.unknownTexture&&this.bind(null,i)}for(i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)},i.prototype.initTexture=function(e){var t=new _t(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},i.prototype.initTextureType=function(e,r){if(r.internalFormat=e.format,r.type=e.type,2===this.webGLVersion){var i=this.renderer.gl;e.type===i.FLOAT&&e.format===i.RGBA&&(r.internalFormat=i.RGBA32F),e.type===t.TYPES.HALF_FLOAT&&(r.type=i.HALF_FLOAT),r.type===i.HALF_FLOAT&&e.format===i.RGBA&&(r.internalFormat=i.RGBA16F)}},i.prototype.updateTexture=function(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var r=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(r,e,t));else{var i=e.realWidth,n=e.realHeight,o=r.gl;(t.width!==i||t.height!==n||t.dirtyId<0)&&(t.width=i,t.height=n,o.texImage2D(e.target,0,t.internalFormat,i,n,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},i.prototype.destroyTexture=function(e,t){var i=this.gl;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),i.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var n=this.managedTextures.indexOf(e);-1!==n&&(0,r.removeItems)(this.managedTextures,n,1)}},i.prototype.updateTextureStyle=function(e){var r=e._glTextures[this.CONTEXT_UID];r&&(e.mipmap!==t.MIPMAP_MODES.POW2&&2===this.webGLVersion||e.isPowerOfTwo?r.mipmap=e.mipmap>=1:r.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?r.wrapMode=e.wrapMode:r.wrapMode=t.WRAP_MODES.CLAMP,e.resource&&e.resource.style(this.renderer,e,r)||this.setStyle(e,r),r.dirtyStyleId=e.dirtyStyleId)},i.prototype.setStyle=function(e,r){var i=this.gl;if(r.mipmap&&i.generateMipmap(e.target),i.texParameteri(e.target,i.TEXTURE_WRAP_S,r.wrapMode),i.texParameteri(e.target,i.TEXTURE_WRAP_T,r.wrapMode),r.mipmap){i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var n=this.renderer.context.extensions.anisotropicFiltering;if(n&&e.anisotropicLevel>0&&e.scaleMode===t.SCALE_MODES.LINEAR){var o=Math.min(e.anisotropicLevel,i.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(e.target,n.TEXTURE_MAX_ANISOTROPY_EXT,o)}}else i.texParameteri(e.target,i.TEXTURE_MIN_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(e.target,i.TEXTURE_MAG_FILTER,e.scaleMode===t.SCALE_MODES.LINEAR?i.LINEAR:i.NEAREST)},i}(S),Tt={FilterSystem:Q,BatchSystem:$,ContextSystem:ee,FramebufferSystem:ie,GeometrySystem:se,MaskSystem:$e,ScissorSystem:et,StencilSystem:tt,ProjectionSystem:rt,RenderTextureSystem:st,ShaderSystem:dt,StateSystem:yt,TextureGCSystem:xt,TextureSystem:Et};exports.systems=Tt;var bt=new o.Matrix,St=function(i){function n(n,s){void 0===n&&(n=t.RENDERER_TYPE.UNKNOWN);var a=i.call(this)||this;return(s=Object.assign({},e.settings.RENDER_OPTIONS,s)).roundPixels&&(e.settings.ROUND_PIXELS=s.roundPixels,(0,r.deprecation)("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),a.options=s,a.type=n,a.screen=new o.Rectangle(0,0,s.width,s.height),a.view=s.view||document.createElement("canvas"),a.resolution=s.resolution||e.settings.RESOLUTION,a.transparent=s.transparent,a.autoDensity=s.autoDensity||s.autoResize||!1,a.preserveDrawingBuffer=s.preserveDrawingBuffer,a.clearBeforeRender=s.clearBeforeRender,a._backgroundColor=0,a._backgroundColorRgba=[0,0,0,0],a._backgroundColorString="#000000",a.backgroundColor=s.backgroundColor||a._backgroundColor,a._lastObjectRendered=null,a.plugins={},a}return h(n,i),n.prototype.initPlugins=function(e){for(var t in e)this.plugins[t]=new e[t](this)},Object.defineProperty(n.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),n.prototype.resize=function(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px"),this.emit("resize",e,t)},n.prototype.generateTexture=function(e,t,r,i){0===(i=i||e.getLocalBounds(null,!0)).width&&(i.width=1),0===i.height&&(i.height=1);var n=D.create({width:0|i.width,height:0|i.height,scaleMode:t,resolution:r});return bt.tx=-i.x,bt.ty=-i.y,this.render(e,n,!1,bt,!!e.parent),n},n.prototype.destroy=function(e){for(var r in this.plugins)this.plugins[r].destroy(),this.plugins[r]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=t.RENDERER_TYPE.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=(0,r.hex2string)(e),(0,r.hex2rgb)(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),n}(r.EventEmitter);exports.AbstractRenderer=St;var wt=function(e){function n(s){var a=e.call(this,t.RENDERER_TYPE.WEBGL,s)||this;return s=a.options,a.gl=null,a.CONTEXT_UID=0,a.runners={destroy:new i.Runner("destroy"),contextChange:new i.Runner("contextChange"),reset:new i.Runner("reset"),update:new i.Runner("update"),postrender:new i.Runner("postrender"),prerender:new i.Runner("prerender"),resize:new i.Runner("resize")},a.globalUniforms=new K({projectionMatrix:new o.Matrix},!0),a.addSystem($e,"mask").addSystem(ee,"context").addSystem(yt,"state").addSystem(dt,"shader").addSystem(Et,"texture").addSystem(se,"geometry").addSystem(ie,"framebuffer").addSystem(et,"scissor").addSystem(tt,"stencil").addSystem(rt,"projection").addSystem(xt,"textureGC").addSystem(Q,"filter").addSystem(st,"renderTexture").addSystem($,"batch"),a.initPlugins(n.__plugins),s.context?a.context.initFromContext(s.context):a.context.initFromOptions({alpha:!!a.transparent,antialias:s.antialias,premultipliedAlpha:a.transparent&&"notMultiplied"!==a.transparent,stencil:!0,preserveDrawingBuffer:s.preserveDrawingBuffer,powerPreference:a.options.powerPreference}),a.renderingToScreen=!0,(0,r.sayHello)(2===a.context.webGLVersion?"WebGL 2":"WebGL 1"),a.resize(a.options.width,a.options.height),a}return h(n,e),n.create=function(e){if((0,r.isWebGLSupported)())return new n(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},n.prototype.addSystem=function(e,t){t||(t=e.name);var r=new e(this);if(this[t])throw new Error('Whoops! The name "'+t+'" is already in use');for(var i in this[t]=r,this.runners)this.runners[i].add(r);return this},n.prototype.render=function(e,t,r,i,n){if(this.renderingToScreen=!t,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=i,!this.context.isLost){if(t||(this._lastObjectRendered=e),!n){var o=e.enableTempParent();e.updateTransform(),e.disableTempParent(o)}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(void 0!==r?r:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},n.prototype.resize=function(t,r){e.prototype.resize.call(this,t,r),this.runners.resize.emit(t,r)},n.prototype.reset=function(){return this.runners.reset.emit(),this},n.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},n.prototype.destroy=function(t){for(var r in this.runners.destroy.emit(),this.runners)this.runners[r].destroy();e.prototype.destroy.call(this,t),this.gl=null},n.registerPlugin=function(e,t){n.__plugins=n.__plugins||{},n.__plugins[e]=t},n}(St);function At(e){return wt.create(e)}exports.Renderer=wt;var Ct="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}";exports.defaultVertex=Ct;var Rt="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";exports.defaultFilterVertex=Rt;var It=function(){return function(){this.texArray=null,this.blend=0,this.type=t.DRAW_MODES.TRIANGLES,this.start=0,this.size=0,this.data=null}}();exports.BatchDrawCall=It;var Ot=function(){function e(){this.elements=[],this.ids=[],this.count=0}return e.prototype.clear=function(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0},e}();exports.BatchTextureArray=Ot;var Pt=function(){function e(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(e.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),e.prototype.view=function(e){return this[e+"View"]},e.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},e.sizeOf=function(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},e}();exports.ViewableBuffer=Pt;var Mt=function(i){function n(t){var r=i.call(this,t)||this;return r.shaderGenerator=null,r.geometryClass=null,r.vertexSize=null,r.state=He.for2d(),r.size=4*e.settings.SPRITE_BATCH_SIZE,r._vertexCount=0,r._indexCount=0,r._bufferedElements=[],r._bufferedTextures=[],r._bufferSize=0,r._shader=null,r._packedGeometries=[],r._packedGeometryPoolSize=2,r._flushId=0,r._aBuffers={},r._iBuffers={},r.MAX_TEXTURES=1,r.renderer.on("prerender",r.onPrerender,r),t.runners.contextChange.add(r),r._dcIndex=0,r._aIndex=0,r._iIndex=0,r._attributeBuffer=null,r._indexBuffer=null,r._tempBoundTextures=[],r}return h(n,i),n.prototype.contextChange=function(){var r=this.renderer.gl;e.settings.PREFER_ENV===t.ENV.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),e.settings.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=Oe(this.MAX_TEXTURES,r)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var i=0;i<this._packedGeometryPoolSize;i++)this._packedGeometries[i]=new this.geometryClass;this.initFlushBuffers()},n.prototype.initFlushBuffers=function(){for(var e=n._drawCallPool,t=n._textureArrayPool,r=this.size/4,i=Math.floor(r/this.MAX_TEXTURES)+1;e.length<r;)e.push(new It);for(;t.length<i;)t.push(new Ot);for(var o=0;o<this.MAX_TEXTURES;o++)this._tempBoundTextures[o]=null},n.prototype.onPrerender=function(){this._flushId=0},n.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},n.prototype.buildTexturesAndDrawCalls=function(){var e=this._bufferedTextures,t=this.MAX_TEXTURES,r=n._textureArrayPool,i=this.renderer.batch,o=this._tempBoundTextures,s=this.renderer.textureGC.count,a=++f._globalBatch,u=0,h=r[0],l=0;i.copyBoundTextures(o,t);for(var d=0;d<this._bufferSize;++d){var c=e[d];e[d]=null,c._batchEnabled!==a&&(h.count>=t&&(i.boundArray(h,o,a,t),this.buildDrawCalls(h,l,d),l=d,h=r[++u],++a),c._batchEnabled=a,c.touched=s,h.elements[h.count++]=c)}h.count>0&&(i.boundArray(h,o,a,t),this.buildDrawCalls(h,l,this._bufferSize),++u,++a);for(d=0;d<o.length;d++)o[d]=null;f._globalBatch=a},n.prototype.buildDrawCalls=function(e,t,i){var o=this._bufferedElements,s=this._attributeBuffer,a=this._indexBuffer,u=this.vertexSize,h=n._drawCallPool,l=this._dcIndex,d=this._aIndex,c=this._iIndex,f=h[l];f.start=this._iIndex,f.texArray=e;for(var p=t;p<i;++p){var m=o[p],v=m._texture.baseTexture,g=r.premultiplyBlendMode[v.alphaMode?1:0][m.blendMode];o[p]=null,t<p&&f.blend!==g&&(f.size=c-f.start,t=p,(f=h[++l]).texArray=e,f.start=c),this.packInterleavedGeometry(m,s,a,d,c),d+=m.vertexData.length/2*u,c+=m.indices.length,f.blend=g}t<i&&(f.size=c-f.start,++l),this._dcIndex=l,this._aIndex=d,this._iIndex=c},n.prototype.bindAndClearTexArray=function(e){for(var t=this.renderer.texture,r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0},n.prototype.updateGeometry=function(){var t=this._packedGeometries,r=this._attributeBuffer,i=this._indexBuffer;e.settings.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},n.prototype.drawBatches=function(){for(var e=this._dcIndex,t=this.renderer,r=t.gl,i=t.state,o=n._drawCallPool,s=null,a=0;a<e;a++){var u=o[a],h=u.texArray,l=u.type,d=u.size,c=u.start,f=u.blend;s!==h&&(s=h,this.bindAndClearTexArray(h)),this.state.blendMode=f,i.set(this.state),r.drawElements(l,d,r.UNSIGNED_SHORT,2*c)}},n.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},n.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),e.settings.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},n.prototype.stop=function(){this.flush()},n.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),i.prototype.destroy.call(this)},n.prototype.getAttributeBuffer=function(e){var t=(0,r.nextPow2)(Math.ceil(e/8)),i=(0,r.log2)(t),n=8*t;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var o=this._aBuffers[n];return o||(this._aBuffers[n]=o=new Pt(n*this.vertexSize*4)),o},n.prototype.getIndexBuffer=function(e){var t=(0,r.nextPow2)(Math.ceil(e/12)),i=(0,r.log2)(t),n=12*t;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var o=this._iBuffers[i];return o||(this._iBuffers[i]=o=new Uint16Array(n)),o},n.prototype.packInterleavedGeometry=function(e,t,i,n,o){for(var s=t.uint32View,a=t.float32View,u=n/this.vertexSize,h=e.uvs,l=e.indices,d=e.vertexData,c=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),p=f<1&&e._texture.baseTexture.alphaMode?(0,r.premultiplyTint)(e._tintRGB,f):e._tintRGB+(255*f<<24),m=0;m<d.length;m+=2)a[n++]=d[m],a[n++]=d[m+1],a[n++]=h[m],a[n++]=h[m+1],s[n++]=p,a[n++]=c;for(m=0;m<l.length;m++)i[o++]=u+l[m]},n._drawCallPool=[],n._textureArrayPool=[],n}(Z);exports.AbstractBatchRenderer=Mt;var Dt=function(){function e(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return e.prototype.generateShader=function(e){if(!this.programCache[e]){for(var t=new Int32Array(e),r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=K.from({uSamplers:t},!0);var i=this.fragTemplate;i=(i=i.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Le(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new o.Matrix,default:this.defaultGroupCache[e]};return new Be(this.programCache[e],n)},e.prototype.generateSampleSrc=function(e){var t="";t+="\n",t+="\n";for(var r=0;r<e;r++)r>0&&(t+="\nelse "),r<e-1&&(t+="if(vTextureId < "+r+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+r+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"},e}();exports.BatchShaderGenerator=Dt;var Ft=function(e){function r(r){void 0===r&&(r=!1);var i=e.call(this)||this;return i._buffer=new B(null,r,!1),i._indexBuffer=new B(null,r,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,t.TYPES.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,t.TYPES.FLOAT).addAttribute("aColor",i._buffer,4,!0,t.TYPES.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,t.TYPES.FLOAT).addIndex(i._indexBuffer),i}return h(r,e),r}(z);exports.BatchGeometry=Ft;var Nt="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",Lt="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Bt=function(){function e(){}return e.create=function(e){var t=Object.assign({vertex:Nt,fragment:Lt,geometryClass:Ft,vertexSize:6},e),r=t.vertex,i=t.fragment,n=t.vertexSize,o=t.geometryClass;return function(e){function t(t){var s=e.call(this,t)||this;return s.shaderGenerator=new Dt(r,i),s.geometryClass=o,s.vertexSize=n,s}return h(t,e),t}(Mt)},Object.defineProperty(e,"defaultVertexSrc",{get:function(){return Nt},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentTemplate",{get:function(){return Lt},enumerable:!1,configurable:!0}),e}();exports.BatchPluginFactory=Bt;var Ut=Bt.create();exports.BatchRenderer=Ut;
},{"@pixi/settings":"Xe2x","@pixi/constants":"djkr","@pixi/utils":"X4iF","@pixi/runner":"KLq2","@pixi/ticker":"AWzT","@pixi/math":"w9h1"}],"ExZK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Application=void 0;var e=require("@pixi/display"),i=require("@pixi/core"),r=function(){function r(n){var t=this;n=Object.assign({forceCanvas:!1},n),this.renderer=(0,i.autoDetectRenderer)(n),this.stage=new e.Container,r._plugins.forEach(function(e){e.init.call(t,n)})}return r.registerPlugin=function(e){r._plugins.push(e)},r.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(r.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),r.prototype.destroy=function(e,i){var n=this,t=r._plugins.slice(0);t.reverse(),t.forEach(function(e){e.destroy.call(n)}),this.stage.destroy(i),this.stage=null,this.renderer.destroy(e),this.renderer=null},r}();exports.Application=r,r._plugins=[];var n=function(){function e(){}return e.init=function(e){var i=this;Object.defineProperty(this,"resizeTo",{set:function(e){window.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(window.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){i._resizeTo&&(i.cancelResize(),i._resizeId=requestAnimationFrame(function(){return i.resize()}))},this.cancelResize=function(){i._resizeId&&(cancelAnimationFrame(i._resizeId),i._resizeId=null)},this.resize=function(){if(i._resizeTo){var e,r;if(i.cancelResize(),i._resizeTo===window)e=window.innerWidth,r=window.innerHeight;else{var n=i._resizeTo;e=n.clientWidth,r=n.clientHeight}i.renderer.resize(e,r)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null},e.destroy=function(){this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},e}();r.registerPlugin(n);
},{"@pixi/display":"qvzw","@pixi/core":"lj2a"}],"ZH8o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Extract=void 0;var e=require("@pixi/utils"),r=require("@pixi/math"),t=require("@pixi/core"),n=new r.Rectangle,a=4,i=function(){function r(e){this.renderer=e,e.extract=this}return r.prototype.image=function(e,r,t){var n=new Image;return n.src=this.base64(e,r,t),n},r.prototype.base64=function(e,r,t){return this.canvas(e).toDataURL(r,t)},r.prototype.canvas=function(i){var o,s,d,h=this.renderer,u=!1,x=!1;i&&(i instanceof t.RenderTexture?d=i:(d=this.renderer.generateTexture(i),x=!0)),d?(o=d.baseTexture.resolution,s=d.frame,u=!1,h.renderTexture.bind(d)):(o=this.renderer.resolution,u=!0,(s=n).width=this.renderer.width,s.height=this.renderer.height,h.renderTexture.bind(null));var c=Math.floor(s.width*o+1e-4),l=Math.floor(s.height*o+1e-4),g=new e.CanvasRenderTarget(c,l,1),v=new Uint8Array(a*c*l),p=h.gl;p.readPixels(s.x*o,s.y*o,c,l,p.RGBA,p.UNSIGNED_BYTE,v);var f=g.context.getImageData(0,0,c,l);if(r.arrayPostDivide(v,f.data),g.context.putImageData(f,0,0),u){var y=new e.CanvasRenderTarget(g.width,g.height,1);y.context.scale(1,-1),y.context.drawImage(g.canvas,0,-l),g.destroy(),g=y}return x&&d.destroy(!0),g.canvas},r.prototype.pixels=function(e){var i,o,s,d=this.renderer,h=!1;e&&(e instanceof t.RenderTexture?s=e:(s=this.renderer.generateTexture(e),h=!0)),s?(i=s.baseTexture.resolution,o=s.frame,d.renderTexture.bind(s)):(i=d.resolution,(o=n).width=d.width,o.height=d.height,d.renderTexture.bind(null));var u=o.width*i,x=o.height*i,c=new Uint8Array(a*u*x),l=d.gl;return l.readPixels(o.x*i,o.y*i,u,x,l.RGBA,l.UNSIGNED_BYTE,c),h&&s.destroy(!0),r.arrayPostDivide(c,c),c},r.prototype.destroy=function(){this.renderer.extract=null,this.renderer=null},r.arrayPostDivide=function(e,r){for(var t=0;t<e.length;t+=4){var n=r[t+3]=e[t+3];0!==n?(r[t]=Math.round(Math.min(255*e[t]/n,255)),r[t+1]=Math.round(Math.min(255*e[t+1]/n,255)),r[t+2]=Math.round(Math.min(255*e[t+2]/n,255))):(r[t]=e[t],r[t+1]=e[t+1],r[t+2]=e[t+2])}},r}();exports.Extract=i;
},{"@pixi/utils":"X4iF","@pixi/math":"w9h1","@pixi/core":"lj2a"}],"YnZR":[function(require,module,exports) {
"use strict";function e(e,r){if(e){r=r||{};for(var o={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},t=o.parser[r.strictMode?"strict":"loose"].exec(e),s={},a=14;a--;)s[o.key[a]]=t[a]||"";return s[o.q.name]={},s[o.key[12]].replace(o.q.parser,function(e,r,t){r&&(s[o.q.name][r]=t)}),s}}module.exports=e;
},{}],"LmWK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function n(n,t){for(var e=0;e<t.length;e++){var i=t[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}();function t(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}var e=function(){function e(n,i,r){void 0===i&&(i=!1),t(this,e),this._fn=n,this._once=i,this._thisArg=r,this._next=this._prev=this._owner=null}return n(e,[{key:"detach",value:function(){return null!==this._owner&&(this._owner.detach(this),!0)}}]),e}();function i(n,t){return n._head?(n._tail._next=t,t._prev=n._tail,n._tail=t):(n._head=t,n._tail=t),t._owner=n,t}var r=function(){function r(){t(this,r),this._head=this._tail=void 0}return n(r,[{key:"handlers",value:function(){var n=!(arguments.length<=0||void 0===arguments[0])&&arguments[0],t=this._head;if(n)return!!t;for(var e=[];t;)e.push(t),t=t._next;return e}},{key:"has",value:function(n){if(!(n instanceof e))throw new Error("MiniSignal#has(): First arg must be a MiniSignalBinding object.");return n._owner===this}},{key:"dispatch",value:function(){var n=this._head;if(!n)return!1;for(;n;)n._once&&this.detach(n),n._fn.apply(n._thisArg,arguments),n=n._next;return!0}},{key:"add",value:function(n){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof n)throw new Error("MiniSignal#add(): First arg must be a Function.");return i(this,new e(n,!1,t))}},{key:"once",value:function(n){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];if("function"!=typeof n)throw new Error("MiniSignal#once(): First arg must be a Function.");return i(this,new e(n,!0,t))}},{key:"detach",value:function(n){if(!(n instanceof e))throw new Error("MiniSignal#detach(): First arg must be a MiniSignalBinding object.");return n._owner!==this?this:(n._prev&&(n._prev._next=n._next),n._next&&(n._next._prev=n._prev),n===this._head?(this._head=n._next,null===n._next&&(this._tail=null)):n===this._tail&&(this._tail=n._prev,this._tail._next=null),n._owner=null,this)}},{key:"detachAll",value:function(){var n=this._head;if(!n)return this;for(this._head=this._tail=null;n;)n._owner=null,n=n._next;return this}}]),r}();r.MiniSignalBinding=e,exports.default=r,module.exports=exports.default;
},{}],"zWx3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.encodeBinary=b,exports.middleware=exports.async=exports.Resource=exports.Loader=void 0;var t=r(require("parse-uri")),e=r(require("mini-signals"));function r(t){return t&&t.__esModule?t:{default:t}}function i(){}function s(t,e,r,i){var s=0,n=t.length;!function o(a){a||s===n?r&&r(a):i?setTimeout(function(){e(t[s++],o)},1):e(t[s++],o)}()}function n(t){return function(){if(null===t)throw new Error("Callback was already called.");var e=t;t=null,e.apply(this,arguments)}}function o(t,e){if(null==e)e=1;else if(0===e)throw new Error("Concurrency must not be zero");var r=0,s={_tasks:[],concurrency:e,saturated:i,unsaturated:i,buffer:e/4,empty:i,drain:i,error:i,started:!1,paused:!1,push:function(t,e){o(t,!1,e)},kill:function(){r=0,s.drain=i,s.started=!1,s._tasks=[]},unshift:function(t,e){o(t,!0,e)},process:function(){for(;!s.paused&&r<s.concurrency&&s._tasks.length;){var e=s._tasks.shift();0===s._tasks.length&&s.empty(),(r+=1)===s.concurrency&&s.saturated(),t(e.data,n(a(e)))}},length:function(){return s._tasks.length},running:function(){return r},idle:function(){return s._tasks.length+r===0},pause:function(){!0!==s.paused&&(s.paused=!0)},resume:function(){if(!1!==s.paused){s.paused=!1;for(var t=1;t<=s.concurrency;t++)s.process()}}};function o(t,e,r){if(null!=r&&"function"!=typeof r)throw new Error("task callback must be a function");if(s.started=!0,null==t&&s.idle())setTimeout(function(){return s.drain()},1);else{var n={data:t,callback:"function"==typeof r?r:i};e?s._tasks.unshift(n):s._tasks.push(n),setTimeout(function(){return s.process()},1)}}function a(t){return function(){r-=1,t.callback.apply(t,arguments),null!=arguments[0]&&s.error(arguments[0],t.data),r<=s.concurrency-s.buffer&&s.unsaturated(),s.idle()&&s.drain(),s.process()}}return s}var a={eachSeries:s,queue:o};exports.async=a;var h={};function u(t,e){var r=this;h[t.url]?(t.data=h[t.url],t.complete()):t.onComplete.once(function(){return h[r.url]=r.data}),e()}function d(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e,r){return e&&d(t.prototype,e),r&&d(t,r),t}var c=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),_=null,E=0,f=200,p=204,T=1223,O=2;function g(){}var m=function(){function r(t,i,s){if("string"!=typeof t||"string"!=typeof i)throw new Error("Both name and url are required for constructing a resource.");s=s||{},this._flags=0,this._setFlag(r.STATUS_FLAGS.DATA_URL,0===i.indexOf("data:")),this.name=t,this.url=i,this.extension=this._getExtension(),this.data=null,this.crossOrigin=!0===s.crossOrigin?"anonymous":s.crossOrigin,this.timeout=s.timeout||0,this.loadType=s.loadType||this._determineLoadType(),this.xhrType=s.xhrType,this.metadata=s.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=r.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=g,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new e.default,this.onProgress=new e.default,this.onComplete=new e.default,this.onAfterMiddleware=new e.default}r.setExtensionLoadType=function(t,e){P(r._loadTypeMap,t,e)},r.setExtensionXhrType=function(t,e){P(r._xhrTypeMap,t,e)};var i=r.prototype;return i.complete=function(){this._clearEvents(),this._finish()},i.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=r.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},i.load=function(t){var e=this;if(!this.isLoading)if(this.isComplete)t&&setTimeout(function(){return t(e)},1);else switch(t&&this.onComplete.once(t),this._setFlag(r.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),!1!==this.crossOrigin&&"string"==typeof this.crossOrigin||(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this.type=r.TYPE.IMAGE,this._loadElement("image");break;case r.LOAD_TYPE.AUDIO:this.type=r.TYPE.AUDIO,this._loadSourceElement("audio");break;case r.LOAD_TYPE.VIDEO:this.type=r.TYPE.VIDEO,this._loadSourceElement("video");break;case r.LOAD_TYPE.XHR:default:c&&this.crossOrigin?this._loadXdr():this._loadXhr()}},i._hasFlag=function(t){return 0!=(this._flags&t)},i._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},i._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},i._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(r.STATUS_FLAGS.COMPLETE,!0),this._setFlag(r.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},i._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:"image"===t&&void 0!==window.Image?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},i._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:"audio"===t&&void 0!==window.Audio?this.data=new Audio:this.data=document.createElement(t),null!==this.data){if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,r=0;r<this.url.length;++r)this.data.appendChild(this._createSource(t,this.url[r],Array.isArray(e)?e[r]:e));else{var i=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(i)?i[0]:i))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))}else this.abort("Unsupported element: "+t)},i._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=r.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},i._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},i._createSource=function(t,e,r){r||(r=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=r,i},i._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},i._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},i._onTimeout=function(){this.abort("Load timed out.")},i._xhrOnError=function(){var t=this.xhr;this.abort(S(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},i._xhrOnTimeout=function(){var t=this.xhr;this.abort(S(t)+" Request timed out.")},i._xhrOnAbort=function(){var t=this.xhr;this.abort(S(t)+" Request was aborted by the user.")},i._xhrOnLoad=function(){var t=this.xhr,e="",i=void 0===t.status?f:t.status;if(""!==t.responseType&&"text"!==t.responseType&&void 0!==t.responseType||(e=t.responseText),i===E&&(e.length>0||t.responseType===r.XHR_RESPONSE_TYPE.BUFFER)?i=f:i===T&&(i=p),(i/100|0)===O){if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=r.TYPE.TEXT;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=r.TYPE.JSON}catch(o){return void this.abort("Error trying to parse loaded json: "+o)}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var s=new DOMParser;this.data=s.parseFromString(e,"text/xml")}else{var n=document.createElement("div");n.innerHTML=e,this.data=n}this.type=r.TYPE.XML}catch(o){return void this.abort("Error trying to parse loaded xml: "+o)}else this.data=t.response||e;this.complete()}else this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL)},i._determineCrossOrigin=function(e,r){if(0===e.indexOf("data:"))return"";if(window.origin!==window.location.origin)return"anonymous";r=r||window.location,_||(_=document.createElement("a")),_.href=e;var i=!(e=(0,t.default)(_.href,{strictMode:!0})).port&&""===r.port||e.port===r.port,s=e.protocol?e.protocol+":":"";return e.host===r.hostname&&i&&s===r.protocol?"":"anonymous"},i._determineXhrType=function(){return r._xhrTypeMap[this.extension]||r.XHR_RESPONSE_TYPE.TEXT},i._determineLoadType=function(){return r._loadTypeMap[this.extension]||r.LOAD_TYPE.XHR},i._getExtension=function(){var t=this.url,e="";if(this.isDataUrl){var r=t.indexOf("/");e=t.substring(r+1,t.indexOf(";",r))}else{var i=t.indexOf("?"),s=t.indexOf("#"),n=Math.min(i>-1?i:t.length,s>-1?s:t.length);e=(t=t.substring(0,n)).substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},i._getMimeFromXhrType=function(t){switch(t){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},l(r,[{key:"isDataUrl",get:function(){return this._hasFlag(r.STATUS_FLAGS.DATA_URL)}},{key:"isComplete",get:function(){return this._hasFlag(r.STATUS_FLAGS.COMPLETE)}},{key:"isLoading",get:function(){return this._hasFlag(r.STATUS_FLAGS.LOADING)}}]),r}();function P(t,e,r){e&&0===e.indexOf(".")&&(e=e.substring(1)),e&&(t[e]=r)}function S(t){return t.toString().replace("object ","")}exports.Resource=m,m.STATUS_FLAGS={NONE:0,DATA_URL:1,COMPLETE:2,LOADING:4},m.TYPE={UNKNOWN:0,JSON:1,XML:2,IMAGE:3,AUDIO:4,VIDEO:5,TEXT:6},m.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},m.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},m._loadTypeMap={gif:m.LOAD_TYPE.IMAGE,png:m.LOAD_TYPE.IMAGE,bmp:m.LOAD_TYPE.IMAGE,jpg:m.LOAD_TYPE.IMAGE,jpeg:m.LOAD_TYPE.IMAGE,tif:m.LOAD_TYPE.IMAGE,tiff:m.LOAD_TYPE.IMAGE,webp:m.LOAD_TYPE.IMAGE,tga:m.LOAD_TYPE.IMAGE,svg:m.LOAD_TYPE.IMAGE,"svg+xml":m.LOAD_TYPE.IMAGE,mp3:m.LOAD_TYPE.AUDIO,ogg:m.LOAD_TYPE.AUDIO,wav:m.LOAD_TYPE.AUDIO,mp4:m.LOAD_TYPE.VIDEO,webm:m.LOAD_TYPE.VIDEO},m._xhrTypeMap={xhtml:m.XHR_RESPONSE_TYPE.DOCUMENT,html:m.XHR_RESPONSE_TYPE.DOCUMENT,htm:m.XHR_RESPONSE_TYPE.DOCUMENT,xml:m.XHR_RESPONSE_TYPE.DOCUMENT,tmx:m.XHR_RESPONSE_TYPE.DOCUMENT,svg:m.XHR_RESPONSE_TYPE.DOCUMENT,tsx:m.XHR_RESPONSE_TYPE.DOCUMENT,gif:m.XHR_RESPONSE_TYPE.BLOB,png:m.XHR_RESPONSE_TYPE.BLOB,bmp:m.XHR_RESPONSE_TYPE.BLOB,jpg:m.XHR_RESPONSE_TYPE.BLOB,jpeg:m.XHR_RESPONSE_TYPE.BLOB,tif:m.XHR_RESPONSE_TYPE.BLOB,tiff:m.XHR_RESPONSE_TYPE.BLOB,webp:m.XHR_RESPONSE_TYPE.BLOB,tga:m.XHR_RESPONSE_TYPE.BLOB,json:m.XHR_RESPONSE_TYPE.JSON,text:m.XHR_RESPONSE_TYPE.TEXT,txt:m.XHR_RESPONSE_TYPE.TEXT,ttf:m.XHR_RESPONSE_TYPE.BUFFER,otf:m.XHR_RESPONSE_TYPE.BUFFER},m.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==";var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function b(t){for(var e="",r=0;r<t.length;){for(var i=[0,0,0],s=[0,0,0,0],n=0;n<i.length;++n)r<t.length?i[n]=255&t.charCodeAt(r++):i[n]=0;switch(s[0]=i[0]>>2,s[1]=(3&i[0])<<4|i[1]>>4,s[2]=(15&i[1])<<2|i[2]>>6,s[3]=63&i[2],r-(t.length-1)){case 2:s[3]=64,s[2]=64;break;case 1:s[3]=64}for(var o=0;o<s.length;++o)e+=A.charAt(s[o])}return e}var y=window.URL||window.webkitURL;function L(t,e){if(t.data){if(t.xhr&&t.xhrType===m.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof t.data){if(0===t.data.type.indexOf("image")){var r=y.createObjectURL(t.data);return t.blob=t.data,t.data=new Image,t.data.src=r,t.type=m.TYPE.IMAGE,void(t.data.onload=function(){y.revokeObjectURL(r),t.data.onload=null,e()})}}else{var i=t.xhr.getResponseHeader("content-type");if(i&&0===i.indexOf("image"))return t.data=new Image,t.data.src="data:"+i+";base64,"+b(t.xhr.responseText),t.type=m.TYPE.IMAGE,void(t.data.onload=function(){t.data.onload=null,e()})}e()}else e()}var v={caching:u,parsing:L};exports.middleware=v;var R=100,x=/(#[\w-]+)?$/,w=function(){function r(t,i){var s=this;void 0===t&&(t=""),void 0===i&&(i=10),this.baseUrl=t,this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(t,e){return s._loadResource(t,e)},this._queue=o(this._boundLoadResource,i),this._queue.pause(),this.resources={},this.onProgress=new e.default,this.onError=new e.default,this.onLoad=new e.default,this.onStart=new e.default,this.onComplete=new e.default;for(var n=0;n<r._defaultBeforeMiddleware.length;++n)this.pre(r._defaultBeforeMiddleware[n]);for(var a=0;a<r._defaultAfterMiddleware.length;++a)this.use(r._defaultAfterMiddleware[a])}var i=r.prototype;return i.add=function(t,e,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;++s)this.add(t[s]);return this}if("object"==typeof t&&(i=e||t.callback||t.onComplete,r=t,e=t.url,t=t.name||t.key||t.url),"string"!=typeof e&&(i=r,r=e,e=t),"string"!=typeof e)throw new Error("No url passed to add resource to loader.");if("function"==typeof r&&(i=r,r=null),this.loading&&(!r||!r.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new m(t,e,r),"function"==typeof i&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var n=r.parentResource,o=[],a=0;a<n.children.length;++a)n.children[a].isComplete||o.push(n.children[a]);var h=n.progressChunk*(o.length+1)/(o.length+2);n.children.push(this.resources[t]),n.progressChunk=h;for(var u=0;u<o.length;++u)o[u].progressChunk=h;this.resources[t].progressChunk=h}return this._queue.push(this.resources[t]),this},i.pre=function(t){return this._beforeMiddleware.push(t),this},i.use=function(t){return this._afterMiddleware.push(t),this},i.reset=function(){for(var t in this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause(),this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort()}return this.resources={},this},i.load=function(t){if("function"==typeof t&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=this._queue._tasks.length,r=R/e,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=r;this._onStart(),this._queue.resume()}return this},i._prepareUrl=function(e){var r,i=(0,t.default)(e,{strictMode:!0});if(r=i.protocol||!i.path||0===e.indexOf("//")?e:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&"/"!==e.charAt(0)?this.baseUrl+"/"+e:this.baseUrl+e,this.defaultQueryString){var s=x.exec(r)[0];-1!==(r=r.substr(0,r.length-s.length)).indexOf("?")?r+="&"+this.defaultQueryString:r+="?"+this.defaultQueryString,r+=s}return r},i._loadResource=function(t,e){var r=this;t._dequeue=e,s(this._beforeMiddleware,function(e,i){e.call(r,t,function(){i(t.isComplete?{}:null)})},function(){t.isComplete?r._onLoad(t):(t._onLoadBinding=t.onComplete.once(r._onLoad,r),t.load())},!0)},i._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},i._onComplete=function(){this.progress=R,this.loading=!1,this.onComplete.dispatch(this,this.resources)},i._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),s(this._afterMiddleware,function(r,i){r.call(e,t,i)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(R,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&0===e._resourcesParsing.length&&e._onComplete()},!0)},l(r,[{key:"concurrency",get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t}}]),r}();exports.Loader=w,w._defaultBeforeMiddleware=[],w._defaultAfterMiddleware=[],w.pre=function(t){return w._defaultBeforeMiddleware.push(t),w},w.use=function(t){return w._defaultAfterMiddleware.push(t),w};
},{"parse-uri":"YnZR","mini-signals":"LmWK"}],"bw5V":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextureLoader=exports.LoaderResource=exports.Loader=exports.AppLoaderPlugin=void 0;var e=require("resource-loader"),r=require("@pixi/core"),t=e.Resource;exports.LoaderResource=t;var o=function(e,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function n(e,r){function t(){this.constructor=e}o(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var u=function(){function t(){}return t.use=function(t,o){t.data&&t.type===e.Resource.TYPE.IMAGE&&(t.texture=r.Texture.fromLoader(t.data,t.url,t.name)),o()},t}();exports.TextureLoader=u;var s=function(e){function r(t,o){for(var n=e.call(this,t,o)||this,u=0;u<r._plugins.length;++u){var s=r._plugins[u],i=s.pre,a=s.use;i&&n.pre(i),a&&n.use(a)}return n._protected=!1,n}return n(r,e),r.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(r,"shared",{get:function(){var e=r._shared;return e||((e=new r)._protected=!0,r._shared=e),e},enumerable:!1,configurable:!0}),r.registerPlugin=function(e){return r._plugins.push(e),e.add&&e.add(),r},r._plugins=[],r}(e.Loader);exports.Loader=s,s.registerPlugin({use:e.middleware.parsing}),s.registerPlugin(u);var i=function(){function e(){}return e.init=function(e){e=Object.assign({sharedLoader:!1},e),this.loader=e.sharedLoader?s.shared:new s},e.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},e}();exports.AppLoaderPlugin=i;
},{"resource-loader":"zWx3","@pixi/core":"lj2a"}],"in9j":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ParticleRenderer=exports.ParticleContainer=void 0;var t=require("@pixi/constants"),e=require("@pixi/display"),i=require("@pixi/utils"),r=require("@pixi/core"),o=require("@pixi/math"),a=function(t,e){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function n(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var s=function(e){function r(i,r,o,a){void 0===i&&(i=1500),void 0===o&&(o=16384),void 0===a&&(a=!1);var n=e.call(this)||this;return o>16384&&(o=16384),n._properties=[!1,!0,!1,!1,!1],n._maxSize=i,n._batchSize=o,n._buffers=null,n._bufferUpdateIDs=[],n._updateID=0,n.interactiveChildren=!1,n.blendMode=t.BLEND_MODES.NORMAL,n.autoResize=a,n.roundPixels=!0,n.baseTexture=null,n.setProperties(r),n._tint=0,n.tintRgb=new Float32Array(4),n.tint=16777215,n}return n(r,e),r.prototype.setProperties=function(t){t&&(this._properties[0]="vertices"in t||"scale"in t?!!t.vertices||!!t.scale:this._properties[0],this._properties[1]="position"in t?!!t.position:this._properties[1],this._properties[2]="rotation"in t?!!t.rotation:this._properties[2],this._properties[3]="uvs"in t?!!t.uvs:this._properties[3],this._properties[4]="tint"in t||"alpha"in t?!!t.tint||!!t.alpha:this._properties[4])},r.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},Object.defineProperty(r.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,(0,i.hex2rgb)(t,this.tintRgb)},enumerable:!1,configurable:!0}),r.prototype.render=function(t){var e=this;this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(this.baseTexture||(this.baseTexture=this.children[0]._texture.baseTexture,this.baseTexture.valid||this.baseTexture.once("update",function(){return e.onChildrenChange(0)})),t.batch.setObjectRenderer(t.plugins.particle),t.plugins.particle.render(this))},r.prototype.onChildrenChange=function(t){for(var e=Math.floor(t/this._batchSize);this._bufferUpdateIDs.length<e;)this._bufferUpdateIDs.push(0);this._bufferUpdateIDs[e]=++this._updateID},r.prototype.dispose=function(){if(this._buffers){for(var t=0;t<this._buffers.length;++t)this._buffers[t].destroy();this._buffers=null}},r.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.dispose(),this._properties=null,this._buffers=null,this._bufferUpdateIDs=null},r}(e.Container);exports.ParticleContainer=s;var u=function(){function e(e,i,o){this.geometry=new r.Geometry,this.indexBuffer=null,this.size=o,this.dynamicProperties=[],this.staticProperties=[];for(var a=0;a<e.length;++a){var n=e[a];n={attributeName:n.attributeName,size:n.size,uploadFunction:n.uploadFunction,type:n.type||t.TYPES.FLOAT,offset:n.offset},i[a]?this.dynamicProperties.push(n):this.staticProperties.push(n)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}return e.prototype.initBuffers=function(){var e=this.geometry,o=0;this.indexBuffer=new r.Buffer((0,i.createIndicesForQuads)(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(var a=0;a<this.dynamicProperties.length;++a){(p=this.dynamicProperties[a]).offset=o,o+=p.size,this.dynamicStride+=p.size}var n=new ArrayBuffer(this.size*this.dynamicStride*4*4);this.dynamicData=new Float32Array(n),this.dynamicDataUint32=new Uint32Array(n),this.dynamicBuffer=new r.Buffer(this.dynamicData,!1,!1);var s=0;this.staticStride=0;for(a=0;a<this.staticProperties.length;++a){(p=this.staticProperties[a]).offset=s,s+=p.size,this.staticStride+=p.size}var u=new ArrayBuffer(this.size*this.staticStride*4*4);this.staticData=new Float32Array(u),this.staticDataUint32=new Uint32Array(u),this.staticBuffer=new r.Buffer(this.staticData,!0,!1);for(a=0;a<this.dynamicProperties.length;++a){var p=this.dynamicProperties[a];e.addAttribute(p.attributeName,this.dynamicBuffer,0,p.type===t.TYPES.UNSIGNED_BYTE,p.type,4*this.dynamicStride,4*p.offset)}for(a=0;a<this.staticProperties.length;++a){p=this.staticProperties[a];e.addAttribute(p.attributeName,this.staticBuffer,0,p.type===t.TYPES.UNSIGNED_BYTE,p.type,4*this.staticStride,4*p.offset)}},e.prototype.uploadDynamic=function(e,i,r){for(var o=0;o<this.dynamicProperties.length;o++){var a=this.dynamicProperties[o];a.uploadFunction(e,i,r,a.type===t.TYPES.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,a.offset)}this.dynamicBuffer._updateID++},e.prototype.uploadStatic=function(e,i,r){for(var o=0;o<this.staticProperties.length;o++){var a=this.staticProperties[o];a.uploadFunction(e,i,r,a.type===t.TYPES.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,a.offset)}this.staticBuffer._updateID++},e.prototype.destroy=function(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()},e}(),p="varying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;\n    gl_FragColor = color;\n}",h="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nattribute vec2 aPositionCoord;\nattribute float aRotation;\n\nuniform mat3 translationMatrix;\nuniform vec4 uColor;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void){\n    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);\n    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);\n\n    vec2 v = vec2(x, y);\n    v = v + aPositionCoord;\n\n    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vColor = aColor * uColor;\n}\n",d=function(e){function a(i){var a=e.call(this,i)||this;return a.shader=null,a.properties=null,a.tempMatrix=new o.Matrix,a.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:a.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:a.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:a.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:a.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:t.TYPES.UNSIGNED_BYTE,uploadFunction:a.uploadTint,offset:0}],a.shader=r.Shader.from(h,p,{}),a.state=r.State.for2d(),a}return n(a,e),a.prototype.render=function(t){var e=t.children,r=t._maxSize,o=t._batchSize,a=this.renderer,n=e.length;if(0!==n){n>r&&!t.autoResize&&(n=r);var s=t._buffers;s||(s=t._buffers=this.generateBuffers(t));var u=e[0]._texture.baseTexture;this.state.blendMode=(0,i.correctBlendMode)(t.blendMode,u.alphaMode),a.state.set(this.state);var p=a.gl,h=t.worldTransform.copyTo(this.tempMatrix);h.prepend(a.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=h.toArray(!0),this.shader.uniforms.uColor=(0,i.premultiplyRgba)(t.tintRgb,t.worldAlpha,this.shader.uniforms.uColor,u.alphaMode),this.shader.uniforms.uSampler=u,this.renderer.shader.bind(this.shader);for(var d=!1,f=0,l=0;f<n;f+=o,l+=1){var c=n-f;c>o&&(c=o),l>=s.length&&s.push(this._generateOneMoreBuffer(t));var y=s[l];y.uploadDynamic(e,f,c);var v=t._bufferUpdateIDs[l]||0;(d=d||y._updateID<v)&&(y._updateID=t._updateID,y.uploadStatic(e,f,c)),a.geometry.bind(y.geometry),p.drawElements(p.TRIANGLES,6*c,p.UNSIGNED_SHORT,0)}}},a.prototype.generateBuffers=function(t){for(var e=[],i=t._maxSize,r=t._batchSize,o=t._properties,a=0;a<i;a+=r)e.push(new u(this.properties,o,r));return e},a.prototype._generateOneMoreBuffer=function(t){var e=t._batchSize,i=t._properties;return new u(this.properties,i,e)},a.prototype.uploadVertices=function(t,e,i,r,o,a){for(var n=0,s=0,u=0,p=0,h=0;h<i;++h){var d=t[e+h],f=d._texture,l=d.scale.x,c=d.scale.y,y=f.trim,v=f.orig;y?(n=(s=y.x-d.anchor.x*v.width)+y.width,u=(p=y.y-d.anchor.y*v.height)+y.height):(n=v.width*(1-d.anchor.x),s=v.width*-d.anchor.x,u=v.height*(1-d.anchor.y),p=v.height*-d.anchor.y),r[a]=s*l,r[a+1]=p*c,r[a+o]=n*l,r[a+o+1]=p*c,r[a+2*o]=n*l,r[a+2*o+1]=u*c,r[a+3*o]=s*l,r[a+3*o+1]=u*c,a+=4*o}},a.prototype.uploadPosition=function(t,e,i,r,o,a){for(var n=0;n<i;n++){var s=t[e+n].position;r[a]=s.x,r[a+1]=s.y,r[a+o]=s.x,r[a+o+1]=s.y,r[a+2*o]=s.x,r[a+2*o+1]=s.y,r[a+3*o]=s.x,r[a+3*o+1]=s.y,a+=4*o}},a.prototype.uploadRotation=function(t,e,i,r,o,a){for(var n=0;n<i;n++){var s=t[e+n].rotation;r[a]=s,r[a+o]=s,r[a+2*o]=s,r[a+3*o]=s,a+=4*o}},a.prototype.uploadUvs=function(t,e,i,r,o,a){for(var n=0;n<i;++n){var s=t[e+n]._texture._uvs;s?(r[a]=s.x0,r[a+1]=s.y0,r[a+o]=s.x1,r[a+o+1]=s.y1,r[a+2*o]=s.x2,r[a+2*o+1]=s.y2,r[a+3*o]=s.x3,r[a+3*o+1]=s.y3,a+=4*o):(r[a]=0,r[a+1]=0,r[a+o]=0,r[a+o+1]=0,r[a+2*o]=0,r[a+2*o+1]=0,r[a+3*o]=0,r[a+3*o+1]=0,a+=4*o)}},a.prototype.uploadTint=function(t,e,r,o,a,n){for(var s=0;s<r;++s){var u=t[e+s],p=u._texture.baseTexture.alphaMode>0,h=u.alpha,d=h<1&&p?(0,i.premultiplyTint)(u._tintRGB,h):u._tintRGB+(255*h<<24);o[n]=d,o[n+a]=d,o[n+2*a]=d,o[n+3*a]=d,n+=4*a}},a.prototype.destroy=function(){e.prototype.destroy.call(this),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null},a}(r.ObjectRenderer);exports.ParticleRenderer=d;
},{"@pixi/constants":"djkr","@pixi/display":"qvzw","@pixi/utils":"X4iF","@pixi/core":"lj2a","@pixi/math":"w9h1"}],"I0PC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.graphicsUtils=exports.LineStyle=exports.LINE_JOIN=exports.LINE_CAP=exports.GraphicsGeometry=exports.GraphicsData=exports.Graphics=exports.GRAPHICS_CURVES=exports.FillStyle=void 0;var t,e,i=require("@pixi/core"),r=require("@pixi/math"),s=require("@pixi/utils"),n=require("@pixi/constants"),a=require("@pixi/display");exports.LINE_JOIN=t,function(t){t.MITER="miter",t.BEVEL="bevel",t.ROUND="round"}(t||(exports.LINE_JOIN=t={})),exports.LINE_CAP=e,function(t){t.BUTT="butt",t.ROUND="round",t.SQUARE="square"}(e||(exports.LINE_CAP=e={}));var h={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(t,e){if(void 0===e&&(e=20),!this.adaptive||!t||isNaN(t))return e;var i=Math.ceil(t/this.maxLength);return i<this.minSegments?i=this.minSegments:i>this.maxSegments&&(i=this.maxSegments),i}};exports.GRAPHICS_CURVES=h;var o=function(){function t(){this.color=16777215,this.alpha=1,this.texture=i.Texture.WHITE,this.matrix=null,this.visible=!1,this.reset()}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e},t.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=i.Texture.WHITE,this.matrix=null,this.visible=!1},t.prototype.destroy=function(){this.texture=null,this.matrix=null},t}();exports.FillStyle=o;var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function u(t,e){function i(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var p={build:function(t){t.points=t.shape.points.slice()},triangulate:function(t,e){var i=t.points,r=t.holes,n=e.points,a=e.indices;if(i.length>=6){for(var h=[],o=0;o<r.length;o++){var l=r[o];h.push(i.length/2),i=i.concat(l.points)}var u=(0,s.earcut)(i,h,2);if(!u)return;var p=n.length/2;for(o=0;o<u.length;o+=3)a.push(u[o]+p),a.push(u[o+1]+p),a.push(u[o+2]+p);for(o=0;o<i.length;o++)n.push(i[o])}}},c={build:function(t){var e,i,s=t.shape,n=t.points,a=s.x,h=s.y;if(n.length=0,t.type===r.SHAPES.CIRC)e=s.radius,i=s.radius;else{var o=t.shape;e=o.width,i=o.height}if(0!==e&&0!==i){var l=Math.floor(30*Math.sqrt(s.radius))||Math.floor(15*Math.sqrt(e+i));l/=2.3;for(var u=2*Math.PI/l,p=0;p<l-.5;p++)n.push(a+Math.sin(-u*p)*e,h+Math.cos(-u*p)*i);n.push(n[0],n[1])}},triangulate:function(t,e){var i=t.points,r=e.points,s=e.indices,n=r.length/2,a=n,h=t.shape,o=t.matrix,l=h.x,u=h.y;r.push(t.matrix?o.a*l+o.c*u+o.tx:l,t.matrix?o.b*l+o.d*u+o.ty:u);for(var p=0;p<i.length;p+=2)r.push(i[p],i[p+1]),s.push(n++,a,n)}},d={build:function(t){var e=t.shape,i=e.x,r=e.y,s=e.width,n=e.height,a=t.points;a.length=0,a.push(i,r,i+s,r,i+s,r+n,i,r+n)},triangulate:function(t,e){var i=t.points,r=e.points,s=r.length/2;r.push(i[0],i[1],i[2],i[3],i[6],i[7],i[4],i[5]),e.indices.push(s,s+1,s+2,s+1,s+2,s+3)}};function f(t,e,i){return t+(e-t)*i}function y(t,e,i,r,s,n,a){void 0===a&&(a=[]);for(var h=a,o=0,l=0,u=0,p=0,c=0,d=0,y=0,v=0;y<=20;++y)o=f(t,i,v=y/20),l=f(e,r,v),u=f(i,s,v),p=f(r,n,v),c=f(o,u,v),d=f(l,p,v),h.push(c,d);return h}var v={build:function(t){var e=t.shape,i=t.points,r=e.x,s=e.y,n=e.width,a=e.height,h=Math.max(0,Math.min(e.radius,Math.min(n,a)/2));i.length=0,h?(y(r,s+h,r,s,r+h,s,i),y(r+n-h,s,r+n,s,r+n,s+h,i),y(r+n,s+a-h,r+n,s+a,r+n-h,s+a,i),y(r+h,s+a,r,s+a,r,s+a-h,i)):i.push(r,s,r+n,s,r+n,s+a,r,s+a)},triangulate:function(t,e){for(var i=t.points,r=e.points,n=e.indices,a=r.length/2,h=(0,s.earcut)(i,null,2),o=0,l=h.length;o<l;o+=3)n.push(h[o]+a),n.push(h[o+1]+a),n.push(h[o+2]+a);for(o=0,l=i.length;o<l;o++)r.push(i[o],i[++o])}};function g(t,e,i,r,s,n,a,h){var o,l;a?(o=r,l=-i):(o=-r,l=i);var u=t-i*s+o,p=e-r*s+l,c=t+i*n+o,d=e+r*n+l;return h.push(u,p),h.push(c,d),2}function b(t,e,i,r,s,n,a,h){var o=i-t,l=r-e,u=Math.atan2(o,l),p=Math.atan2(s-t,n-e);h&&u<p?u+=2*Math.PI:!h&&u>p&&(p+=2*Math.PI);var c=u,d=p-u,f=Math.abs(d),y=Math.sqrt(o*o+l*l),v=1+(15*f*Math.sqrt(y)/Math.PI>>0),g=d/v;if(c+=g,h){a.push(t,e),a.push(i,r);for(var b=1,x=c;b<v;b++,x+=g)a.push(t,e),a.push(t+Math.sin(x)*y,e+Math.cos(x)*y);a.push(t,e),a.push(s,n)}else{a.push(i,r),a.push(t,e);for(b=1,x=c;b<v;b++,x+=g)a.push(t+Math.sin(x)*y,e+Math.cos(x)*y),a.push(t,e);a.push(s,n),a.push(t,e)}return 2*v}function x(i,s){var n=i.shape,a=i.points||n.points.slice(),o=s.closePointEps;if(0!==a.length){var l=i.lineStyle,u=new r.Point(a[0],a[1]),p=new r.Point(a[a.length-2],a[a.length-1]),c=n.type!==r.SHAPES.POLY||n.closeStroke,d=Math.abs(u.x-p.x)<o&&Math.abs(u.y-p.y)<o;if(c){a=a.slice(),d&&(a.pop(),a.pop(),p.set(a[a.length-2],a[a.length-1]));var f=.5*(u.x+p.x),y=.5*(p.y+u.y);a.unshift(f,y),a.push(f,y)}var v=s.points,x=a.length/2,m=a.length,_=v.length/2,S=l.width/2,P=S*S,w=l.miterLimit*l.miterLimit,M=a[0],T=a[1],D=a[2],E=a[3],A=0,I=0,C=-(T-E),R=M-D,B=0,L=0,O=Math.sqrt(C*C+R*R);C/=O,R/=O,C*=S,R*=S;var U=l.alignment,N=2*(1-U),H=2*U;c||(l.cap===e.ROUND?m+=b(M-C*(N-H)*.5,T-R*(N-H)*.5,M-C*N,T-R*N,M+C*H,T+R*H,v,!0)+2:l.cap===e.SQUARE&&(m+=g(M,T,C,R,N,H,!0,v))),v.push(M-C*N,T-R*N),v.push(M+C*H,T+R*H);for(var j=1;j<x-1;++j){M=a[2*(j-1)],T=a[2*(j-1)+1],D=a[2*j],E=a[2*j+1],A=a[2*(j+1)],I=a[2*(j+1)+1],C=-(T-E),R=M-D,C/=O=Math.sqrt(C*C+R*R),R/=O,C*=S,R*=S,B=-(E-I),L=D-A,B/=O=Math.sqrt(B*B+L*L),L/=O,B*=S,L*=S;var F=D-M,q=T-E,G=D-A,z=I-E,k=q*G-z*F,W=k<0;if(Math.abs(k)<.1)v.push(D-C*N,E-R*N),v.push(D+C*H,E+R*H);else{var V=(-C+M)*(-R+E)-(-C+D)*(-R+T),Y=(-B+A)*(-L+E)-(-B+D)*(-L+I),Q=(F*Y-G*V)/k,X=(z*V-q*Y)/k,J=(Q-D)*(Q-D)+(X-E)*(X-E),Z=D+(Q-D)*N,K=E+(X-E)*N,$=D-(Q-D)*H,tt=E-(X-E)*H,et=W?N:H;J<=Math.min(F*F+q*q,G*G+z*z)+et*et*P?l.join===t.BEVEL||J/P>w?(W?(v.push(Z,K),v.push(D+C*H,E+R*H),v.push(Z,K),v.push(D+B*H,E+L*H)):(v.push(D-C*N,E-R*N),v.push($,tt),v.push(D-B*N,E-L*N),v.push($,tt)),m+=2):l.join===t.ROUND?W?(v.push(Z,K),v.push(D+C*H,E+R*H),m+=b(D,E,D+C*H,E+R*H,D+B*H,E+L*H,v,!0)+4,v.push(Z,K),v.push(D+B*H,E+L*H)):(v.push(D-C*N,E-R*N),v.push($,tt),m+=b(D,E,D-C*N,E-R*N,D-B*N,E-L*N,v,!1)+4,v.push(D-B*N,E-L*N),v.push($,tt)):(v.push(Z,K),v.push($,tt)):(v.push(D-C*N,E-R*N),v.push(D+C*H,E+R*H),l.join===t.BEVEL||J/P>w||(l.join===t.ROUND?m+=W?b(D,E,D+C*H,E+R*H,D+B*H,E+L*H,v,!0)+2:b(D,E,D-C*N,E-R*N,D-B*N,E-L*N,v,!1)+2:(W?(v.push($,tt),v.push($,tt)):(v.push(Z,K),v.push(Z,K)),m+=2)),v.push(D-B*N,E-L*N),v.push(D+B*H,E+L*H),m+=2)}}M=a[2*(x-2)],T=a[2*(x-2)+1],D=a[2*(x-1)],C=-(T-(E=a[2*(x-1)+1])),R=M-D,C/=O=Math.sqrt(C*C+R*R),R/=O,C*=S,R*=S,v.push(D-C*N,E-R*N),v.push(D+C*H,E+R*H),c||(l.cap===e.ROUND?m+=b(D-C*(N-H)*.5,E-R*(N-H)*.5,D-C*N,E-R*N,D+C*H,E+R*H,v,!1)+2:l.cap===e.SQUARE&&(m+=g(D,E,C,R,N,H,!1,v)));var it=s.indices,rt=h.epsilon*h.epsilon;for(j=_;j<m+_-2;++j)M=v[2*j],T=v[2*j+1],D=v[2*(j+1)],E=v[2*(j+1)+1],A=v[2*(j+2)],I=v[2*(j+2)+1],Math.abs(M*(E-I)+D*(I-T)+A*(T-E))<rt||it.push(j,j+1,j+2)}}function m(t,e){var i=0,s=t.shape,n=t.points||s.points,a=s.type!==r.SHAPES.POLY||s.closeStroke;if(0!==n.length){var h=e.points,o=e.indices,l=n.length/2,u=h.length/2,p=u;for(h.push(n[0],n[1]),i=1;i<l;i++)h.push(n[2*i],n[2*i+1]),o.push(p,p+1),p++;a&&o.push(p,u)}}function _(t,e){t.lineStyle.native?m(t,e):x(t,e)}var S,P=function(t){function e(e,i,s,n,a,h){void 0===h&&(h=0);a=a||n/2;for(var o=-1*Math.PI/2+h,l=2*s,u=r.PI_2/l,p=[],c=0;c<l;c++){var d=c%2?a:n,f=c*u+o;p.push(e+d*Math.cos(f),i+d*Math.sin(f))}return t.call(this,p)||this}return u(e,t),e}(r.Polygon),w=function(){function t(){}return t.curveTo=function(t,e,i,r,s,n){var a=n[n.length-2],h=n[n.length-1]-e,o=a-t,l=r-e,u=i-t,p=Math.abs(h*u-o*l);if(p<1e-8||0===s)return n[n.length-2]===t&&n[n.length-1]===e||n.push(t,e),null;var c=h*h+o*o,d=l*l+u*u,f=h*l+o*u,y=s*Math.sqrt(c)/p,v=s*Math.sqrt(d)/p,g=y*f/c,b=v*f/d,x=y*u+v*o,m=y*l+v*h,_=o*(v+g),S=h*(v+g),P=u*(y+b),w=l*(y+b);return{cx:x+t,cy:m+e,radius:s,startAngle:Math.atan2(S-m,_-x),endAngle:Math.atan2(w-m,P-x),anticlockwise:o*l>u*h}},t.arc=function(t,e,i,s,n,a,o,l,u){for(var p=o-a,c=h._segmentsCount(Math.abs(p)*n,40*Math.ceil(Math.abs(p)/r.PI_2)),d=p/(2*c),f=2*d,y=Math.cos(d),v=Math.sin(d),g=c-1,b=g%1/g,x=0;x<=g;++x){var m=d+a+f*(x+b*x),_=Math.cos(m),S=-Math.sin(m);u.push((y*_+v*S)*n+i,(y*-S+v*_)*n+s)}},t}(),M=function(){function t(){}return t.curveLength=function(t,e,i,r,s,n,a,h){for(var o=0,l=0,u=0,p=0,c=0,d=0,f=0,y=0,v=0,g=0,b=0,x=t,m=e,_=1;_<=10;++_)g=x-(y=(f=(d=(c=1-(l=_/10))*c)*c)*t+3*d*l*i+3*c*(u=l*l)*s+(p=u*l)*a),b=m-(v=f*e+3*d*l*r+3*c*u*n+p*h),x=y,m=v,o+=Math.sqrt(g*g+b*b);return o},t.curveTo=function(e,i,r,s,n,a,o){var l=o[o.length-2],u=o[o.length-1];o.length-=2;var p=h._segmentsCount(t.curveLength(l,u,e,i,r,s,n,a)),c=0,d=0,f=0,y=0,v=0;o.push(l,u);for(var g=1,b=0;g<=p;++g)f=(d=(c=1-(b=g/p))*c)*c,v=(y=b*b)*b,o.push(f*l+3*d*b*e+3*c*y*r+v*n,f*u+3*d*b*i+3*c*y*s+v*a)},t}(),T=function(){function t(){}return t.curveLength=function(t,e,i,r,s,n){var a=t-2*i+s,h=e-2*r+n,o=2*i-2*t,l=2*r-2*e,u=4*(a*a+h*h),p=4*(a*o+h*l),c=o*o+l*l,d=2*Math.sqrt(u+p+c),f=Math.sqrt(u),y=2*u*f,v=2*Math.sqrt(c),g=p/f;return(y*d+f*p*(d-v)+(4*c*u-p*p)*Math.log((2*f+g+d)/(g+v)))/(4*y)},t.curveTo=function(e,i,r,s,n){for(var a=n[n.length-2],o=n[n.length-1],l=h._segmentsCount(t.curveLength(a,o,e,i,r,s)),u=0,p=0,c=1;c<=l;++c){var d=c/l;u=a+(e-a)*d,p=o+(i-o)*d,n.push(u+(e+(r-e)*d-u)*d,p+(i+(s-i)*d-p)*d)}},t}(),D=function(){function t(){this.reset()}return t.prototype.begin=function(t,e,i){this.reset(),this.style=t,this.start=e,this.attribStart=i},t.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},t.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},t}(),E=((S={})[r.SHAPES.POLY]=p,S[r.SHAPES.CIRC]=c,S[r.SHAPES.ELIP]=c,S[r.SHAPES.RECT]=d,S[r.SHAPES.RREC]=v,S),A=[],I=[],C={buildPoly:p,buildCircle:c,buildRectangle:d,buildRoundedRectangle:v,FILL_COMMANDS:E,BATCH_POOL:A,DRAW_CALL_POOL:I,buildLine:_,Star:P,ArcUtils:w,BezierUtils:M,QuadraticUtils:T,BatchPart:D};exports.graphicsUtils=C;var R=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null),this.shape=t,this.lineStyle=i,this.fillStyle=e,this.matrix=r,this.type=t.type,this.points=[],this.holes=[]}return t.prototype.clone=function(){return new t(this.shape,this.fillStyle,this.lineStyle,this.matrix)},t.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},t}();exports.GraphicsData=R;var B=new r.Point,L=new a.Bounds,O=function(t){function e(){var e=t.call(this)||this;return e.uvsFloat32=null,e.indicesUint16=null,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.dirty=0,e.batchDirty=-1,e.cacheDirty=-1,e.clearDirty=0,e.drawCalls=[],e.batches=[],e.shapeIndex=0,e._bounds=new a.Bounds,e.boundsDirty=-1,e.boundsPadding=0,e.batchable=!1,e.indicesUint16=null,e.uvsFloat32=null,e.closePointEps=1e-4,e}return u(e,t),Object.defineProperty(e.prototype,"bounds",{get:function(){return this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),e.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var t=0;t<this.drawCalls.length;t++)this.drawCalls[t].texArray.clear(),I.push(this.drawCalls[t]);this.drawCalls.length=0;for(t=0;t<this.batches.length;t++){var e=this.batches[t];e.reset(),A.push(e)}this.batches.length=0},e.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},e.prototype.drawShape=function(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=null),void 0===r&&(r=null);var s=new R(t,e,i,r);return this.graphicsData.push(s),this.dirty++,this},e.prototype.drawHole=function(t,e){if(void 0===e&&(e=null),!this.graphicsData.length)return null;var i=new R(t,null,null,e),r=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=r.lineStyle,r.holes.push(i),this.dirty++,this},e.prototype.destroy=function(){t.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},e.prototype.containsPoint=function(t){for(var e=this.graphicsData,i=0;i<e.length;++i){var r=e[i];if(r.fillStyle.visible&&(r.shape&&(r.matrix?r.matrix.applyInverse(t,B):B.copyFrom(t),r.shape.contains(B.x,B.y)))){var s=!1;if(r.holes)for(var n=0;n<r.holes.length;n++){if(r.holes[n].shape.contains(B.x,B.y)){s=!0;break}}if(!s)return!0}}return!1},e.prototype.updateBatches=function(t){if(this.graphicsData.length){if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,i=this.graphicsData,r=null,s=null;this.batches.length>0&&(s=(r=this.batches[this.batches.length-1]).style);for(var a=this.shapeIndex;a<i.length;a++){this.shapeIndex++;var h=i[a],o=h.fillStyle,l=h.lineStyle;E[h.type].build(h),h.matrix&&this.transformPoints(h.points,h.matrix);for(var u=0;u<2;u++){var p=0===u?o:l;if(p.visible){var c=p.texture.baseTexture,d=this.indices.length,f=this.points.length/2;c.wrapMode=n.WRAP_MODES.REPEAT,0===u?this.processFill(h):this.processLine(h);var y=this.points.length/2-f;0!==y&&(r&&!this._compareStyles(s,p)&&(r.end(d,f),r=null),r||((r=A.pop()||new D).begin(p,d,f),this.batches.push(r),s=p),this.addUvs(this.points,e,p.texture,f,y,p.matrix))}}}var v=this.indices.length,g=this.points.length/2;if(r&&r.end(v,g),0!==this.batches.length){if(this.indicesUint16&&this.indices.length===this.indicesUint16.length)this.indicesUint16.set(this.indices);else{var b=g>65535&&t;this.indicesUint16=b?new Uint32Array(this.indices):new Uint16Array(this.indices)}this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}else this.batchable=!0}}else this.batchable=!0},e.prototype._compareStyles=function(t,e){return!(!t||!e)&&(t.texture.baseTexture===e.texture.baseTexture&&(t.color+t.alpha===e.color+e.alpha&&!!t.native==!!e.native))},e.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var t=0,e=this.graphicsData.length;t<e;t++){var i=this.graphicsData[t],r=i.fillStyle,s=i.lineStyle;if(r&&!r.texture.baseTexture.valid)return!1;if(s&&!s.texture.baseTexture.valid)return!1}return!0},e.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var t=this.batches,e=0,i=t.length;e<i;e++)for(var r=t[e],s=0;s<r.size;s++){var n=r.start+s;this.indicesUint16[n]=this.indicesUint16[n]-r.attribStart}},e.prototype.isBatchable=function(){if(this.points.length>131070)return!1;for(var t=this.batches,i=0;i<t.length;i++)if(t[i].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE},e.prototype.buildDrawCalls=function(){for(var t=++i.BaseTexture._globalBatch,e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),I.push(this.drawCalls[e]);this.drawCalls.length=0;var r=this.colors,s=this.textureIds,a=I.pop();a||((a=new i.BatchDrawCall).texArray=new i.BatchTextureArray),a.texArray.count=0,a.start=0,a.size=0,a.type=n.DRAW_MODES.TRIANGLES;var h=0,o=null,l=0,u=!1,p=n.DRAW_MODES.TRIANGLES,c=0;this.drawCalls.push(a);for(e=0;e<this.batches.length;e++){var d=this.batches[e],f=d.style,y=f.texture.baseTexture;u!==!!f.native&&(p=(u=!!f.native)?n.DRAW_MODES.LINES:n.DRAW_MODES.TRIANGLES,o=null,h=8,t++),o!==y&&(o=y,y._batchEnabled!==t&&(8===h&&(t++,h=0,a.size>0&&((a=I.pop())||((a=new i.BatchDrawCall).texArray=new i.BatchTextureArray),this.drawCalls.push(a)),a.start=c,a.size=0,a.texArray.count=0,a.type=p),y.touched=1,y._batchEnabled=t,y._batchLocation=h,y.wrapMode=10497,a.texArray.elements[a.texArray.count++]=y,h++)),a.size+=d.size,c+=d.size,l=y._batchLocation,this.addColors(r,f.color,f.alpha,d.attribSize),this.addTextureIds(s,l,d.attribSize)}i.BaseTexture._globalBatch=t,this.packAttributes()},e.prototype.packAttributes=function(){for(var t=this.points,e=this.uvs,i=this.colors,r=this.textureIds,s=new ArrayBuffer(3*t.length*4),n=new Float32Array(s),a=new Uint32Array(s),h=0,o=0;o<t.length/2;o++)n[h++]=t[2*o],n[h++]=t[2*o+1],n[h++]=e[2*o],n[h++]=e[2*o+1],a[h++]=i[o],n[h++]=r[o];this._buffer.update(s),this._indexBuffer.update(this.indicesUint16)},e.prototype.processFill=function(t){t.holes.length?(this.processHoles(t.holes),p.triangulate(t,this)):E[t.type].triangulate(t,this)},e.prototype.processLine=function(t){_(t,this);for(var e=0;e<t.holes.length;e++)_(t.holes[e],this)},e.prototype.processHoles=function(t){for(var e=0;e<t.length;e++){var i=t[e];E[i.type].build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},e.prototype.calculateBounds=function(){var t=this._bounds,e=L,i=r.Matrix.IDENTITY;this._bounds.clear(),e.clear();for(var s=0;s<this.graphicsData.length;s++){var n=this.graphicsData[s],a=n.shape,h=n.type,o=n.lineStyle,l=n.matrix||r.Matrix.IDENTITY,u=0;if(o&&o.visible){var p=o.alignment;u=o.width,h===r.SHAPES.POLY?u*=.5+Math.abs(.5-p):u*=Math.max(0,p)}if(i!==l&&(e.isEmpty()||(t.addBoundsMatrix(e,i),e.clear()),i=l),h===r.SHAPES.RECT||h===r.SHAPES.RREC){var c=a;e.addFramePad(c.x,c.y,c.x+c.width,c.y+c.height,u,u)}else if(h===r.SHAPES.CIRC){var d=a;e.addFramePad(d.x,d.y,d.x,d.y,d.radius+u,d.radius+u)}else if(h===r.SHAPES.ELIP){var f=a;e.addFramePad(f.x,f.y,f.x,f.y,f.width+u,f.height+u)}else{var y=a;t.addVerticesMatrix(i,y.points,0,y.points.length,u,u)}}e.isEmpty()||t.addBoundsMatrix(e,i),t.pad(this.boundsPadding,this.boundsPadding)},e.prototype.transformPoints=function(t,e){for(var i=0;i<t.length/2;i++){var r=t[2*i],s=t[2*i+1];t[2*i]=e.a*r+e.c*s+e.tx,t[2*i+1]=e.b*r+e.d*s+e.ty}},e.prototype.addColors=function(t,e,i,r){for(var n=(e>>16)+(65280&e)+((255&e)<<16),a=(0,s.premultiplyTint)(n,i);r-- >0;)t.push(a)},e.prototype.addTextureIds=function(t,e,i){for(;i-- >0;)t.push(e)},e.prototype.addUvs=function(t,e,i,r,s,n){void 0===n&&(n=null);for(var a=0,h=e.length,o=i.frame;a<s;){var l=t[2*(r+a)],u=t[2*(r+a)+1];if(n){var p=n.a*l+n.c*u+n.tx;u=n.b*l+n.d*u+n.ty,l=p}a++,e.push(l/o.width,u/o.height)}var c=i.baseTexture;(o.width<c.width||o.height<c.height)&&this.adjustUvs(e,i,h,s)},e.prototype.adjustUvs=function(t,e,i,r){for(var s=e.baseTexture,n=i+2*r,a=e.frame,h=a.width/s.width,o=a.height/s.height,l=a.x/a.width,u=a.y/a.height,p=Math.floor(t[i]+1e-6),c=Math.floor(t[i+1]+1e-6),d=i+2;d<n;d+=2)p=Math.min(p,Math.floor(t[d]+1e-6)),c=Math.min(c,Math.floor(t[d+1]+1e-6));l-=p,u-=c;for(d=i;d<n;d+=2)t[d]=(t[d]+l)*h,t[d+1]=(t[d+1]+u)*o},e.BATCHABLE_SIZE=100,e}(i.BatchGeometry);exports.GraphicsGeometry=O;var U=function(i){function r(){var r=null!==i&&i.apply(this,arguments)||this;return r.width=0,r.alignment=.5,r.native=!1,r.cap=e.BUTT,r.join=t.MITER,r.miterLimit=10,r}return u(r,i),r.prototype.clone=function(){var t=new r;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t.width=this.width,t.alignment=this.alignment,t.native=this.native,t.cap=this.cap,t.join=this.join,t.miterLimit=this.miterLimit,t},r.prototype.reset=function(){i.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},r}(o);exports.LineStyle=U;var N=new Float32Array(3),H={},j=function(a){function h(t){void 0===t&&(t=null);var e=a.call(this)||this;return e._geometry=t||new O,e._geometry.refCount++,e.shader=null,e.state=i.State.for2d(),e._fillStyle=new o,e._lineStyle=new U,e._matrix=null,e._holeMode=!1,e.currentPath=null,e.batches=[],e.batchTint=-1,e.batchDirty=-1,e.vertexData=null,e.pluginName="batch",e._transformID=-1,e.tint=16777215,e.blendMode=n.BLEND_MODES.NORMAL,e}return u(h,a),Object.defineProperty(h.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),h.prototype.clone=function(){return this.finishPoly(),new h(this._geometry)},Object.defineProperty(h.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),h.prototype.lineStyle=function(t){if(void 0===t&&(t=null),"number"==typeof t){var e=arguments;t={width:e[0]||0,color:e[1]||0,alpha:void 0!==e[2]?e[2]:1,alignment:void 0!==e[3]?e[3]:.5,native:!!e[4]}}return this.lineTextureStyle(t)},h.prototype.lineTextureStyle=function(r){if("number"==typeof r){(0,s.deprecation)("v5.2.0","Please use object-based options for Graphics#lineTextureStyle");var n=arguments,a=n[0],h=n[1],o=n[2],l=n[3],u=n[4],p=n[5],c=n[6];r={width:a,texture:h,color:o,alpha:l,matrix:u,alignment:p,native:c},Object.keys(r).forEach(function(t){return void 0===r[t]&&delete r[t]})}r=Object.assign({width:0,texture:i.Texture.WHITE,color:r&&r.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:e.BUTT,join:t.MITER,miterLimit:10},r),this.currentPath&&this.startPoly();var d=r.width>0&&r.alpha>0;return d?(r.matrix&&(r.matrix=r.matrix.clone(),r.matrix.invert()),Object.assign(this._lineStyle,{visible:d},r)):this._lineStyle.reset(),this},h.prototype.startPoly=function(){if(this.currentPath){var t=this.currentPath.points,e=this.currentPath.points.length;e>2&&(this.drawShape(this.currentPath),this.currentPath=new r.Polygon,this.currentPath.closeStroke=!1,this.currentPath.points.push(t[e-2],t[e-1]))}else this.currentPath=new r.Polygon,this.currentPath.closeStroke=!1},h.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},h.prototype.moveTo=function(t,e){return this.startPoly(),this.currentPath.points[0]=t,this.currentPath.points[1]=e,this},h.prototype.lineTo=function(t,e){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,r=i[i.length-2],s=i[i.length-1];return r===t&&s===e||i.push(t,e),this},h.prototype._initCurve=function(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[t,e]):this.moveTo(t,e)},h.prototype.quadraticCurveTo=function(t,e,i,r){this._initCurve();var s=this.currentPath.points;return 0===s.length&&this.moveTo(0,0),T.curveTo(t,e,i,r,s),this},h.prototype.bezierCurveTo=function(t,e,i,r,s,n){return this._initCurve(),M.curveTo(t,e,i,r,s,n,this.currentPath.points),this},h.prototype.arcTo=function(t,e,i,r,s){this._initCurve(t,e);var n=this.currentPath.points,a=w.curveTo(t,e,i,r,s,n);if(a){var h=a.cx,o=a.cy,l=a.radius,u=a.startAngle,p=a.endAngle,c=a.anticlockwise;this.arc(h,o,l,u,p,c)}return this},h.prototype.arc=function(t,e,i,s,n,a){if(void 0===a&&(a=!1),s===n)return this;if(!a&&n<=s?n+=r.PI_2:a&&s<=n&&(s+=r.PI_2),0===n-s)return this;var h=t+Math.cos(s)*i,o=e+Math.sin(s)*i,l=this._geometry.closePointEps,u=this.currentPath?this.currentPath.points:null;if(u){var p=Math.abs(u[u.length-2]-h),c=Math.abs(u[u.length-1]-o);p<l&&c<l||u.push(h,o)}else this.moveTo(h,o),u=this.currentPath.points;return w.arc(h,o,t,e,i,s,n,a,u),this},h.prototype.beginFill=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=1),this.beginTextureFill({texture:i.Texture.WHITE,color:t,alpha:e})},h.prototype.beginTextureFill=function(t){if(t instanceof i.Texture){(0,s.deprecation)("v5.2.0","Please use object-based options for Graphics#beginTextureFill");var e=arguments,r=e[0],n=e[1],a=e[2],h=e[3];t={texture:r,color:n,alpha:a,matrix:h},Object.keys(t).forEach(function(e){return void 0===t[e]&&delete t[e]})}t=Object.assign({texture:i.Texture.WHITE,color:16777215,alpha:1,matrix:null},t),this.currentPath&&this.startPoly();var o=t.alpha>0;return o?(t.matrix&&(t.matrix=t.matrix.clone(),t.matrix.invert()),Object.assign(this._fillStyle,{visible:o},t)):this._fillStyle.reset(),this},h.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},h.prototype.drawRect=function(t,e,i,s){return this.drawShape(new r.Rectangle(t,e,i,s))},h.prototype.drawRoundedRect=function(t,e,i,s,n){return this.drawShape(new r.RoundedRectangle(t,e,i,s,n))},h.prototype.drawCircle=function(t,e,i){return this.drawShape(new r.Circle(t,e,i))},h.prototype.drawEllipse=function(t,e,i,s){return this.drawShape(new r.Ellipse(t,e,i,s))},h.prototype.drawPolygon=function(){for(var t,e=arguments,i=[],s=0;s<arguments.length;s++)i[s]=e[s];var n=!0,a=i[0];a.points?(n=a.closeStroke,t=a.points):t=Array.isArray(i[0])?i[0]:i;var h=new r.Polygon(t);return h.closeStroke=n,this.drawShape(h),this},h.prototype.drawShape=function(t){return this._holeMode?this._geometry.drawHole(t,this._matrix):this._geometry.drawShape(t,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},h.prototype.drawStar=function(t,e,i,r,s,n){return void 0===n&&(n=0),this.drawPolygon(new P(t,e,i,r,s,n))},h.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},h.prototype.isFastRect=function(){var t=this._geometry.graphicsData;return 1===t.length&&t[0].shape.type===r.SHAPES.RECT&&!(t[0].lineStyle.visible&&t[0].lineStyle.width)},h.prototype._render=function(t){this.finishPoly();var e=this._geometry,i=t.context.supports.uint32Indices;e.updateBatches(i),e.batchable?(this.batchDirty!==e.batchDirty&&this._populateBatches(),this._renderBatched(t)):(t.batch.flush(),this._renderDirect(t))},h.prototype._populateBatches=function(){var t=this._geometry,e=this.blendMode,i=t.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=t.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(t.points);for(var r=0;r<i;r++){var n=t.batches[r],a=n.style.color,h=new Float32Array(this.vertexData.buffer,4*n.attribStart*2,2*n.attribSize),o=new Float32Array(t.uvsFloat32.buffer,4*n.attribStart*2,2*n.attribSize),l={vertexData:h,blendMode:e,indices:new Uint16Array(t.indicesUint16.buffer,2*n.start,n.size),uvs:o,_batchRGB:(0,s.hex2rgb)(a),_tintRGB:a,_texture:n.style.texture,alpha:n.style.alpha,worldAlpha:1};this.batches[r]=l}},h.prototype._renderBatched=function(t){if(this.batches.length){t.batch.setObjectRenderer(t.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var e=0,i=this.batches.length;e<i;e++){var r=this.batches[e];r.worldAlpha=this.worldAlpha*r.alpha,t.plugins[this.pluginName].render(r)}}},h.prototype._renderDirect=function(t){var e=this._resolveDirectShader(t),i=this._geometry,r=this.tint,s=this.worldAlpha,n=e.uniforms,a=i.drawCalls;n.translationMatrix=this.transform.worldTransform,n.tint[0]=(r>>16&255)/255*s,n.tint[1]=(r>>8&255)/255*s,n.tint[2]=(255&r)/255*s,n.tint[3]=s,t.shader.bind(e),t.geometry.bind(i,e),t.state.set(this.state);for(var h=0,o=a.length;h<o;h++)this._renderDrawCallDirect(t,i.drawCalls[h])},h.prototype._renderDrawCallDirect=function(t,e){for(var i=e.texArray,r=e.type,s=e.size,n=e.start,a=i.count,h=0;h<a;h++)t.texture.bind(i.elements[h],h);t.geometry.draw(r,s,n)},h.prototype._resolveDirectShader=function(t){var e=this.shader,s=this.pluginName;if(!e){if(!H[s]){for(var n=t.plugins.batch.MAX_TEXTURES,a=new Int32Array(n),h=0;h<n;h++)a[h]=h;var o={tint:new Float32Array([1,1,1,1]),translationMatrix:new r.Matrix,default:i.UniformGroup.from({uSamplers:a},!0)},l=t.plugins[s]._shader.program;H[s]=new i.Shader(l,o)}e=H[s]}return e},h.prototype._calculateBounds=function(){this.finishPoly();var t=this._geometry;if(t.graphicsData.length){var e=t.bounds,i=e.minX,r=e.minY,s=e.maxX,n=e.maxY;this._bounds.addFrame(this.transform,i,r,s,n)}},h.prototype.containsPoint=function(t){return this.worldTransform.applyInverse(t,h._TEMP_POINT),this._geometry.containsPoint(h._TEMP_POINT)},h.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var t=(0,s.hex2rgb)(this.tint,N),e=0;e<this.batches.length;e++){var i=this.batches[e],r=i._batchRGB,n=(t[0]*r[0]*255<<16)+(t[1]*r[1]*255<<8)+(0|t[2]*r[2]*255);i._tintRGB=(n>>16)+(65280&n)+((255&n)<<16)}}},h.prototype.calculateVertices=function(){var t=this.transform._worldID;if(this._transformID!==t){this._transformID=t;for(var e=this.transform.worldTransform,i=e.a,r=e.b,s=e.c,n=e.d,a=e.tx,h=e.ty,o=this._geometry.points,l=this.vertexData,u=0,p=0;p<o.length;p+=2){var c=o[p],d=o[p+1];l[u++]=i*c+s*d+a,l[u++]=n*d+r*c+h}}},h.prototype.closePath=function(){var t=this.currentPath;return t&&(t.closeStroke=!0),this},h.prototype.setMatrix=function(t){return this._matrix=t,this},h.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},h.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},h.prototype.destroy=function(t){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,a.prototype.destroy.call(this,t)},h._TEMP_POINT=new r.Point,h}(a.Container);exports.Graphics=j;
},{"@pixi/core":"lj2a","@pixi/math":"w9h1","@pixi/utils":"X4iF","@pixi/constants":"djkr","@pixi/display":"qvzw"}],"XG9w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sprite=void 0;var t=require("@pixi/constants"),e=require("@pixi/core"),i=require("@pixi/display"),r=require("@pixi/math"),s=require("@pixi/settings"),n=require("@pixi/utils"),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function h(t,e){function i(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var u=new r.Point,a=new Uint16Array([0,1,2,0,2,3]),_=function(i){function o(n){var o=i.call(this)||this;return o._anchor=new r.ObservablePoint(o._onAnchorUpdate,o,n?n.defaultAnchor.x:0,n?n.defaultAnchor.y:0),o._texture=null,o._width=0,o._height=0,o._tint=null,o._tintRGB=null,o.tint=16777215,o.blendMode=t.BLEND_MODES.NORMAL,o._cachedTint=16777215,o.uvs=null,o.texture=n||e.Texture.EMPTY,o.vertexData=new Float32Array(8),o.vertexTrimmedData=null,o._transformID=-1,o._textureID=-1,o._transformTrimmedID=-1,o._textureTrimmedID=-1,o.indices=a,o.pluginName="batch",o.isSprite=!0,o._roundPixels=s.settings.ROUND_PIXELS,o}return h(o,i),o.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=(0,n.sign)(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=(0,n.sign)(this.scale.y)*this._height/this._texture.orig.height)},o.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},o.prototype.calculateVertices=function(){var t=this._texture;if(this._transformID!==this.transform._worldID||this._textureID!==t._updateID){this._textureID!==t._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=t._updateID;var e=this.transform.worldTransform,i=e.a,r=e.b,n=e.c,o=e.d,h=e.tx,u=e.ty,a=this.vertexData,_=t.trim,c=t.orig,d=this._anchor,l=0,x=0,p=0,f=0;if(_?(l=(x=_.x-d._x*c.width)+_.width,p=(f=_.y-d._y*c.height)+_.height):(l=(x=-d._x*c.width)+c.width,p=(f=-d._y*c.height)+c.height),a[0]=i*x+n*f+h,a[1]=o*f+r*x+u,a[2]=i*l+n*f+h,a[3]=o*f+r*l+u,a[4]=i*l+n*p+h,a[5]=o*p+r*l+u,a[6]=i*x+n*p+h,a[7]=o*p+r*x+u,this._roundPixels)for(var m=s.settings.RESOLUTION,g=0;g<a.length;++g)a[g]=Math.round((a[g]*m|0)/m)}},o.prototype.calculateTrimmedVertices=function(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var t=this._texture,e=this.vertexTrimmedData,i=t.orig,r=this._anchor,s=this.transform.worldTransform,n=s.a,o=s.b,h=s.c,u=s.d,a=s.tx,_=s.ty,c=-r._x*i.width,d=c+i.width,l=-r._y*i.height,x=l+i.height;e[0]=n*c+h*l+a,e[1]=u*l+o*c+_,e[2]=n*d+h*l+a,e[3]=u*l+o*d+_,e[4]=n*d+h*x+a,e[5]=u*x+o*d+_,e[6]=n*c+h*x+a,e[7]=u*x+o*c+_},o.prototype._render=function(t){this.calculateVertices(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this)},o.prototype._calculateBounds=function(){var t=this._texture.trim,e=this._texture.orig;!t||t.width===e.width&&t.height===e.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},o.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._texture.orig.width*-this._anchor._x,this._bounds.minY=this._texture.orig.height*-this._anchor._y,this._bounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._bounds.maxY=this._texture.orig.height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new r.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):i.prototype.getLocalBounds.call(this,t)},o.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,u);var e=this._texture.orig.width,i=this._texture.orig.height,r=-e*this.anchor.x,s=0;return u.x>=r&&u.x<r+e&&(s=-i*this.anchor.y,u.y>=s&&u.y<s+i)},o.prototype.destroy=function(t){if(i.prototype.destroy.call(this,t),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof t?t:t&&t.texture){var e="boolean"==typeof t?t:t&&t.baseTexture;this._texture.destroy(!!e)}this._texture=null},o.from=function(t,i){return new o(t instanceof e.Texture?t:e.Texture.from(t,i))},Object.defineProperty(o.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){var e=(0,n.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){var e=(0,n.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"anchor",{get:function(){return this._anchor},set:function(t){this._anchor.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tint",{get:function(){return this._tint},set:function(t){this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture!==t&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=t||e.Texture.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,t&&(t.baseTexture.valid?this._onTextureUpdate():t.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),o}(i.Container);exports.Sprite=_;
},{"@pixi/constants":"djkr","@pixi/core":"lj2a","@pixi/display":"qvzw","@pixi/math":"w9h1","@pixi/settings":"Xe2x","@pixi/utils":"X4iF"}],"aZY8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextStyle=exports.TextMetrics=exports.Text=exports.TEXT_GRADIENT=void 0;var t,e=require("@pixi/sprite"),i=require("@pixi/core"),r=require("@pixi/settings"),n=require("@pixi/math"),o=require("@pixi/utils"),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function a(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}exports.TEXT_GRADIENT=t,function(t){t[t.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",t[t.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"}(t||(exports.TEXT_GRADIENT=t={}));var h={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:t.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},l=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],c=function(){function t(t){this.styleID=0,this.reset(),d(this,t,t)}return t.prototype.clone=function(){var e={};return d(e,this,h),new t(e)},t.prototype.reset=function(){d(this,h,h)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=f(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=f(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){p(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=f(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),t.prototype.toFontString=function(){var t="number"==typeof this.fontSize?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var i=e.length-1;i>=0;i--){var r=e[i].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&l.indexOf(r)<0&&(r='"'+r+'"'),e[i]=r}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},t}();function u(t){return"number"==typeof t?(0,o.hex2string)(t):("string"==typeof t&&0===t.indexOf("0x")&&(t=t.replace("0x","#")),t)}function f(t){if(Array.isArray(t)){for(var e=0;e<t.length;++e)t[e]=u(t[e]);return t}return u(t)}function p(t,e){if(!Array.isArray(t)||!Array.isArray(e))return!1;if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}function d(t,e,i){for(var r in i)Array.isArray(e[r])?t[r]=e[r].slice():t[r]=e[r]}exports.TextStyle=c;var g=function(){function t(t,e,i,r,n,o,s,a,h){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=s,this.maxLineWidth=a,this.fontProperties=h}return t.measureText=function(e,i,r,n){void 0===n&&(n=t._canvas),r=null==r?i.wordWrap:r;var o=i.toFontString(),s=t.measureFont(o);0===s.fontSize&&(s.fontSize=i.fontSize,s.ascent=i.fontSize);var a=n.getContext("2d");a.font=o;for(var h=(r?t.wordWrap(e,i,n):e).split(/(?:\r\n|\r|\n)/),l=new Array(h.length),c=0,u=0;u<h.length;u++){var f=a.measureText(h[u]).width+(h[u].length-1)*i.letterSpacing;l[u]=f,c=Math.max(c,f)}var p=c+i.strokeThickness;i.dropShadow&&(p+=i.dropShadowDistance);var d=i.lineHeight||s.fontSize+i.strokeThickness,g=Math.max(d,s.fontSize+i.strokeThickness)+(h.length-1)*(d+i.leading);return i.dropShadow&&(g+=i.dropShadowDistance),new t(e,i,p,g,h,l,d+i.leading,c,s)},t.wordWrap=function(e,i,r){void 0===r&&(r=t._canvas);for(var n=r.getContext("2d"),o=0,s="",a="",h=Object.create(null),l=i.letterSpacing,c=i.whiteSpace,u=t.collapseSpaces(c),f=t.collapseNewlines(c),p=!u,d=i.wordWrapWidth+l,g=t.tokenize(e),y=0;y<g.length;y++){var _=g[y];if(t.isNewline(_)){if(!f){a+=t.addLine(s),p=!u,s="",o=0;continue}_=" "}if(u){var b=t.isBreakingSpace(_),S=t.isBreakingSpace(s[s.length-1]);if(b&&S)continue}var m=t.getFromCache(_,l,h,n);if(m>d)if(""!==s&&(a+=t.addLine(s),s="",o=0),t.canBreakWords(_,i.breakWords))for(var w=t.wordWrapSplit(_),x=0;x<w.length;x++){for(var v=w[x],T=1;w[x+T];){var k=w[x+T],I=v[v.length-1];if(t.canBreakChars(I,k,_,x,i.breakWords))break;v+=k,T++}x+=v.length-1;var O=t.getFromCache(v,l,h,n);O+o>d&&(a+=t.addLine(s),p=!1,s="",o=0),s+=v,o+=O}else{s.length>0&&(a+=t.addLine(s),s="",o=0);var A=y===g.length-1;a+=t.addLine(_,!A),p=!1,s="",o=0}else m+o>d&&(p=!1,a+=t.addLine(s),s="",o=0),(s.length>0||!t.isBreakingSpace(_)||p)&&(s+=_,o+=m)}return a+=t.addLine(s,!1)},t.addLine=function(e,i){return void 0===i&&(i=!0),e=t.trimRight(e),e=i?e+"\n":e},t.getFromCache=function(t,e,i,r){var n=i[t];if("number"!=typeof n){var o=t.length*e;n=r.measureText(t).width+o,i[t]=n}return n},t.collapseSpaces=function(t){return"normal"===t||"pre-line"===t},t.collapseNewlines=function(t){return"normal"===t},t.trimRight=function(e){if("string"!=typeof e)return"";for(var i=e.length-1;i>=0;i--){var r=e[i];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e},t.isNewline=function(e){return"string"==typeof e&&t._newlines.indexOf(e.charCodeAt(0))>=0},t.isBreakingSpace=function(e){return"string"==typeof e&&t._breakingSpaces.indexOf(e.charCodeAt(0))>=0},t.tokenize=function(e){var i=[],r="";if("string"!=typeof e)return i;for(var n=0;n<e.length;n++){var o=e[n];t.isBreakingSpace(o)||t.isNewline(o)?(""!==r&&(i.push(r),r=""),i.push(o)):r+=o}return""!==r&&i.push(r),i},t.canBreakWords=function(t,e){return e},t.canBreakChars=function(t,e,i,r,n){return!0},t.wordWrapSplit=function(t){return t.split("")},t.measureFont=function(e){if(t._fonts[e])return t._fonts[e];var i={ascent:0,descent:0,fontSize:0},r=t._canvas,n=t._context;n.font=e;var o=t.METRICS_STRING+t.BASELINE_SYMBOL,s=Math.ceil(n.measureText(o).width),a=Math.ceil(n.measureText(t.BASELINE_SYMBOL).width),h=2*a;a=a*t.BASELINE_MULTIPLIER|0,r.width=s,r.height=h,n.fillStyle="#f00",n.fillRect(0,0,s,h),n.font=e,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(o,0,a);var l=n.getImageData(0,0,s,h).data,c=l.length,u=4*s,f=0,p=0,d=!1;for(f=0;f<a;++f){for(var g=0;g<u;g+=4)if(255!==l[p+g]){d=!0;break}if(d)break;p+=u}for(i.ascent=a-f,p=c-u,d=!1,f=h;f>a;--f){for(g=0;g<u;g+=4)if(255!==l[p+g]){d=!0;break}if(d)break;p-=u}return i.descent=f-a,i.fontSize=i.ascent+i.descent,t._fonts[e]=i,i},t.clearMetrics=function(e){void 0===e&&(e=""),e?delete t._fonts[e]:t._fonts={}},t}();exports.TextMetrics=g;var y=function(){try{var t=new OffscreenCanvas(0,0),e=t.getContext("2d");return e&&e.measureText?t:document.createElement("canvas")}catch(i){return document.createElement("canvas")}}();y.width=y.height=10,g._canvas=y,g._context=y.getContext("2d"),g._fonts={},g.METRICS_STRING="|ÉqÅ",g.BASELINE_SYMBOL="M",g.BASELINE_MULTIPLIER=1.4,g._newlines=[10,13],g._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var _={texture:!0,children:!1,baseTexture:!0},b=function(e){function s(t,o,s){var a=this,h=!1;s||(s=document.createElement("canvas"),h=!0),s.width=3,s.height=3;var l=i.Texture.from(s);return l.orig=new n.Rectangle,l.trim=new n.Rectangle,(a=e.call(this,l)||this)._ownCanvas=h,a.canvas=s,a.context=a.canvas.getContext("2d"),a._resolution=r.settings.RESOLUTION,a._autoResolution=!0,a._text=null,a._style=null,a._styleListener=null,a._font="",a.text=t,a.style=o,a.localStyleID=-1,a}return a(s,e),s.prototype.updateText=function(t){var e=this._style;if(this.localStyleID!==e.styleID&&(this.dirty=!0,this.localStyleID=e.styleID),this.dirty||!t){this._font=this._style.toFontString();var i,r,n=this.context,s=g.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=s.width,h=s.height,l=s.lines,c=s.lineHeight,u=s.lineWidths,f=s.maxLineWidth,p=s.fontProperties;this.canvas.width=Math.ceil((Math.max(1,a)+2*e.padding)*this._resolution),this.canvas.height=Math.ceil((Math.max(1,h)+2*e.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=e.strokeThickness,n.textBaseline=e.textBaseline,n.lineJoin=e.lineJoin,n.miterLimit=e.miterLimit;for(var d=e.dropShadow?2:1,y=0;y<d;++y){var _=e.dropShadow&&0===y,b=_?Math.ceil(Math.max(1,h)+2*e.padding):0,S=b*this._resolution;if(_){n.fillStyle="black",n.strokeStyle="black";var m=e.dropShadowColor,w=(0,o.hex2rgb)("number"==typeof m?m:(0,o.string2hex)(m));n.shadowColor="rgba("+255*w[0]+","+255*w[1]+","+255*w[2]+","+e.dropShadowAlpha+")",n.shadowBlur=e.dropShadowBlur,n.shadowOffsetX=Math.cos(e.dropShadowAngle)*e.dropShadowDistance,n.shadowOffsetY=Math.sin(e.dropShadowAngle)*e.dropShadowDistance+S}else n.fillStyle=this._generateFillStyle(e,l,s),n.strokeStyle=e.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;for(var x=0;x<l.length;x++)i=e.strokeThickness/2,r=e.strokeThickness/2+x*c+p.ascent,"right"===e.align?i+=f-u[x]:"center"===e.align&&(i+=(f-u[x])/2),e.stroke&&e.strokeThickness&&this.drawLetterSpacing(l[x],i+e.padding,r+e.padding-b,!0),e.fill&&this.drawLetterSpacing(l[x],i+e.padding,r+e.padding-b)}this.updateTexture()}},s.prototype.drawLetterSpacing=function(t,e,i,r){void 0===r&&(r=!1);var n=this._style.letterSpacing;if(0!==n)for(var o=e,s=Array.from?Array.from(t):t.split(""),a=this.context.measureText(t).width,h=0,l=0;l<s.length;++l){var c=s[l];r?this.context.strokeText(c,o,i):this.context.fillText(c,o,i),o+=a-(h=this.context.measureText(t.substring(l+1)).width)+n,a=h}else r?this.context.strokeText(t,e,i):this.context.fillText(t,e,i)},s.prototype.updateTexture=function(){var t=this.canvas;if(this._style.trim){var e=(0,o.trimCanvas)(t);e.data&&(t.width=e.width,t.height=e.height,this.context.putImageData(e.data,0,0))}var i=this._texture,r=this._style,n=r.trim?0:r.padding,s=i.baseTexture;i.trim.width=i._frame.width=Math.ceil(t.width/this._resolution),i.trim.height=i._frame.height=Math.ceil(t.height/this._resolution),i.trim.x=-n,i.trim.y=-n,i.orig.width=i._frame.width-2*n,i.orig.height=i._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(t.width,t.height,this._resolution),this._recursivePostUpdateTransform(),this.dirty=!1},s.prototype._render=function(t){this._autoResolution&&this._resolution!==t.resolution&&(this._resolution=t.resolution,this.dirty=!0),this.updateText(!0),e.prototype._render.call(this,t)},s.prototype.getLocalBounds=function(t){return this.updateText(!0),e.prototype.getLocalBounds.call(this,t)},s.prototype._calculateBounds=function(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)},s.prototype._generateFillStyle=function(e,i,r){var n,o=e.fill;if(!Array.isArray(o))return o;if(1===o.length)return o[0];var s=e.dropShadow?e.dropShadowDistance:0,a=e.padding||0,h=Math.ceil(this.canvas.width/this._resolution)-s-2*a,l=Math.ceil(this.canvas.height/this._resolution)-s-2*a,c=o.slice(),u=e.fillGradientStops.slice();if(!u.length)for(var f=c.length+1,p=1;p<f;++p)u.push(p/f);if(c.unshift(o[0]),u.unshift(0),c.push(o[o.length-1]),u.push(1),e.fillGradientType===t.LINEAR_VERTICAL){n=this.context.createLinearGradient(h/2,a,h/2,l+a);var d=0,g=(r.fontProperties.fontSize+e.strokeThickness)/l;for(p=0;p<i.length;p++)for(var y=r.lineHeight*p,_=0;_<c.length;_++){var b=y/l+("number"==typeof u[_]?u[_]:_/c.length)*g,S=Math.max(d,b);S=Math.min(S,1),n.addColorStop(S,c[_]),d=S}}else{n=this.context.createLinearGradient(a,l/2,h+a,l/2);var m=c.length+1,w=1;for(p=0;p<c.length;p++){var x=void 0;x="number"==typeof u[p]?u[p]:w/m,n.addColorStop(x,c[p]),w++}}return n},s.prototype.destroy=function(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},_,t),e.prototype.destroy.call(this,t),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(s.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(t){this.updateText(!0);var e=(0,o.sign)(this.scale.x)||1;this.scale.x=e*t/this._texture.orig.width,this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(t){this.updateText(!0);var e=(0,o.sign)(this.scale.y)||1;this.scale.y=e*t/this._texture.orig.height,this._height=t},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"style",{get:function(){return this._style},set:function(t){t=t||{},this._style=t instanceof c?t:new c(t),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"text",{get:function(){return this._text},set:function(t){t=String(null==t?"":t),this._text!==t&&(this._text=t,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"resolution",{get:function(){return this._resolution},set:function(t){this._autoResolution=!1,this._resolution!==t&&(this._resolution=t,this.dirty=!0)},enumerable:!1,configurable:!0}),s}(e.Sprite);exports.Text=b;
},{"@pixi/sprite":"XG9w","@pixi/core":"lj2a","@pixi/settings":"Xe2x","@pixi/math":"w9h1","@pixi/utils":"X4iF"}],"cawE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TimeLimiter=exports.Prepare=exports.CountLimiter=exports.BasePrepare=void 0;var e=require("@pixi/settings"),t=require("@pixi/core"),i=require("@pixi/graphics"),r=require("@pixi/ticker"),o=require("@pixi/display"),s=require("@pixi/text");e.settings.UPLOADS_PER_FRAME=4;var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function u(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var a=function(){function e(e){this.maxItemsPerFrame=e,this.itemsLeft=0}return e.prototype.beginFrame=function(){this.itemsLeft=this.maxItemsPerFrame},e.prototype.allowedToUpload=function(){return this.itemsLeft-- >0},e}();function h(e,i){var r=!1;if(e&&e._textures&&e._textures.length)for(var o=0;o<e._textures.length;o++)if(e._textures[o]instanceof t.Texture){var s=e._textures[o].baseTexture;-1===i.indexOf(s)&&(i.push(s),r=!0)}return r}function p(e,i){if(e.baseTexture instanceof t.BaseTexture){var r=e.baseTexture;return-1===i.indexOf(r)&&i.push(r),!0}return!1}function c(e,i){if(e._texture&&e._texture instanceof t.Texture){var r=e._texture.baseTexture;return-1===i.indexOf(r)&&i.push(r),!0}return!1}function l(e,t){return t instanceof s.Text&&(t.updateText(!0),!0)}function f(e,t){if(t instanceof s.TextStyle){var i=t.toFontString();return s.TextMetrics.measureFont(i),!0}return!1}function d(e,t){if(e instanceof s.Text){-1===t.indexOf(e.style)&&t.push(e.style),-1===t.indexOf(e)&&t.push(e);var i=e._texture.baseTexture;return-1===t.indexOf(i)&&t.push(i),!0}return!1}function x(e,t){return e instanceof s.TextStyle&&(-1===t.indexOf(e)&&t.push(e),!0)}exports.CountLimiter=a;var k=function(){function t(t){var i=this;this.limiter=new a(e.settings.UPLOADS_PER_FRAME),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=function(){i.queue&&i.prepareItems()},this.registerFindHook(d),this.registerFindHook(x),this.registerFindHook(h),this.registerFindHook(p),this.registerFindHook(c),this.registerUploadHook(l),this.registerUploadHook(f)}return t.prototype.upload=function(e,t){"function"==typeof e&&(t=e,e=null),e&&this.add(e),this.queue.length?(t&&this.completes.push(t),this.ticking||(this.ticking=!0,r.Ticker.system.addOnce(this.tick,this,r.UPDATE_PRIORITY.UTILITY))):t&&t()},t.prototype.tick=function(){setTimeout(this.delayedTick,0)},t.prototype.prepareItems=function(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){var e=this.queue[0],t=!1;if(e&&!e._destroyed)for(var i=0,o=this.uploadHooks.length;i<o;i++)if(this.uploadHooks[i](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}t||this.queue.shift()}if(this.queue.length)r.Ticker.system.addOnce(this.tick,this,r.UPDATE_PRIORITY.UTILITY);else{this.ticking=!1;var s=this.completes.slice(0);this.completes.length=0;for(i=0,o=s.length;i<o;i++)s[i]()}},t.prototype.registerFindHook=function(e){return e&&this.addHooks.push(e),this},t.prototype.registerUploadHook=function(e){return e&&this.uploadHooks.push(e),this},t.prototype.add=function(e){for(var t=0,i=this.addHooks.length;t<i&&!this.addHooks[t](e,this.queue);t++);if(e instanceof o.Container)for(t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this},t.prototype.destroy=function(){this.ticking&&r.Ticker.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null},t}();function m(e,i){return i instanceof t.BaseTexture&&(i._glTextures[e.CONTEXT_UID]||e.texture.bind(i),!0)}function g(e,t){if(!(t instanceof i.Graphics))return!1;var r=t.geometry;t.finishPoly(),r.updateBatches();for(var o=r.batches,s=0;s<o.length;s++){var n=o[s].style.texture;n&&m(e,n.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function T(e,t){return e instanceof i.Graphics&&(t.push(e),!0)}exports.BasePrepare=k;var y=function(e){function t(t){var i=e.call(this,t)||this;return i.uploadHookHelper=i.renderer,i.registerFindHook(T),i.registerUploadHook(m),i.registerUploadHook(g),i}return u(t,e),t}(k);exports.Prepare=y;var H=function(){function e(e){this.maxMilliseconds=e,this.frameStart=0}return e.prototype.beginFrame=function(){this.frameStart=Date.now()},e.prototype.allowedToUpload=function(){return Date.now()-this.frameStart<this.maxMilliseconds},e}();exports.TimeLimiter=H;
},{"@pixi/settings":"Xe2x","@pixi/core":"lj2a","@pixi/graphics":"I0PC","@pixi/ticker":"AWzT","@pixi/display":"qvzw","@pixi/text":"aZY8"}],"O2FJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SpritesheetLoader=exports.Spritesheet=void 0;var t=require("@pixi/math"),e=require("@pixi/core"),s=require("@pixi/utils"),r=require("@pixi/loaders"),i=function(){function r(t,s,r){void 0===r&&(r=null),this._texture=t instanceof e.Texture?t:null,this.baseTexture=t instanceof e.BaseTexture?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=s;var i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return r.prototype._updateResolution=function(t){void 0===t&&(t=null);var e=this.data.meta.scale,r=(0,s.getResolutionOfUrl)(t,null);return null===r&&(r=void 0!==e?parseFloat(e):1),1!==r&&this.baseTexture.setResolution(r),r},r.prototype.parse=function(t){this._batchIndex=0,this._callback=t,this._frameKeys.length<=r.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()},r.prototype._processFrames=function(s){for(var i=s,o=r.BATCH_SIZE;i-s<o&&i<this._frameKeys.length;){var a=this._frameKeys[i],n=this._frames[a],h=n.frame;if(h){var u=null,l=null,c=!1!==n.trimmed&&n.sourceSize?n.sourceSize:n.frame,f=new t.Rectangle(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);u=n.rotated?new t.Rectangle(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.h)/this.resolution,Math.floor(h.w)/this.resolution):new t.Rectangle(Math.floor(h.x)/this.resolution,Math.floor(h.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution),!1!==n.trimmed&&n.spriteSourceSize&&(l=new t.Rectangle(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution)),this.textures[a]=new e.Texture(this.baseTexture,u,f,l,n.rotated?2:0,n.anchor),e.Texture.addToCache(this.textures[a],a)}i++}},r.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var s=0;s<t[e].length;s++){var r=t[e][s];this.animations[e].push(this.textures[r])}}},r.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},r.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*r.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*r.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},r.prototype.destroy=function(t){var e;for(var s in void 0===t&&(t=!1),this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(null===(e=this._texture)||void 0===e||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null},r.BATCH_SIZE=1e3,r}();exports.Spritesheet=i;var o=function(){function t(){}return t.use=function(e,s){var o=e.name+"_image";if(e.data&&e.type===r.LoaderResource.TYPE.JSON&&e.data.frames&&!this.resources[o]){var a={crossOrigin:e.crossOrigin,metadata:e.metadata.imageMetadata,parentResource:e},n=t.getResourcePath(e,this.baseUrl);this.add(o,n,a,function(t){if(t.error)s(t.error);else{var r=new i(t.texture,e.data,e.url);r.parse(function(){e.spritesheet=r,e.textures=r.textures,s()})}})}else s()},t.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:s.url.resolve(t.url.replace(e,""),t.data.meta.image)},t}();exports.SpritesheetLoader=o;
},{"@pixi/math":"w9h1","@pixi/core":"lj2a","@pixi/utils":"X4iF","@pixi/loaders":"bw5V"}],"hxhD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TilingSpriteRenderer=exports.TilingSprite=void 0;var t=require("@pixi/core"),e=require("@pixi/math"),r=require("@pixi/sprite"),i=require("@pixi/utils"),o=require("@pixi/constants"),n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function a(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var s=new e.Point,u=function(r){function o(i,o,n){void 0===o&&(o=100),void 0===n&&(n=100);var a=r.call(this,i)||this;return a.tileTransform=new e.Transform,a._width=o,a._height=n,a.uvMatrix=a.texture.uvMatrix||new t.TextureMatrix(i),a.pluginName="tilingSprite",a.uvRespectAnchor=!1,a}return a(o,r),Object.defineProperty(o.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(t){this.uvMatrix.clampMargin=t,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(t){this.tileTransform.scale.copyFrom(t)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(t){this.tileTransform.position.copyFrom(t)},enumerable:!1,configurable:!0}),o.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},o.prototype._render=function(t){var e=this._texture;e&&e.valid&&(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),t.batch.setObjectRenderer(t.plugins[this.pluginName]),t.plugins[this.pluginName].render(this))},o.prototype._calculateBounds=function(){var t=this._width*-this._anchor._x,e=this._height*-this._anchor._y,r=this._width*(1-this._anchor._x),i=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,t,e,r,i)},o.prototype.getLocalBounds=function(t){return 0===this.children.length?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),t||(this._localBoundsRect||(this._localBoundsRect=new e.Rectangle),t=this._localBoundsRect),this._bounds.getRectangle(t)):r.prototype.getLocalBounds.call(this,t)},o.prototype.containsPoint=function(t){this.worldTransform.applyInverse(t,s);var e=this._width,r=this._height,i=-e*this.anchor._x;if(s.x>=i&&s.x<i+e){var o=-r*this.anchor._y;if(s.y>=o&&s.y<o+r)return!0}return!1},o.prototype.destroy=function(t){r.prototype.destroy.call(this,t),this.tileTransform=null,this.uvMatrix=null},o.from=function(e,r){return"number"==typeof r&&((0,i.deprecation)("5.3.0","TilingSprite.from use options instead of width and height args"),r={width:r,height:arguments[2]}),new o(t.Texture.from(e,r),r.width,r.height)},Object.defineProperty(o.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t},enumerable:!1,configurable:!0}),o}(r.Sprite);exports.TilingSprite=u;var h="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTransform;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;\n}\n",c="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\nuniform mat3 uMapCoord;\nuniform vec4 uClampFrame;\nuniform vec2 uClampOffset;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);\n    coord = (uMapCoord * vec3(coord, 1.0)).xy;\n    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n    vec4 texSample = texture2D(uSampler, coord);\n    gl_FragColor = texSample * uColor;\n}\n",l="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 uColor;\n\nvoid main(void)\n{\n    vec4 sample = texture2D(uSampler, vTextureCoord);\n    gl_FragColor = sample * uColor;\n}\n",p=new e.Matrix,d=function(e){function r(r){var i=e.call(this,r)||this,o={globals:i.renderer.globalUniforms};return i.shader=t.Shader.from(h,c,o),i.simpleShader=t.Shader.from(h,l,o),i.quad=new t.QuadUv,i.state=t.State.for2d(),i}return a(r,e),r.prototype.render=function(t){var e=this.renderer,r=this.quad,n=r.vertices;n[0]=n[6]=t._width*-t.anchor.x,n[1]=n[3]=t._height*-t.anchor.y,n[2]=n[4]=t._width*(1-t.anchor.x),n[5]=n[7]=t._height*(1-t.anchor.y),t.uvRespectAnchor&&((n=r.uvs)[0]=n[6]=-t.anchor.x,n[1]=n[3]=-t.anchor.y,n[2]=n[4]=1-t.anchor.x,n[5]=n[7]=1-t.anchor.y),r.invalidate();var a=t._texture,s=a.baseTexture,u=t.tileTransform.localTransform,h=t.uvMatrix,c=s.isPowerOfTwo&&a.frame.width===s.width&&a.frame.height===s.height;c&&(s._glTextures[e.CONTEXT_UID]?c=s.wrapMode!==o.WRAP_MODES.CLAMP:s.wrapMode===o.WRAP_MODES.CLAMP&&(s.wrapMode=o.WRAP_MODES.REPEAT));var l=c?this.simpleShader:this.shader,d=a.width,m=a.height,f=t._width,_=t._height;p.set(u.a*d/f,u.b*d/_,u.c*m/f,u.d*m/_,u.tx/f,u.ty/_),p.invert(),c?p.prepend(h.mapCoord):(l.uniforms.uMapCoord=h.mapCoord.toArray(!0),l.uniforms.uClampFrame=h.uClampFrame,l.uniforms.uClampOffset=h.uClampOffset),l.uniforms.uTransform=p.toArray(!0),l.uniforms.uColor=(0,i.premultiplyTintToRgba)(t.tint,t.worldAlpha,l.uniforms.uColor,s.alphaMode),l.uniforms.translationMatrix=t.transform.worldTransform.toArray(!0),l.uniforms.uSampler=a,e.shader.bind(l),e.geometry.bind(r),this.state.blendMode=(0,i.correctBlendMode)(t.blendMode,s.alphaMode),e.state.set(this.state),e.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},r}(t.ObjectRenderer);exports.TilingSpriteRenderer=d;
},{"@pixi/core":"lj2a","@pixi/math":"w9h1","@pixi/sprite":"XG9w","@pixi/utils":"X4iF","@pixi/constants":"djkr"}],"KkZL":[function(require,module,exports) {

"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MeshMaterial=exports.MeshGeometry=exports.MeshBatchUvs=exports.Mesh=void 0;var t=require("@pixi/core"),e=require("@pixi/math"),r=require("@pixi/constants"),i=require("@pixi/display"),n=require("@pixi/settings"),a=require("@pixi/utils"),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function s(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var u=function(){function t(t,e){this.uvBuffer=t,this.uvMatrix=e,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}return t.prototype.update=function(t){if(t||this._bufferUpdateId!==this.uvBuffer._updateID||this._textureUpdateId!==this.uvMatrix._updateID){this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;var e=this.uvBuffer.data;this.data&&this.data.length===e.length||(this.data=new Float32Array(e.length)),this.uvMatrix.multiplyUvs(e,this.data),this._updateID++}},t}();exports.MeshBatchUvs=u;var h=new e.Point,l=new e.Polygon,d=function(e){function i(i,a,o,s){void 0===s&&(s=r.DRAW_MODES.TRIANGLES);var u=e.call(this)||this;return u.geometry=i,i.refCount++,u.shader=a,u.state=o||t.State.for2d(),u.drawMode=s,u.start=0,u.size=0,u.uvs=null,u.indices=null,u.vertexData=new Float32Array(1),u.vertexDirty=0,u._transformID=-1,u._roundPixels=n.settings.ROUND_PIXELS,u.batchUvs=null,u}return s(i,e),Object.defineProperty(i.prototype,"uvBuffer",{get:function(){return this.geometry.buffers[1]},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"verticesBuffer",{get:function(){return this.geometry.buffers[0]},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"material",{get:function(){return this.shader},set:function(t){this.shader=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(t){this._roundPixels!==t&&(this._transformID=-1),this._roundPixels=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tint",{get:function(){return this.shader.tint},set:function(t){this.shader.tint=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture=t},enumerable:!1,configurable:!0}),i.prototype._render=function(t){var e=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===r.DRAW_MODES.TRIANGLES&&e.length<2*i.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)},i.prototype._renderDefault=function(t){var e=this.shader;e.alpha=this.worldAlpha,e.update&&e.update(),t.batch.flush(),e.program.uniformData.translationMatrix&&(e.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0)),t.shader.bind(e),t.state.set(this.state),t.geometry.bind(this.geometry,e),t.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)},i.prototype._renderToBatch=function(t){var e=this.geometry;this.shader.uvMatrix&&(this.shader.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=e.indexBuffer.data,this._tintRGB=this.shader._tintRGB,this._texture=this.shader.texture;var r=this.material.pluginName;t.batch.setObjectRenderer(t.plugins[r]),t.plugins[r].render(this)},i.prototype.calculateVertices=function(){var t=this.geometry,e=t.buffers[0].data;if(t.vertexDirtyId!==this.vertexDirty||this._transformID!==this.transform._worldID){this._transformID=this.transform._worldID,this.vertexData.length!==e.length&&(this.vertexData=new Float32Array(e.length));for(var r=this.transform.worldTransform,i=r.a,a=r.b,o=r.c,s=r.d,u=r.tx,h=r.ty,l=this.vertexData,d=0;d<l.length/2;d++){var f=e[2*d],p=e[2*d+1];l[2*d]=i*f+o*p+u,l[2*d+1]=a*f+s*p+h}if(this._roundPixels){var c=n.settings.RESOLUTION;for(d=0;d<l.length;++d)l[d]=Math.round((l[d]*c|0)/c)}this.vertexDirty=t.vertexDirtyId}},i.prototype.calculateUvs=function(){var t=this.geometry.buffers[1];this.shader.uvMatrix.isSimple?this.uvs=t.data:(this.batchUvs||(this.batchUvs=new u(t,this.shader.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)},i.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)},i.prototype.containsPoint=function(t){if(!this.getBounds().contains(t.x,t.y))return!1;this.worldTransform.applyInverse(t,h);for(var e=this.geometry.getBuffer("aVertexPosition").data,r=l.points,i=this.geometry.getIndex().data,n=i.length,a=4===this.drawMode?3:1,o=0;o+2<n;o+=a){var s=2*i[o],u=2*i[o+1],d=2*i[o+2];if(r[0]=e[s],r[1]=e[s+1],r[2]=e[u],r[3]=e[u+1],r[4]=e[d],r[5]=e[d+1],l.contains(h.x,h.y))return!0}return!1},i.prototype.destroy=function(t){e.prototype.destroy.call(this,t),this.geometry.refCount--,0===this.geometry.refCount&&this.geometry.dispose(),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null},i.BATCHABLE_SIZE=100,i}(i.Container);exports.Mesh=d;var f="varying vec2 vTextureCoord;\nuniform vec4 uColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;\n}\n",p="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mat3 uTextureMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;\n}\n",c=function(r){function i(i,n){var a=this,o={uSampler:i,alpha:1,uTextureMatrix:e.Matrix.IDENTITY,uColor:new Float32Array([1,1,1,1])};return(n=Object.assign({tint:16777215,alpha:1,pluginName:"batch"},n)).uniforms&&Object.assign(o,n.uniforms),(a=r.call(this,n.program||t.Program.from(p,f),o)||this)._colorDirty=!1,a.uvMatrix=new t.TextureMatrix(i),a.batchable=void 0===n.program,a.pluginName=n.pluginName,a.tint=n.tint,a.alpha=n.alpha,a}return s(i,r),Object.defineProperty(i.prototype,"texture",{get:function(){return this.uniforms.uSampler},set:function(t){this.uniforms.uSampler!==t&&(this.uniforms.uSampler=t,this.uvMatrix.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"alpha",{get:function(){return this._alpha},set:function(t){t!==this._alpha&&(this._alpha=t,this._colorDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"tint",{get:function(){return this._tint},set:function(t){t!==this._tint&&(this._tint=t,this._tintRGB=(t>>16)+(65280&t)+((255&t)<<16),this._colorDirty=!0)},enumerable:!1,configurable:!0}),i.prototype.update=function(){if(this._colorDirty){this._colorDirty=!1;var t=this.texture.baseTexture;(0,a.premultiplyTintToRgba)(this._tint,this._alpha,this.uniforms.uColor,t.alphaMode)}this.uvMatrix.update()&&(this.uniforms.uTextureMatrix=this.uvMatrix.mapCoord)},i}(t.Shader);exports.MeshMaterial=c;var x=function(e){function i(i,n,a){var o=e.call(this)||this,s=new t.Buffer(i),u=new t.Buffer(n,!0),h=new t.Buffer(a,!0,!0);return o.addAttribute("aVertexPosition",s,2,!1,r.TYPES.FLOAT).addAttribute("aTextureCoord",u,2,!1,r.TYPES.FLOAT).addIndex(h),o._updateId=-1,o}return s(i,e),Object.defineProperty(i.prototype,"vertexDirtyId",{get:function(){return this.buffers[0]._updateID},enumerable:!1,configurable:!0}),i}(t.Geometry);exports.MeshGeometry=x;
},{"@pixi/core":"lj2a","@pixi/math":"w9h1","@pixi/constants":"djkr","@pixi/display":"qvzw","@pixi/settings":"Xe2x","@pixi/utils":"X4iF"}],"wAzD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BitmapText=exports.BitmapFontLoader=exports.BitmapFontData=exports.BitmapFont=void 0;var e=require("@pixi/math"),t=require("@pixi/settings"),r=require("@pixi/mesh"),i=require("@pixi/utils"),n=require("@pixi/core"),a=require("@pixi/text"),o=require("@pixi/display"),s=require("@pixi/loaders"),h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function l(e,t){function r(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var f=function(){return function(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[]}}();exports.BitmapFontData=f;var u=function(){function e(){}return e.test=function(e){return"string"==typeof e&&0===e.indexOf("info face=")},e.parse=function(e){var t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[]};for(var i in t){var n=t[i].match(/^[a-z]+/gm)[0],a=t[i].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),o={};for(var s in a){var h=a[s].split("="),l=h[0],u=h[1].replace(/"/gm,""),c=parseFloat(u),p=isNaN(c)?u:c;o[l]=p}r[n].push(o)}var g=new f;return r.info.forEach(function(e){return g.info.push({face:e.face,size:parseInt(e.size,10)})}),r.common.forEach(function(e){return g.common.push({lineHeight:parseInt(e.lineHeight,10)})}),r.page.forEach(function(e){return g.page.push({id:parseInt(e.id,10),file:e.file})}),r.char.forEach(function(e){return g.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)})}),r.kerning.forEach(function(e){return g.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)})}),g},e}(),c=function(){function e(){}return e.test=function(e){return e instanceof XMLDocument&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")},e.parse=function(e){for(var t=new f,r=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),n=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning"),s=0;s<r.length;s++)t.info.push({face:r[s].getAttribute("face"),size:parseInt(r[s].getAttribute("size"),10)});for(s=0;s<i.length;s++)t.common.push({lineHeight:parseInt(i[s].getAttribute("lineHeight"),10)});for(s=0;s<n.length;s++)t.page.push({id:parseInt(n[s].getAttribute("id"),10)||0,file:n[s].getAttribute("file")});for(s=0;s<a.length;s++){var h=a[s];t.char.push({id:parseInt(h.getAttribute("id"),10),page:parseInt(h.getAttribute("page"),10)||0,x:parseInt(h.getAttribute("x"),10),y:parseInt(h.getAttribute("y"),10),width:parseInt(h.getAttribute("width"),10),height:parseInt(h.getAttribute("height"),10),xoffset:parseInt(h.getAttribute("xoffset"),10),yoffset:parseInt(h.getAttribute("yoffset"),10),xadvance:parseInt(h.getAttribute("xadvance"),10)})}for(s=0;s<o.length;s++)t.kerning.push({first:parseInt(o[s].getAttribute("first"),10),second:parseInt(o[s].getAttribute("second"),10),amount:parseInt(o[s].getAttribute("amount"),10)});return t},e}(),p=function(){function e(){}return e.test=function(e){if("string"==typeof e&&e.indexOf("<font>")>-1){var t=(new self.DOMParser).parseFromString(e,"text/xml");return c.test(t)}return!1},e.parse=function(e){var t=(new window.DOMParser).parseFromString(e,"text/xml");return c.parse(t)},e}(),g=[u,c,p];function d(e){for(var t=0;t<g.length;t++)if(g[t].test(e))return g[t];return null}function x(e,t,r,i,n,o){var s,h=r.fill;if(!Array.isArray(h))return h;if(1===h.length)return h[0];var l=r.dropShadow?r.dropShadowDistance:0,f=r.padding||0,u=Math.ceil(e.width/i)-l-2*f,c=Math.ceil(e.height/i)-l-2*f,p=h.slice(),g=r.fillGradientStops.slice();if(!g.length)for(var d=p.length+1,x=1;x<d;++x)g.push(x/d);if(p.unshift(h[0]),g.unshift(0),p.push(h[h.length-1]),g.push(1),r.fillGradientType===a.TEXT_GRADIENT.LINEAR_VERTICAL){s=t.createLinearGradient(u/2,f,u/2,c+f);var m=0,v=(o.fontProperties.fontSize+r.strokeThickness)/c;for(x=0;x<n.length;x++)for(var y=o.lineHeight*x,b=0;b<p.length;b++){var _=y/c+("number"==typeof g[b]?g[b]:b/p.length)*v,w=Math.max(m,_);w=Math.min(w,1),s.addColorStop(w,p[b]),m=w}}else{s=t.createLinearGradient(f,c/2,u+f,c/2);var T=p.length+1,S=1;for(x=0;x<p.length;x++){var A=void 0;A="number"==typeof g[x]?g[x]:S/T,s.addColorStop(A,p[x]),S++}}return s}function m(e,t,r,n,a,o,s){var h=r.text,l=r.fontProperties;t.translate(n,a),t.scale(o,o);var f=s.strokeThickness/2,u=-s.strokeThickness/2;t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=x(e,t,s,o,[h],r),t.strokeStyle=s.stroke,t.font=s.toFontString(),t.lineWidth=s.strokeThickness,t.textBaseline=s.textBaseline,t.lineJoin=s.lineJoin,t.miterLimit=s.miterLimit,t.fillStyle=x(e,t,s,o,[h],r),t.strokeStyle=s.stroke;var c=s.dropShadowColor,p=(0,i.hex2rgb)("number"==typeof c?c:(0,i.string2hex)(c));s.dropShadow?(t.shadowColor="rgba("+255*p[0]+","+255*p[1]+","+255*p[2]+","+s.dropShadowAlpha+")",t.shadowBlur=s.dropShadowBlur,t.shadowOffsetX=Math.cos(s.dropShadowAngle)*s.dropShadowDistance,t.shadowOffsetY=Math.sin(s.dropShadowAngle)*s.dropShadowDistance):(t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),s.stroke&&s.strokeThickness&&t.strokeText(h,f,u+r.lineHeight-l.descent),s.fill&&t.fillText(h,f,u+r.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}function v(e){"string"==typeof e&&(e=[e]);for(var t=[],r=0,i=e.length;r<i;r++){var n=e[r];if(Array.isArray(n)){if(2!==n.length)throw new Error("[BitmapFont]: Invalid character range length, expecting 2 got "+n.length+".");var a=n[0].charCodeAt(0),o=n[1].charCodeAt(0);if(o<a)throw new Error("[BitmapFont]: Invalid character range.");for(var s=a,h=o;s<=h;s++)t.push(String.fromCharCode(s))}else t.push.apply(t,n.split(""))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}var y=function(){function t(t,r){var a=t.info[0],o=t.common[0],s=t.page[0],h=(0,i.getResolutionOfUrl)(s.file),l={};this.font=a.face,this.size=a.size,this.lineHeight=o.lineHeight/h,this.chars={},this.pageTextures=l;for(var f=0;f<t.page.length;f++){var u=t.page[f],c=u.id,p=u.file;l[c]=r instanceof Array?r[f]:r[p]}for(f=0;f<t.char.length;f++){var g=t.char[f],d=(c=g.id,g.page),x=t.char[f],m=x.x,v=x.y,y=x.width,b=x.height,_=x.xoffset,w=x.yoffset,T=x.xadvance;m/=h,v/=h,y/=h,b/=h,_/=h,w/=h,T/=h;var S=new e.Rectangle(m+l[d].frame.x/h,v+l[d].frame.y/h,y,b);this.chars[c]={xOffset:_,yOffset:w,xAdvance:T,kerning:{},texture:new n.Texture(l[d].baseTexture,S),page:d}}for(f=0;f<t.kerning.length;f++){var A=t.kerning[f],I=A.first,P=A.second,O=A.amount;I/=h,P/=h,O/=h,this.chars[P]&&(this.chars[P].kerning[I]=O)}}return t.prototype.destroy=function(){for(var e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(var e in this.pageTextures)this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null},t.install=function(e,r){var i;if(e instanceof f)i=e;else{var a=d(e);if(!a)throw new Error("Unrecognized data format for font.");i=a.parse(e)}r instanceof n.Texture&&(r=[r]);var o=new t(i,r);return t.available[o.font]=o,o},t.uninstall=function(e){var r=t.available[e];if(!r)throw new Error("No font found named '"+e+"'");r.destroy(),delete t.available[e]},t.from=function(e,r,i){if(!e)throw new Error("[BitmapFont] Property `name` is required.");var o=Object.assign({},t.defaultOptions,i),s=o.chars,h=o.padding,l=o.resolution,u=o.textureWidth,c=o.textureHeight,p=v(s),g=r instanceof a.TextStyle?r:new a.TextStyle(r),d=u,x=new f;x.info[0]={face:g.fontFamily,size:g.fontSize},x.common[0]={lineHeight:g.fontSize};for(var y,b,_,w=0,T=0,S=0,A=[],I=0;I<p.length;I++){y||((y=document.createElement("canvas")).width=u,y.height=c,b=y.getContext("2d"),_=new n.BaseTexture(y,{resolution:l}),A.push(new n.Texture(_)),x.page.push({id:A.length-1,file:""}));var P=a.TextMetrics.measureText(p[I],g,!1,y),O=P.width,B=Math.ceil(P.height),E=Math.ceil(("italic"===g.fontStyle?2:1)*O);if(T>=c-B*l){if(0===T)throw new Error("[BitmapFont] textureHeight "+c+"px is too small for "+g.fontSize+"px fonts");--I,y=null,b=null,_=null,T=0,w=0,S=0}else if(S=Math.max(B+P.fontProperties.descent,S),E*l+w>=d)--I,T+=S*l,T=Math.ceil(T),w=0,S=0;else{m(y,b,P,w,T,l,g);var M=P.text.charCodeAt(0);x.char.push({id:M,page:A.length-1,x:w/l,y:T/l,width:E,height:B,xoffset:0,yoffset:0,xadvance:Math.ceil(O-(g.dropShadow?g.dropShadowDistance:0)-(g.stroke?g.strokeThickness:0))}),w+=(E+2*h)*l,w=Math.ceil(w)}}var k=new t(x,A);return void 0!==t.available[e]&&t.uninstall(e),t.available[e]=k,k},t.ALPHA=[["a","z"],["A","Z"]," "],t.NUMERIC=[["0","9"]],t.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],t.ASCII=[[" ","~"]],t.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:t.ALPHANUMERIC},t.available={},t}();exports.BitmapFont=y;var b=[],_=[],w=function(a){function o(r,n){void 0===n&&(n={});var s=a.call(this)||this;s._tint=16777215,n.font&&((0,i.deprecation)("5.3.0","PIXI.BitmapText constructor style.font property is deprecated."),s._upgradeStyle(n));var h=Object.assign({},o.styleDefaults,n),l=h.align,f=h.tint,u=h.maxWidth,c=h.letterSpacing,p=h.fontName,g=h.fontSize;if(!y.available[p])throw new Error('Missing BitmapFont "'+p+'"');return s._activePagesMeshData=[],s._textWidth=0,s._textHeight=0,s._align=l,s._tint=f,s._fontName=p,s._fontSize=g||y.available[p].size,s._text=r,s._maxWidth=u,s._maxLineHeight=0,s._letterSpacing=c,s._anchor=new e.ObservablePoint(function(){s.dirty=!0},s,0,0),s._roundPixels=t.settings.ROUND_PIXELS,s.dirty=!0,s._textureCache={},s}return l(o,a),o.prototype.updateText=function(){for(var t,a=y.available[this._fontName],o=this._fontSize/a.size,s=new e.Point,h=[],l=[],f=this._text.replace(/(?:\r\n|\r)/g,"\n")||" ",u=f.length,c=this._maxWidth*a.size/this._fontSize,p=null,g=0,d=0,x=0,m=-1,v=0,w=0,T=0,S=0;S<u;S++){var A=f.charCodeAt(S),I=f.charAt(S);if(/(?:\s)/.test(I)&&(m=S,v=g),"\r"!==I&&"\n"!==I){var P=a.chars[A];if(P){p&&P.kerning[p]&&(s.x+=P.kerning[p]);var O=_.pop()||{texture:n.Texture.EMPTY,line:0,charCode:0,position:new e.Point};O.texture=P.texture,O.line=x,O.charCode=A,O.position.x=s.x+P.xOffset+this._letterSpacing/2,O.position.y=s.y+P.yOffset,h.push(O),s.x+=P.xAdvance+this._letterSpacing,g=s.x,T=Math.max(T,P.yOffset+P.texture.height),p=A,-1!==m&&c>0&&s.x>c&&(++w,(0,i.removeItems)(h,1+m-w,1+S-m),S=m,m=-1,l.push(v),d=Math.max(d,v),x++,s.x=0,s.y+=a.lineHeight,p=null)}}else l.push(g),d=Math.max(d,g),++x,++w,s.x=0,s.y+=a.lineHeight,p=null}var B=f.charAt(f.length-1);"\r"!==B&&"\n"!==B&&(/(?:\s)/.test(B)&&(g=v),l.push(g),d=Math.max(d,g));var E=[];for(S=0;S<=x;S++){var M=0;"right"===this._align?M=d-l[S]:"center"===this._align&&(M=(d-l[S])/2),E.push(M)}var k=h.length,z={},C=[],F=this._activePagesMeshData;for(S=0;S<F.length;S++)b.push(F[S]);for(S=0;S<k;S++){var H=(q=h[S].texture).baseTexture.uid;if(!z[H]){if(!(K=b.pop())){var L=new r.MeshGeometry,N=new r.MeshMaterial(n.Texture.EMPTY);K={index:0,indexCount:0,vertexCount:0,uvsCount:0,total:0,mesh:new r.Mesh(L,N),vertices:null,uvs:null,indices:null}}K.index=0,K.indexCount=0,K.vertexCount=0,K.uvsCount=0,K.total=0;var j=this._textureCache;j[H]=j[H]||new n.Texture(q.baseTexture),K.mesh.texture=j[H],K.mesh.tint=this._tint,C.push(K),z[H]=K}z[H].total++}for(S=0;S<F.length;S++)-1===C.indexOf(F[S])&&this.removeChild(F[S].mesh);for(S=0;S<C.length;S++)C[S].mesh.parent!==this&&this.addChild(C[S].mesh);for(var S in this._activePagesMeshData=C,z){var D=(K=z[S]).total;if(!((null===(t=K.indices)||void 0===t?void 0:t.length)>6*D)||K.vertices.length<2*r.Mesh.BATCHABLE_SIZE)K.vertices=new Float32Array(8*D),K.uvs=new Float32Array(8*D),K.indices=new Uint16Array(6*D);else for(var W=K.total,U=K.vertices,R=4*W*2;R<U.length;R++)U[R]=0;K.mesh.size=6*D}for(S=0;S<k;S++){var X=(I=h[S]).position.x+E[I.line];this._roundPixels&&(X=Math.round(X));var q,G=X*o,Y=I.position.y*o,J=z[(q=I.texture).baseTexture.uid],Z=q.frame,$=q._uvs,V=J.index++;J.indices[6*V+0]=0+4*V,J.indices[6*V+1]=1+4*V,J.indices[6*V+2]=2+4*V,J.indices[6*V+3]=0+4*V,J.indices[6*V+4]=2+4*V,J.indices[6*V+5]=3+4*V,J.vertices[8*V+0]=G,J.vertices[8*V+1]=Y,J.vertices[8*V+2]=G+Z.width*o,J.vertices[8*V+3]=Y,J.vertices[8*V+4]=G+Z.width*o,J.vertices[8*V+5]=Y+Z.height*o,J.vertices[8*V+6]=G,J.vertices[8*V+7]=Y+Z.height*o,J.uvs[8*V+0]=$.x0,J.uvs[8*V+1]=$.y0,J.uvs[8*V+2]=$.x1,J.uvs[8*V+3]=$.y1,J.uvs[8*V+4]=$.x2,J.uvs[8*V+5]=$.y2,J.uvs[8*V+6]=$.x3,J.uvs[8*V+7]=$.y3}for(var S in this._textWidth=d*o,this._textHeight=(s.y+a.lineHeight)*o,z){var K=z[S];if(0!==this.anchor.x||0!==this.anchor.y)for(var Q=0,ee=this._textWidth*this.anchor.x,te=this._textHeight*this.anchor.y,re=0;re<K.total;re++)K.vertices[Q++]-=ee,K.vertices[Q++]-=te,K.vertices[Q++]-=ee,K.vertices[Q++]-=te,K.vertices[Q++]-=ee,K.vertices[Q++]-=te,K.vertices[Q++]-=ee,K.vertices[Q++]-=te;this._maxLineHeight=T*o;var ie=K.mesh.geometry.getBuffer("aVertexPosition"),ne=K.mesh.geometry.getBuffer("aTextureCoord"),ae=K.mesh.geometry.getIndex();ie.data=K.vertices,ne.data=K.uvs,ae.data=K.indices,ie.update(),ne.update(),ae.update()}for(S=0;S<h.length;S++)_.push(h[S])},o.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},o.prototype.getLocalBounds=function(){return this.validate(),a.prototype.getLocalBounds.call(this)},o.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},Object.defineProperty(o.prototype,"tint",{get:function(){return this._tint},set:function(e){if(this._tint!==e){this._tint=e;for(var t=0;t<this._activePagesMeshData.length;t++)this._activePagesMeshData[t].mesh.tint=e}},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"align",{get:function(){return this._align},set:function(e){this._align!==e&&(this._align=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontName",{get:function(){return this._fontName},set:function(e){if(!y.available[e])throw new Error('Missing BitmapFont "'+e+'"');this._fontName!==e&&(this._fontName=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){this._fontSize!==e&&(this._fontSize=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"anchor",{get:function(){return this._anchor},set:function(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"text",{get:function(){return this._text},set:function(e){e=String(null==e?"":e),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){this._maxWidth!==e&&(this._maxWidth=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"maxLineHeight",{get:function(){return this.validate(),this._maxLineHeight},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textWidth",{get:function(){return this.validate(),this._textWidth},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){e!==this._roundPixels&&(this._roundPixels=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"textHeight",{get:function(){return this.validate(),this._textHeight},enumerable:!1,configurable:!0}),o.prototype._upgradeStyle=function(e){if("string"==typeof e.font){var t=e.font.split(" ");e.fontName=1===t.length?t[0]:t.slice(1).join(" "),t.length>=2&&(e.fontSize=parseInt(t[0],10))}else e.fontName=e.font.name,e.fontSize="number"==typeof e.font.size?e.font.size:parseInt(e.font.size,10)},o.prototype.destroy=function(e){var t=this._textureCache;for(var r in t){t[r].destroy(),delete t[r]}this._textureCache=null,a.prototype.destroy.call(this,e)},o.registerFont=function(e,t){return(0,i.deprecation)("5.3.0","PIXI.BitmapText.registerFont is deprecated, use PIXI.BitmapFont.install"),y.install(e,t)},Object.defineProperty(o,"fonts",{get:function(){return(0,i.deprecation)("5.3.0","PIXI.BitmapText.fonts is deprecated, use PIXI.BitmapFont.available"),y.available},enumerable:!1,configurable:!0}),o.styleDefaults={align:"left",tint:16777215,maxWidth:0,letterSpacing:0},o}(o.Container);exports.BitmapText=w;var T=function(){function e(){}return e.add=function(){s.LoaderResource.setExtensionXhrType("fnt",s.LoaderResource.XHR_RESPONSE_TYPE.TEXT)},e.use=function(t,r){var i=d(t.data);if(i)for(var n=e.getBaseUrl(this,t),a=i.parse(t.data),o={},h=function(e){o[e.metadata.pageFile]=e.texture,Object.keys(o).length===a.page.length&&(t.bitmapFont=y.install(a,o),r())},l=0;l<a.page.length;++l){var f=a.page[l].file,u=n+f,c=!1;for(var p in this.resources){var g=this.resources[p];if(g.url===u){g.metadata.pageFile=f,g.texture?h(g):g.onAfterMiddleware.add(h),c=!0;break}}if(!c){var x={crossOrigin:t.crossOrigin,loadType:s.LoaderResource.LOAD_TYPE.IMAGE,metadata:Object.assign({pageFile:f},t.metadata.imageMetadata),parentResource:t};this.add(u,x,h)}}else r()},e.getBaseUrl=function(t,r){var i=r.isDataUrl?"":e.dirname(r.url);return r.isDataUrl&&("."===i&&(i=""),t.baseUrl&&i&&"/"===t.baseUrl.charAt(t.baseUrl.length-1)&&(i+="/")),(i=i.replace(t.baseUrl,""))&&"/"!==i.charAt(i.length-1)&&(i+="/"),i},e.dirname=function(e){var t=e.replace(/\\/g,"/").replace(/\/$/,"").replace(/\/[^\/]*$/,"");return t===e?".":""===t?"/":t},e}();exports.BitmapFontLoader=T;
},{"@pixi/math":"w9h1","@pixi/settings":"Xe2x","@pixi/mesh":"KkZL","@pixi/utils":"X4iF","@pixi/core":"lj2a","@pixi/text":"aZY8","@pixi/display":"qvzw","@pixi/loaders":"bw5V"}],"RZoz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AlphaFilter=void 0;var r=require("@pixi/core"),t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,t){r.__proto__=t}||function(r,t){for(var e in t)t.hasOwnProperty(e)&&(r[e]=t[e])})(r,e)};function e(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}var o="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float uAlpha;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;\n}\n",n=function(t){function n(e){void 0===e&&(e=1);var n=t.call(this,r.defaultVertex,o,{uAlpha:1})||this;return n.alpha=e,n}return e(n,t),Object.defineProperty(n.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(r){this.uniforms.uAlpha=r},enumerable:!1,configurable:!0}),n}(r.Filter);exports.AlphaFilter=n;
},{"@pixi/core":"lj2a"}],"WUS5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BlurFilterPass=exports.BlurFilter=void 0;var t=require("@pixi/core"),e=require("@pixi/settings"),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function i(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var n="\n    attribute vec2 aVertexPosition;\n\n    uniform mat3 projectionMatrix;\n\n    uniform float strength;\n\n    varying vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 inputSize;\n    uniform vec4 outputFrame;\n\n    vec4 filterVertexPosition( void )\n    {\n        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n    }\n\n    vec2 filterTextureCoord( void )\n    {\n        return aVertexPosition * (outputFrame.zw * inputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }";function o(t,e){var r,i=Math.ceil(t/2),o=n,E="";r=e?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(var u=0;u<t;u++){var l=r.replace("%index%",u.toString());E+=l=l.replace("%sampleIndex%",u-(i-1)+".0"),E+="\n"}return o=(o=o.replace("%blur%",E)).replace("%size%",t.toString())}var E,u,l,_,s,T,a,N,O,A,R,P,L,p,I,h,c,S={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},d=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join("\n");function f(t){for(var e,r=S[t],i=r.length,n=d,o="",E=0;E<t;E++){var u="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",E.toString());e=E,E>=i&&(e=t-E-1),o+=u=u.replace("%value%",r[e].toString()),o+="\n"}return n=(n=n.replace("%blur%",o)).replace("%size%",t.toString())}!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(E||(E={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(u||(u={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(l||(l={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(_||(_={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(s||(s={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(T||(T={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(a||(a={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(N||(N={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(O||(O={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(A||(A={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(R||(R={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(P||(P={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(L||(L={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(p||(p={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(I||(I={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(h||(h={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(c||(c={}));var U=function(t){function r(r,i,n,E,u){void 0===i&&(i=8),void 0===n&&(n=4),void 0===E&&(E=e.settings.FILTER_RESOLUTION),void 0===u&&(u=5);var l=this,_=o(u,r),s=f(u);return(l=t.call(this,_,s)||this).horizontal=r,l.resolution=E,l._quality=0,l.quality=n,l.blur=i,l}return i(r,t),r.prototype.apply=function(t,e,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/e.width):this.uniforms.strength=1/r.height*(r.height/e.height):this.horizontal?this.uniforms.strength=1/t.renderer.width*(t.renderer.width/e.width):this.uniforms.strength=1/t.renderer.height*(t.renderer.height/e.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)t.applyFilter(this,e,r,i);else{var n=t.getFilterTexture(),o=t.renderer,E=e,u=n;this.state.blend=!1,t.applyFilter(this,E,u,L.CLEAR);for(var l=1;l<this.passes-1;l++){t.bindAndClear(E,L.BLIT),this.uniforms.uSampler=u;var _=u;u=E,E=_,o.shader.bind(this),o.geometry.draw(5)}this.state.blend=!0,t.applyFilter(this,u,r,i),t.returnFilterTexture(n)}},Object.defineProperty(r.prototype,"blur",{get:function(){return this.strength},set:function(t){this.padding=1+2*Math.abs(t),this.strength=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"quality",{get:function(){return this._quality},set:function(t){this._quality=t,this.passes=t},enumerable:!1,configurable:!0}),r}(t.Filter);exports.BlurFilterPass=U;var b=function(t){function r(r,i,n,o){void 0===r&&(r=8),void 0===i&&(i=4),void 0===n&&(n=e.settings.FILTER_RESOLUTION),void 0===o&&(o=5);var E=t.call(this)||this;return E.blurXFilter=new U(!0,r,i,n,o),E.blurYFilter=new U(!1,r,i,n,o),E.resolution=n,E.quality=i,E.blur=r,E.repeatEdgePixels=!1,E}return i(r,t),r.prototype.apply=function(t,e,r,i){var n=Math.abs(this.blurXFilter.strength),o=Math.abs(this.blurYFilter.strength);if(n&&o){var E=t.getFilterTexture();this.blurXFilter.apply(t,e,E,L.CLEAR),this.blurYFilter.apply(t,E,r,i),t.returnFilterTexture(E)}else o?this.blurYFilter.apply(t,e,r,i):this.blurXFilter.apply(t,e,r,i)},r.prototype.updatePadding=function(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))},Object.defineProperty(r.prototype,"blur",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"quality",{get:function(){return this.blurXFilter.quality},set:function(t){this.blurXFilter.quality=this.blurYFilter.quality=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blurX",{get:function(){return this.blurXFilter.blur},set:function(t){this.blurXFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blurY",{get:function(){return this.blurYFilter.blur},set:function(t){this.blurYFilter.blur=t,this.updatePadding()},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blendMode",{get:function(){return this.blurYFilter.blendMode},set:function(t){this.blurYFilter.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"repeatEdgePixels",{get:function(){return this._repeatEdgePixels},set:function(t){this._repeatEdgePixels=t,this.updatePadding()},enumerable:!1,configurable:!0}),r}(t.Filter);exports.BlurFilter=b;
},{"@pixi/core":"lj2a","@pixi/settings":"Xe2x"}],"ts1g":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorMatrixFilter=void 0;var t=require("@pixi/core"),r=function(t,o){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(t,o)};function o(t,o){function n(){this.constructor=t}r(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}var n="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[20];\nuniform float uAlpha;\n\nvoid main(void)\n{\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    if (uAlpha == 0.0) {\n        gl_FragColor = c;\n        return;\n    }\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (c.a > 0.0) {\n      c.rgb /= c.a;\n    }\n\n    vec4 result;\n\n    result.r = (m[0] * c.r);\n        result.r += (m[1] * c.g);\n        result.r += (m[2] * c.b);\n        result.r += (m[3] * c.a);\n        result.r += m[4];\n\n    result.g = (m[5] * c.r);\n        result.g += (m[6] * c.g);\n        result.g += (m[7] * c.b);\n        result.g += (m[8] * c.a);\n        result.g += m[9];\n\n    result.b = (m[10] * c.r);\n       result.b += (m[11] * c.g);\n       result.b += (m[12] * c.b);\n       result.b += (m[13] * c.a);\n       result.b += m[14];\n\n    result.a = (m[15] * c.r);\n       result.a += (m[16] * c.g);\n       result.a += (m[17] * c.b);\n       result.a += (m[18] * c.a);\n       result.a += m[19];\n\n    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);\n\n    // Premultiply alpha again.\n    rgb *= result.a;\n\n    gl_FragColor = vec4(rgb, result.a);\n}\n",e=function(r){function e(){var o=this,e={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return(o=r.call(this,t.defaultFilterVertex,n,e)||this).alpha=1,o}return o(e,r),e.prototype._loadMatrix=function(t,r){void 0===r&&(r=!1);var o=t;r&&(this._multiply(o,this.uniforms.m,t),o=this._colorMatrix(o)),this.uniforms.m=o},e.prototype._multiply=function(t,r,o){return t[0]=r[0]*o[0]+r[1]*o[5]+r[2]*o[10]+r[3]*o[15],t[1]=r[0]*o[1]+r[1]*o[6]+r[2]*o[11]+r[3]*o[16],t[2]=r[0]*o[2]+r[1]*o[7]+r[2]*o[12]+r[3]*o[17],t[3]=r[0]*o[3]+r[1]*o[8]+r[2]*o[13]+r[3]*o[18],t[4]=r[0]*o[4]+r[1]*o[9]+r[2]*o[14]+r[3]*o[19]+r[4],t[5]=r[5]*o[0]+r[6]*o[5]+r[7]*o[10]+r[8]*o[15],t[6]=r[5]*o[1]+r[6]*o[6]+r[7]*o[11]+r[8]*o[16],t[7]=r[5]*o[2]+r[6]*o[7]+r[7]*o[12]+r[8]*o[17],t[8]=r[5]*o[3]+r[6]*o[8]+r[7]*o[13]+r[8]*o[18],t[9]=r[5]*o[4]+r[6]*o[9]+r[7]*o[14]+r[8]*o[19]+r[9],t[10]=r[10]*o[0]+r[11]*o[5]+r[12]*o[10]+r[13]*o[15],t[11]=r[10]*o[1]+r[11]*o[6]+r[12]*o[11]+r[13]*o[16],t[12]=r[10]*o[2]+r[11]*o[7]+r[12]*o[12]+r[13]*o[17],t[13]=r[10]*o[3]+r[11]*o[8]+r[12]*o[13]+r[13]*o[18],t[14]=r[10]*o[4]+r[11]*o[9]+r[12]*o[14]+r[13]*o[19]+r[14],t[15]=r[15]*o[0]+r[16]*o[5]+r[17]*o[10]+r[18]*o[15],t[16]=r[15]*o[1]+r[16]*o[6]+r[17]*o[11]+r[18]*o[16],t[17]=r[15]*o[2]+r[16]*o[7]+r[17]*o[12]+r[18]*o[17],t[18]=r[15]*o[3]+r[16]*o[8]+r[17]*o[13]+r[18]*o[18],t[19]=r[15]*o[4]+r[16]*o[9]+r[17]*o[14]+r[18]*o[19]+r[19],t},e.prototype._colorMatrix=function(t){var r=new Float32Array(t);return r[4]/=255,r[9]/=255,r[14]/=255,r[19]/=255,r},e.prototype.brightness=function(t,r){var o=[t,0,0,0,0,0,t,0,0,0,0,0,t,0,0,0,0,0,1,0];this._loadMatrix(o,r)},e.prototype.greyscale=function(t,r){var o=[t,t,t,0,0,t,t,t,0,0,t,t,t,0,0,0,0,0,1,0];this._loadMatrix(o,r)},e.prototype.blackAndWhite=function(t){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],t)},e.prototype.hue=function(t,r){t=(t||0)/180*Math.PI;var o=Math.cos(t),n=Math.sin(t),e=1/3,i=(0,Math.sqrt)(e),a=[o+(1-o)*e,e*(1-o)-i*n,e*(1-o)+i*n,0,0,e*(1-o)+i*n,o+e*(1-o),e*(1-o)-i*n,0,0,e*(1-o)-i*n,e*(1-o)+i*n,o+e*(1-o),0,0,0,0,0,1,0];this._loadMatrix(a,r)},e.prototype.contrast=function(t,r){var o=(t||0)+1,n=-.5*(o-1),e=[o,0,0,0,n,0,o,0,0,n,0,0,o,0,n,0,0,0,1,0];this._loadMatrix(e,r)},e.prototype.saturate=function(t,r){void 0===t&&(t=0);var o=2*t/3+1,n=-.5*(o-1),e=[o,n,n,0,0,n,o,n,0,0,n,n,o,0,0,0,0,0,1,0];this._loadMatrix(e,r)},e.prototype.desaturate=function(){this.saturate(-1)},e.prototype.negative=function(t){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],t)},e.prototype.sepia=function(t){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],t)},e.prototype.technicolor=function(t){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],t)},e.prototype.polaroid=function(t){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],t)},e.prototype.toBGR=function(t){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],t)},e.prototype.kodachrome=function(t){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],t)},e.prototype.browni=function(t){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],t)},e.prototype.vintage=function(t){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],t)},e.prototype.colorTone=function(t,r,o,n,e){var i=((o=o||16770432)>>16&255)/255,a=(o>>8&255)/255,u=(255&o)/255,l=((n=n||3375104)>>16&255)/255,p=(n>>8&255)/255,s=(255&n)/255,c=[.3,.59,.11,0,0,i,a,u,t=t||.2,0,l,p,s,r=r||.15,0,i-l,a-p,u-s,0,0];this._loadMatrix(c,e)},e.prototype.night=function(t,r){var o=[-2*(t=t||.1),-t,0,0,0,-t,0,t,0,0,0,t,2*t,0,0,0,0,0,1,0];this._loadMatrix(o,r)},e.prototype.predator=function(t,r){var o=[11.224130630493164*t,-4.794486999511719*t,-2.8746118545532227*t,0*t,.40342438220977783*t,-3.6330697536468506*t,9.193157196044922*t,-2.951810836791992*t,0*t,-1.316135048866272*t,-3.2184197902679443*t,-4.2375030517578125*t,7.476448059082031*t,0*t,.8044459223747253*t,0,0,0,1,0];this._loadMatrix(o,r)},e.prototype.lsd=function(t){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],t)},e.prototype.reset=function(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)},Object.defineProperty(e.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(t){this.uniforms.m=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(t){this.uniforms.uAlpha=t},enumerable:!1,configurable:!0}),e}(t.Filter);exports.ColorMatrixFilter=e,e.prototype.grayscale=e.prototype.greyscale;
},{"@pixi/core":"lj2a"}],"XNHP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DisplacementFilter=void 0;var t=require("@pixi/core"),r=require("@pixi/math"),e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(t,r)};function i(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}var n="varying vec2 vFilterCoord;\nvarying vec2 vTextureCoord;\n\nuniform vec2 scale;\nuniform mat2 rotation;\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nuniform highp vec4 inputSize;\nuniform vec4 inputClamp;\n\nvoid main(void)\n{\n  vec4 map =  texture2D(mapSampler, vFilterCoord);\n\n  map -= 0.5;\n  map.xy = scale * inputSize.zw * (rotation * map.xy);\n\n  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));\n}\n",o="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\nuniform mat3 filterMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vFilterCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n\tgl_Position = filterVertexPosition();\n\tvTextureCoord = filterTextureCoord();\n\tvFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;\n}\n",a=function(t){function e(e,i){var a=this,u=new r.Matrix;return e.renderable=!1,(a=t.call(this,o,n,{mapSampler:e._texture,filterMatrix:u,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])})||this).maskSprite=e,a.maskMatrix=u,null==i&&(i=20),a.scale=new r.Point(i,i),a}return i(e,t),e.prototype.apply=function(t,r,e,i){this.uniforms.filterMatrix=t.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;var n=this.maskSprite.worldTransform,o=Math.sqrt(n.a*n.a+n.b*n.b),a=Math.sqrt(n.c*n.c+n.d*n.d);0!==o&&0!==a&&(this.uniforms.rotation[0]=n.a/o,this.uniforms.rotation[1]=n.b/o,this.uniforms.rotation[2]=n.c/a,this.uniforms.rotation[3]=n.d/a),t.applyFilter(this,r,e,i)},Object.defineProperty(e.prototype,"map",{get:function(){return this.uniforms.mapSampler},set:function(t){this.uniforms.mapSampler=t},enumerable:!1,configurable:!0}),e}(t.Filter);exports.DisplacementFilter=a;
},{"@pixi/core":"lj2a","@pixi/math":"w9h1"}],"d2iI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FXAAFilter=void 0;var n=require("@pixi/core"),e=function(n,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r])})(n,r)};function r(n,r){function o(){this.constructor=n}e(n,r),n.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}var o="\nattribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\n\nuniform vec4 inputPixel;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvoid texcoords(vec2 fragCoord, vec2 inverseVP,\n               out vec2 v_rgbNW, out vec2 v_rgbNE,\n               out vec2 v_rgbSW, out vec2 v_rgbSE,\n               out vec2 v_rgbM) {\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void) {\n\n   gl_Position = filterVertexPosition();\n\n   vFragCoord = aVertexPosition * outputFrame.zw;\n\n   texcoords(vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",t='varying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nvarying vec2 vFragCoord;\nuniform sampler2D uSampler;\nuniform highp vec4 inputPixel;\n\n\n/**\n Basic FXAA implementation based on the code on geeks3d.com with the\n modification that the texture2DLod stuff was removed since it\'s\n unsupported by WebGL.\n\n --\n\n From:\n https://github.com/mitsuhiko/webgl-meincraft\n\n Copyright (c) 2011 by Armin Ronacher.\n\n Some rights reserved.\n\n Redistribution and use in source and binary forms, with or without\n modification, are permitted provided that the following conditions are\n met:\n\n * Redistributions of source code must retain the above copyright\n notice, this list of conditions and the following disclaimer.\n\n * Redistributions in binary form must reproduce the above\n copyright notice, this list of conditions and the following\n disclaimer in the documentation and/or other materials provided\n with the distribution.\n\n * The names of the contributors may not be used to endorse or\n promote products derived from this software without specific\n prior written permission.\n\n THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\n LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\n A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\n OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\n THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n#ifndef FXAA_REDUCE_MIN\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n#define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,\n          vec2 v_rgbNW, vec2 v_rgbNE,\n          vec2 v_rgbSW, vec2 v_rgbSE,\n          vec2 v_rgbM) {\n    vec4 color;\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n                  dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\nvoid main() {\n\n      vec4 color;\n\n      color = fxaa(uSampler, vFragCoord, inputPixel.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n      gl_FragColor = color;\n}\n',i=function(n){function e(){return n.call(this,o,t)||this}return r(e,n),e}(n.Filter);exports.FXAAFilter=i;
},{"@pixi/core":"lj2a"}],"Y0eQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NoiseFilter=void 0;var e=require("@pixi/core"),o=function(e,r){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var r in o)o.hasOwnProperty(r)&&(e[r]=o[r])})(e,r)};function r(e,r){function n(){this.constructor=e}o(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n="precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float uNoise;\nuniform float uSeed;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n    float randomValue = rand(gl_FragCoord.xy * uSeed);\n    float diff = (randomValue - 0.5) * uNoise;\n\n    // Un-premultiply alpha before applying the color matrix. See issue #3539.\n    if (color.a > 0.0) {\n        color.rgb /= color.a;\n    }\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    // Premultiply alpha again.\n    color.rgb *= color.a;\n\n    gl_FragColor = color;\n}\n",t=function(o){function t(r,t){void 0===r&&(r=.5),void 0===t&&(t=Math.random());var i=o.call(this,e.defaultFilterVertex,n,{uNoise:0,uSeed:0})||this;return i.noise=r,i.seed=t,i}return r(t,o),Object.defineProperty(t.prototype,"noise",{get:function(){return this.uniforms.uNoise},set:function(e){this.uniforms.uNoise=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"seed",{get:function(){return this.uniforms.uSeed},set:function(e){this.uniforms.uSeed=e},enumerable:!1,configurable:!0}),t}(e.Filter);exports.NoiseFilter=t;
},{"@pixi/core":"lj2a"}],"vc4X":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CacheData=void 0;var t=require("@pixi/core"),a=require("@pixi/sprite"),e=require("@pixi/display"),i=require("@pixi/math"),r=require("@pixi/utils"),s=require("@pixi/settings"),n=new i.Matrix;e.DisplayObject.prototype._cacheAsBitmap=!1,e.DisplayObject.prototype._cacheData=null;var h=function(){return function(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}();exports.CacheData=h,Object.defineProperties(e.DisplayObject.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(t){var a;this._cacheAsBitmap!==t&&(this._cacheAsBitmap=t,t?(this._cacheData||(this._cacheData=new h),(a=this._cacheData).originalRender=this.render,a.originalRenderCanvas=this.renderCanvas,a.originalUpdateTransform=this.updateTransform,a.originalCalculateBounds=this.calculateBounds,a.originalGetLocalBounds=this.getLocalBounds,a.originalDestroy=this.destroy,a.originalContainsPoint=this.containsPoint,a.originalMask=this._mask,a.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((a=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=a.originalRender,this.renderCanvas=a.originalRenderCanvas,this.calculateBounds=a.originalCalculateBounds,this.getLocalBounds=a.originalGetLocalBounds,this.destroy=a.originalDestroy,this.updateTransform=a.originalUpdateTransform,this.containsPoint=a.originalContainsPoint,this._mask=a.originalMask,this.filterArea=a.originalFilterArea))}}}),e.DisplayObject.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))},e.DisplayObject.prototype._initCachedDisplayObject=function(e){if(!this._cacheData||!this._cacheData.sprite){var i=this.alpha;this.alpha=1,e.batch.flush();var h=this.getLocalBounds(null,!0).clone();if(this.filters){var o=this.filters[0].padding;h.pad(o)}h.ceil(s.settings.RESOLUTION);var c=e.renderTexture.current,l=e.renderTexture.sourceFrame.clone(),d=e.projection.transform,p=t.RenderTexture.create({width:h.width,height:h.height}),u="cacheAsBitmap_"+(0,r.uid)();this._cacheData.textureCacheId=u,t.BaseTexture.addToCache(p.baseTexture,u),t.Texture.addToCache(p,u);var _=this.transform.localTransform.copyTo(n).invert().translate(-h.x,-h.y);this.render=this._cacheData.originalRender,e.render(this,p,!0,_,!1),e.projection.transform=d,e.renderTexture.bind(c,l),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var D=new a.Sprite(p);D.transform.worldTransform=this.transform.worldTransform,D.anchor.x=-h.x/h.width,D.anchor.y=-h.y/h.height,D.alpha=i,D._bounds=this._bounds,this._cacheData.sprite=D,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=D.containsPoint.bind(D)}},e.DisplayObject.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))},e.DisplayObject.prototype._initCachedDisplayObjectCanvas=function(e){if(!this._cacheData||!this._cacheData.sprite){var i=this.getLocalBounds(null,!0),h=this.alpha;this.alpha=1;var o=e.context,c=e._projTransform;i.ceil(s.settings.RESOLUTION);var l=t.RenderTexture.create({width:i.width,height:i.height}),d="cacheAsBitmap_"+(0,r.uid)();this._cacheData.textureCacheId=d,t.BaseTexture.addToCache(l.baseTexture,d),t.Texture.addToCache(l,d);var p=n;this.transform.localTransform.copyTo(p),p.invert(),p.tx-=i.x,p.ty-=i.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,l,!0,p,!1),e.context=o,e._projTransform=c,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null;var u=new a.Sprite(l);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-i.x/i.width,u.anchor.y=-i.y/i.height,u.alpha=h,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}},e.DisplayObject.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},e.DisplayObject.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},e.DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,t.BaseTexture.removeFromCache(this._cacheData.textureCacheId),t.Texture.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},e.DisplayObject.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};
},{"@pixi/core":"lj2a","@pixi/sprite":"XG9w","@pixi/display":"qvzw","@pixi/math":"w9h1","@pixi/utils":"X4iF","@pixi/settings":"Xe2x"}],"k2x1":[function(require,module,exports) {
"use strict";var i=require("@pixi/display");i.DisplayObject.prototype.name=null,i.Container.prototype.getChildByName=function(i,e){for(var r=0,t=this.children.length;r<t;r++)if(this.children[r].name===i)return this.children[r];if(e)for(r=0,t=this.children.length;r<t;r++){if(this.children[r].getChildByName){var n=this.children[r].getChildByName(i,!0);if(n)return n}}return null};
},{"@pixi/display":"qvzw"}],"hqMH":[function(require,module,exports) {
"use strict";var i=require("@pixi/display"),t=require("@pixi/math");i.DisplayObject.prototype.getGlobalPosition=function(i,o){return void 0===i&&(i=new t.Point),void 0===o&&(o=!1),this.parent?this.parent.toGlobal(this.position,i,o):(i.x=this.position.x,i.y=this.position.y),i};
},{"@pixi/display":"qvzw","@pixi/math":"w9h1"}],"vnLX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SimpleRope=exports.SimplePlane=exports.SimpleMesh=exports.RopeGeometry=exports.PlaneGeometry=exports.NineSlicePlane=void 0;var t=require("@pixi/mesh"),e=require("@pixi/constants"),i=require("@pixi/core"),r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function h(t,e){function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var o=function(t){function e(e,i,r,h){void 0===e&&(e=100),void 0===i&&(i=100),void 0===r&&(r=10),void 0===h&&(h=10);var o=t.call(this)||this;return o.segWidth=r,o.segHeight=h,o.width=e,o.height=i,o.build(),o}return h(e,t),e.prototype.build=function(){for(var t=this.segWidth*this.segHeight,e=[],i=[],r=[],h=this.segWidth-1,o=this.segHeight-1,s=this.width/h,n=this.height/o,a=0;a<t;a++){var u=a%this.segWidth,d=a/this.segWidth|0;e.push(u*s,d*n),i.push(u/h,d/o)}var p=h*o;for(a=0;a<p;a++){var f=a%h,g=a/h|0,c=g*this.segWidth+f,l=g*this.segWidth+f+1,_=(g+1)*this.segWidth+f,y=(g+1)*this.segWidth+f+1;r.push(c,l,_,l,y,_)}this.buffers[0].data=new Float32Array(e),this.buffers[1].data=new Float32Array(i),this.indexBuffer.data=new Uint16Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()},e}(t.MeshGeometry);exports.PlaneGeometry=o;var s=function(t){function e(e,i,r){void 0===e&&(e=200),void 0===r&&(r=0);var h=t.call(this,new Float32Array(4*i.length),new Float32Array(4*i.length),new Uint16Array(6*(i.length-1)))||this;return h.points=i,h._width=e,h.textureScale=r,h.build(),h}return h(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),e.prototype.build=function(){var t=this.points;if(t){var e=this.getBuffer("aVertexPosition"),i=this.getBuffer("aTextureCoord"),r=this.getIndex();if(!(t.length<1)){e.data.length/4!==t.length&&(e.data=new Float32Array(4*t.length),i.data=new Float32Array(4*t.length),r.data=new Uint16Array(6*(t.length-1)));var h=i.data,o=r.data;h[0]=0,h[1]=0,h[2]=0,h[3]=1;for(var s=0,n=t[0],a=this._width*this.textureScale,u=t.length,d=0;d<u;d++){var p=4*d;if(this.textureScale>0){var f=n.x-t[d].x,g=n.y-t[d].y,c=Math.sqrt(f*f+g*g);n=t[d],s+=c/a}else s=d/(u-1);h[p]=s,h[p+1]=0,h[p+2]=s,h[p+3]=1}var l=0;for(d=0;d<u-1;d++){p=2*d;o[l++]=p,o[l++]=p+1,o[l++]=p+2,o[l++]=p+2,o[l++]=p+1,o[l++]=p+3}i.update(),r.update(),this.updateVertices()}}},e.prototype.updateVertices=function(){var t=this.points;if(!(t.length<1)){for(var e,i=t[0],r=0,h=0,o=this.buffers[0].data,s=t.length,n=0;n<s;n++){var a=t[n],u=4*n;h=-((e=n<t.length-1?t[n+1]:a).x-i.x),r=e.y-i.y;var d=Math.sqrt(r*r+h*h),p=this.textureScale>0?this.textureScale*this._width/2:this._width/2;r/=d,h/=d,r*=p,h*=p,o[u]=a.x+r,o[u+1]=a.y+h,o[u+2]=a.x-r,o[u+3]=a.y-h,i=a}this.buffers[0].update()}},e.prototype.update=function(){this.textureScale>0?this.build():this.updateVertices()},e}(t.MeshGeometry);exports.RopeGeometry=s;var n=function(i){function r(r,h,o){void 0===o&&(o=0);var n=this,a=new s(r.height,h,o),u=new t.MeshMaterial(r);return o>0&&(r.baseTexture.wrapMode=e.WRAP_MODES.REPEAT),(n=i.call(this,a,u)||this).autoUpdate=!0,n}return h(r,i),r.prototype._render=function(t){var e=this.geometry;(this.autoUpdate||e._width!==this.shader.texture.height)&&(e._width=this.shader.texture.height,e.update()),i.prototype._render.call(this,t)},r}(t.Mesh);exports.SimpleRope=n;var a=function(e){function r(r,h,s){var n=this,a=new o(r.width,r.height,h,s),u=new t.MeshMaterial(i.Texture.WHITE);return(n=e.call(this,a,u)||this).texture=r,n}return h(r,e),r.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID;var t=this.geometry;t.width=this.shader.texture.width,t.height=this.shader.texture.height,t.build()},Object.defineProperty(r.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this._textureID=-1,t.baseTexture.valid?this.textureUpdated():t.once("update",this.textureUpdated,this))},enumerable:!1,configurable:!0}),r.prototype._render=function(t){this._textureID!==this.shader.texture._updateID&&this.textureUpdated(),e.prototype._render.call(this,t)},r.prototype.destroy=function(t){this.shader.texture.off("update",this.textureUpdated,this),e.prototype.destroy.call(this,t)},r}(t.Mesh);exports.SimplePlane=a;var u=function(e){function r(r,h,o,s,n){void 0===r&&(r=i.Texture.EMPTY);var a=this,u=new t.MeshGeometry(h,o,s);u.getBuffer("aVertexPosition").static=!1;var d=new t.MeshMaterial(r);return(a=e.call(this,u,d,null,n)||this).autoUpdate=!0,a}return h(r,e),Object.defineProperty(r.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),r.prototype._render=function(t){this.autoUpdate&&this.geometry.getBuffer("aVertexPosition").update(),e.prototype._render.call(this,t)},r}(t.Mesh);exports.SimpleMesh=u;var d=10,p=function(t){function e(e,r,h,o,s){void 0===r&&(r=d),void 0===h&&(h=d),void 0===o&&(o=d),void 0===s&&(s=d);var n=t.call(this,i.Texture.WHITE,4,4)||this;return n._origWidth=e.orig.width,n._origHeight=e.orig.height,n._width=n._origWidth,n._height=n._origHeight,n._leftWidth=r,n._rightWidth=o,n._topHeight=h,n._bottomHeight=s,n.texture=e,n}return h(e,t),e.prototype.textureUpdated=function(){this._textureID=this.shader.texture._updateID,this._refresh()},Object.defineProperty(e.prototype,"vertices",{get:function(){return this.geometry.getBuffer("aVertexPosition").data},set:function(t){this.geometry.getBuffer("aVertexPosition").data=t},enumerable:!1,configurable:!0}),e.prototype.updateHorizontalVertices=function(){var t=this.vertices,e=this._getMinScale();t[9]=t[11]=t[13]=t[15]=this._topHeight*e,t[17]=t[19]=t[21]=t[23]=this._height-this._bottomHeight*e,t[25]=t[27]=t[29]=t[31]=this._height},e.prototype.updateVerticalVertices=function(){var t=this.vertices,e=this._getMinScale();t[2]=t[10]=t[18]=t[26]=this._leftWidth*e,t[4]=t[12]=t[20]=t[28]=this._width-this._rightWidth*e,t[6]=t[14]=t[22]=t[30]=this._width},e.prototype._getMinScale=function(){var t=this._leftWidth+this._rightWidth,e=this._width>t?1:this._width/t,i=this._topHeight+this._bottomHeight,r=this._height>i?1:this._height/i;return Math.min(e,r)},Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"leftWidth",{get:function(){return this._leftWidth},set:function(t){this._leftWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rightWidth",{get:function(){return this._rightWidth},set:function(t){this._rightWidth=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"topHeight",{get:function(){return this._topHeight},set:function(t){this._topHeight=t,this._refresh()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottomHeight",{get:function(){return this._bottomHeight},set:function(t){this._bottomHeight=t,this._refresh()},enumerable:!1,configurable:!0}),e.prototype._refresh=function(){var t=this.texture,e=this.geometry.buffers[1].data;this._origWidth=t.orig.width,this._origHeight=t.orig.height;var i=1/this._origWidth,r=1/this._origHeight;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1,e[2]=e[10]=e[18]=e[26]=i*this._leftWidth,e[4]=e[12]=e[20]=e[28]=1-i*this._rightWidth,e[9]=e[11]=e[13]=e[15]=r*this._topHeight,e[17]=e[19]=e[21]=e[23]=1-r*this._bottomHeight,this.updateHorizontalVertices(),this.updateVerticalVertices(),this.geometry.buffers[0].update(),this.geometry.buffers[1].update()},e}(a);exports.NineSlicePlane=p;
},{"@pixi/mesh":"KkZL","@pixi/constants":"djkr","@pixi/core":"lj2a"}],"fDWR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnimatedSprite=void 0;var t=require("@pixi/core"),e=require("@pixi/sprite"),r=require("@pixi/ticker"),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function o(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var n=function(e){function i(r,i){void 0===i&&(i=!0);var o=e.call(this,r[0]instanceof t.Texture?r[0]:r[0].texture)||this;return o._textures=null,o._durations=null,o._autoUpdate=i,o._isConnectedToTicker=!1,o.animationSpeed=1,o.loop=!0,o.updateAnchor=!1,o.onComplete=null,o.onFrameChange=null,o.onLoop=null,o._currentTime=0,o._playing=!1,o._previousFrame=null,o.textures=r,o}return o(i,e),i.prototype.stop=function(){this._playing&&(this._playing=!1,this._autoUpdate&&this._isConnectedToTicker&&(r.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1))},i.prototype.play=function(){this._playing||(this._playing=!0,this._autoUpdate&&!this._isConnectedToTicker&&(r.Ticker.shared.add(this.update,this,r.UPDATE_PRIORITY.HIGH),this._isConnectedToTicker=!0))},i.prototype.gotoAndStop=function(t){this.stop();var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture()},i.prototype.gotoAndPlay=function(t){var e=this.currentFrame;this._currentTime=t,e!==this.currentFrame&&this.updateTexture(),this.play()},i.prototype.update=function(t){var e=this.animationSpeed*t,r=this.currentFrame;if(null!==this._durations){var i=this._currentTime%1*this._durations[this.currentFrame];for(i+=e/60*1e3;i<0;)this._currentTime--,i+=this._durations[this.currentFrame];var o=Math.sign(this.animationSpeed*t);for(this._currentTime=Math.floor(this._currentTime);i>=this._durations[this.currentFrame];)i-=this._durations[this.currentFrame]*o,this._currentTime+=o;this._currentTime+=i/this._durations[this.currentFrame]}else this._currentTime+=e;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):r!==this.currentFrame&&(this.loop&&this.onLoop&&(this.animationSpeed>0&&this.currentFrame<r?this.onLoop():this.animationSpeed<0&&this.currentFrame>r&&this.onLoop()),this.updateTexture())},i.prototype.updateTexture=function(){var t=this.currentFrame;this._previousFrame!==t&&(this._previousFrame=t,this._texture=this._textures[t],this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this.uvs=this._texture._uvs.uvsFloat32,this.updateAnchor&&this._anchor.copyFrom(this._texture.defaultAnchor),this.onFrameChange&&this.onFrameChange(this.currentFrame))},i.prototype.destroy=function(t){this.stop(),e.prototype.destroy.call(this,t),this.onComplete=null,this.onFrameChange=null,this.onLoop=null},i.fromFrames=function(e){for(var r=[],o=0;o<e.length;++o)r.push(t.Texture.from(e[o]));return new i(r)},i.fromImages=function(e){for(var r=[],o=0;o<e.length;++o)r.push(t.Texture.from(e[o]));return new i(r)},Object.defineProperty(i.prototype,"totalFrames",{get:function(){return this._textures.length},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"textures",{get:function(){return this._textures},set:function(e){if(e[0]instanceof t.Texture)this._textures=e,this._durations=null;else{this._textures=[],this._durations=[];for(var r=0;r<e.length;r++)this._textures.push(e[r].texture),this._durations.push(e[r].time)}this._previousFrame=null,this.gotoAndStop(0),this.updateTexture()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"currentFrame",{get:function(){var t=Math.floor(this._currentTime)%this._textures.length;return t<0&&(t+=this._textures.length),t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"playing",{get:function(){return this._playing},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(r.Ticker.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._playing&&(r.Ticker.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),i}(e.Sprite);exports.AnimatedSprite=n;
},{"@pixi/core":"lj2a","@pixi/sprite":"XG9w","@pixi/ticker":"AWzT"}],"aQiP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e={VERSION:!0,filters:!0,useDeprecated:!0,utils:!0};exports.useDeprecated=A,exports.utils=exports.filters=exports.VERSION=void 0,require("@pixi/polyfill");var r=E(require("@pixi/utils"));exports.utils=r;var t=require("@pixi/accessibility");Object.keys(t).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===t[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return t[r]}}))});var n=require("@pixi/interaction");Object.keys(n).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===n[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return n[r]}}))});var o=require("@pixi/app");Object.keys(o).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===o[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return o[r]}}))});var i=require("@pixi/core");Object.keys(i).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===i[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return i[r]}}))});var a=require("@pixi/extract");Object.keys(a).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===a[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return a[r]}}))});var s=require("@pixi/loaders");Object.keys(s).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===s[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return s[r]}}))});var c=require("@pixi/particles");Object.keys(c).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===c[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return c[r]}}))});var p=require("@pixi/prepare");Object.keys(p).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===p[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return p[r]}}))});var u=require("@pixi/spritesheet");Object.keys(u).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===u[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return u[r]}}))});var d=require("@pixi/sprite-tiling");Object.keys(d).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===d[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return d[r]}}))});var l=require("@pixi/text-bitmap");Object.keys(l).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===l[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return l[r]}}))});var f=require("@pixi/ticker");Object.keys(f).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===f[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return f[r]}}))});var I=require("@pixi/filter-alpha"),P=require("@pixi/filter-blur"),h=require("@pixi/filter-color-matrix"),m=require("@pixi/filter-displacement"),y=require("@pixi/filter-fxaa"),g=require("@pixi/filter-noise");require("@pixi/mixin-cache-as-bitmap"),require("@pixi/mixin-get-child-by-name"),require("@pixi/mixin-get-global-position");var x=require("@pixi/constants");Object.keys(x).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===x[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return x[r]}}))});var b=require("@pixi/display");Object.keys(b).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===b[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return b[r]}}))});var v=require("@pixi/graphics");Object.keys(v).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===v[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return v[r]}}))});var X=require("@pixi/math");Object.keys(X).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===X[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return X[r]}}))});var O=require("@pixi/mesh");Object.keys(O).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===O[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return O[r]}}))});var S=require("@pixi/mesh-extras");Object.keys(S).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===S[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return S[r]}}))});var j=require("@pixi/runner");Object.keys(j).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===j[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return j[r]}}))});var M=require("@pixi/sprite");Object.keys(M).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===M[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return M[r]}}))});var T=require("@pixi/sprite-animated");Object.keys(T).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===T[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return T[r]}}))});var R=require("@pixi/text");Object.keys(R).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===R[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return R[r]}}))});var _=require("@pixi/settings");function F(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return F=function(){return e},e}function E(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=F();if(r&&r.has(e))return r.get(e);var t={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var i=n?Object.getOwnPropertyDescriptor(e,o):null;i&&(i.get||i.set)?Object.defineProperty(t,o,i):t[o]=e[o]}return t.default=e,r&&r.set(e,t),t}Object.keys(_).forEach(function(r){"default"!==r&&"__esModule"!==r&&(Object.prototype.hasOwnProperty.call(e,r)||r in exports&&exports[r]===_[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return _[r]}}))});var B=function(e,r){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)};function L(e,r){function t(){this.constructor=e}B(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var w="5.0.0";function A(){var e=this;Object.defineProperties(e,{SVG_SIZE:{get:function(){return(0,r.deprecation)(w,"PIXI.utils.SVG_SIZE property has moved to PIXI.resources.SVGResource.SVG_SIZE"),e.SVGResource.SVG_SIZE}},TransformStatic:{get:function(){return(0,r.deprecation)(w,"PIXI.TransformStatic class has been removed, use PIXI.Transform"),e.Transform}},TransformBase:{get:function(){return(0,r.deprecation)(w,"PIXI.TransformBase class has been removed, use PIXI.Transform"),e.Transform}},TRANSFORM_MODE:{get:function(){return(0,r.deprecation)(w,"PIXI.TRANSFORM_MODE property has been removed"),{STATIC:0,DYNAMIC:1}}},WebGLRenderer:{get:function(){return(0,r.deprecation)(w,"PIXI.WebGLRenderer class has moved to PIXI.Renderer"),e.Renderer}},CanvasRenderTarget:{get:function(){return(0,r.deprecation)(w,"PIXI.CanvasRenderTarget class has moved to PIXI.utils.CanvasRenderTarget"),e.utils.CanvasRenderTarget}},loader:{get:function(){return(0,r.deprecation)(w,"PIXI.loader instance has moved to PIXI.Loader.shared"),e.Loader.shared}},FilterManager:{get:function(){return(0,r.deprecation)(w,"PIXI.FilterManager class has moved to PIXI.systems.FilterSystem"),e.systems.FilterSystem}},CanvasTinter:{get:function(){return(0,r.deprecation)("5.2.0","PIXI.CanvasTinter namespace has moved to PIXI.canvasUtils"),e.canvasUtils}},GroupD8:{get:function(){return(0,r.deprecation)("5.2.0","PIXI.GroupD8 namespace has moved to PIXI.groupD8"),e.groupD8}}}),e.accessibility={},Object.defineProperties(e.accessibility,{AccessibilityManager:{get:function(){return(0,r.deprecation)("5.3.0","PIXI.accessibility.AccessibilityManager moved to PIXI.AccessibilityManager"),e.AccessibilityManager}}}),e.interaction={},Object.defineProperties(e.interaction,{InteractionManager:{get:function(){return(0,r.deprecation)("5.3.0","PIXI.interaction.InteractionManager moved to PIXI.InteractionManager"),e.InteractionManager}},InteractionData:{get:function(){return(0,r.deprecation)("5.3.0","PIXI.interaction.InteractionData moved to PIXI.InteractionData"),e.InteractionData}},InteractionEvent:{get:function(){return(0,r.deprecation)("5.3.0","PIXI.interaction.InteractionEvent moved to PIXI.InteractionEvent"),e.InteractionEvent}}}),e.prepare={},Object.defineProperties(e.prepare,{BasePrepare:{get:function(){return(0,r.deprecation)("5.2.1","PIXI.prepare.BasePrepare moved to PIXI.BasePrepare"),e.BasePrepare}},Prepare:{get:function(){return(0,r.deprecation)("5.2.1","PIXI.prepare.Prepare moved to PIXI.Prepare"),e.Prepare}},CanvasPrepare:{get:function(){return(0,r.deprecation)("5.2.1","PIXI.prepare.CanvasPrepare moved to PIXI.CanvasPrepare"),e.CanvasPrepare}}}),e.extract={},Object.defineProperties(e.extract,{Extract:{get:function(){return(0,r.deprecation)("5.2.1","PIXI.extract.Extract moved to PIXI.Extract"),e.Extract}},CanvasExtract:{get:function(){return(0,r.deprecation)("5.2.1","PIXI.extract.CanvasExtract moved to PIXI.CanvasExtract"),e.CanvasExtract}}}),e.extras={},Object.defineProperties(e.extras,{TilingSprite:{get:function(){return(0,r.deprecation)(w,"PIXI.extras.TilingSprite class has moved to PIXI.TilingSprite"),e.TilingSprite}},TilingSpriteRenderer:{get:function(){return(0,r.deprecation)(w,"PIXI.extras.TilingSpriteRenderer class has moved to PIXI.TilingSpriteRenderer"),e.TilingSpriteRenderer}},AnimatedSprite:{get:function(){return(0,r.deprecation)(w,"PIXI.extras.AnimatedSprite class has moved to PIXI.AnimatedSprite"),e.AnimatedSprite}},BitmapText:{get:function(){return(0,r.deprecation)(w,"PIXI.extras.BitmapText class has moved to PIXI.BitmapText"),e.BitmapText}}}),e.TilingSprite.fromFrame=function(t,n,o){return(0,r.deprecation)("5.3.0","TilingSprite.fromFrame is deprecated, use TilingSprite.from"),e.TilingSprite.from(t,{width:n,height:o})},e.TilingSprite.fromImage=function(t,n,o,i){return void 0===i&&(i={}),(0,r.deprecation)("5.3.0","TilingSprite.fromImage is deprecated, use TilingSprite.from"),i&&"object"!=typeof i&&(i={scaleMode:arguments[4],resourceOptions:{crossorigin:arguments[3]}}),i.width=n,i.height=o,e.TilingSprite.from(t,i)},Object.defineProperties(e.utils,{getSvgSize:{get:function(){return(0,r.deprecation)(w,"PIXI.utils.getSvgSize function has moved to PIXI.resources.SVGResource.getSize"),e.resources.SVGResource.getSize}}}),e.mesh={},Object.defineProperties(e.mesh,{Mesh:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.Mesh class has moved to PIXI.SimpleMesh"),e.SimpleMesh}},NineSlicePlane:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.NineSlicePlane class has moved to PIXI.NineSlicePlane"),e.NineSlicePlane}},Plane:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.Plane class has moved to PIXI.SimplePlane"),e.SimplePlane}},Rope:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.Rope class has moved to PIXI.SimpleRope"),e.SimpleRope}},RawMesh:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.RawMesh class has moved to PIXI.Mesh"),e.Mesh}},CanvasMeshRenderer:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.CanvasMeshRenderer class has moved to PIXI.CanvasMeshRenderer"),e.CanvasMeshRenderer}},MeshRenderer:{get:function(){return(0,r.deprecation)(w,"PIXI.mesh.MeshRenderer class has moved to PIXI.MeshRenderer"),e.MeshRenderer}}}),e.particles={},Object.defineProperties(e.particles,{ParticleContainer:{get:function(){return(0,r.deprecation)(w,"PIXI.particles.ParticleContainer class has moved to PIXI.ParticleContainer"),e.ParticleContainer}},ParticleRenderer:{get:function(){return(0,r.deprecation)(w,"PIXI.particles.ParticleRenderer class has moved to PIXI.ParticleRenderer"),e.ParticleRenderer}}}),e.ticker={},Object.defineProperties(e.ticker,{Ticker:{get:function(){return(0,r.deprecation)(w,"PIXI.ticker.Ticker class has moved to PIXI.Ticker"),e.Ticker}},shared:{get:function(){return(0,r.deprecation)(w,"PIXI.ticker.shared instance has moved to PIXI.Ticker.shared"),e.Ticker.shared}}}),e.loaders={},Object.defineProperties(e.loaders,{Loader:{get:function(){return(0,r.deprecation)(w,"PIXI.loaders.Loader class has moved to PIXI.Loader"),e.Loader}},Resource:{get:function(){return(0,r.deprecation)(w,"PIXI.loaders.Resource class has moved to PIXI.LoaderResource"),e.LoaderResource}},bitmapFontParser:{get:function(){return(0,r.deprecation)(w,"PIXI.loaders.bitmapFontParser function has moved to PIXI.BitmapFontLoader.use"),e.BitmapFontLoader.use}},parseBitmapFontData:{get:function(){(0,r.deprecation)(w,"PIXI.loaders.parseBitmapFontData function has removed")}},spritesheetParser:{get:function(){return(0,r.deprecation)(w,"PIXI.loaders.spritesheetParser function has moved to PIXI.SpritesheetLoader.use"),e.SpritesheetLoader.use}},getResourcePath:{get:function(){return(0,r.deprecation)(w,"PIXI.loaders.getResourcePath property has moved to PIXI.SpritesheetLoader.getResourcePath"),e.SpritesheetLoader.getResourcePath}}}),e.Loader.addPixiMiddleware=function(t){return(0,r.deprecation)(w,"PIXI.loaders.Loader.addPixiMiddleware function is deprecated, use PIXI.loaders.Loader.registerPlugin"),e.loaders.Loader.registerPlugin({use:t()})};var t=function(e){return"on"+e.charAt(0).toUpperCase()+e.slice(1)};Object.assign(e.Loader.prototype,{on:function(e){var n=t(e);(0,r.deprecation)(w,"PIXI.Loader#on is completely deprecated, use PIXI.Loader#"+n+".add")},once:function(e){var n=t(e);(0,r.deprecation)(w,"PIXI.Loader#once is completely deprecated, use PIXI.Loader#"+n+".once")},off:function(e){var n=t(e);(0,r.deprecation)(w,"PIXI.Loader#off is completely deprecated, use PIXI.Loader#"+n+".detach")}}),Object.defineProperty(e.extract,"WebGLExtract",{get:function(){return(0,r.deprecation)(w,"PIXI.extract.WebGLExtract method has moved to PIXI.Extract"),e.Extract}}),Object.defineProperty(e.prepare,"WebGLPrepare",{get:function(){return(0,r.deprecation)(w,"PIXI.prepare.WebGLPrepare class has moved to PIXI.Prepare"),e.Prepare}}),e.Container.prototype._renderWebGL=function(e){(0,r.deprecation)(w,"PIXI.Container._renderWebGL method has moved to PIXI.Container._render"),this._render(e)},e.Container.prototype.renderWebGL=function(e){(0,r.deprecation)(w,"PIXI.Container.renderWebGL method has moved to PIXI.Container.render"),this.render(e)},e.DisplayObject.prototype.renderWebGL=function(e){(0,r.deprecation)(w,"PIXI.DisplayObject.renderWebGL method has moved to PIXI.DisplayObject.render"),this.render(e)},e.Container.prototype.renderAdvancedWebGL=function(e){(0,r.deprecation)(w,"PIXI.Container.renderAdvancedWebGL method has moved to PIXI.Container.renderAdvanced"),this.renderAdvanced(e)},Object.defineProperties(e.settings,{TRANSFORM_MODE:{get:function(){return(0,r.deprecation)(w,"PIXI.settings.TRANSFORM_MODE property has been removed"),0},set:function(){(0,r.deprecation)(w,"PIXI.settings.TRANSFORM_MODE property has been removed")}}});var n=e.BaseTexture;n.prototype.loadSource=function(t){(0,r.deprecation)(w,"PIXI.BaseTexture.loadSource method has been deprecated");var n=e.resources.autoDetectResource(t);n.internal=!0,this.setResource(n),this.update()};var o=!1;Object.defineProperties(n.prototype,{hasLoaded:{get:function(){return(0,r.deprecation)(w,"PIXI.BaseTexture.hasLoaded property has been removed, use PIXI.BaseTexture.valid"),this.valid}},imageUrl:{get:function(){var e;return(0,r.deprecation)(w,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),null===(e=this.resource)||void 0===e?void 0:e.url},set:function(e){(0,r.deprecation)(w,"PIXI.BaseTexture.imageUrl property has been removed, use PIXI.BaseTexture.resource.url"),this.resource&&(this.resource.url=e)}},source:{get:function(){return(0,r.deprecation)(w,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source`"),this.resource.source},set:function(e){(0,r.deprecation)(w,"PIXI.BaseTexture.source property has been moved, use `PIXI.BaseTexture.resource.source` if you want to set HTMLCanvasElement. Otherwise, create new BaseTexture."),this.resource&&(this.resource.source=e)}},premultiplyAlpha:{get:function(){return(0,r.deprecation)("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(e){(0,r.deprecation)("5.2.0","PIXI.BaseTexture.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(e)}},_id:{get:function(){return o||((0,r.deprecation)("5.2.0","PIXI.BaseTexture._id batch local field has been changed to `_batchLocation`"),o=!0),this._batchLocation},set:function(e){this._batchLocation=e}}}),n.fromImage=function(e,t,o,i){(0,r.deprecation)(w,"PIXI.BaseTexture.fromImage method has been replaced with PIXI.BaseTexture.from");var a={scale:i,crossorigin:t};return n.from(e,{scaleMode:o,resourceOptions:a})},n.fromCanvas=function(e,t){return(0,r.deprecation)(w,"PIXI.BaseTexture.fromCanvas method has been replaced with PIXI.BaseTexture.from"),n.from(e,{scaleMode:t})},n.fromSVG=function(e,t,o,i){(0,r.deprecation)(w,"PIXI.BaseTexture.fromSVG method has been replaced with PIXI.BaseTexture.from");var a={scale:i,crossorigin:t};return n.from(e,{scaleMode:o,resourceOptions:a})},Object.defineProperties(e.resources.ImageResource.prototype,{premultiplyAlpha:{get:function(){return(0,r.deprecation)("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),0!==this.alphaMode},set:function(e){(0,r.deprecation)("5.2.0","PIXI.resources.ImageResource.premultiplyAlpha property has been changed to `alphaMode`, see `PIXI.ALPHA_MODES`"),this.alphaMode=Number(e)}}}),e.Point.prototype.copy=function(e){return(0,r.deprecation)(w,"PIXI.Point.copy method has been replaced with PIXI.Point.copyFrom"),this.copyFrom(e)},e.ObservablePoint.prototype.copy=function(e){return(0,r.deprecation)(w,"PIXI.ObservablePoint.copy method has been replaced with PIXI.ObservablePoint.copyFrom"),this.copyFrom(e)},e.Rectangle.prototype.copy=function(e){return(0,r.deprecation)(w,"PIXI.Rectangle.copy method has been replaced with PIXI.Rectangle.copyFrom"),this.copyFrom(e)},e.Matrix.prototype.copy=function(e){return(0,r.deprecation)(w,"PIXI.Matrix.copy method has been replaced with PIXI.Matrix.copyTo"),this.copyTo(e)},e.systems.StateSystem.prototype.setState=function(e){return(0,r.deprecation)("v5.1.0","StateSystem.setState has been renamed to StateSystem.set"),this.set(e)},Object.assign(e.systems.FilterSystem.prototype,{getRenderTarget:function(e,t){return(0,r.deprecation)(w,"PIXI.FilterManager.getRenderTarget method has been replaced with PIXI.systems.FilterSystem#getFilterTexture"),this.getFilterTexture(null,t)},returnRenderTarget:function(e){(0,r.deprecation)(w,"PIXI.FilterManager.returnRenderTarget method has been replaced with PIXI.systems.FilterSystem.returnFilterTexture"),this.returnFilterTexture(e)},calculateScreenSpaceMatrix:function(e){(0,r.deprecation)(w,"PIXI.systems.FilterSystem.calculateScreenSpaceMatrix method is removed, use `(vTextureCoord * inputSize.xy) + outputFrame.xy` instead");var t=e.identity(),n=this.activeState,o=n.sourceFrame,i=n.destinationFrame;return t.translate(o.x/i.width,o.y/i.height),t.scale(i.width,i.height),t},calculateNormalizedScreenSpaceMatrix:function(e){(0,r.deprecation)(w,"PIXI.systems.FilterManager.calculateNormalizedScreenSpaceMatrix method is removed, use `((vTextureCoord * inputSize.xy) + outputFrame.xy) / outputFrame.zw` instead.");var t=this.activeState,n=t.sourceFrame,o=t.destinationFrame,i=e.identity();i.translate(n.x/o.width,n.y/o.height);var a=o.width/n.width,s=o.height/n.height;return i.scale(a,s),i}}),Object.defineProperties(e.RenderTexture.prototype,{sourceFrame:{get:function(){return(0,r.deprecation)(w,"PIXI.RenderTexture.sourceFrame property has been removed"),this.filterFrame}},size:{get:function(){return(0,r.deprecation)(w,"PIXI.RenderTexture.size property has been removed"),this._frame}}});var i=function(e){function t(t,n,o,i){return(0,r.deprecation)(w,"PIXI.filters.BlurXFilter class is deprecated, use PIXI.filters.BlurFilterPass"),e.call(this,!0,t,n,o,i)||this}return L(t,e),t}(e.filters.BlurFilterPass),a=function(e){function t(t,n,o,i){return(0,r.deprecation)(w,"PIXI.filters.BlurYFilter class is deprecated, use PIXI.filters.BlurFilterPass"),e.call(this,!1,t,n,o,i)||this}return L(t,e),t}(e.filters.BlurFilterPass);Object.assign(e.filters,{BlurXFilter:i,BlurYFilter:a});var s=e.Sprite,c=e.Texture,p=e.Graphics;function u(e,t,n,o){return(0,r.deprecation)(w,"PIXI.Sprite."+e+" method is deprecated, use PIXI.Sprite.from"),s.from(t,{resourceOptions:{scale:o,crossorigin:n}})}function d(e,t,n,o){return(0,r.deprecation)(w,"PIXI.Texture."+e+" method is deprecated, use PIXI.Texture.from"),c.from(t,{resourceOptions:{scale:o,crossorigin:n}})}p.prototype.generateCanvasTexture||(p.prototype.generateCanvasTexture=function(){(0,r.deprecation)(w,'PIXI.Graphics.generateCanvasTexture method is only available in "pixi.js-legacy"')}),Object.defineProperty(p.prototype,"graphicsData",{get:function(){return(0,r.deprecation)(w,"PIXI.Graphics.graphicsData property is deprecated, use PIXI.Graphics.geometry.graphicsData"),this.geometry.graphicsData}}),s.fromImage=u.bind(null,"fromImage"),s.fromSVG=u.bind(null,"fromSVG"),s.fromCanvas=u.bind(null,"fromCanvas"),s.fromVideo=u.bind(null,"fromVideo"),s.fromFrame=u.bind(null,"fromFrame"),c.fromImage=d.bind(null,"fromImage"),c.fromSVG=d.bind(null,"fromSVG"),c.fromCanvas=d.bind(null,"fromCanvas"),c.fromVideo=d.bind(null,"fromVideo"),c.fromFrame=d.bind(null,"fromFrame"),Object.defineProperty(e.AbstractRenderer.prototype,"autoResize",{get:function(){return(0,r.deprecation)(w,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity},set:function(e){(0,r.deprecation)(w,"PIXI.AbstractRenderer.autoResize property is deprecated, use PIXI.AbstractRenderer.autoDensity"),this.autoDensity=e}}),Object.defineProperty(e.Renderer.prototype,"textureManager",{get:function(){return(0,r.deprecation)(w,"PIXI.Renderer.textureManager property is deprecated, use PIXI.Renderer.texture"),this.texture}}),e.utils.mixins={mixin:function(){(0,r.deprecation)(w,"PIXI.utils.mixins.mixin function is no longer available")},delayMixin:function(){(0,r.deprecation)(w,"PIXI.utils.mixins.delayMixin function is no longer available")},performMixins:function(){(0,r.deprecation)(w,"PIXI.utils.mixins.performMixins function is no longer available")}},Object.defineProperty(e.BitmapText.prototype,"font",{get:function(){return(0,r.deprecation)("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),{name:this._fontName,size:this._fontSize,tint:this._tint,align:this._align}},set:function(t){if((0,r.deprecation)("5.3.0","PIXI.BitmapText.font property is deprecated, use fontName, fontSize, tint or align properties"),t){var n={font:t};this._upgradeStyle(n),n.fontSize=n.fontSize||e.BitmapFont.available[n.fontName].size,this._fontName=n.fontName,this._fontSize=n.fontSize,this.dirty=!0}}})}i.Renderer.registerPlugin("accessibility",t.AccessibilityManager),i.Renderer.registerPlugin("extract",a.Extract),i.Renderer.registerPlugin("interaction",n.InteractionManager),i.Renderer.registerPlugin("particle",c.ParticleRenderer),i.Renderer.registerPlugin("prepare",p.Prepare),i.Renderer.registerPlugin("batch",i.BatchRenderer),i.Renderer.registerPlugin("tilingSprite",d.TilingSpriteRenderer),s.Loader.registerPlugin(l.BitmapFontLoader),s.Loader.registerPlugin(u.SpritesheetLoader),o.Application.registerPlugin(f.TickerPlugin),o.Application.registerPlugin(s.AppLoaderPlugin);var C="5.3.6";exports.VERSION=C;var D={AlphaFilter:I.AlphaFilter,BlurFilter:P.BlurFilter,BlurFilterPass:P.BlurFilterPass,ColorMatrixFilter:h.ColorMatrixFilter,DisplacementFilter:m.DisplacementFilter,FXAAFilter:y.FXAAFilter,NoiseFilter:g.NoiseFilter};exports.filters=D;
},{"@pixi/polyfill":"jbXN","@pixi/utils":"X4iF","@pixi/accessibility":"JMFw","@pixi/interaction":"hG98","@pixi/app":"ExZK","@pixi/core":"lj2a","@pixi/extract":"ZH8o","@pixi/loaders":"bw5V","@pixi/particles":"in9j","@pixi/prepare":"cawE","@pixi/spritesheet":"O2FJ","@pixi/sprite-tiling":"hxhD","@pixi/text-bitmap":"wAzD","@pixi/ticker":"AWzT","@pixi/filter-alpha":"RZoz","@pixi/filter-blur":"WUS5","@pixi/filter-color-matrix":"ts1g","@pixi/filter-displacement":"XNHP","@pixi/filter-fxaa":"d2iI","@pixi/filter-noise":"Y0eQ","@pixi/mixin-cache-as-bitmap":"vc4X","@pixi/mixin-get-child-by-name":"k2x1","@pixi/mixin-get-global-position":"hqMH","@pixi/constants":"djkr","@pixi/display":"qvzw","@pixi/graphics":"I0PC","@pixi/math":"w9h1","@pixi/mesh":"KkZL","@pixi/mesh-extras":"vnLX","@pixi/runner":"KLq2","@pixi/sprite":"XG9w","@pixi/sprite-animated":"fDWR","@pixi/text":"aZY8","@pixi/settings":"Xe2x"}],"TSDb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=require("@pixi/loaders"),e=require("@pixi/ticker"),n=require("@pixi/utils"),o=require("@pixi/core"),i=function(){function t(t,e){this._output=e,this._input=t}return Object.defineProperty(t.prototype,"destination",{get:function(){return this._input},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._filters},set:function(t){var e=this;if(this._filters&&(this._filters.forEach(function(t){t&&t.disconnect()}),this._filters=null,this._input.connect(this._output)),t&&t.length){this._filters=t.slice(0),this._input.disconnect();var n=null;t.forEach(function(t){null===n?e._input.connect(t.destination):n.connect(t.destination),n=t}),n.connect(this._output)}},enumerable:!0,configurable:!0}),t.prototype.destroy=function(){this.filters=null,this._input=null,this._output=null},t}(),r=function(){function t(t,e){this.init(t,e)}return t.prototype.init=function(t,e){this.destination=t,this.source=e||t},t.prototype.connect=function(t){this.source.connect(t)},t.prototype.disconnect=function(){this.source.disconnect()},t.prototype.destroy=function(){this.disconnect(),this.destination=null,this.source=null},t}(),s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function u(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a,c=function(){return(c=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function p(){return a}var h,l,f,d,_=function(){function t(){}return t.setParamValue=function(t,e){if(t.setValueAtTime){var n=p().context;t.setValueAtTime(e,n.audioContext.currentTime)}else t.value=e;return e},t}(),y=0,m=function(t){function n(e){var n=t.call(this)||this;return n.id=y++,n._media=null,n._paused=!1,n._muted=!1,n._elapsed=0,n.init(e),n}return u(n,t),n.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},n.prototype.stop=function(){this._source&&(this._internalStop(),this.emit("stop"))},Object.defineProperty(n.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh(),this._update(!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){if(this._source){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var n=t.volume*(t.muted?0:1),o=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);_.setParamValue(this._gain.gain,i*o*n),_.setParamValue(this._source.playbackRate,this._speed*e.speed*t.speed)}},n.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._elapsed%this._duration,end:this._end,speed:this._speed,loop:this._loop,volume:this._volume})),this.emit("pause",n))},n.prototype.play=function(t){var e=t.start,n=t.end,o=t.speed,i=t.loop,r=t.volume,s=t.muted;this._paused=!1;var u=this._media.nodes.cloneBufferSource(),a=u.source,c=u.gain;this._source=a,this._gain=c,this._speed=o,this._volume=r,this._loop=!!i,this._muted=s,this.refresh();var p=this._source.buffer.duration;this._duration=p,this._end=n,this._lastUpdate=this._now(),this._elapsed=e,this._source.onended=this._onComplete.bind(this),this._loop?(this._source.loopEnd=n,this._source.loopStart=e,this._source.start(0,e)):n?this._source.start(0,e,n-e):this._source.start(0,e),this.emit("start"),this._update(!0),this._enabled=!0},n.prototype._toSec=function(t){return t>10&&(t/=1e3),t||0},Object.defineProperty(n.prototype,"_enabled",{set:function(t){e.Ticker.shared.remove(this._updateListener,this),t&&e.Ticker.shared.add(this._updateListener,this)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"progress",{get:function(){return this._progress},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.removeAllListeners(),this._internalStop(),this._gain&&(this._gain.disconnect(),this._gain=null),this._media&&(this._media.context.events.off("refresh",this.refresh,this),this._media.context.events.off("refreshPaused",this.refreshPaused,this),this._media=null),this._end=null,this._speed=1,this._volume=1,this._loop=!1,this._elapsed=0,this._duration=0,this._paused=!1,this._muted=!1,this._pausedReal=!1},n.prototype.toString=function(){return"[WebAudioInstance id="+this.id+"]"},n.prototype._now=function(){return this._media.context.audioContext.currentTime},n.prototype._updateListener=function(){this._update()},n.prototype._update=function(t){if(void 0===t&&(t=!1),this._source){var e=this._now(),n=e-this._lastUpdate;if(n>0||t){var o=this._source.playbackRate.value;this._elapsed+=n*o,this._lastUpdate=e;var i=this._duration,r=void 0;if(this._source.loopStart){var s=this._source.loopEnd-this._source.loopStart;r=(this._source.loopStart+this._elapsed%s)/i}else r=this._elapsed%i/i;this._progress=r,this.emit("progress",this._progress,i)}}},n.prototype.init=function(t){this._media=t,t.context.events.on("refresh",this.refresh,this),t.context.events.on("refreshPaused",this.refreshPaused,this)},n.prototype._internalStop=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.stop(0),this._source.disconnect(),this._source=null)},n.prototype._onComplete=function(){this._source&&(this._enabled=!1,this._source.onended=null,this._source.disconnect()),this._source=null,this._progress=1,this.emit("progress",1,this._duration),this.emit("end",this)},n}(n.EventEmitter),g=function(t){function e(e){var n=this,o=e.audioContext,i=o.createBufferSource(),r=o.createGain(),s=o.createAnalyser();return i.connect(s),s.connect(r),r.connect(e.destination),(n=t.call(this,s,r)||this).context=e,n.bufferSource=i,n.gain=r,n.analyser=s,n}return u(e,t),Object.defineProperty(e.prototype,"script",{get:function(){return this._script||(this._script=this.context.audioContext.createScriptProcessor(e.BUFFER_SIZE),this._script.connect(this.context.destination)),this._script},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this.bufferSource.disconnect(),this._script&&this._script.disconnect(),this.gain.disconnect(),this.analyser.disconnect(),this.bufferSource=null,this._script=null,this.gain=null,this.analyser=null,this.context=null},e.prototype.cloneBufferSource=function(){var t=this.bufferSource,e=this.context.audioContext.createBufferSource();e.buffer=t.buffer,_.setParamValue(e.playbackRate,t.playbackRate.value),e.loop=t.loop;var n=this.context.audioContext.createGain();return e.connect(n),n.connect(this.destination),{source:e,gain:n}},Object.defineProperty(e.prototype,"bufferSize",{get:function(){return this.script.bufferSize},enumerable:!0,configurable:!0}),e.BUFFER_SIZE=0,e}(i),b=function(){function t(){}return t.prototype.init=function(t){this.parent=t,this._nodes=new g(this.context),this._source=this._nodes.bufferSource,this.source=t.options.source},t.prototype.destroy=function(){this.parent=null,this._nodes.destroy(),this._nodes=null,this._source=null,this.source=null},t.prototype.create=function(){return new m(this)},Object.defineProperty(t.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPlayable",{get:function(){return!!this._source&&!!this._source.buffer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this._nodes.filters},set:function(t){this._nodes.filters=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this._source.buffer.duration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buffer",{get:function(){return this._source.buffer},set:function(t){this._source.buffer=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),t.prototype.load=function(t){this.source?this._decode(this.source,t):this.parent.url?this._loadUrl(t):t&&t(new Error("sound.url or sound.source must be set"))},t.prototype._loadUrl=function(t){var e=this,n=new XMLHttpRequest,o=this.parent.url;n.open("GET",o,!0),n.responseType="arraybuffer",n.onload=function(){e.source=n.response,e._decode(n.response,t)},n.send()},t.prototype._decode=function(t,e){var n=this;this.parent.context.decode(t,function(t,o){if(t)e&&e(t);else{n.parent.isLoaded=!0,n.buffer=o;var i=n.parent.autoPlayStart();e&&e(null,n.parent,i)}})},t}(),v=function(t){function e(){var o=this,i=window,r=new e.AudioContext,s=r.createDynamicsCompressor(),u=r.createAnalyser();return u.connect(s),s.connect(r.destination),(o=t.call(this,u,s)||this)._ctx=r,o._offlineCtx=new e.OfflineAudioContext(1,2,i.OfflineAudioContext?r.sampleRate:44100),o._unlocked=!1,o.compressor=s,o.analyser=u,o.events=new n.EventEmitter,o.volume=1,o.speed=1,o.muted=!1,o.paused=!1,"running"!==r.state&&(o._unlock(),o._unlock=o._unlock.bind(o),document.addEventListener("mousedown",o._unlock,!0),document.addEventListener("touchstart",o._unlock,!0),document.addEventListener("touchend",o._unlock,!0)),o}return u(e,t),e.prototype._unlock=function(){this._unlocked||(this.playEmptySound(),"running"===this._ctx.state&&(document.removeEventListener("mousedown",this._unlock,!0),document.removeEventListener("touchend",this._unlock,!0),document.removeEventListener("touchstart",this._unlock,!0),this._unlocked=!0))},e.prototype.playEmptySound=function(){var t=this._ctx.createBufferSource();t.buffer=this._ctx.createBuffer(1,1,22050),t.connect(this._ctx.destination),t.start(0,0,0),"suspended"===t.context.state&&t.context.resume()},Object.defineProperty(e,"AudioContext",{get:function(){var t=window;return t.AudioContext||t.webkitAudioContext||null},enumerable:!0,configurable:!0}),Object.defineProperty(e,"OfflineAudioContext",{get:function(){var t=window;return t.OfflineAudioContext||t.webkitOfflineAudioContext||null},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this);var e=this._ctx;void 0!==e.close&&e.close(),this.events.removeAllListeners(),this.analyser.disconnect(),this.compressor.disconnect(),this.analyser=null,this.compressor=null,this.events=null,this._offlineCtx=null,this._ctx=null},Object.defineProperty(e.prototype,"audioContext",{get:function(){return this._ctx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"offlineContext",{get:function(){return this._offlineCtx},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this._paused},set:function(t){t&&"running"===this._ctx.state?this._ctx.suspend():t||"suspended"!==this._ctx.state||this._ctx.resume(),this._paused=t},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.events.emit("refresh")},e.prototype.refreshPaused=function(){this.events.emit("refreshPaused")},e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this._paused},e.prototype.decode=function(t,e){this._offlineCtx.decodeAudioData(t,function(t){e(null,t)},function(t){e(new Error(t.message||"Unable to decode file"))})},e}(i),P={WebAudioMedia:b,WebAudioInstance:m,WebAudioNodes:g,WebAudioContext:v,WebAudioUtils:_},x={Filter:r,EqualizerFilter:function(t){function e(n,o,i,r,s,u,a,c,h,l){void 0===n&&(n=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===r&&(r=0),void 0===s&&(s=0),void 0===u&&(u=0),void 0===a&&(a=0),void 0===c&&(c=0),void 0===h&&(h=0),void 0===l&&(l=0);var f=this;if(!p().useLegacy){var d=[{f:e.F32,type:"lowshelf",gain:n},{f:e.F64,type:"peaking",gain:o},{f:e.F125,type:"peaking",gain:i},{f:e.F250,type:"peaking",gain:r},{f:e.F500,type:"peaking",gain:s},{f:e.F1K,type:"peaking",gain:u},{f:e.F2K,type:"peaking",gain:a},{f:e.F4K,type:"peaking",gain:c},{f:e.F8K,type:"peaking",gain:h},{f:e.F16K,type:"highshelf",gain:l}].map(function(t){var e=p().context.audioContext.createBiquadFilter();return e.type=t.type,_.setParamValue(e.Q,1),e.frequency.value=t.f,_.setParamValue(e.gain,t.gain),e});(f=t.call(this,d[0],d[d.length-1])||this).bands=d,f.bandsMap={};for(var y=0;y<f.bands.length;y++){var m=f.bands[y];y>0&&f.bands[y-1].connect(m),f.bandsMap[m.frequency.value]=m}return f}f=t.call(this,null)||this}return u(e,t),e.prototype.setGain=function(t,e){if(void 0===e&&(e=0),!this.bandsMap[t])throw new Error("No band found for frequency "+t);_.setParamValue(this.bandsMap[t].gain,e)},e.prototype.getGain=function(t){if(!this.bandsMap[t])throw new Error("No band found for frequency "+t);return this.bandsMap[t].gain.value},Object.defineProperty(e.prototype,"f32",{get:function(){return this.getGain(e.F32)},set:function(t){this.setGain(e.F32,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f64",{get:function(){return this.getGain(e.F64)},set:function(t){this.setGain(e.F64,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f125",{get:function(){return this.getGain(e.F125)},set:function(t){this.setGain(e.F125,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f250",{get:function(){return this.getGain(e.F250)},set:function(t){this.setGain(e.F250,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f500",{get:function(){return this.getGain(e.F500)},set:function(t){this.setGain(e.F500,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f1k",{get:function(){return this.getGain(e.F1K)},set:function(t){this.setGain(e.F1K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f2k",{get:function(){return this.getGain(e.F2K)},set:function(t){this.setGain(e.F2K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f4k",{get:function(){return this.getGain(e.F4K)},set:function(t){this.setGain(e.F4K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f8k",{get:function(){return this.getGain(e.F8K)},set:function(t){this.setGain(e.F8K,t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"f16k",{get:function(){return this.getGain(e.F16K)},set:function(t){this.setGain(e.F16K,t)},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.bands.forEach(function(t){_.setParamValue(t.gain,0)})},e.prototype.destroy=function(){this.bands.forEach(function(t){t.disconnect()}),this.bands=null,this.bandsMap=null},e.F32=32,e.F64=64,e.F125=125,e.F250=250,e.F500=500,e.F1K=1e3,e.F2K=2e3,e.F4K=4e3,e.F8K=8e3,e.F16K=16e3,e}(r),DistortionFilter:function(t){function e(e){void 0===e&&(e=0);var n=this;if(!p().useLegacy){var o=p().context.audioContext.createWaveShaper();return(n=t.call(this,o)||this)._distortion=o,n.amount=e,n}n=t.call(this,null)||this}return u(e,t),Object.defineProperty(e.prototype,"amount",{get:function(){return this._amount},set:function(t){t*=1e3,this._amount=t;for(var e,n=new Float32Array(44100),o=Math.PI/180,i=0;i<44100;++i)e=2*i/44100-1,n[i]=(3+t)*e*20*o/(Math.PI+t*Math.abs(e));this._distortion.curve=n,this._distortion.oversample="4x"},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this._distortion=null,t.prototype.destroy.call(this)},e}(r),StereoFilter:function(t){function e(e){void 0===e&&(e=0);var n=this;if(!p().useLegacy){var o,i,r,s=p().context.audioContext;return s.createStereoPanner?r=o=s.createStereoPanner():((i=s.createPanner()).panningModel="equalpower",r=i),(n=t.call(this,r)||this)._stereo=o,n._panner=i,n.pan=e,n}n=t.call(this,null)||this}return u(e,t),Object.defineProperty(e.prototype,"pan",{get:function(){return this._pan},set:function(t){this._pan=t,this._stereo?_.setParamValue(this._stereo.pan,t):this._panner.setPosition(t,0,1-Math.abs(t))},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){t.prototype.destroy.call(this),this._stereo=null,this._panner=null},e}(r),ReverbFilter:function(t){function e(e,n,o){void 0===e&&(e=3),void 0===n&&(n=2),void 0===o&&(o=!1);var i=this;if(!p().useLegacy)return(i=t.call(this,null)||this)._seconds=i._clamp(e,1,50),i._decay=i._clamp(n,0,100),i._reverse=o,i._rebuild(),i;i=t.call(this,null)||this}return u(e,t),e.prototype._clamp=function(t,e,n){return Math.min(n,Math.max(e,t))},Object.defineProperty(e.prototype,"seconds",{get:function(){return this._seconds},set:function(t){this._seconds=this._clamp(t,1,50),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"decay",{get:function(){return this._decay},set:function(t){this._decay=this._clamp(t,0,100),this._rebuild()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reverse",{get:function(){return this._reverse},set:function(t){this._reverse=t,this._rebuild()},enumerable:!0,configurable:!0}),e.prototype._rebuild=function(){for(var t,e=p().context.audioContext,n=e.sampleRate,o=n*this._seconds,i=e.createBuffer(2,o,n),r=i.getChannelData(0),s=i.getChannelData(1),u=0;u<o;u++)t=this._reverse?o-u:u,r[u]=(2*Math.random()-1)*Math.pow(1-t/o,this._decay),s[u]=(2*Math.random()-1)*Math.pow(1-t/o,this._decay);var a=p().context.audioContext.createConvolver();a.buffer=i,this.init(a)},e}(r),MonoFilter:function(t){function e(){var e=this;if(!p().useLegacy){var n=p().context.audioContext,o=n.createChannelSplitter(),i=n.createChannelMerger();return i.connect(o),(e=t.call(this,i,o)||this)._merger=i,e}e=t.call(this,null)||this}return u(e,t),e.prototype.destroy=function(){this._merger.disconnect(),this._merger=null,t.prototype.destroy.call(this)},e}(r),TelephoneFilter:function(t){function e(){if(!p().useLegacy){var e=p().context.audioContext,n=e.createBiquadFilter(),o=e.createBiquadFilter(),i=e.createBiquadFilter(),r=e.createBiquadFilter();return n.type="lowpass",_.setParamValue(n.frequency,2e3),o.type="lowpass",_.setParamValue(o.frequency,2e3),i.type="highpass",_.setParamValue(i.frequency,500),r.type="highpass",_.setParamValue(r.frequency,500),n.connect(o),o.connect(i),i.connect(r),t.call(this,n,r)||this}t.call(this,null)}return u(e,t),e}(r)},O=0,j=function(t){function n(e){var n=t.call(this)||this;return n.id=O++,n.init(e),n}return u(n,t),n.prototype.set=function(t,e){if(void 0===this[t])throw new Error("Property with name "+t+" does not exist.");return this[t]=e,this},Object.defineProperty(n.prototype,"progress",{get:function(){return this._source.currentTime/this._duration},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),n.prototype._onPlay=function(){this._playing=!0},n.prototype._onPause=function(){this._playing=!1},n.prototype.init=function(t){this._playing=!1,this._duration=t.source.duration;var e=this._source=t.source.cloneNode(!1);e.src=t.parent.url,e.onplay=this._onPlay.bind(this),e.onpause=this._onPause.bind(this),t.context.on("refresh",this.refresh,this),t.context.on("refreshPaused",this.refreshPaused,this),this._media=t},n.prototype._internalStop=function(){this._source&&this._playing&&(this._source.onended=null,this._source.pause())},n.prototype.stop=function(){this._internalStop(),this._source&&this.emit("stop")},Object.defineProperty(n.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),n.prototype.refresh=function(){var t=this._media.context,e=this._media.parent;this._source.loop=this._loop||e.loop;var n=t.volume*(t.muted?0:1),o=e.volume*(e.muted?0:1),i=this._volume*(this._muted?0:1);this._source.volume=i*n*o,this._source.playbackRate=this._speed*t.speed*e.speed},n.prototype.refreshPaused=function(){var t=this._media.context,e=this._media.parent,n=this._paused||e.paused||t.paused;n!==this._pausedReal&&(this._pausedReal=n,n?(this._internalStop(),this.emit("paused")):(this.emit("resumed"),this.play({start:this._source.currentTime,end:this._end,volume:this._volume,speed:this._speed,loop:this._loop})),this.emit("pause",n))},n.prototype.play=function(t){var o=this,i=t.start,r=t.end,s=t.speed,u=t.loop,a=t.volume,c=t.muted;this._speed=s,this._volume=a,this._loop=!!u,this._muted=c,this.refresh(),this.loop&&null!==r&&(this.loop=!1),this._start=i,this._end=r||this._duration,this._start=Math.max(0,this._start-n.PADDING),this._end=Math.min(this._end+n.PADDING,this._duration),this._source.onloadedmetadata=function(){o._source&&(o._source.currentTime=i,o._source.onloadedmetadata=null,o.emit("progress",i,o._duration),e.Ticker.shared.add(o._onUpdate,o))},this._source.onended=this._onComplete.bind(this),this._source.play(),this.emit("start")},n.prototype._onUpdate=function(){this.emit("progress",this.progress,this._duration),this._source.currentTime>=this._end&&!this._source.loop&&this._onComplete()},n.prototype._onComplete=function(){e.Ticker.shared.remove(this._onUpdate,this),this._internalStop(),this.emit("progress",1,this._duration),this.emit("end",this)},n.prototype.destroy=function(){e.Ticker.shared.remove(this._onUpdate,this),this.removeAllListeners();var t=this._source;t&&(t.onended=null,t.onplay=null,t.onpause=null,this._internalStop()),this._source=null,this._speed=1,this._volume=1,this._loop=!1,this._end=null,this._start=0,this._duration=0,this._playing=!1,this._pausedReal=!1,this._paused=!1,this._muted=!1,this._media&&(this._media.context.off("refresh",this.refresh,this),this._media.context.off("refreshPaused",this.refreshPaused,this),this._media=null)},n.prototype.toString=function(){return"[HTMLAudioInstance id="+this.id+"]"},n.PADDING=.1,n}(n.EventEmitter),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.init=function(t){this.parent=t,this._source=t.options.source||new Audio,t.url&&(this._source.src=t.url)},e.prototype.create=function(){return new j(this)},Object.defineProperty(e.prototype,"isPlayable",{get:function(){return!!this._source&&4===this._source.readyState},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._source.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this.parent.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){this.removeAllListeners(),this.parent=null,this._source&&(this._source.src="",this._source.load(),this._source=null)},Object.defineProperty(e.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),e.prototype.load=function(t){var e=this._source,n=this.parent;if(4!==e.readyState){if(!n.url)return t(new Error("sound.url or sound.source must be set"));e.src=n.url;var o=function(){e.removeEventListener("canplaythrough",i),e.removeEventListener("load",i),e.removeEventListener("abort",r),e.removeEventListener("error",s)},i=function(){o(),n.isLoaded=!0;var e=n.autoPlayStart();t&&t(null,n,e)},r=function(){o(),t&&t(new Error("Sound loading has been aborted"))},s=function(){o();var n="Failed to load audio element (code: "+e.error.code+")";t&&t(new Error(n))};e.addEventListener("canplaythrough",i,!1),e.addEventListener("load",i,!1),e.addEventListener("abort",r,!1),e.addEventListener("error",s,!1),e.load()}else{n.isLoaded=!0;var u=n.autoPlayStart();t&&setTimeout(function(){t(null,n,u)},0)}},e}(n.EventEmitter),w=function(t){function e(){var e=t.call(this)||this;return e.speed=1,e.volume=1,e.muted=!1,e.paused=!1,e}return u(e,t),e.prototype.refresh=function(){this.emit("refresh")},e.prototype.refreshPaused=function(){this.emit("refreshPaused")},Object.defineProperty(e.prototype,"filters",{get:function(){return null},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"audioContext",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.toggleMute=function(){return this.muted=!this.muted,this.refresh(),this.muted},e.prototype.togglePause=function(){return this.paused=!this.paused,this.refreshPaused(),this.paused},e.prototype.destroy=function(){this.removeAllListeners()},e}(n.EventEmitter),A={HTMLAudioMedia:E,HTMLAudioInstance:j,HTMLAudioContext:w},L=["mp3","ogg","oga","opus","mpeg","wav","m4a","aiff","wma","mid"],F=(h={m4a:"mp4",oga:"ogg"},l=document.createElement("audio"),f={},d=/^no$/,L.forEach(function(t){var e=h[t]||t,n=l.canPlayType("audio/"+t).replace(d,""),o=l.canPlayType("audio/"+e).replace(d,"");f[t]=!!n||!!o}),Object.freeze(f)),C=/\.(\{([^\}]+)\})(\?.*)?$/;function S(t){var e=C,n="string"==typeof t?t:t.url;if(e.test(n)){for(var o=e.exec(n),i=o[2].split(","),r=i[i.length-1],s=0,u=i.length;s<u;s++){var a=i[s];if(F[a]){r=a;break}}var c=n.replace(o[1],r);return"string"!=typeof t&&(t.extension=r,t.url=c),c}return n}var k=function(){function e(){}return e.add=function(){e.legacy=p().useLegacy},Object.defineProperty(e,"legacy",{set:function(e){var n=L;e?n.forEach(function(e){t.LoaderResource.setExtensionXhrType(e,t.LoaderResource.XHR_RESPONSE_TYPE.DEFAULT),t.LoaderResource.setExtensionLoadType(e,t.LoaderResource.LOAD_TYPE.AUDIO)}):n.forEach(function(e){t.LoaderResource.setExtensionXhrType(e,t.LoaderResource.XHR_RESPONSE_TYPE.BUFFER),t.LoaderResource.setExtensionLoadType(e,t.LoaderResource.LOAD_TYPE.XHR)})},enumerable:!0,configurable:!0}),e.pre=function(t,e){S(t),e()},e.use=function(t,e){t.data&&L.indexOf(t.extension)>-1?t.sound=p().add(t.name,{loaded:e,preload:!0,url:t.url,source:t.data}):e()},e}(),M=function(){function t(t,e){this.parent=t,Object.assign(this,e),this.duration=this.end-this.start}return t.prototype.play=function(t){return this.parent.play({complete:t,speed:this.speed||this.parent.speed,end:this.end,start:this.start,loop:this.loop})},t.prototype.destroy=function(){this.parent=null},t}(),T=function(){function t(t,e){this.media=t,this.options=e,this._instances=[],this._sprites={},this.media.init(this);var n=e.complete;this._autoPlayOptions=n?{complete:n}:null,this.isLoaded=!1,this.isPlaying=!1,this.autoPlay=e.autoPlay,this.singleInstance=e.singleInstance,this.preload=e.preload||this.autoPlay,this.url=e.url,this.speed=e.speed,this.volume=e.volume,this.loop=e.loop,e.sprites&&this.addSprites(e.sprites),this.preload&&this._preload(e.loaded)}return t.from=function(e){var n={};return"string"==typeof e?n.url=e:e instanceof ArrayBuffer||e instanceof HTMLAudioElement?n.source=e:n=e,(n=c({autoPlay:!1,singleInstance:!1,url:null,source:null,preload:!1,volume:1,speed:1,complete:null,loaded:null,loop:!1},n)).url&&(n.url=S(n.url)),Object.freeze(n),new t(p().useLegacy?new E:new b,n)},Object.defineProperty(t.prototype,"context",{get:function(){return p().context},enumerable:!0,configurable:!0}),t.prototype.pause=function(){return this.isPlaying=!1,this.paused=!0,this},t.prototype.resume=function(){return this.isPlaying=this._instances.length>0,this.paused=!1,this},Object.defineProperty(t.prototype,"paused",{get:function(){return this._paused},set:function(t){this._paused=t,this.refreshPaused()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filters",{get:function(){return this.media.filters},set:function(t){this.media.filters=t},enumerable:!0,configurable:!0}),t.prototype.addSprites=function(t,e){if("object"==typeof t){var n={};for(var o in t)n[o]=this.addSprites(o,t[o]);return n}if("string"==typeof t){var i=new M(this,e);return this._sprites[t]=i,i}},t.prototype.destroy=function(){this._removeInstances(),this.removeSprites(),this.media.destroy(),this.media=null,this._sprites=null,this._instances=null},t.prototype.removeSprites=function(t){if(t){var e=this._sprites[t];void 0!==e&&(e.destroy(),delete this._sprites[t])}else for(var n in this._sprites)this.removeSprites(n);return this},Object.defineProperty(t.prototype,"isPlayable",{get:function(){return this.isLoaded&&this.media&&this.media.isPlayable},enumerable:!0,configurable:!0}),t.prototype.stop=function(){if(!this.isPlayable)return this.autoPlay=!1,this._autoPlayOptions=null,this;this.isPlaying=!1;for(var t=this._instances.length-1;t>=0;t--)this._instances[t].stop();return this},t.prototype.play=function(t,e){var n,o=this;if("string"==typeof t?n={sprite:r=t,loop:this.loop,complete:e}:"function"==typeof t?(n={}).complete=t:n=t,(n=c({complete:null,loaded:null,sprite:null,end:null,start:0,volume:1,speed:1,muted:!1,loop:!1},n||{})).sprite){var i=n.sprite,r=this._sprites[i];n.start=r.start,n.end=r.end,n.speed=r.speed||1,n.loop=r.loop||n.loop,delete n.sprite}if(n.offset&&(n.start=n.offset),!this.isLoaded)return new Promise(function(t,e){o.autoPlay=!0,o._autoPlayOptions=n,o._preload(function(o,i,r){o?e(o):(n.loaded&&n.loaded(o,i,r),t(r))})});this.singleInstance&&this._removeInstances();var s=this._createInstance();return this._instances.push(s),this.isPlaying=!0,s.once("end",function(){n.complete&&n.complete(o),o._onComplete(s)}),s.once("stop",function(){o._onComplete(s)}),s.play(n),s},t.prototype.refresh=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refresh()},t.prototype.refreshPaused=function(){for(var t=this._instances.length,e=0;e<t;e++)this._instances[e].refreshPaused()},Object.defineProperty(t.prototype,"volume",{get:function(){return this._volume},set:function(t){this._volume=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"muted",{get:function(){return this._muted},set:function(t){this._muted=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loop",{get:function(){return this._loop},set:function(t){this._loop=t,this.refresh()},enumerable:!0,configurable:!0}),t.prototype._preload=function(t){this.media.load(t)},Object.defineProperty(t.prototype,"instances",{get:function(){return this._instances},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sprites",{get:function(){return this._sprites},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"duration",{get:function(){return this.media.duration},enumerable:!0,configurable:!0}),t.prototype.autoPlayStart=function(){var t;return this.autoPlay&&(t=this.play(this._autoPlayOptions)),t},t.prototype._removeInstances=function(){for(var t=this._instances.length-1;t>=0;t--)this._poolInstance(this._instances[t]);this._instances.length=0},t.prototype._onComplete=function(t){if(this._instances){var e=this._instances.indexOf(t);e>-1&&this._instances.splice(e,1),this.isPlaying=this._instances.length>0}this._poolInstance(t)},t.prototype._createInstance=function(){if(t._pool.length>0){var e=t._pool.pop();return e.init(this.media),e}return this.media.create()},t.prototype._poolInstance=function(e){e.destroy(),t._pool.indexOf(e)<0&&t._pool.push(e)},t._pool=[],t}(),R=function(){function t(){this.init()}return t.prototype.init=function(){return this.supported&&(this._webAudioContext=new v),this._htmlAudioContext=new w,this._sounds={},this.useLegacy=!this.supported,this},Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"filtersAll",{get:function(){return this.useLegacy?[]:this._context.filters},set:function(t){this.useLegacy||(this._context.filters=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"supported",{get:function(){return null!==v.AudioContext},enumerable:!0,configurable:!0}),t.prototype.add=function(t,e){if("object"==typeof t){var n={};for(var o in t){var i=this._getOptions(t[o],e);n[o]=this.add(o,i)}return n}if("string"==typeof t){if(e instanceof T)return this._sounds[t]=e,e;i=this._getOptions(e);var r=T.from(i);return this._sounds[t]=r,r}},t.prototype._getOptions=function(t,e){var n;return n="string"==typeof t?{url:t}:t instanceof ArrayBuffer||t instanceof HTMLAudioElement?{source:t}:t,c({},n,e||{})},Object.defineProperty(t.prototype,"useLegacy",{get:function(){return this._useLegacy},set:function(t){k.legacy=t,this._useLegacy=t,this._context=!t&&this.supported?this._webAudioContext:this._htmlAudioContext},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){return this.exists(t,!0),this._sounds[t].destroy(),delete this._sounds[t],this},Object.defineProperty(t.prototype,"volumeAll",{get:function(){return this._context.volume},set:function(t){this._context.volume=t,this._context.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"speedAll",{get:function(){return this._context.speed},set:function(t){this._context.speed=t,this._context.refresh()},enumerable:!0,configurable:!0}),t.prototype.togglePauseAll=function(){return this._context.togglePause()},t.prototype.pauseAll=function(){return this._context.paused=!0,this._context.refreshPaused(),this},t.prototype.resumeAll=function(){return this._context.paused=!1,this._context.refreshPaused(),this},t.prototype.toggleMuteAll=function(){return this._context.toggleMute()},t.prototype.muteAll=function(){return this._context.muted=!0,this._context.refresh(),this},t.prototype.unmuteAll=function(){return this._context.muted=!1,this._context.refresh(),this},t.prototype.removeAll=function(){for(var t in this._sounds)this._sounds[t].destroy(),delete this._sounds[t];return this},t.prototype.stopAll=function(){for(var t in this._sounds)this._sounds[t].stop();return this},t.prototype.exists=function(t,e){return void 0===e&&(e=!1),!!this._sounds[t]},t.prototype.find=function(t){return this.exists(t,!0),this._sounds[t]},t.prototype.play=function(t,e){return this.find(t).play(e)},t.prototype.stop=function(t){return this.find(t).stop()},t.prototype.pause=function(t){return this.find(t).pause()},t.prototype.resume=function(t){return this.find(t).resume()},t.prototype.volume=function(t,e){var n=this.find(t);return void 0!==e&&(n.volume=e),n.volume},t.prototype.speed=function(t,e){var n=this.find(t);return void 0!==e&&(n.speed=e),n.speed},t.prototype.duration=function(t){return this.find(t).duration},t.prototype.close=function(){return this.removeAll(),this._sounds=null,this._webAudioContext&&(this._webAudioContext.destroy(),this._webAudioContext=null),this._htmlAudioContext&&(this._htmlAudioContext.destroy(),this._htmlAudioContext=null),this._context=null,this},t}(),G=0,I={get PLAY_ID(){return G},playOnce:function(t,e){var n="alias"+G++;return p().add(n,{url:t,preload:!0,autoPlay:!0,loaded:function(t){t&&(p().remove(n),e&&e(t))},complete:function(){p().remove(n),e&&e(null)}}),n},render:function(t,e){var n=document.createElement("canvas");e=c({width:512,height:128,fill:"black"},e||{}),n.width=e.width,n.height=e.height;var i=o.BaseTexture.from(n);if(!(t.media instanceof b))return i;var r=t.media,s=n.getContext("2d");s.fillStyle=e.fill;for(var u=r.buffer.getChannelData(0),a=Math.ceil(u.length/e.width),p=e.height/2,h=0;h<e.width;h++){for(var l=1,f=-1,d=0;d<a;d++){var _=u[h*a+d];_<l&&(l=_),_>f&&(f=_)}s.fillRect(h,(1+l)*p,1,Math.max(1,(f-l)*p))}return i},resolveUrl:S,sineTone:function(t,e){void 0===t&&(t=200),void 0===e&&(e=1);var n=T.from({singleInstance:!0});if(!(n.media instanceof b))return n;for(var o=n.media,i=n.context.audioContext.createBuffer(1,48e3*e,48e3),r=i.getChannelData(0),s=0;s<r.length;s++){var u=t*(s/i.sampleRate)*Math.PI;r[s]=2*Math.sin(u)}return o.buffer=i,n.isLoaded=!0,n},extensions:L,supported:F},q=function(t){return a=t,t}(new R);t.Loader.registerPlugin(k),Object.defineProperties(q,{Filterable:{get:function(){return i}},filters:{get:function(){return x}},htmlaudio:{get:function(){return A}},Sound:{get:function(){return T}},SoundLibrary:{get:function(){return R}},SoundSprite:{get:function(){return M}},utils:{get:function(){return I}},webaudio:{get:function(){return P}},sound:{get:function(){return q}}});var K=q;exports.default=K;
},{"@pixi/loaders":"bw5V","@pixi/ticker":"AWzT","@pixi/utils":"X4iF","@pixi/core":"lj2a"}],"rqRq":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/roll_01.e1c505d5.mp3";
},{}],"O9JV":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/click_02.d2a55495.mp3";
},{}],"VCeQ":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_shape_1.e57977f9.mp3";
},{}],"Wf21":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_shape_2.3737c1e1.mp3";
},{}],"WSCq":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_shape_3.c0d1b8db.mp3";
},{}],"M7TH":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_shape_4.e5a014d7.mp3";
},{}],"zEY1":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_shape_5.17190c99.mp3";
},{}],"tSms":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_joint_1.3c62b6c6.mp3";
},{}],"H71I":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_joint_2.e7dd119e.mp3";
},{}],"qwxQ":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_joint_3.6deccb64.mp3";
},{}],"J5PP":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_joint_4.918ac01f.mp3";
},{}],"Q08G":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/create_joint_5.2b2f3569.mp3";
},{}],"NmTX":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/Incredibots_Intro.ed3057eb.mp3";
},{}],"zMH3":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/Incredibots_Win_r1.91aacfa2.mp3";
},{}],"E8ny":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/Incredibots_Lose_r2.98ee4e18.mp3";
},{}],"uEc4":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/incredibots2_logo.026e4393.png";
},{}],"UMr5":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_1_L.2fd34588.png";
},{}],"Jmk5":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_1_M.34c35c13.png";
},{}],"Djum":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_1_R.7f8f8f81.png";
},{}],"QWkq":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_2_L.4c7b040a.png";
},{}],"t9tb":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_2_M.caa08214.png";
},{}],"svMc":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_2_R.500f9c17.png";
},{}],"fXCq":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_other_L.0938ff48.png";
},{}],"Y7JB":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_other_M.7f7e269d.png";
},{}],"TdcD":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_box_other_R.b4b32bf9.png";
},{}],"yFWD":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_checkbox_levels_A.5debe601.png";
},{}],"wo7d":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_checkbox_levels_B.d82ddb9b.png";
},{}],"fzWI":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_starthere_text.04302561.png";
},{}],"yYfL":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/levelselect_starthere_arrow.f2f90529.png";
},{}],"rsnw":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_red_base.1b0f4e2a.png";
},{}],"WVuP":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_red_roll.82fbcd72.png";
},{}],"mI81":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_red_click.57dcc910.png";
},{}],"LGo7":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_purple_base.780693b3.png";
},{}],"RNS1":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_purple_roll.b1994ded.png";
},{}],"ilyK":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_purple_click.e9e1a783.png";
},{}],"kVPt":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_blue_base.efdfc3ec.png";
},{}],"K5Fc":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_blue_roll.5e9a0688.png";
},{}],"qlgj":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_blue_click.26094f5e.png";
},{}],"zyjf":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_pink_base.45b09cf7.png";
},{}],"Nnn9":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_pink_roll.c1a1e763.png";
},{}],"TsMk":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_pink_click.1d73cae2.png";
},{}],"mwft":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_orange_base.2e52929e.png";
},{}],"fNOv":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_orange_roll.4ca91ed8.png";
},{}],"zqGB":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_orange_click.a3e986df.png";
},{}],"nO6G":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_play_base.0c382f8f.png";
},{}],"r4gB":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_play_roll.b144f681.png";
},{}],"uOr3":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_play_click.ca9f95c8.png";
},{}],"KRnj":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_X_base.3381527d.png";
},{}],"BL8h":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_X_roll.f26c2e88.png";
},{}],"h8xC":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_X_click.5314adad.png";
},{}],"vN4E":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box120_top.dabf20a1.png";
},{}],"FX6V":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box120_bot.56e4b8c5.png";
},{}],"k1tC":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box120_mid.307da1da.png";
},{}],"vFfY":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box154_top.578d11e2.png";
},{}],"pa4Q":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box154_bot.3d084567.png";
},{}],"ZtjE":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box154_mid.a9cb5714.png";
},{}],"lzTO":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box200_top.cd46bdca.png";
},{}],"pPny":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box200_bot.8104d0ef.png";
},{}],"DQS9":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box200_mid.9f594aff.png";
},{}],"zwVP":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box248_top.7d801a9c.png";
},{}],"RHhy":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box248_bot.18b75c19.png";
},{}],"b2Di":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box248_mid.daf42d3e.png";
},{}],"Ks0W":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box547_top.12e6e2f4.png";
},{}],"JOfO":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box547_bot.dcbdd066.png";
},{}],"p6ow":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/box547_mid.1dae50ef.png";
},{}],"lSjS":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/topbox_left.38b3db40.png";
},{}],"ukAH":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/topbox_right.ad72dfa4.png";
},{}],"xHXu":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/topbox_mid.f3bd5b5d.png";
},{}],"qW8q":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_restrictions_box_L.970db22c.png";
},{}],"n3xr":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_restrictions_box_R.5e4ea036.png";
},{}],"uPol":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_restrictions_box_M.0472df86.png";
},{}],"A2Dt":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_winloss_box_L.4feb2875.png";
},{}],"zHew":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_winloss_box_R.0a972d9d.png";
},{}],"ogoW":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_winloss_box_M.e23edca3.png";
},{}],"DCQ6":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_winloss_box_linebox.9991871b.png";
},{}],"GDIT":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chall_ed_winloss_box_linehoriz.89605882.png";
},{}],"tnmv":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubar.6fa296ad.png";
},{}],"vzeR":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubar_roll.91e3d254.png";
},{}],"jIsX":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubox_chkboxA_base.cd2e7555.png";
},{}],"RRhG":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubox_chkboxA_roll.8b0c56c5.png";
},{}],"wqeP":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubox_chkboxA_click.95b2fa10.png";
},{}],"KjNk":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubox_chkboxB_base.797d45ff.png";
},{}],"lr79":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubox_chkboxB_roll.4fc49309.png";
},{}],"o0Yf":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/menubox_chkboxB_click.80c010d5.png";
},{}],"nhL3":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxA_base.ab9869ba.png";
},{}],"Ey7I":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxA_roll.165b6df1.png";
},{}],"N858":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxA_click.ec6bcfdf.png";
},{}],"Updy":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxA_disabled.ea3a81b3.png";
},{}],"Sxow":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxB_base.0dfab42e.png";
},{}],"hN4L":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxB_roll.26f3a620.png";
},{}],"wAkz":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxB_click.130f4be0.png";
},{}],"YkmS":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/chkboxB_disabled.45a0b7a5.png";
},{}],"lGNz":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/txtbox_base.276b4595.png";
},{}],"lgTu":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/txtbox_roll.bbe82f39.png";
},{}],"YMeh":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/txtbox_base_disabled.f947bc2b.png";
},{}],"VUDQ":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_purplearrow_base.d5346590.png";
},{}],"dPoJ":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_purplearrow_roll.8399e467.png";
},{}],"G2Xu":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/button_purplearrow_click.c3649cff.png";
},{}],"lC8l":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/listboxentry_base.ab9a6c1c.png";
},{}],"n8ze":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/listboxentry_roll.4efdac31.png";
},{}],"VnZQ":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/listboxentry_active.a6037f80.png";
},{}],"VVPG":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/listboxentry_wide_base.355ad809.png";
},{}],"V6uI":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/listboxentry_wide_roll.f0708777.png";
},{}],"U4Tn":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/listboxentry_wide_active.6f4434bd.png";
},{}],"J4J5":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/slider_groove.827ee54e.png";
},{}],"TTxi":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/slider_groove_disabled.defcaafe.png";
},{}],"s0Op":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/slider_arrow.81cc725d.png";
},{}],"Fj7H":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_0.f7bbf4b5.png";
},{}],"axjt":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_1.dda861ef.png";
},{}],"Th7t":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_2.412e541c.png";
},{}],"NBsq":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_3.63ec4901.png";
},{}],"EBzn":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_4.735af85b.png";
},{}],"Arc5":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_5.872f80da.png";
},{}],"XO9z":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_6.b31cac3e.png";
},{}],"zYG3":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_7.85276b82.png";
},{}],"bF0b":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_8.bdd05d82.png";
},{}],"atRL":[function(require,module,exports) {
module.exports="/Incredibots-2-HTML5-Open-Source/cloud_9.432ec0bc.png";
},{}],"VWUR":[function(require,module,exports) {
"use strict";var e=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Resource=exports.MouseCursor=void 0;const r=require("pixi.js"),u=e(require("pixi-sound")),o=e(require("../../../resource/roll_01.mp3")),t=e(require("../../../resource/click_02.mp3")),l=e(require("../../../resource/create_shape_1.mp3")),c=e(require("../../../resource/create_shape_2.mp3")),i=e(require("../../../resource/create_shape_3.mp3")),n=e(require("../../../resource/create_shape_4.mp3")),s=e(require("../../../resource/create_shape_5.mp3")),d=e(require("../../../resource/create_joint_1.mp3")),a=e(require("../../../resource/create_joint_2.mp3")),_=e(require("../../../resource/create_joint_3.mp3")),p=e(require("../../../resource/create_joint_4.mp3")),f=e(require("../../../resource/create_joint_5.mp3")),b=e(require("../../../resource/Incredibots_Intro.mp3")),g=e(require("../../../resource/Incredibots_Win_r1.mp3")),x=e(require("../../../resource/Incredibots_Lose_r2.mp3")),q=e(require("../../../resource/incredibots2_logo.png")),h=e(require("../../../resource/levelselect_box_1_L.png")),G=e(require("../../../resource/levelselect_box_1_M.png")),B=e(require("../../../resource/levelselect_box_1_R.png")),k=e(require("../../../resource/levelselect_box_2_L.png")),m=e(require("../../../resource/levelselect_box_2_M.png")),C=e(require("../../../resource/levelselect_box_2_R.png")),v=e(require("../../../resource/levelselect_box_other_L.png")),w=e(require("../../../resource/levelselect_box_other_M.png")),S=e(require("../../../resource/levelselect_box_other_R.png")),L=e(require("../../../resource/levelselect_checkbox_levels_A.png")),R=e(require("../../../resource/levelselect_checkbox_levels_B.png")),W=e(require("../../../resource/levelselect_starthere_text.png")),M=e(require("../../../resource/levelselect_starthere_arrow.png")),A=e(require("../../../resource/button_red_base.png")),y=e(require("../../../resource/button_red_roll.png")),P=e(require("../../../resource/button_red_click.png")),T=e(require("../../../resource/button_purple_base.png")),I=e(require("../../../resource/button_purple_roll.png")),j=e(require("../../../resource/button_purple_click.png")),O=e(require("../../../resource/button_blue_base.png")),X=e(require("../../../resource/button_blue_roll.png")),D=e(require("../../../resource/button_blue_click.png")),J=e(require("../../../resource/button_pink_base.png")),H=e(require("../../../resource/button_pink_roll.png")),z=e(require("../../../resource/button_pink_click.png")),U=e(require("../../../resource/button_orange_base.png")),E=e(require("../../../resource/button_orange_roll.png")),F=e(require("../../../resource/button_orange_click.png")),K=e(require("../../../resource/button_play_base.png")),N=e(require("../../../resource/button_play_roll.png")),Q=e(require("../../../resource/button_play_click.png")),V=e(require("../../../resource/button_X_base.png")),Y=e(require("../../../resource/button_X_roll.png")),Z=e(require("../../../resource/button_X_click.png")),$=e(require("../../../resource/box120_top.png")),ee=e(require("../../../resource/box120_bot.png")),re=e(require("../../../resource/box120_mid.png")),ue=e(require("../../../resource/box154_top.png")),oe=e(require("../../../resource/box154_bot.png")),te=e(require("../../../resource/box154_mid.png")),le=e(require("../../../resource/box200_top.png")),ce=e(require("../../../resource/box200_bot.png")),ie=e(require("../../../resource/box200_mid.png")),ne=e(require("../../../resource/box248_top.png")),se=e(require("../../../resource/box248_bot.png")),de=e(require("../../../resource/box248_mid.png")),ae=e(require("../../../resource/box547_top.png")),_e=e(require("../../../resource/box547_bot.png")),pe=e(require("../../../resource/box547_mid.png")),fe=e(require("../../../resource/topbox_left.png")),be=e(require("../../../resource/topbox_right.png")),ge=e(require("../../../resource/topbox_mid.png")),xe=e(require("../../../resource/chall_ed_restrictions_box_L.png")),qe=e(require("../../../resource/chall_ed_restrictions_box_R.png")),he=e(require("../../../resource/chall_ed_restrictions_box_M.png")),Ge=e(require("../../../resource/chall_ed_winloss_box_L.png")),Be=e(require("../../../resource/chall_ed_winloss_box_R.png")),ke=e(require("../../../resource/chall_ed_winloss_box_M.png")),me=e(require("../../../resource/chall_ed_winloss_box_linebox.png")),Ce=e(require("../../../resource/chall_ed_winloss_box_linehoriz.png")),ve=e(require("../../../resource/menubar.png")),we=e(require("../../../resource/menubar_roll.png")),Se=e(require("../../../resource/menubox_chkboxA_base.png")),Le=e(require("../../../resource/menubox_chkboxA_roll.png")),Re=e(require("../../../resource/menubox_chkboxA_click.png")),We=e(require("../../../resource/menubox_chkboxB_base.png")),Me=e(require("../../../resource/menubox_chkboxB_roll.png")),Ae=e(require("../../../resource/menubox_chkboxB_click.png")),ye=e(require("../../../resource/chkboxA_base.png")),Pe=e(require("../../../resource/chkboxA_roll.png")),Te=e(require("../../../resource/chkboxA_click.png")),Ie=e(require("../../../resource/chkboxA_disabled.png")),je=e(require("../../../resource/chkboxB_base.png")),Oe=e(require("../../../resource/chkboxB_roll.png")),Xe=e(require("../../../resource/chkboxB_click.png")),De=e(require("../../../resource/chkboxB_disabled.png")),Je=e(require("../../../resource/txtbox_base.png")),He=e(require("../../../resource/txtbox_roll.png")),ze=e(require("../../../resource/txtbox_base_disabled.png")),Ue=e(require("../../../resource/button_purplearrow_base.png")),Ee=e(require("../../../resource/button_purplearrow_roll.png")),Fe=e(require("../../../resource/button_purplearrow_click.png")),Ke=e(require("../../../resource/listboxentry_base.png")),Ne=e(require("../../../resource/listboxentry_roll.png")),Qe=e(require("../../../resource/listboxentry_active.png")),Ve=e(require("../../../resource/listboxentry_wide_base.png")),Ye=e(require("../../../resource/listboxentry_wide_roll.png")),Ze=e(require("../../../resource/listboxentry_wide_active.png")),$e=e(require("../../../resource/slider_groove.png")),er=e(require("../../../resource/slider_groove_disabled.png")),rr=e(require("../../../resource/slider_arrow.png")),ur=e(require("../../../resource/cloud_0.png")),or=e(require("../../../resource/cloud_1.png")),tr=e(require("../../../resource/cloud_2.png")),lr=e(require("../../../resource/cloud_3.png")),cr=e(require("../../../resource/cloud_4.png")),ir=e(require("../../../resource/cloud_5.png")),nr=e(require("../../../resource/cloud_6.png")),sr=e(require("../../../resource/cloud_7.png")),dr=e(require("../../../resource/cloud_8.png")),ar=e(require("../../../resource/cloud_9.png"));class _r{constructor(){this.defaultIcon="url('resource/mouse_pointer.png'),auto",this.hoverIcon="url('resource/mopuse_hourglass.png'),auto"}apply(e){e.renderer.plugins.interaction.cursorStyles.default=this.defaultIcon,e.renderer.plugins.interaction.cursorStyles.hover=this.hoverIcon}}exports.MouseCursor=_r;class pr{static async load(){const e=[];for(const r in pr.paths)e.push(fetch(pr.paths[r]).then(e=>e.blob()).then(e=>pr[r]=e));for(const u in pr.textures)e.push(r.Texture.fromURL(pr.textures[u]).then(e=>pr[u]=e));await Promise.all(e)}}exports.Resource=pr,pr.paths={cReplay:"resource/replay.dat",cRobot:"resource/robot.dat"},pr.textures={cMainMenuLogo:q.default,cLevelSelectBox1L:h.default,cLevelSelectBox1M:G.default,cLevelSelectBox1R:B.default,cLevelSelectBox2L:k.default,cLevelSelectBox2M:m.default,cLevelSelectBox2R:C.default,cLevelSelectOtherBoxL:v.default,cLevelSelectOtherBoxM:w.default,cLevelSelectOtherBoxR:S.default,cLevelSelectLevelCheckBoxA:L.default,cLevelSelectLevelCheckBoxB:R.default,cLevelSelectStartHereText:W.default,cLevelSelectStartHereArrow:M.default,cGuiButtonRedBase:A.default,cGuiButtonRedRoll:y.default,cGuiButtonRedClick:P.default,cGuiButtonPurpleBase:T.default,cGuiButtonPurpleRoll:I.default,cGuiButtonPurpleClick:j.default,cGuiButtonBlueBase:O.default,cGuiButtonBlueRoll:X.default,cGuiButtonBlueClick:D.default,cGuiButtonPinkBase:J.default,cGuiButtonPinkRoll:H.default,cGuiButtonPinkClick:z.default,cGuiButtonOrangeBase:U.default,cGuiButtonOrangeRoll:E.default,cGuiButtonOrangeClick:F.default,cGuiButtonPlayBase:K.default,cGuiButtonPlayRoll:N.default,cGuiButtonPlayClick:Q.default,cGuiButtonXBase:V.default,cGuiButtonXRoll:Y.default,cGuiButtonXClick:Z.default,cGuiWindowTop120:$.default,cGuiWindowBottom120:ee.default,cGuiWindowMid120:re.default,cGuiWindowTop154:ue.default,cGuiWindowBottom154:oe.default,cGuiWindowMid154:te.default,cGuiWindowTop200:le.default,cGuiWindowBottom200:ce.default,cGuiWindowMid200:ie.default,cGuiWindowTop248:ne.default,cGuiWindowBottom248:se.default,cGuiWindowMid248:de.default,cGuiWindowTop547:ae.default,cGuiWindowBottom547:_e.default,cGuiWindowMid547:pe.default,cGuiWindowLeft800:fe.default,cGuiWindowRight800:be.default,cGuiWindowMid800:ge.default,cGuiWindowLeft600:xe.default,cGuiWindowRight600:qe.default,cGuiWindowMid600:he.default,cGuiWindowLeft700:Ge.default,cGuiWindowRight700:Be.default,cGuiWindowMid700:ke.default,cGuiWindowLinebox:me.default,cGuiWindowLine:Ce.default,cGuiMenuBar:ve.default,cGuiMenuBarRoll:we.default,cGuiMenuCheckBoxABase:Se.default,cGuiMenuCheckBoxARoll:Le.default,cGuiMenuCheckBoxAClick:Re.default,cGuiMenuCheckBoxBBase:We.default,cGuiMenuCheckBoxBRoll:Me.default,cGuiMenuCheckBoxBClick:Ae.default,cGuiCheckboxABase:ye.default,cGuiCheckboxARoll:Pe.default,cGuiCheckboxAClick:Te.default,cGuiCheckboxADisabled:Ie.default,cGuiCheckboxBBase:je.default,cGuiCheckboxBRoll:Oe.default,cGuiCheckboxBClick:Xe.default,cGuiCheckboxBDisabled:De.default,cGuiTextAreaBase:Je.default,cGuiTextAreaRoll:He.default,cGuiTextAreaDisabled:ze.default,cGuiComboboxBase:Ue.default,cGuiComboboxRoll:Ee.default,cGuiComboboxClick:Fe.default,cGuiListboxBase:Ke.default,cGuiListboxRoll:Ne.default,cGuiListboxClick:Qe.default,cGuiListboxWideBase:Ve.default,cGuiListboxWideRoll:Ye.default,cGuiListboxWideClick:Ze.default,cGuiSliderGroove:$e.default,cGuiSliderGrooveDisabled:er.default,cGuiSliderThumb:rr.default,cCloud0:ur.default,cCloud1:or.default,cCloud2:tr.default,cCloud3:lr.default,cCloud4:cr.default,cCloud5:ir.default,cCloud6:nr.default,cCloud7:sr.default,cCloud8:dr.default,cCloud9:ar.default},pr.cRoll=u.default.Sound.from(o.default),pr.cClick=u.default.Sound.from(t.default),pr.cShape1=u.default.Sound.from(l.default),pr.cShape2=u.default.Sound.from(c.default),pr.cShape3=u.default.Sound.from(i.default),pr.cShape4=u.default.Sound.from(n.default),pr.cShape5=u.default.Sound.from(s.default),pr.cJoint1=u.default.Sound.from(d.default),pr.cJoint2=u.default.Sound.from(a.default),pr.cJoint3=u.default.Sound.from(_.default),pr.cJoint4=u.default.Sound.from(p.default),pr.cJoint5=u.default.Sound.from(f.default),pr.cIntro=u.default.Sound.from(b.default),pr.cWin=u.default.Sound.from(g.default),pr.cLose=u.default.Sound.from(x.default);
},{"pixi.js":"aQiP","pixi-sound":"TSDb","../../../resource/roll_01.mp3":"rqRq","../../../resource/click_02.mp3":"O9JV","../../../resource/create_shape_1.mp3":"VCeQ","../../../resource/create_shape_2.mp3":"Wf21","../../../resource/create_shape_3.mp3":"WSCq","../../../resource/create_shape_4.mp3":"M7TH","../../../resource/create_shape_5.mp3":"zEY1","../../../resource/create_joint_1.mp3":"tSms","../../../resource/create_joint_2.mp3":"H71I","../../../resource/create_joint_3.mp3":"qwxQ","../../../resource/create_joint_4.mp3":"J5PP","../../../resource/create_joint_5.mp3":"Q08G","../../../resource/Incredibots_Intro.mp3":"NmTX","../../../resource/Incredibots_Win_r1.mp3":"zMH3","../../../resource/Incredibots_Lose_r2.mp3":"E8ny","../../../resource/incredibots2_logo.png":"uEc4","../../../resource/levelselect_box_1_L.png":"UMr5","../../../resource/levelselect_box_1_M.png":"Jmk5","../../../resource/levelselect_box_1_R.png":"Djum","../../../resource/levelselect_box_2_L.png":"QWkq","../../../resource/levelselect_box_2_M.png":"t9tb","../../../resource/levelselect_box_2_R.png":"svMc","../../../resource/levelselect_box_other_L.png":"fXCq","../../../resource/levelselect_box_other_M.png":"Y7JB","../../../resource/levelselect_box_other_R.png":"TdcD","../../../resource/levelselect_checkbox_levels_A.png":"yFWD","../../../resource/levelselect_checkbox_levels_B.png":"wo7d","../../../resource/levelselect_starthere_text.png":"fzWI","../../../resource/levelselect_starthere_arrow.png":"yYfL","../../../resource/button_red_base.png":"rsnw","../../../resource/button_red_roll.png":"WVuP","../../../resource/button_red_click.png":"mI81","../../../resource/button_purple_base.png":"LGo7","../../../resource/button_purple_roll.png":"RNS1","../../../resource/button_purple_click.png":"ilyK","../../../resource/button_blue_base.png":"kVPt","../../../resource/button_blue_roll.png":"K5Fc","../../../resource/button_blue_click.png":"qlgj","../../../resource/button_pink_base.png":"zyjf","../../../resource/button_pink_roll.png":"Nnn9","../../../resource/button_pink_click.png":"TsMk","../../../resource/button_orange_base.png":"mwft","../../../resource/button_orange_roll.png":"fNOv","../../../resource/button_orange_click.png":"zqGB","../../../resource/button_play_base.png":"nO6G","../../../resource/button_play_roll.png":"r4gB","../../../resource/button_play_click.png":"uOr3","../../../resource/button_X_base.png":"KRnj","../../../resource/button_X_roll.png":"BL8h","../../../resource/button_X_click.png":"h8xC","../../../resource/box120_top.png":"vN4E","../../../resource/box120_bot.png":"FX6V","../../../resource/box120_mid.png":"k1tC","../../../resource/box154_top.png":"vFfY","../../../resource/box154_bot.png":"pa4Q","../../../resource/box154_mid.png":"ZtjE","../../../resource/box200_top.png":"lzTO","../../../resource/box200_bot.png":"pPny","../../../resource/box200_mid.png":"DQS9","../../../resource/box248_top.png":"zwVP","../../../resource/box248_bot.png":"RHhy","../../../resource/box248_mid.png":"b2Di","../../../resource/box547_top.png":"Ks0W","../../../resource/box547_bot.png":"JOfO","../../../resource/box547_mid.png":"p6ow","../../../resource/topbox_left.png":"lSjS","../../../resource/topbox_right.png":"ukAH","../../../resource/topbox_mid.png":"xHXu","../../../resource/chall_ed_restrictions_box_L.png":"qW8q","../../../resource/chall_ed_restrictions_box_R.png":"n3xr","../../../resource/chall_ed_restrictions_box_M.png":"uPol","../../../resource/chall_ed_winloss_box_L.png":"A2Dt","../../../resource/chall_ed_winloss_box_R.png":"zHew","../../../resource/chall_ed_winloss_box_M.png":"ogoW","../../../resource/chall_ed_winloss_box_linebox.png":"DCQ6","../../../resource/chall_ed_winloss_box_linehoriz.png":"GDIT","../../../resource/menubar.png":"tnmv","../../../resource/menubar_roll.png":"vzeR","../../../resource/menubox_chkboxA_base.png":"jIsX","../../../resource/menubox_chkboxA_roll.png":"RRhG","../../../resource/menubox_chkboxA_click.png":"wqeP","../../../resource/menubox_chkboxB_base.png":"KjNk","../../../resource/menubox_chkboxB_roll.png":"lr79","../../../resource/menubox_chkboxB_click.png":"o0Yf","../../../resource/chkboxA_base.png":"nhL3","../../../resource/chkboxA_roll.png":"Ey7I","../../../resource/chkboxA_click.png":"N858","../../../resource/chkboxA_disabled.png":"Updy","../../../resource/chkboxB_base.png":"Sxow","../../../resource/chkboxB_roll.png":"hN4L","../../../resource/chkboxB_click.png":"wAkz","../../../resource/chkboxB_disabled.png":"YkmS","../../../resource/txtbox_base.png":"lGNz","../../../resource/txtbox_roll.png":"lgTu","../../../resource/txtbox_base_disabled.png":"YMeh","../../../resource/button_purplearrow_base.png":"VUDQ","../../../resource/button_purplearrow_roll.png":"dPoJ","../../../resource/button_purplearrow_click.png":"G2Xu","../../../resource/listboxentry_base.png":"lC8l","../../../resource/listboxentry_roll.png":"n8ze","../../../resource/listboxentry_active.png":"VnZQ","../../../resource/listboxentry_wide_base.png":"VVPG","../../../resource/listboxentry_wide_roll.png":"V6uI","../../../resource/listboxentry_wide_active.png":"U4Tn","../../../resource/slider_groove.png":"J4J5","../../../resource/slider_groove_disabled.png":"TTxi","../../../resource/slider_arrow.png":"s0Op","../../../resource/cloud_0.png":"Fj7H","../../../resource/cloud_1.png":"axjt","../../../resource/cloud_2.png":"Th7t","../../../resource/cloud_3.png":"NBsq","../../../resource/cloud_4.png":"EBzn","../../../resource/cloud_5.png":"Arc5","../../../resource/cloud_6.png":"XO9z","../../../resource/cloud_7.png":"zYG3","../../../resource/cloud_8.png":"bF0b","../../../resource/cloud_9.png":"atRL"}],"K8aL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ControllerGameGlobals=void 0;const e=require("../Graphics/Resource");class a{}exports.ControllerGameGlobals=a,a.INIT_PHYS_SCALE=30,a.MIN_ZOOM_VAL=12,a.MAX_ZOOM_VAL=75,a.ZOOM_FOCUS_X=400,a.ZOOM_FOCUS_Y=310,a.REPLAY_SYNC_FRAMES=3,a.ADMIN_USERS=["Oliver","Ryan Clark","aaaaajon","andreas002","BillyJimBob","EMDF","fighterlegend","Sruixan","Illume","Cheeseyx","Leafsnail","bigjohnpalmer","jayther","Spedione","Thax","b0tman","zom","KyuubisSlave","Redstater","rutgersemp","Euphrates","lakeeriesuperstar","SilverGun","mattbob","bowman9898","willempiee","dark dan21","pandm"],a.playingReplay=!1,a.viewingUnsavedReplay=!1,a.replayDirectlyLinked=!1,a.collisionGroup=1,a.wasMouseDown=!1,a.minDensity=1,a.maxDensity=30,a.maxRJStrength=30,a.maxRJSpeed=30,a.maxSJStrength=30,a.maxSJSpeed=30,a.maxThrusterStrength=30,a.initX=Number.MAX_VALUE,a.initY=Number.MAX_VALUE,a.initZoom=Number.MAX_VALUE,a.defaultR=253,a.defaultG=66,a.defaultB=42,a.defaultO=255,a.clickedBox=!1,a.adStarted=!1,a.snapToCenter=!0,a.showJoints=!0,a.showOutlines=!0,a.showGraphics=!0,a.showColours=!0,a.centerOnSelected=!1,a.failedChallenge=!1,a.justLoadedRobotWithChallenge=!1,a.cannonballs=[],a.showTutorial=!0,a.ratedCurRobot=!1,a.ratedCurReplay=!1,a.ratedCurChallenge=!1,a.loadAndInsert=!1,a.potentialRobotID="",a.potentialRobotEditable=!1,a.potentialRobotPublic=!1,a.potentialRobotFeatured=!1,a.potentialChallengeID="",a.potentialChallengeEditable=!1,a.potentialChallengePublic=!1,a.potentialChallengeFeatured=!1,a.potentialReplayID="",a.potentialReplayPublic=!1,a.potentialReplayFeatured=!1,a.curRobotID="",a.curRobotEditable=!0,a.curRobotPublic=!1,a.curRobotFeatured=!1,a.curChallengeID="",a.curChallengePublic=!1,a.curChallengeFeatured=!1,a.curReplayID="",a.curReplayPublic=!1,a.curReplayFeatured=!1,a.userName="_Public",a.password="",a.sessionID="",a.clipboardParts=[],a.replayParts=[],a.loadedParts=[],a.shapeSound1=e.Resource.cShape1,a.shapeSound2=e.Resource.cShape2,a.shapeSound3=e.Resource.cShape3,a.shapeSound4=e.Resource.cShape4,a.shapeSound5=e.Resource.cShape5,a.jointSound1=e.Resource.cJoint1,a.jointSound2=e.Resource.cJoint2,a.jointSound3=e.Resource.cJoint3,a.jointSound4=e.Resource.cJoint4,a.jointSound5=e.Resource.cJoint5,a.winSound=e.Resource.cWin,a.loseSound=e.Resource.cLose,a.introVolume=.5,a.NEW_CIRCLE=0,a.NEW_RECT=1,a.NEW_TRIANGLE=2,a.NEW_FIXED_JOINT=3,a.NEW_REVOLUTE_JOINT=4,a.NEW_PRISMATIC_JOINT=5,a.ROTATE=6,a.PASTE=7,a.BOX_SELECTING=8,a.FINALIZING_JOINT=9,a.NEW_TEXT=10,a.RESIZING_TEXT=11,a.RESIZING_SHAPES=12,a.NEW_THRUSTERS=13,a.DRAWING_BOX=14,a.DRAWING_HORIZONTAL_LINE=15,a.DRAWING_VERTICAL_LINE=16,a.SELECTING_SHAPE=17,a.DRAWING_BUILD_BOX=18,a.NEW_CANNON=19;
},{"../Graphics/Resource":"VWUR"}],"nssz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2_maxPolygonVertices=exports.b2_lengthUnitsPerMeter=void 0,exports.b2_lengthUnitsPerMeter=1,exports.b2_maxPolygonVertices=8;
},{}],"xZSi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2MakeArray=exports.b2MakeBooleanArray=exports.b2MakeNumberArray=exports.b2_version=exports.b2_angularSleepTolerance=exports.b2_linearSleepTolerance=exports.b2_timeToSleep=exports.b2_toiBaumgarte=exports.b2_baumgarte=exports.b2_maxRotationSquared=exports.b2_maxRotation=exports.b2_maxTranslationSquared=exports.b2_maxTranslation=exports.b2_maxAngularCorrection=exports.b2_maxLinearCorrection=exports.b2_maxTOIContacts=exports.b2_maxSubSteps=exports.b2_polygonRadius=exports.b2_angularSlop=exports.b2_linearSlop=exports.b2_aabbMultiplier=exports.b2_aabbExtension=exports.b2_maxManifoldPoints=exports.b2_epsilon_sq=exports.b2_epsilon=exports.b2_maxFloat=exports.b2Verify=exports.b2Assert=void 0;const e=require("./b2_settings");function r(e,r){if(!e)throw new Error(r)}function t(e){if(null===e)throw new Error;return e}function o(e,r=0){const t=new Array(e);for(let o=0;o<e;o++)t[o]=r;return t}function a(e,r=!1){const t=new Array(e);for(let o=0;o<e;o++)t[o]=r;return t}function s(e,r){const t=new Array(e);for(let o=0;o<e;o++)t[o]=new r;return t}exports.b2Assert=r,exports.b2Verify=t,exports.b2_maxFloat=1e37,exports.b2_epsilon=1e-5,exports.b2_epsilon_sq=exports.b2_epsilon*exports.b2_epsilon,exports.b2_maxManifoldPoints=2,exports.b2_aabbExtension=.1*e.b2_lengthUnitsPerMeter,exports.b2_aabbMultiplier=4,exports.b2_linearSlop=.005*e.b2_lengthUnitsPerMeter,exports.b2_angularSlop=2/180*Math.PI,exports.b2_polygonRadius=2*exports.b2_linearSlop,exports.b2_maxSubSteps=8,exports.b2_maxTOIContacts=32,exports.b2_maxLinearCorrection=.2*e.b2_lengthUnitsPerMeter,exports.b2_maxAngularCorrection=8/180*Math.PI,exports.b2_maxTranslation=2*e.b2_lengthUnitsPerMeter,exports.b2_maxTranslationSquared=exports.b2_maxTranslation*exports.b2_maxTranslation,exports.b2_maxRotation=.5*Math.PI,exports.b2_maxRotationSquared=exports.b2_maxRotation*exports.b2_maxRotation,exports.b2_baumgarte=.2,exports.b2_toiBaumgarte=.75,exports.b2_timeToSleep=.5,exports.b2_linearSleepTolerance=.01*e.b2_lengthUnitsPerMeter,exports.b2_angularSleepTolerance=2/180*Math.PI,exports.b2_version={major:2,minor:4,patch:0},exports.b2MakeNumberArray=o,exports.b2MakeBooleanArray=a,exports.b2MakeArray=s;
},{"./b2_settings":"nssz"}],"YmMi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Sweep=exports.b2Transform=exports.b2Rot=exports.b2Mat33=exports.b2Mat22=exports.b2Vec3=exports.b2Vec2=exports.b2RandomInt=exports.b2RandomFloat=exports.b2Random=exports.b2IsPowerOfTwo=exports.b2NextPowerOfTwo=exports.b2RadToDeg=exports.b2DegToRad=exports.b2Clamp=exports.b2_two_pi=exports.b2_180_over_pi=exports.b2_pi_over_180=void 0;const t=require("./b2_common");function e(t,e,s){return t<e?e:t>s?s:t}function s(t){return t*exports.b2_pi_over_180}function i(t){return t*exports.b2_180_over_pi}function r(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}function h(t){return t>0&&0==(t&t-1)}function y(){return 2*Math.random()-1}function x(t,e){return(e-t)*Math.random()+t}function n(t,e){return Math.round((e-t)*Math.random()+t)}exports.b2_pi_over_180=Math.PI/180,exports.b2_180_over_pi=180/Math.PI,exports.b2_two_pi=2*Math.PI,exports.b2Clamp=e,exports.b2DegToRad=s,exports.b2RadToDeg=i,exports.b2NextPowerOfTwo=r,exports.b2IsPowerOfTwo=h,exports.b2Random=y,exports.b2RandomFloat=x,exports.b2RandomInt=n;class o{constructor(t=0,e=0){this.x=t,this.y=e}Clone(){return new o(this.x,this.y)}SetZero(){return this.x=0,this.y=0,this}Set(t,e){return this.x=t,this.y=e,this}Copy(t){return this.x=t.x,this.y=t.y,this}Add(t){return this.x+=t.x,this.y+=t.y,this}AddXY(t,e){return this.x+=t,this.y+=e,this}Subtract(t){return this.x-=t.x,this.y-=t.y,this}SubtractXY(t,e){return this.x-=t,this.y-=e,this}Scale(t){return this.x*=t,this.y*=t,this}AddScaled(t,e){return this.x+=t*e.x,this.y+=t*e.y,this}SubtractScaled(t,e){return this.x-=t*e.x,this.y-=t*e.y,this}Dot(t){return this.x*t.x+this.y*t.y}Cross(t){return this.x*t.y-this.y*t.x}Length(){const{x:t,y:e}=this;return Math.sqrt(t*t+e*e)}LengthSquared(){const{x:t,y:e}=this;return t*t+e*e}Normalize(){const e=this.Length();if(e<t.b2_epsilon)return 0;const s=1/e;return this.x*=s,this.y*=s,e}Rotate(t){const e=Math.cos(t),s=Math.sin(t),{x:i}=this;return this.x=e*i-s*this.y,this.y=s*i+e*this.y,this}RotateCosSin(t,e){const{x:s}=this;return this.x=t*s-e*this.y,this.y=e*s+t*this.y,this}IsValid(){return Number.isFinite(this.x)&&Number.isFinite(this.y)}Abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}GetAbs(t){return t.x=Math.abs(this.x),t.y=Math.abs(this.y),t}Negate(){return this.x=-this.x,this.y=-this.y,this}Skew(){const{x:t}=this;return this.x=-this.y,this.y=t,this}static Min(t,e,s){return s.x=Math.min(t.x,e.x),s.y=Math.min(t.y,e.y),s}static Max(t,e,s){return s.x=Math.max(t.x,e.x),s.y=Math.max(t.y,e.y),s}static Clamp(t,s,i,r){return r.x=e(t.x,s.x,i.x),r.y=e(t.y,s.y,i.y),r}static Rotate(t,e,s){const i=t.x,r=t.y,h=Math.cos(e),y=Math.sin(e);return s.x=h*i-y*r,s.y=y*i+h*r,s}static Dot(t,e){return t.x*e.x+t.y*e.y}static Cross(t,e){return t.x*e.y-t.y*e.x}static CrossVec2Scalar(t,e,s){const i=t.x;return s.x=e*t.y,s.y=-e*i,s}static CrossVec2One(t,e){const s=t.x;return e.x=t.y,e.y=-s,e}static CrossScalarVec2(t,e,s){const i=e.x;return s.x=-t*e.y,s.y=t*i,s}static CrossOneVec2(t,e){const s=t.x;return e.x=-t.y,e.y=s,e}static Add(t,e,s){return s.x=t.x+e.x,s.y=t.y+e.y,s}static Subtract(t,e,s){return s.x=t.x-e.x,s.y=t.y-e.y,s}static Scale(t,e,s){return s.x=e.x*t,s.y=e.y*t,s}static AddScaled(t,e,s,i){return i.x=t.x+e*s.x,i.y=t.y+e*s.y,i}static SubtractScaled(t,e,s,i){return i.x=t.x-e*s.x,i.y=t.y-e*s.y,i}static AddCrossScalarVec2(t,e,s,i){const r=s.x;return i.x=t.x-e*s.y,i.y=t.y+e*r,i}static Mid(t,e,s){return s.x=.5*(t.x+e.x),s.y=.5*(t.y+e.y),s}static Extents(t,e,s){return s.x=.5*(e.x-t.x),s.y=.5*(e.y-t.y),s}static Equals(t,e){return t.x===e.x&&t.y===e.y}static Distance(t,e){return Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2)}static DistanceSquared(t,e){return(t.x-e.x)**2+(t.y-e.y)**2}static Negate(t,e){return e.x=-t.x,e.y=-t.y,e}static Normalize(e,s){const i=e.x**2+e.y**2;if(i>=t.b2_epsilon_sq){const t=1/Math.sqrt(i);s.x=t*e.x,s.y=t*e.y}else s.x=0,s.y=0;return s}static Skew(t,e){const{x:s}=t;return e.x=-t.y,e.y=s,e}}exports.b2Vec2=o,o.ZERO=new o,o.UNITX=new o(1,0),o.UNITY=new o(0,1),o.s_t0=new o,o.s_t1=new o,o.s_t2=new o,o.s_t3=new o;class c{constructor(t=0,e=0,s=0){this.x=t,this.y=e,this.z=s}Clone(){return new c(this.x,this.y,this.z)}SetZero(){return this.x=0,this.y=0,this.z=0,this}Set(t,e,s){return this.x=t,this.y=e,this.z=s,this}Copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}Negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}Add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}AddXYZ(t,e,s){return this.x+=t,this.y+=e,this.z+=s,this}Subtract(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}SubtractXYZ(t,e,s){return this.x-=t,this.y-=e,this.z-=s,this}Scale(t){return this.x*=t,this.y*=t,this.z*=t,this}static Dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static Cross(t,e,s){const i=t.x,r=t.y,h=t.z,y=e.x,x=e.y,n=e.z;return s.x=r*n-h*x,s.y=h*y-i*n,s.z=i*x-r*y,s}}exports.b2Vec3=c,c.ZERO=new c(0,0,0),c.s_t0=new c;class a{constructor(){this.ex=new o(1,0),this.ey=new o(0,1)}Clone(){return(new a).Copy(this)}static FromColumns(t,e){return(new a).SetColumns(t,e)}static FromScalars(t,e,s,i){return(new a).SetScalars(t,e,s,i)}static FromAngle(t){return(new a).SetAngle(t)}SetScalars(t,e,s,i){return this.ex.Set(t,s),this.ey.Set(e,i),this}SetColumns(t,e){return this.ex.Copy(t),this.ey.Copy(e),this}SetAngle(t){const e=Math.cos(t),s=Math.sin(t);return this.ex.Set(e,s),this.ey.Set(-s,e),this}Copy(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this}SetIdentity(){return this.ex.Set(1,0),this.ey.Set(0,1),this}SetZero(){return this.ex.SetZero(),this.ey.SetZero(),this}GetAngle(){return Math.atan2(this.ex.y,this.ex.x)}Solve(t,e,s){const i=this.ex.x,r=this.ey.x,h=this.ex.y,y=this.ey.y;let x=i*y-r*h;return 0!==x&&(x=1/x),s.x=x*(y*t-r*e),s.y=x*(i*e-h*t),s}Abs(){return this.ex.Abs(),this.ey.Abs(),this}Inverse(){return this.GetInverse(this),this}Add(t){return this.ex.Add(t.ex),this.ey.Add(t.ey),this}Subtract(t){return this.ex.Subtract(t.ex),this.ey.Subtract(t.ey),this}GetInverse(t){const e=this.ex.x,s=this.ey.x,i=this.ex.y,r=this.ey.y;let h=e*r-s*i;return 0!==h&&(h=1/h),t.ex.x=h*r,t.ey.x=-h*s,t.ex.y=-h*i,t.ey.y=h*e,t}GetAbs(t){return t.ex.x=Math.abs(this.ex.x),t.ex.y=Math.abs(this.ex.y),t.ey.x=Math.abs(this.ey.x),t.ey.y=Math.abs(this.ey.y),t}static MultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.ex.x*i+t.ey.x*r,s.y=t.ex.y*i+t.ey.y*r,s}static TransposeMultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.ex.x*i+t.ex.y*r,s.y=t.ey.x*i+t.ey.y*r,s}static Add(t,e,s){return s.ex.x=t.ex.x+e.ex.x,s.ex.y=t.ex.y+e.ex.y,s.ey.x=t.ey.x+e.ey.x,s.ey.y=t.ey.y+e.ey.y,s}static Multiply(t,e,s){const i=t.ex.x,r=t.ex.y,h=t.ey.x,y=t.ey.y,x=e.ex.x,n=e.ex.y,o=e.ey.x,c=e.ey.y;return s.ex.x=i*x+h*n,s.ex.y=r*x+y*n,s.ey.x=i*o+h*c,s.ey.y=r*o+y*c,s}static TransposeMultiply(t,e,s){const i=t.ex.x,r=t.ex.y,h=t.ey.x,y=t.ey.y,x=e.ex.x,n=e.ex.y,o=e.ey.x,c=e.ey.y;return s.ex.x=i*x+r*n,s.ex.y=h*x+y*n,s.ey.x=i*o+r*c,s.ey.y=h*o+y*c,s}}exports.b2Mat22=a,a.IDENTITY=new a;class u{constructor(){this.ex=new c(1,0,0),this.ey=new c(0,1,0),this.ez=new c(0,0,1)}Clone(){return(new u).Copy(this)}SetColumns(t,e,s){return this.ex.Copy(t),this.ey.Copy(e),this.ez.Copy(s),this}Copy(t){return this.ex.Copy(t.ex),this.ey.Copy(t.ey),this.ez.Copy(t.ez),this}SetIdentity(){return this.ex.Set(1,0,0),this.ey.Set(0,1,0),this.ez.Set(0,0,1),this}SetZero(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this}Add(t){return this.ex.Add(t.ex),this.ey.Add(t.ey),this.ez.Add(t.ez),this}Solve33(t,e,s,i){const r=this.ex.x,h=this.ex.y,y=this.ex.z,x=this.ey.x,n=this.ey.y,o=this.ey.z,c=this.ez.x,a=this.ez.y,u=this.ez.z;let p=r*(n*u-o*a)+h*(o*c-x*u)+y*(x*a-n*c);return 0!==p&&(p=1/p),i.x=p*(t*(n*u-o*a)+e*(o*c-x*u)+s*(x*a-n*c)),i.y=p*(r*(e*u-s*a)+h*(s*c-t*u)+y*(t*a-e*c)),i.z=p*(r*(n*s-o*e)+h*(o*t-x*s)+y*(x*e-n*t)),i}Solve22(t,e,s){const i=this.ex.x,r=this.ey.x,h=this.ex.y,y=this.ey.y;let x=i*y-r*h;return 0!==x&&(x=1/x),s.x=x*(y*t-r*e),s.y=x*(i*e-h*t),s}GetInverse22(t){const e=this.ex.x,s=this.ey.x,i=this.ex.y,r=this.ey.y;let h=e*r-s*i;0!==h&&(h=1/h),t.ex.x=h*r,t.ey.x=-h*s,t.ex.z=0,t.ex.y=-h*i,t.ey.y=h*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0}GetSymInverse33(t){let e=c.Dot(this.ex,c.Cross(this.ey,this.ez,c.s_t0));0!==e&&(e=1/e);const s=this.ex.x,i=this.ey.x,r=this.ez.x,h=this.ey.y,y=this.ez.y,x=this.ez.z;t.ex.x=e*(h*x-y*y),t.ex.y=e*(r*y-i*x),t.ex.z=e*(i*y-r*h),t.ey.x=t.ex.y,t.ey.y=e*(s*x-r*r),t.ey.z=e*(r*i-s*y),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(s*h-i*i)}static MultiplyVec3(t,e,s){const{x:i,y:r,z:h}=e;return s.x=t.ex.x*i+t.ey.x*r+t.ez.x*h,s.y=t.ex.y*i+t.ey.y*r+t.ez.y*h,s.z=t.ex.z*i+t.ey.z*r+t.ez.z*h,s}static MultiplyVec2(t,e,s){const{x:i,y:r}=e;return s.x=t.ex.x*i+t.ey.x*r,s.y=t.ex.y*i+t.ey.y*r,s}}exports.b2Mat33=u,u.IDENTITY=new u;class p{constructor(t=0){this.s=0,this.c=1,t&&(this.s=Math.sin(t),this.c=Math.cos(t))}Clone(){return(new p).Copy(this)}Copy(t){return this.s=t.s,this.c=t.c,this}Set(t){return this.s=Math.sin(t),this.c=Math.cos(t),this}SetIdentity(){return this.s=0,this.c=1,this}GetAngle(){return Math.atan2(this.s,this.c)}GetXAxis(t){return t.x=this.c,t.y=this.s,t}GetYAxis(t){return t.x=-this.s,t.y=this.c,t}static Multiply(t,e,s){const i=t.s*e.c+t.c*e.s,r=t.c*e.c-t.s*e.s;return s.s=i,s.c=r,s}static TransposeMultiply(t,e,s){const i=t.c*e.s-t.s*e.c,r=t.c*e.c+t.s*e.s;return s.s=i,s.c=r,s}static MultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.c*i-t.s*r,s.y=t.s*i+t.c*r,s}static TransposeMultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.c*i+t.s*r,s.y=-t.s*i+t.c*r,s}}exports.b2Rot=p,p.IDENTITY=new p;class l{constructor(){this.p=new o,this.q=new p}Clone(){return(new l).Copy(this)}Copy(t){return this.p.Copy(t.p),this.q.Copy(t.q),this}SetIdentity(){return this.p.SetZero(),this.q.SetIdentity(),this}SetPositionRotation(t,e){return this.p.Copy(t),this.q.Copy(e),this}SetPositionAngle(t,e){return this.p.Copy(t),this.q.Set(e),this}SetPosition(t){return this.p.Copy(t),this}SetPositionXY(t,e){return this.p.Set(t,e),this}SetRotation(t){return this.q.Copy(t),this}SetRotationAngle(t){return this.q.Set(t),this}GetPosition(){return this.p}GetRotation(){return this.q}GetAngle(){return this.q.GetAngle()}static MultiplyVec2(t,e,s){const i=e.x,r=e.y;return s.x=t.q.c*i-t.q.s*r+t.p.x,s.y=t.q.s*i+t.q.c*r+t.p.y,s}static TransposeMultiplyVec2(t,e,s){const i=e.x-t.p.x,r=e.y-t.p.y;return s.x=t.q.c*i+t.q.s*r,s.y=-t.q.s*i+t.q.c*r,s}static Multiply(t,e,s){return p.Multiply(t.q,e.q,s.q),p.MultiplyVec2(t.q,e.p,s.p).Add(t.p),s}static TransposeMultiply(t,e,s){return p.TransposeMultiply(t.q,e.q,s.q),p.TransposeMultiplyVec2(t.q,o.Subtract(e.p,t.p,s.p),s.p),s}}exports.b2Transform=l,l.IDENTITY=new l;class S{constructor(){this.localCenter=new o,this.c0=new o,this.c=new o,this.a0=0,this.a=0,this.alpha0=0}Clone(){return(new S).Copy(this)}Copy(t){return this.localCenter.Copy(t.localCenter),this.c0.Copy(t.c0),this.c.Copy(t.c),this.a0=t.a0,this.a=t.a,this.alpha0=t.alpha0,this}GetTransform(t,e){const s=1-e;t.p.x=s*this.c0.x+e*this.c.x,t.p.y=s*this.c0.y+e*this.c.y;const i=s*this.a0+e*this.a;return t.q.Set(i),t.p.Subtract(p.MultiplyVec2(t.q,this.localCenter,o.s_t0)),t}Advance(t){const e=(t-this.alpha0)/(1-this.alpha0);this.c0.x+=e*(this.c.x-this.c0.x),this.c0.y+=e*(this.c.y-this.c0.y),this.a0+=e*(this.a-this.a0),this.alpha0=t}Normalize(){const t=exports.b2_two_pi*Math.floor(this.a0/exports.b2_two_pi);this.a0-=t,this.a-=t}}exports.b2Sweep=S;
},{"./b2_common":"xZSi"}],"J87F":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.debugColors=exports.b2Color=void 0;class t{constructor(t=.5,i=.5,s=.5,r=1){this.r=t,this.g=i,this.b=s,this.a=r}Clone(){return new t(this.r,this.g,this.b,this.a)}Copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}IsEqual(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}IsZero(){return 0===this.r&&0===this.g&&0===this.b&&0===this.a}SetByteRGB(t,i,s){return this.r=t/255,this.g=i/255,this.b=s/255,this}SetByteRGBA(t,i,s,r){return this.r=t/255,this.g=i/255,this.b=s/255,this.a=r/255,this}SetRGB(t,i,s){return this.r=t,this.g=i,this.b=s,this}SetRGBA(t,i,s,r){return this.r=t,this.g=i,this.b=s,this.a=r,this}Add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this.a+=t.a,this}Subtract(t){return this.r-=t.r,this.g-=t.g,this.b-=t.b,this.a-=t.a,this}Scale(t){return this.r*=t,this.g*=t,this.b*=t,this.a*=t,this}Mix(i,s){t.MixColors(this,i,s)}static Add(t,i,s){return s.r=t.r+i.r,s.g=t.g+i.g,s.b=t.b+i.b,s.a=t.a+i.a,s}static Subtract(t,i,s){return s.r=t.r-i.r,s.g=t.g-i.g,s.b=t.b-i.b,s.a=t.a-i.a,s}static Scale(t,i,s){return s.r=t.r*i,s.g=t.g*i,s.b=t.b*i,s.a=t.a*i,s}static MixColors(t,i,s){const r=s*(i.r-t.r),e=s*(i.g-t.g),n=s*(i.b-t.b),h=s*(i.a-t.a);t.r+=r,t.g+=e,t.b+=n,t.a+=h,i.r-=r,i.g-=e,i.b-=n,i.a-=h}}exports.b2Color=t,t.ZERO=new t(0,0,0,0),t.RED=new t(1,0,0),t.GREEN=new t(0,1,0),t.BLUE=new t(0,0,1),t.WHITE=new t(1,1,1),t.BLACK=new t(0,0,0),exports.debugColors={badBody:new t(1,0,0),disabledBody:new t(.5,.5,.3),staticBody:new t(.5,.9,.5),kinematicBody:new t(.5,.5,.9),sleepingBody:new t(.6,.6,.6),body:new t(.9,.7,.7),pair:new t(.3,.9,.9),aabb:new t(.9,.3,.9),joint1:new t(.7,.7,.7),joint2:new t(.3,.9,.3),joint3:new t(.9,.3,.3),joint4:new t(.3,.3,.9),joint5:new t(.4,.4,.4),joint6:new t(.5,.8,.8),joint7:new t(0,1,0),joint8:new t(.8,.8,.8),rope:new t(.4,.5,.7),ropePointG:new t(.1,.8,.1),ropePointD:new t(.7,.2,.4)};
},{}],"QXiX":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Shape=exports.b2ShapeType=exports.b2MassData=void 0;const e=require("../common/b2_math");class t{constructor(){this.mass=0,this.center=new e.b2Vec2,this.I=0}}var s;exports.b2MassData=t,function(e){e[e.e_unknown=-1]="e_unknown",e[e.e_circle=0]="e_circle",e[e.e_edge=1]="e_edge",e[e.e_polygon=2]="e_polygon",e[e.e_chain=3]="e_chain",e[e.e_typeCount=4]="e_typeCount"}(s=exports.b2ShapeType||(exports.b2ShapeType={}));class r{constructor(e,t){this.m_radius=0,this.m_type=e,this.m_radius=t}Copy(e){return this.m_radius=e.m_radius,this}GetType(){return this.m_type}}exports.b2Shape=r;
},{"../common/b2_math":"YmMi"}],"XVAh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ShapeCast=exports.b2Distance=exports.b2Gjk=exports.b2ShapeCastOutput=exports.b2ShapeCastInput=exports.b2DistanceOutput=exports.b2DistanceInput=exports.b2SimplexCache=exports.b2DistanceProxy=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math");class s{constructor(){this.m_buffer=t.b2MakeArray(2,e.b2Vec2),this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0}Copy(t){return t.m_vertices===t.m_buffer?(this.m_vertices=this.m_buffer,this.m_buffer[0].Copy(t.m_buffer[0]),this.m_buffer[1].Copy(t.m_buffer[1])):this.m_vertices=t.m_vertices,this.m_count=t.m_count,this.m_radius=t.m_radius,this}Reset(){return this.m_vertices=this.m_buffer,this.m_count=0,this.m_radius=0,this}SetShape(t,e){t.SetupDistanceProxy(this,e)}SetVerticesRadius(t,e,s){this.m_vertices=t,this.m_count=e,this.m_radius=s}GetSupport(t){let s=0,i=e.b2Vec2.Dot(this.m_vertices[0],t);for(let r=1;r<this.m_count;++r){const o=e.b2Vec2.Dot(this.m_vertices[r],t);o>i&&(s=r,i=o)}return s}GetSupportVertex(t){let s=0,i=e.b2Vec2.Dot(this.m_vertices[0],t);for(let r=1;r<this.m_count;++r){const o=e.b2Vec2.Dot(this.m_vertices[r],t);o>i&&(s=r,i=o)}return this.m_vertices[s]}GetVertexCount(){return this.m_count}GetVertex(t){return this.m_vertices[t]}}exports.b2DistanceProxy=s;class i{constructor(){this.metric=0,this.count=0,this.indexA=[0,0,0],this.indexB=[0,0,0]}Reset(){return this.metric=0,this.count=0,this}}exports.b2SimplexCache=i;class r{constructor(){this.proxyA=new s,this.proxyB=new s,this.transformA=new e.b2Transform,this.transformB=new e.b2Transform,this.useRadii=!1}Reset(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this}}exports.b2DistanceInput=r;class o{constructor(){this.pointA=new e.b2Vec2,this.pointB=new e.b2Vec2,this.distance=0,this.iterations=0}Reset(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this}}exports.b2DistanceOutput=o;class c{constructor(){this.proxyA=new s,this.proxyB=new s,this.transformA=new e.b2Transform,this.transformB=new e.b2Transform,this.translationB=new e.b2Vec2}}exports.b2ShapeCastInput=c;class n{constructor(){this.point=new e.b2Vec2,this.normal=new e.b2Vec2,this.lambda=0,this.iterations=0}}exports.b2ShapeCastOutput=n,exports.b2Gjk={calls:0,iters:0,maxIters:0,reset(){this.calls=0,this.iters=0,this.maxIters=0}};class a{constructor(){this.wA=new e.b2Vec2,this.wB=new e.b2Vec2,this.w=new e.b2Vec2,this.a=0,this.indexA=0,this.indexB=0}Copy(t){return this.wA.Copy(t.wA),this.wB.Copy(t.wB),this.w.Copy(t.w),this.a=t.a,this.indexA=t.indexA,this.indexB=t.indexB,this}}class h{constructor(){this.m_v1=new a,this.m_v2=new a,this.m_v3=new a,this.m_count=0,this.m_vertices=[this.m_v1,this.m_v2,this.m_v3]}ReadCache(s,i,r,o,c){this.m_count=s.count;const n=this.m_vertices;for(let t=0;t<this.m_count;++t){const a=n[t];a.indexA=s.indexA[t],a.indexB=s.indexB[t];const h=i.GetVertex(a.indexA),m=o.GetVertex(a.indexB);e.b2Transform.MultiplyVec2(r,h,a.wA),e.b2Transform.MultiplyVec2(c,m,a.wB),e.b2Vec2.Subtract(a.wB,a.wA,a.w),a.a=0}if(this.m_count>1){const e=s.metric,i=this.GetMetric();(i<.5*e||2*e<i||i<t.b2_epsilon)&&(this.m_count=0)}if(0===this.m_count){const t=n[0];t.indexA=0,t.indexB=0;const s=i.GetVertex(0),a=o.GetVertex(0);e.b2Transform.MultiplyVec2(r,s,t.wA),e.b2Transform.MultiplyVec2(c,a,t.wB),e.b2Vec2.Subtract(t.wB,t.wA,t.w),t.a=1,this.m_count=1}}WriteCache(t){t.metric=this.GetMetric(),t.count=this.m_count;const e=this.m_vertices;for(let s=0;s<this.m_count;++s)t.indexA[s]=e[s].indexA,t.indexB[s]=e[s].indexB}GetSearchDirection(t){switch(this.m_count){case 1:return e.b2Vec2.Negate(this.m_v1.w,t);case 2:{const s=e.b2Vec2.Subtract(this.m_v2.w,this.m_v1.w,t);return e.b2Vec2.Cross(s,e.b2Vec2.Negate(this.m_v1.w,e.b2Vec2.s_t0))>0?e.b2Vec2.CrossOneVec2(s,t):e.b2Vec2.CrossVec2One(s,t)}default:return t.SetZero()}}GetClosestPoint(t){switch(this.m_count){case 0:return t.SetZero();case 1:return t.Copy(this.m_v1.w);case 2:return t.Set(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:default:return t.SetZero()}}GetWitnessPoints(t,e){switch(this.m_count){case 0:break;case 1:t.Copy(this.m_v1.wA),e.Copy(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,e.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,e.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:e.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,e.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y}}GetMetric(){switch(this.m_count){case 0:case 1:return 0;case 2:return e.b2Vec2.Distance(this.m_v1.w,this.m_v2.w);case 3:return e.b2Vec2.Cross(e.b2Vec2.Subtract(this.m_v2.w,this.m_v1.w,e.b2Vec2.s_t0),e.b2Vec2.Subtract(this.m_v3.w,this.m_v1.w,e.b2Vec2.s_t1));default:return 0}}Solve2(){const t=this.m_v1.w,s=this.m_v2.w,i=e.b2Vec2.Subtract(s,t,h.s_e12),r=-e.b2Vec2.Dot(t,i);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);const o=e.b2Vec2.Dot(s,i);if(o<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);const c=1/(o+r);this.m_v1.a=o*c,this.m_v2.a=r*c,this.m_count=2}Solve3(){const t=this.m_v1.w,s=this.m_v2.w,i=this.m_v3.w,r=e.b2Vec2.Subtract(s,t,h.s_e12),o=e.b2Vec2.Dot(t,r),c=e.b2Vec2.Dot(s,r),n=-o,a=e.b2Vec2.Subtract(i,t,h.s_e13),m=e.b2Vec2.Dot(t,a),_=e.b2Vec2.Dot(i,a),u=-m,b=e.b2Vec2.Subtract(i,s,h.s_e23),p=e.b2Vec2.Dot(s,b),v=e.b2Vec2.Dot(i,b),V=-p,w=e.b2Vec2.Cross(r,a),x=w*e.b2Vec2.Cross(s,i),l=w*e.b2Vec2.Cross(i,t),d=w*e.b2Vec2.Cross(t,s);if(n<=0&&u<=0)return this.m_v1.a=1,void(this.m_count=1);if(c>0&&n>0&&d<=0){const t=1/(c+n);return this.m_v1.a=c*t,this.m_v2.a=n*t,void(this.m_count=2)}if(_>0&&u>0&&l<=0){const t=1/(_+u);return this.m_v1.a=_*t,this.m_v3.a=u*t,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(c<=0&&V<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(_<=0&&v<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(v>0&&V>0&&x<=0){const t=1/(v+V);return this.m_v2.a=v*t,this.m_v3.a=V*t,this.m_count=2,void this.m_v1.Copy(this.m_v3)}const f=1/(x+l+d);this.m_v1.a=x*f,this.m_v2.a=l*f,this.m_v3.a=d*f,this.m_count=3}}h.s_e12=new e.b2Vec2,h.s_e13=new e.b2Vec2,h.s_e23=new e.b2Vec2;const m=new h,_=[0,0,0],u=[0,0,0],b=new e.b2Vec2,p=new e.b2Vec2,v=new e.b2Vec2,V=new e.b2Vec2,w=new e.b2Vec2;function x(s,i,r){++exports.b2Gjk.calls;const{proxyA:o,proxyB:c,transformA:n,transformB:a}=r,h=m;h.ReadCache(i,o,n,c,a);const x=h.m_vertices,l=_,d=u;let f=0,y=0;for(;y<20;){f=h.m_count;for(let t=0;t<f;++t)l[t]=x[t].indexA,d[t]=x[t].indexB;switch(h.m_count){case 1:break;case 2:h.Solve2();break;case 3:h.Solve3()}if(3===h.m_count)break;const s=h.GetSearchDirection(p);if(s.LengthSquared()<t.b2_epsilon_sq)break;const i=x[h.m_count];i.indexA=o.GetSupport(e.b2Rot.TransposeMultiplyVec2(n.q,e.b2Vec2.Negate(s,e.b2Vec2.s_t0),V)),e.b2Transform.MultiplyVec2(n,o.GetVertex(i.indexA),i.wA),i.indexB=c.GetSupport(e.b2Rot.TransposeMultiplyVec2(a.q,s,w)),e.b2Transform.MultiplyVec2(a,c.GetVertex(i.indexB),i.wB),e.b2Vec2.Subtract(i.wB,i.wA,i.w),++y,++exports.b2Gjk.iters;let r=!1;for(let t=0;t<f;++t)if(i.indexA===l[t]&&i.indexB===d[t]){r=!0;break}if(r)break;++h.m_count}if(exports.b2Gjk.maxIters=Math.max(exports.b2Gjk.maxIters,y),h.GetWitnessPoints(s.pointA,s.pointB),s.distance=e.b2Vec2.Distance(s.pointA,s.pointB),s.iterations=y,h.WriteCache(i),r.useRadii){const i=o.m_radius,r=c.m_radius;if(s.distance>i+r&&s.distance>t.b2_epsilon){s.distance-=i+r;const t=e.b2Vec2.Subtract(s.pointB,s.pointA,v);t.Normalize(),s.pointA.AddScaled(i,t),s.pointB.SubtractScaled(r,t)}else{const t=e.b2Vec2.Mid(s.pointA,s.pointB,b);s.pointA.Copy(t),s.pointB.Copy(t),s.distance=0}}}exports.b2Distance=x;const l=new e.b2Vec2,d=new h,f=new e.b2Vec2,y=new e.b2Vec2,S=new e.b2Vec2,A=new e.b2Vec2,B=new e.b2Vec2,C=new e.b2Vec2;function G(s,i){s.iterations=0,s.lambda=1,s.normal.SetZero(),s.point.SetZero();const{proxyA:r,proxyB:o}=i,c=Math.max(r.m_radius,t.b2_polygonRadius),n=c+Math.max(o.m_radius,t.b2_polygonRadius),a=i.transformA,h=i.transformB,m=i.translationB,_=l.SetZero();let u=0;const b=d;b.m_count=0;const p=b.m_vertices;let v=r.GetSupport(e.b2Rot.TransposeMultiplyVec2(a.q,e.b2Vec2.Negate(m,e.b2Vec2.s_t1),e.b2Vec2.s_t0)),V=e.b2Transform.MultiplyVec2(a,r.GetVertex(v),f),w=o.GetSupport(e.b2Rot.TransposeMultiplyVec2(h.q,m,e.b2Vec2.s_t0)),x=e.b2Transform.MultiplyVec2(h,o.GetVertex(w),y);const G=e.b2Vec2.Subtract(V,x,S),D=Math.max(t.b2_polygonRadius,n-t.b2_polygonRadius),M=.5*t.b2_linearSlop;let R=0;for(;R<20&&G.Length()-D>M;){s.iterations+=1,v=r.GetSupport(e.b2Rot.TransposeMultiplyVec2(a.q,e.b2Vec2.Negate(G,e.b2Vec2.s_t1),e.b2Vec2.s_t0)),V=e.b2Transform.MultiplyVec2(a,r.GetVertex(v),f),w=o.GetSupport(e.b2Rot.TransposeMultiplyVec2(h.q,G,e.b2Vec2.s_t0)),x=e.b2Transform.MultiplyVec2(h,o.GetVertex(w),y);const t=e.b2Vec2.Subtract(V,x,A);G.Normalize();const i=e.b2Vec2.Dot(G,t),c=e.b2Vec2.Dot(G,m);if(i-D>u*c){if(c<=0)return!1;if((u=(i-D)/c)>1)return!1;e.b2Vec2.Negate(G,_),b.m_count=0}const n=p[b.m_count];switch(n.indexA=w,e.b2Vec2.AddScaled(x,u,m,n.wA),n.indexB=v,n.wB.Copy(V),e.b2Vec2.Subtract(n.wB,n.wA,n.w),n.a=1,b.m_count+=1,b.m_count){case 1:break;case 2:b.Solve2();break;case 3:b.Solve3()}if(3===b.m_count)return!1;b.GetClosestPoint(G),++R}if(0===R)return!1;const T=B,k=C;return b.GetWitnessPoints(T,k),G.LengthSquared()>0&&(e.b2Vec2.Negate(G,_),_.Normalize()),e.b2Vec2.AddScaled(T,c,_,s.point),s.normal.Copy(_),s.lambda=u,s.iterations=R,!0}exports.b2ShapeCast=G;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi"}],"DOG3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2TestOverlap=exports.b2ClipSegmentToLine=exports.b2AABB=exports.b2RayCastOutput=exports.b2RayCastInput=exports.b2ClipVertex=exports.b2GetPointStates=exports.b2PointState=exports.b2WorldManifold=exports.b2Manifold=exports.b2ManifoldType=exports.b2ManifoldPoint=exports.b2ContactID=exports.b2ContactFeature=exports.b2ContactFeatureType=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),i=require("./b2_distance");var o,n,s;!function(t){t[t.e_vertex=0]="e_vertex",t[t.e_face=1]="e_face"}(o=exports.b2ContactFeatureType||(exports.b2ContactFeatureType={}));class r{constructor(){this.m_key=0,this.m_key_invalid=!1,this.m_indexA=0,this.m_indexB=0,this.m_typeA=o.e_vertex,this.m_typeB=o.e_vertex}get key(){return this.m_key_invalid&&(this.m_key_invalid=!1,this.m_key=this.m_indexA|this.m_indexB<<8|this.m_typeA<<16|this.m_typeB<<24),this.m_key}set key(t){this.m_key=t,this.m_key_invalid=!1,this.m_indexA=255&this.m_key,this.m_indexB=this.m_key>>8&255,this.m_typeA=this.m_key>>16&255,this.m_typeB=this.m_key>>24&255}get indexA(){return this.m_indexA}set indexA(t){this.m_indexA=t,this.m_key_invalid=!0}get indexB(){return this.m_indexB}set indexB(t){this.m_indexB=t,this.m_key_invalid=!0}get typeA(){return this.m_typeA}set typeA(t){this.m_typeA=t,this.m_key_invalid=!0}get typeB(){return this.m_typeB}set typeB(t){this.m_typeB=t,this.m_key_invalid=!0}}exports.b2ContactFeature=r;class a{constructor(){this.cf=new r}Copy(t){return this.key=t.key,this}Clone(){return(new a).Copy(this)}get key(){return this.cf.key}set key(t){this.cf.key=t}}exports.b2ContactID=a;class p{constructor(){this.localPoint=new e.b2Vec2,this.normalImpulse=0,this.tangentImpulse=0,this.id=new a}Reset(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0}Copy(t){return this.localPoint.Copy(t.localPoint),this.normalImpulse=t.normalImpulse,this.tangentImpulse=t.tangentImpulse,this.id.Copy(t.id),this}}exports.b2ManifoldPoint=p,function(t){t[t.e_circles=0]="e_circles",t[t.e_faceA=1]="e_faceA",t[t.e_faceB=2]="e_faceB"}(n=exports.b2ManifoldType||(exports.b2ManifoldType={}));class l{constructor(){this.points=t.b2MakeArray(t.b2_maxManifoldPoints,p),this.localNormal=new e.b2Vec2,this.localPoint=new e.b2Vec2,this.type=n.e_circles,this.pointCount=0}Reset(){for(let e=0;e<t.b2_maxManifoldPoints;++e)this.points[e].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=n.e_circles,this.pointCount=0}Copy(e){this.pointCount=e.pointCount;for(let i=0;i<t.b2_maxManifoldPoints;++i)this.points[i].Copy(e.points[i]);return this.localNormal.Copy(e.localNormal),this.localPoint.Copy(e.localPoint),this.type=e.type,this}Clone(){return(new l).Copy(this)}}exports.b2Manifold=l;class u{constructor(){this.normal=new e.b2Vec2,this.points=t.b2MakeArray(t.b2_maxManifoldPoints,e.b2Vec2),this.separations=t.b2MakeNumberArray(t.b2_maxManifoldPoints)}Initialize(i,o,s,r,a){if(0!==i.pointCount)switch(i.type){case n.e_circles:{this.normal.Set(1,0);const n=e.b2Transform.MultiplyVec2(o,i.localPoint,u.Initialize_s_pointA),p=e.b2Transform.MultiplyVec2(r,i.points[0].localPoint,u.Initialize_s_pointB);e.b2Vec2.DistanceSquared(n,p)>t.b2_epsilon_sq&&e.b2Vec2.Subtract(p,n,this.normal).Normalize();const l=e.b2Vec2.AddScaled(n,s,this.normal,u.Initialize_s_cA),c=e.b2Vec2.SubtractScaled(p,a,this.normal,u.Initialize_s_cB);e.b2Vec2.Mid(l,c,this.points[0]),this.separations[0]=e.b2Vec2.Dot(e.b2Vec2.Subtract(c,l,e.b2Vec2.s_t0),this.normal);break}case n.e_faceA:{e.b2Rot.MultiplyVec2(o.q,i.localNormal,this.normal);const t=e.b2Transform.MultiplyVec2(o,i.localPoint,u.Initialize_s_planePoint);for(let o=0;o<i.pointCount;++o){const n=e.b2Transform.MultiplyVec2(r,i.points[o].localPoint,u.Initialize_s_clipPoint),p=s-e.b2Vec2.Dot(e.b2Vec2.Subtract(n,t,e.b2Vec2.s_t0),this.normal),l=e.b2Vec2.AddScaled(n,p,this.normal,u.Initialize_s_cA),c=e.b2Vec2.SubtractScaled(n,a,this.normal,u.Initialize_s_cB);e.b2Vec2.Mid(l,c,this.points[o]),this.separations[o]=e.b2Vec2.Dot(e.b2Vec2.Subtract(c,l,e.b2Vec2.s_t0),this.normal)}break}case n.e_faceB:{e.b2Rot.MultiplyVec2(r.q,i.localNormal,this.normal);const t=e.b2Transform.MultiplyVec2(r,i.localPoint,u.Initialize_s_planePoint);for(let n=0;n<i.pointCount;++n){const r=e.b2Transform.MultiplyVec2(o,i.points[n].localPoint,u.Initialize_s_clipPoint),p=a-e.b2Vec2.Dot(e.b2Vec2.Subtract(r,t,e.b2Vec2.s_t0),this.normal),l=e.b2Vec2.AddScaled(r,p,this.normal,u.Initialize_s_cB),c=e.b2Vec2.SubtractScaled(r,s,this.normal,u.Initialize_s_cA);e.b2Vec2.Mid(c,l,this.points[n]),this.separations[n]=e.b2Vec2.Dot(e.b2Vec2.Subtract(c,l,e.b2Vec2.s_t0),this.normal)}this.normal.Negate();break}}}}function c(e,i,o,n){let r;for(r=0;r<o.pointCount;++r){const{key:t}=o.points[r].id;e[r]=s.b2_removeState;for(let i=0;i<n.pointCount;++i)if(n.points[i].id.key===t){e[r]=s.b2_persistState;break}}for(;r<t.b2_maxManifoldPoints;++r)e[r]=s.b2_nullState;for(r=0;r<n.pointCount;++r){const{key:t}=n.points[r].id;i[r]=s.b2_addState;for(let e=0;e<o.pointCount;++e)if(o.points[e].id.key===t){i[r]=s.b2_persistState;break}}for(;r<t.b2_maxManifoldPoints;++r)i[r]=s.b2_nullState}exports.b2WorldManifold=u,u.Initialize_s_pointA=new e.b2Vec2,u.Initialize_s_pointB=new e.b2Vec2,u.Initialize_s_cA=new e.b2Vec2,u.Initialize_s_cB=new e.b2Vec2,u.Initialize_s_planePoint=new e.b2Vec2,u.Initialize_s_clipPoint=new e.b2Vec2,function(t){t[t.b2_nullState=0]="b2_nullState",t[t.b2_addState=1]="b2_addState",t[t.b2_persistState=2]="b2_persistState",t[t.b2_removeState=3]="b2_removeState"}(s=exports.b2PointState||(exports.b2PointState={})),exports.b2GetPointStates=c;class h{constructor(){this.v=new e.b2Vec2,this.id=new a}Copy(t){return this.v.Copy(t.v),this.id.Copy(t.id),this}}exports.b2ClipVertex=h;class d{constructor(){this.p1=new e.b2Vec2,this.p2=new e.b2Vec2,this.maxFraction=1}Copy(t){return this.p1.Copy(t.p1),this.p2.Copy(t.p2),this.maxFraction=t.maxFraction,this}}exports.b2RayCastInput=d;class b{constructor(){this.normal=new e.b2Vec2,this.fraction=0}Copy(t){return this.normal.Copy(t.normal),this.fraction=t.fraction,this}}exports.b2RayCastOutput=b;class y{constructor(){this.lowerBound=new e.b2Vec2,this.upperBound=new e.b2Vec2}Copy(t){return this.lowerBound.Copy(t.lowerBound),this.upperBound.Copy(t.upperBound),this}IsValid(){return this.lowerBound.IsValid()&&this.upperBound.IsValid()&&this.upperBound.x>=this.lowerBound.x&&this.upperBound.y>=this.lowerBound.y}GetCenter(t){return e.b2Vec2.Mid(this.lowerBound,this.upperBound,t)}GetExtents(t){return e.b2Vec2.Extents(this.lowerBound,this.upperBound,t)}GetPerimeter(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))}Combine1(t){return this.lowerBound.x=Math.min(this.lowerBound.x,t.lowerBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,t.lowerBound.y),this.upperBound.x=Math.max(this.upperBound.x,t.upperBound.x),this.upperBound.y=Math.max(this.upperBound.y,t.upperBound.y),this}Combine2(t,e){return this.lowerBound.x=Math.min(t.lowerBound.x,e.lowerBound.x),this.lowerBound.y=Math.min(t.lowerBound.y,e.lowerBound.y),this.upperBound.x=Math.max(t.upperBound.x,e.upperBound.x),this.upperBound.y=Math.max(t.upperBound.y,e.upperBound.y),this}static Combine(t,e,i){return i.Combine2(t,e),i}Contains(t){return this.lowerBound.x<=t.lowerBound.x&&this.lowerBound.y<=t.lowerBound.y&&t.upperBound.x<=this.upperBound.x&&t.upperBound.y<=this.upperBound.y}RayCast(e,i){let o=-t.b2_maxFloat,n=t.b2_maxFloat;const s=i.p1.x,r=i.p1.y,a=i.p2.x-i.p1.x,p=i.p2.y-i.p1.y,l=Math.abs(a),u=Math.abs(p),{normal:c}=e;if(l<t.b2_epsilon){if(s<this.lowerBound.x||this.upperBound.x<s)return!1}else{const t=1/a;let e=(this.lowerBound.x-s)*t,i=(this.upperBound.x-s)*t,r=-1;if(e>i){const t=e;e=i,i=t,r=1}if(e>o&&(c.x=r,c.y=0,o=e),o>(n=Math.min(n,i)))return!1}if(u<t.b2_epsilon){if(r<this.lowerBound.y||this.upperBound.y<r)return!1}else{const t=1/p;let e=(this.lowerBound.y-r)*t,i=(this.upperBound.y-r)*t,s=-1;if(e>i){const t=e;e=i,i=t,s=1}if(e>o&&(c.x=0,c.y=s,o=e),o>(n=Math.min(n,i)))return!1}return!(o<0||i.maxFraction<o)&&(e.fraction=o,!0)}TestContain(t){return!(t.x<this.lowerBound.x||this.upperBound.x<t.x)&&!(t.y<this.lowerBound.y||this.upperBound.y<t.y)}TestOverlap(t){return!(this.upperBound.x<t.lowerBound.x)&&(!(this.upperBound.y<t.lowerBound.y)&&(!(t.upperBound.x<this.lowerBound.x)&&!(t.upperBound.y<this.lowerBound.y)))}}function _(t,[i,n],s,r,a){let p=0;const l=e.b2Vec2.Dot(s,i.v)-r,u=e.b2Vec2.Dot(s,n.v)-r;if(l<=0&&t[p++].Copy(i),u<=0&&t[p++].Copy(n),l*u<0){const e=l/(l-u),{v:s,id:r}=t[p];s.x=i.v.x+e*(n.v.x-i.v.x),s.y=i.v.y+e*(n.v.y-i.v.y),r.cf.indexA=a,r.cf.indexB=i.id.cf.indexB,r.cf.typeA=o.e_vertex,r.cf.typeB=o.e_face,++p}return p}exports.b2AABB=y,exports.b2ClipSegmentToLine=_;const m=new i.b2DistanceInput,x=new i.b2SimplexCache,B=new i.b2DistanceOutput;function f(e,o,n,s,r,a){const p=m.Reset();p.proxyA.SetShape(e,o),p.proxyB.SetShape(n,s),p.transformA.Copy(r),p.transformB.Copy(a),p.useRadii=!0;const l=x.Reset();l.count=0;const u=B.Reset();return i.b2Distance(u,l,p),u.distance<10*t.b2_epsilon}exports.b2TestOverlap=f;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_distance":"XVAh"}],"MuJF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Fixture=exports.b2FixtureProxy=exports.b2DefaultFilter=void 0;const t=require("../common/b2_math"),e=require("../collision/b2_collision"),s=require("../collision/b2_shape"),i=require("../common/b2_common"),r=require("../common/b2_settings"),o={c1:new t.b2Vec2,c2:new t.b2Vec2};exports.b2DefaultFilter={categoryBits:1,maskBits:65535,groupIndex:0};class n{constructor(t,s,i,r){this.aabb=new e.b2AABB,this.fixture=t,this.childIndex=r,t.m_shape.ComputeAABB(this.aabb,i,r),this.treeNode=s.CreateProxy(this.aabb,this)}}exports.b2FixtureProxy=n;const h=new e.b2AABB,a=new e.b2AABB,m=new t.b2Vec2;class u{constructor(t,e){var s,i,o,n,h;this.m_density=0,this.m_next=null,this.m_friction=0,this.m_restitution=0,this.m_restitutionThreshold=0,this.m_proxies=[],this.m_isSensor=!1,this.m_userData=null,this.m_body=t,this.m_shape=e.shape.Clone(),this.m_userData=e.userData,this.m_friction=null!==(s=e.friction)&&void 0!==s?s:.2,this.m_restitution=null!==(i=e.restitution)&&void 0!==i?i:0,this.m_restitutionThreshold=null!==(o=e.restitutionThreshold)&&void 0!==o?o:r.b2_lengthUnitsPerMeter,this.m_filter={...exports.b2DefaultFilter,...e.filter},this.m_isSensor=null!==(n=e.isSensor)&&void 0!==n&&n,this.m_density=null!==(h=e.density)&&void 0!==h?h:0}get m_proxyCount(){return this.m_proxies.length}GetType(){return this.m_shape.GetType()}GetShape(){return this.m_shape}SetSensor(t){t!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=t)}IsSensor(){return this.m_isSensor}SetFilterData(t){var e,s,i;this.m_filter.categoryBits=null!==(e=t.categoryBits)&&void 0!==e?e:exports.b2DefaultFilter.categoryBits,this.m_filter.groupIndex=null!==(s=t.groupIndex)&&void 0!==s?s:exports.b2DefaultFilter.groupIndex,this.m_filter.maskBits=null!==(i=t.maskBits)&&void 0!==i?i:exports.b2DefaultFilter.maskBits,this.Refilter()}GetFilterData(){return this.m_filter}Refilter(){let t=this.m_body.GetContactList();for(;t;){const{contact:e}=t,s=e.GetFixtureA(),i=e.GetFixtureB();s!==this&&i!==this||e.FlagForFiltering(),t=t.next}const e=this.m_body.GetWorld().m_contactManager.m_broadPhase;for(const s of this.m_proxies)e.TouchProxy(s.treeNode)}GetBody(){return this.m_body}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}TestPoint(t){return this.m_shape.TestPoint(this.m_body.GetTransform(),t)}RayCast(t,e,s){return this.m_shape.RayCast(t,e,this.m_body.GetTransform(),s)}GetMassData(t=new s.b2MassData){return this.m_shape.ComputeMass(t,this.m_density),t}SetDensity(t){this.m_density=t}GetDensity(){return this.m_density}GetFriction(){return this.m_friction}SetFriction(t){this.m_friction=t}GetRestitution(){return this.m_restitution}SetRestitution(t){this.m_restitution=t}SetRestitutionThreshold(t){this.m_restitutionThreshold=t}GetAABB(t){return this.m_proxies[t].aabb}CreateProxies(t,e){i.b2Assert(0===this.m_proxies.length),this.m_proxies.length=this.m_shape.GetChildCount();for(let s=0;s<this.m_proxies.length;++s)this.m_proxies[s]=new n(this,t,e,s)}DestroyProxies(t){for(const e of this.m_proxies)t.DestroyProxy(e.treeNode);this.m_proxies.length=0}Synchronize(e,s,i){const{c1:r,c2:n}=o,u=m;for(const o of this.m_proxies){const m=h,l=a;this.m_shape.ComputeAABB(m,s,o.childIndex),this.m_shape.ComputeAABB(l,i,o.childIndex),o.aabb.Combine2(m,l),t.b2Vec2.Subtract(l.GetCenter(n),m.GetCenter(r),u),e.MoveProxy(o.treeNode,o.aabb,u)}}}exports.b2Fixture=u;
},{"../common/b2_math":"YmMi","../collision/b2_collision":"DOG3","../collision/b2_shape":"QXiX","../common/b2_common":"xZSi","../common/b2_settings":"nssz"}],"hxRe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Body=exports.b2BodyType=void 0;const t=require("../common/b2_math"),e=require("../collision/b2_shape"),s=require("./b2_fixture"),i=require("../common/b2_common");var a;!function(t){t[t.b2_staticBody=0]="b2_staticBody",t[t.b2_kinematicBody=1]="b2_kinematicBody",t[t.b2_dynamicBody=2]="b2_dynamicBody"}(a=exports.b2BodyType||(exports.b2BodyType={}));class m{constructor(e,s){var i,m,_,r,o,n,h,l,c,p,u,y,d,w;this.m_type=a.b2_staticBody,this.m_islandFlag=!1,this.m_awakeFlag=!1,this.m_autoSleepFlag=!1,this.m_bulletFlag=!1,this.m_fixedRotationFlag=!1,this.m_enabledFlag=!1,this.m_toiFlag=!1,this.m_islandIndex=0,this.m_xf=new t.b2Transform,this.m_sweep=new t.b2Sweep,this.m_linearVelocity=new t.b2Vec2,this.m_angularVelocity=0,this.m_force=new t.b2Vec2,this.m_torque=0,this.m_prev=null,this.m_next=null,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_jointList=null,this.m_contactList=null,this.m_mass=1,this.m_invMass=1,this.m_I=0,this.m_invI=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_gravityScale=1,this.m_sleepTime=0,this.m_userData=null,this.m_bulletFlag=null!==(i=e.bullet)&&void 0!==i&&i,this.m_fixedRotationFlag=null!==(m=e.fixedRotation)&&void 0!==m&&m,this.m_autoSleepFlag=null===(_=e.allowSleep)||void 0===_||_,null!==(r=e.awake)&&void 0!==r&&!r||(null!==(o=e.type)&&void 0!==o?o:a.b2_staticBody)===a.b2_staticBody||(this.m_awakeFlag=!0),this.m_enabledFlag=null===(n=e.enabled)||void 0===n||n,this.m_world=s,this.m_xf.p.Copy(null!==(h=e.position)&&void 0!==h?h:t.b2Vec2.ZERO),this.m_xf.q.Set(null!==(l=e.angle)&&void 0!==l?l:0),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a=this.m_xf.q.GetAngle(),this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(null!==(c=e.linearVelocity)&&void 0!==c?c:t.b2Vec2.ZERO),this.m_angularVelocity=null!==(p=e.angularVelocity)&&void 0!==p?p:0,this.m_linearDamping=null!==(u=e.linearDamping)&&void 0!==u?u:0,this.m_angularDamping=null!==(y=e.angularDamping)&&void 0!==y?y:0,this.m_gravityScale=null!==(d=e.gravityScale)&&void 0!==d?d:1,this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=null!==(w=e.type)&&void 0!==w?w:a.b2_staticBody,this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}CreateFixture(t){i.b2Assert(!this.m_world.IsLocked());const e=new s.b2Fixture(this,t);if(this.m_enabledFlag){const t=this.m_world.m_contactManager.m_broadPhase;e.CreateProxies(t,this.m_xf)}return e.m_next=this.m_fixtureList,this.m_fixtureList=e,++this.m_fixtureCount,e.m_density>0&&this.ResetMassData(),this.m_world.m_newContacts=!0,e}DestroyFixture(t){i.b2Assert(!this.m_world.IsLocked());let e=this.m_fixtureList,s=null;for(;null!==e;){if(e===t){s?s.m_next=t.m_next:this.m_fixtureList=t.m_next;break}s=e,e=e.m_next}let a=this.m_contactList;for(;a;){const e=a.contact;a=a.next;const s=e.GetFixtureA(),i=e.GetFixtureB();t!==s&&t!==i||this.m_world.m_contactManager.Destroy(e)}if(this.m_enabledFlag){const e=this.m_world.m_contactManager.m_broadPhase;t.DestroyProxies(e)}t.m_next=null,--this.m_fixtureCount,this.ResetMassData()}SetTransformVec(t,e){this.SetTransformXY(t.x,t.y,e)}SetTransformXY(e,s,a){i.b2Assert(!this.m_world.IsLocked()),this.m_xf.q.Set(a),this.m_xf.p.Set(e,s),t.b2Transform.MultiplyVec2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=a,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=a;const m=this.m_world.m_contactManager.m_broadPhase;for(let t=this.m_fixtureList;t;t=t.m_next)t.Synchronize(m,this.m_xf,this.m_xf);this.m_world.m_newContacts=!0}SetTransform(t){this.SetTransformVec(t.p,t.GetAngle())}GetTransform(){return this.m_xf}GetPosition(){return this.m_xf.p}GetAngle(){return this.m_sweep.a}SetAngle(t){this.SetTransformVec(this.GetPosition(),t)}GetWorldCenter(){return this.m_sweep.c}GetLocalCenter(){return this.m_sweep.localCenter}SetLinearVelocity(e){this.m_type!==a.b2_staticBody&&(t.b2Vec2.Dot(e,e)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(e))}GetLinearVelocity(){return this.m_linearVelocity}SetAngularVelocity(t){this.m_type!==a.b2_staticBody&&(t*t>0&&this.SetAwake(!0),this.m_angularVelocity=t)}GetAngularVelocity(){return this.m_angularVelocity}ApplyForce(t,e,s=!0){this.m_type===a.b2_dynamicBody&&(s&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y,this.m_torque+=(e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x))}ApplyForceToCenter(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_force.x+=t.x,this.m_force.y+=t.y))}ApplyTorque(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))}ApplyLinearImpulse(t,e,s=!0){this.m_type===a.b2_dynamicBody&&(s&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y,this.m_angularVelocity+=this.m_invI*((e.x-this.m_sweep.c.x)*t.y-(e.y-this.m_sweep.c.y)*t.x)))}ApplyLinearImpulseToCenter(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*t.x,this.m_linearVelocity.y+=this.m_invMass*t.y))}ApplyAngularImpulse(t,e=!0){this.m_type===a.b2_dynamicBody&&(e&&!this.m_awakeFlag&&this.SetAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))}GetMass(){return this.m_mass}GetInertia(){return this.m_I+this.m_mass*t.b2Vec2.Dot(this.m_sweep.localCenter,this.m_sweep.localCenter)}GetMassData(e){return e.mass=this.m_mass,e.I=this.m_I+this.m_mass*t.b2Vec2.Dot(this.m_sweep.localCenter,this.m_sweep.localCenter),e.center.Copy(this.m_sweep.localCenter),e}SetMassData(e){if(i.b2Assert(!this.m_world.IsLocked()),this.m_type!==a.b2_dynamicBody)return;this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&!this.m_fixedRotationFlag&&(this.m_I=e.I-this.m_mass*t.b2Vec2.Dot(e.center,e.center),this.m_invI=1/this.m_I);const s=m.SetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e.center),t.b2Transform.MultiplyVec2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(this.m_sweep.c,s,t.b2Vec2.s_t0),this.m_linearVelocity)}ResetMassData(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===a.b2_staticBody||this.m_type===a.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);const e=m.ResetMassData_s_localCenter.SetZero();for(let t=this.m_fixtureList;t;t=t.m_next){if(0===t.m_density)continue;const s=t.GetMassData(m.ResetMassData_s_massData);this.m_mass+=s.mass,e.AddScaled(s.mass,s.center),this.m_I+=s.I}this.m_mass>0&&(this.m_invMass=1/this.m_mass,e.Scale(this.m_invMass)),this.m_I>0&&!this.m_fixedRotationFlag?(this.m_I-=this.m_mass*t.b2Vec2.Dot(e,e),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);const s=m.ResetMassData_s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e),t.b2Transform.MultiplyVec2(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(this.m_sweep.c,s,t.b2Vec2.s_t0),this.m_linearVelocity)}GetWorldPoint(e,s){return t.b2Transform.MultiplyVec2(this.m_xf,e,s)}GetWorldVector(e,s){return t.b2Rot.MultiplyVec2(this.m_xf.q,e,s)}GetLocalPoint(e,s){return t.b2Transform.TransposeMultiplyVec2(this.m_xf,e,s)}GetLocalVector(e,s){return t.b2Rot.TransposeMultiplyVec2(this.m_xf.q,e,s)}GetLinearVelocityFromWorldPoint(e,s){return t.b2Vec2.AddCrossScalarVec2(this.m_linearVelocity,this.m_angularVelocity,t.b2Vec2.Subtract(e,this.m_sweep.c,t.b2Vec2.s_t0),s)}GetLinearVelocityFromLocalPoint(t,e){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(t,e),e)}GetLinearDamping(){return this.m_linearDamping}SetLinearDamping(t){this.m_linearDamping=t}GetAngularDamping(){return this.m_angularDamping}SetAngularDamping(t){this.m_angularDamping=t}GetGravityScale(){return this.m_gravityScale}SetGravityScale(t){this.m_gravityScale=t}SetType(t){if(i.b2Assert(!this.m_world.IsLocked()),this.m_type===t)return;this.m_type=t,this.ResetMassData(),this.m_type===a.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_awakeFlag=!1,this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;let e=this.m_contactList;for(;e;){const t=e;e=e.next,this.m_world.m_contactManager.Destroy(t.contact)}this.m_contactList=null;const s=this.m_world.m_contactManager.m_broadPhase;for(let i=this.m_fixtureList;i;i=i.m_next)for(const t of i.m_proxies)s.TouchProxy(t.treeNode)}GetType(){return this.m_type}SetBullet(t){this.m_bulletFlag=t}IsBullet(){return this.m_bulletFlag}SetSleepingAllowed(t){this.m_autoSleepFlag=t,t||this.SetAwake(!0)}IsSleepingAllowed(){return this.m_autoSleepFlag}SetAwake(t){this.m_type!==a.b2_staticBody&&(t?(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0))}IsAwake(){return this.m_awakeFlag}SetEnabled(t){if(i.b2Assert(!this.m_world.IsLocked()),t===this.IsEnabled())return;this.m_enabledFlag=t;const e=this.m_world.m_contactManager.m_broadPhase;if(t){for(let t=this.m_fixtureList;t;t=t.m_next)t.CreateProxies(e,this.m_xf);this.m_world.m_newContacts=!0}else{for(let s=this.m_fixtureList;s;s=s.m_next)s.DestroyProxies(e);let t=this.m_contactList;for(;t;){const e=t;t=t.next,this.m_world.m_contactManager.Destroy(e.contact)}this.m_contactList=null}}IsEnabled(){return this.m_enabledFlag}SetFixedRotation(t){this.m_fixedRotationFlag!==t&&(this.m_fixedRotationFlag=t,this.m_angularVelocity=0,this.ResetMassData())}IsFixedRotation(){return this.m_fixedRotationFlag}GetFixtureList(){return this.m_fixtureList}GetJointList(){return this.m_jointList}GetContactList(){return this.m_contactList}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}GetWorld(){return this.m_world}SynchronizeFixtures(){const e=this.m_world.m_contactManager.m_broadPhase;if(this.m_awakeFlag){const s=m.SynchronizeFixtures_s_xf1;s.q.Set(this.m_sweep.a0),t.b2Rot.MultiplyVec2(s.q,this.m_sweep.localCenter,s.p),t.b2Vec2.Subtract(this.m_sweep.c0,s.p,s.p);for(let t=this.m_fixtureList;t;t=t.m_next)t.Synchronize(e,s,this.m_xf)}else for(let t=this.m_fixtureList;t;t=t.m_next)t.Synchronize(e,this.m_xf,this.m_xf)}SynchronizeTransform(){this.m_xf.q.Set(this.m_sweep.a),t.b2Rot.MultiplyVec2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),t.b2Vec2.Subtract(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}ShouldCollide(t){return(this.m_type===a.b2_dynamicBody||t.m_type===a.b2_dynamicBody)&&this.ShouldCollideConnected(t)}ShouldCollideConnected(t){for(let e=this.m_jointList;e;e=e.next)if(e.other===t&&!e.joint.m_collideConnected)return!1;return!0}Advance(e){this.m_sweep.Advance(e),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.Set(this.m_sweep.a),t.b2Rot.MultiplyVec2(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),t.b2Vec2.Subtract(this.m_sweep.c,this.m_xf.p,this.m_xf.p)}}exports.b2Body=m,m.SetMassData_s_oldCenter=new t.b2Vec2,m.ResetMassData_s_localCenter=new t.b2Vec2,m.ResetMassData_s_oldCenter=new t.b2Vec2,m.ResetMassData_s_massData=new e.b2MassData,m.SynchronizeFixtures_s_xf1=new t.b2Transform;
},{"../common/b2_math":"YmMi","../collision/b2_shape":"QXiX","./b2_fixture":"MuJF","../common/b2_common":"xZSi"}],"VBK5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DrawCenterOfMasses=exports.DrawAABBs=exports.DrawPairs=exports.DrawJoints=exports.DrawShapes=exports.GetShapeColor=void 0;const e=require("./b2_math"),o=require("./b2_draw"),t=require("../dynamics/b2_body"),r=require("./b2_common"),s={cA:new e.b2Vec2,cB:new e.b2Vec2,vs:r.b2MakeArray(4,e.b2Vec2),xf:new e.b2Transform};function n(e){return e.GetType()===t.b2BodyType.b2_dynamicBody&&0===e.m_mass?o.debugColors.badBody:e.IsEnabled()?e.GetType()===t.b2BodyType.b2_staticBody?o.debugColors.staticBody:e.GetType()===t.b2BodyType.b2_kinematicBody?o.debugColors.kinematicBody:e.IsAwake()?o.debugColors.body:o.debugColors.sleepingBody:o.debugColors.disabledBody}function a(e,o){for(let t=o.GetBodyList();t;t=t.m_next){const o=t.m_xf;e.PushTransform(o);for(let r=t.GetFixtureList();r;r=r.m_next)r.GetShape().Draw(e,n(t));e.PopTransform(o)}}function d(e,o){for(let t=o.GetJointList();t;t=t.m_next)t.Draw(e)}function i(e,t){for(let r=t.GetContactList();r;r=r.m_next){const t=r.GetFixtureA(),n=r.GetFixtureB(),a=r.GetChildIndexA(),d=r.GetChildIndexB(),i=t.GetAABB(a).GetCenter(s.cA),p=n.GetAABB(d).GetCenter(s.cB);e.DrawSegment(i,p,o.debugColors.pair)}}function p(e,t){const{vs:r}=s;for(let s=t.GetBodyList();s;s=s.m_next)if(s.IsEnabled())for(let t=s.GetFixtureList();t;t=t.m_next)for(let s=0;s<t.m_proxyCount;++s){const n=t.m_proxies[s],{aabb:a}=n.treeNode;r[0].Set(a.lowerBound.x,a.lowerBound.y),r[1].Set(a.upperBound.x,a.lowerBound.y),r[2].Set(a.upperBound.x,a.upperBound.y),r[3].Set(a.lowerBound.x,a.upperBound.y),e.DrawPolygon(r,4,o.debugColors.aabb)}}function u(e,o){const{xf:t}=s;for(let r=o.GetBodyList();r;r=r.m_next)t.q.Copy(r.m_xf.q),t.p.Copy(r.GetWorldCenter()),e.DrawTransform(t)}exports.GetShapeColor=n,exports.DrawShapes=a,exports.DrawJoints=d,exports.DrawPairs=i,exports.DrawAABBs=p,exports.DrawCenterOfMasses=u;
},{"./b2_math":"YmMi","./b2_draw":"J87F","../dynamics/b2_body":"hxRe","./b2_common":"xZSi"}],"KajI":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Timer=void 0;class e{constructor(){this.m_start=performance.now()}Reset(){return this.m_start=performance.now(),this}GetMilliseconds(){return performance.now()-this.m_start}}exports.b2Timer=e;
},{}],"O0IN":[function(require,module,exports) {
"use strict";function e(e,t){for(const n of Object.keys(t)){const o=t[n],r=e[n],s=function(...e){return o.call(this,r.bind(this),...e)};Object.defineProperty(s,"name",{value:n}),e[n]=s}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2_augment=void 0,exports.b2_augment=e;
},{}],"TnoZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2DynamicTree=exports.b2TreeNode=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),i=require("./b2_collision"),a={stack:[],t:new t.b2Vec2,r:new t.b2Vec2,v:new t.b2Vec2,abs_v:new t.b2Vec2,segmentAABB:new i.b2AABB,subInput:new i.b2RayCastInput,combinedAABB:new i.b2AABB,aabb:new i.b2AABB,fatAABB:new i.b2AABB,hugeAABB:new i.b2AABB,c:new t.b2Vec2,h:new t.b2Vec2};let h=0;class r{constructor(){this.aabb=new i.b2AABB,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=0,this.moved=!1,this.id=h++}Reset(){this.child1=null,this.child2=null,this.height=-1,this.userData=null}IsLeaf(){return null===this.child1}GetArea(){if(this.IsLeaf())return 0;let e=this.aabb.GetPerimeter();return this.child1&&(e+=this.child1.GetArea()),this.child2&&(e+=this.child2.GetArea()),e}ComputeHeight(){if(this.IsLeaf())return 0;e.b2Assert(null!==this.child1&&null!==this.child2);const t=e.b2Verify(this.child1).ComputeHeight(),i=e.b2Verify(this.child2).ComputeHeight();return 1+Math.max(t,i)}GetMaxBalance(){if(this.height<=1)return 0;const t=e.b2Verify(this.child1),i=e.b2Verify(this.child2);return Math.max(t.GetMaxBalance(),i.GetMaxBalance(),Math.abs(i.height-t.height))}ShiftOrigin(t){this.height<=1||(e.b2Verify(this.child1).ShiftOrigin(t),e.b2Verify(this.child2).ShiftOrigin(t),this.aabb.lowerBound.Subtract(t),this.aabb.upperBound.Subtract(t))}}exports.b2TreeNode=r;class n{constructor(){this.m_root=null,this.m_freeList=null}Query(e,t){const i=a.stack;i.length=0;let h=this.m_root;for(;h;){if(h.aabb.TestOverlap(e))if(h.IsLeaf()){if(!t(h))return}else i.push(h.child1),i.push(h.child2);h=i.pop()}}QueryPoint(e,t){const i=a.stack;i.length=0;let h=this.m_root;for(;h;){if(h.aabb.TestContain(e))if(h.IsLeaf()){if(!t(h))return}else i.push(h.child1),i.push(h.child2);h=i.pop()}}RayCast(e,i){const{p1:h,p2:r}=e,n=t.b2Vec2.Subtract(r,h,a.r);n.Normalize();const b=t.b2Vec2.CrossOneVec2(n,a.v),o=b.GetAbs(a.abs_v);let{maxFraction:l}=e;const{segmentAABB:s,subInput:c,c:u,h:d,t:p}=a;t.b2Vec2.AddScaled(h,l,t.b2Vec2.Subtract(r,h,p),p),t.b2Vec2.Min(h,p,s.lowerBound),t.b2Vec2.Max(h,p,s.upperBound);const m=a.stack;m.length=0;let f=this.m_root;for(;f;){if(!f.aabb.TestOverlap(s)){f=m.pop();continue}if(f.aabb.GetCenter(u),f.aabb.GetExtents(d),Math.abs(t.b2Vec2.Dot(b,t.b2Vec2.Subtract(h,u,t.b2Vec2.s_t0)))-t.b2Vec2.Dot(o,d)>0)f=m.pop();else{if(f.IsLeaf()){c.p1.Copy(e.p1),c.p2.Copy(e.p2),c.maxFraction=l;const a=i(c,f);if(0===a)return;a>0&&(l=a,t.b2Vec2.AddScaled(h,l,t.b2Vec2.Subtract(r,h,p),p),t.b2Vec2.Min(h,p,s.lowerBound),t.b2Vec2.Max(h,p,s.upperBound))}else m.push(f.child1),m.push(f.child2);f=m.pop()}}}AllocateNode(){if(null===this.m_freeList)return new r;const e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e.height=0,e.moved=!1,e}FreeNode(e){e.parent=this.m_freeList,e.Reset(),this.m_freeList=e}CreateProxy(t,i){const a=this.AllocateNode(),h=e.b2_aabbExtension;return a.aabb.lowerBound.Set(t.lowerBound.x-h,t.lowerBound.y-h),a.aabb.upperBound.Set(t.upperBound.x+h,t.upperBound.y+h),a.userData=i,a.height=0,a.moved=!0,this.InsertLeaf(a),a}DestroyProxy(e){this.RemoveLeaf(e),this.FreeNode(e)}MoveProxy(t,i,h){const{fatAABB:r,hugeAABB:n}=a,b=e.b2_aabbExtension;r.lowerBound.Set(i.lowerBound.x-b,i.lowerBound.y-b),r.upperBound.Set(i.upperBound.x+b,i.upperBound.y+b);const o=e.b2_aabbMultiplier*h.x,l=e.b2_aabbMultiplier*h.y;o<0?r.lowerBound.x+=o:r.upperBound.x+=o,l<0?r.lowerBound.y+=l:r.upperBound.y+=l;const s=t.aabb;if(s.Contains(i)){const t=4*e.b2_aabbExtension;if(n.lowerBound.Set(r.lowerBound.x-t,i.lowerBound.y-t),n.upperBound.Set(r.upperBound.x+t,i.upperBound.y+t),n.Contains(s))return!1}return this.RemoveLeaf(t),t.aabb.Copy(r),this.InsertLeaf(t),t.moved=!0,!0}InsertLeaf(t){if(null===this.m_root)return this.m_root=t,void(this.m_root.parent=null);const{combinedAABB:i,aabb:h}=a,r=t.aabb;let n=this.m_root;for(;!n.IsLeaf();){const t=e.b2Verify(n.child1),a=e.b2Verify(n.child2),b=n.aabb.GetPerimeter();i.Combine2(n.aabb,r);const o=i.GetPerimeter(),l=2*o,s=2*(o-b);let c,u,d,p;if(t.IsLeaf()?(h.Combine2(r,t.aabb),c=h.GetPerimeter()+s):(h.Combine2(r,t.aabb),u=t.aabb.GetPerimeter(),c=(d=h.GetPerimeter())-u+s),a.IsLeaf()?(h.Combine2(r,a.aabb),p=h.GetPerimeter()+s):(h.Combine2(r,a.aabb),u=a.aabb.GetPerimeter(),p=(d=h.GetPerimeter())-u+s),l<c&&l<p)break;n=c<p?t:a}const b=n.parent,o=this.AllocateNode();o.parent=b,o.userData=null,o.aabb.Combine2(r,n.aabb),o.height=n.height+1,null!==b?(b.child1===n?b.child1=o:b.child2=o,o.child1=n,o.child2=t,n.parent=o,t.parent=o):(o.child1=n,o.child2=t,n.parent=o,t.parent=o,this.m_root=o);let l=t.parent;for(;null!==l;){l=this.Balance(l);const t=e.b2Verify(l.child1),i=e.b2Verify(l.child2);l.height=1+Math.max(t.height,i.height),l.aabb.Combine2(t.aabb,i.aabb),l=l.parent}}RemoveLeaf(t){if(t===this.m_root)return void(this.m_root=null);const i=e.b2Verify(t.parent),a=i.parent,h=e.b2Verify(i.child1===t?i.child2:i.child1);if(null!==a){a.child1===i?a.child1=h:a.child2=h,h.parent=a,this.FreeNode(i);let t=a;for(;null!==t;){t=this.Balance(t);const i=e.b2Verify(t.child1),a=e.b2Verify(t.child2);t.aabb.Combine2(i.aabb,a.aabb),t.height=1+Math.max(i.height,a.height),t=t.parent}}else this.m_root=h,h.parent=null,this.FreeNode(i)}Balance(t){if(t.IsLeaf()||t.height<2)return t;const i=e.b2Verify(t.child1),a=e.b2Verify(t.child2),h=a.height-i.height;if(h>1){const h=e.b2Verify(a.child1),r=e.b2Verify(a.child2);return a.child1=t,a.parent=t.parent,t.parent=a,null!==a.parent?a.parent.child1===t?a.parent.child1=a:a.parent.child2=a:this.m_root=a,h.height>r.height?(a.child2=h,t.child2=r,r.parent=t,t.aabb.Combine2(i.aabb,r.aabb),a.aabb.Combine2(t.aabb,h.aabb),t.height=1+Math.max(i.height,r.height),a.height=1+Math.max(t.height,h.height)):(a.child2=r,t.child2=h,h.parent=t,t.aabb.Combine2(i.aabb,h.aabb),a.aabb.Combine2(t.aabb,r.aabb),t.height=1+Math.max(i.height,h.height),a.height=1+Math.max(t.height,r.height)),a}if(h<-1){const h=e.b2Verify(i.child1),r=e.b2Verify(i.child2);return i.child1=t,i.parent=t.parent,t.parent=i,null!==i.parent?i.parent.child1===t?i.parent.child1=i:i.parent.child2=i:this.m_root=i,h.height>r.height?(i.child2=h,t.child1=r,r.parent=t,t.aabb.Combine2(a.aabb,r.aabb),i.aabb.Combine2(t.aabb,h.aabb),t.height=1+Math.max(a.height,r.height),i.height=1+Math.max(t.height,h.height)):(i.child2=r,t.child1=h,h.parent=t,t.aabb.Combine2(a.aabb,h.aabb),i.aabb.Combine2(t.aabb,r.aabb),t.height=1+Math.max(a.height,h.height),i.height=1+Math.max(t.height,r.height)),i}return t}GetHeight(){return null===this.m_root?0:this.m_root.height}GetAreaRatio(){if(null===this.m_root)return 0;const e=this.m_root,t=e.aabb.GetPerimeter();return e.GetArea()/t}GetMaxBalance(){return null===this.m_root?0:this.m_root.GetMaxBalance()}ShiftOrigin(e){var t;null===(t=this.m_root)||void 0===t||t.ShiftOrigin(e)}}exports.b2DynamicTree=n;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_collision":"DOG3"}],"r8Yy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2BroadPhase=void 0;const e=require("../common/b2_common"),t=require("./b2_dynamic_tree");class r{constructor(){this.m_tree=new t.b2DynamicTree,this.m_proxyCount=0,this.m_moveCount=0,this.m_moveBuffer=[],this.m_pairCount=0,this.m_pairBuffer=[],this.m_queryProxy=new t.b2TreeNode,this.QueryCallback=(e=>e.id===this.m_queryProxy.id||(!!(e.moved&&e.id>this.m_queryProxy.id)||(this.m_pairBuffer[this.m_pairCount]=e.id<this.m_queryProxy.id?[e,this.m_queryProxy]:[this.m_queryProxy,e],++this.m_pairCount,!0)))}CreateProxy(e,t){const r=this.m_tree.CreateProxy(e,t);return++this.m_proxyCount,this.BufferMove(r),r}DestroyProxy(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}MoveProxy(e,t,r){this.m_tree.MoveProxy(e,t,r)&&this.BufferMove(e)}TouchProxy(e){this.BufferMove(e)}GetProxyCount(){return this.m_proxyCount}UpdatePairs(t){this.m_pairCount=0;for(let e=0;e<this.m_moveCount;++e){const t=this.m_moveBuffer[e];if(null===t)continue;this.m_queryProxy=t;const r=t.aabb;this.m_tree.Query(r,this.QueryCallback)}for(let r=0;r<this.m_pairCount;++r){const o=this.m_pairBuffer[r];t(e.b2Verify(o[0].userData),e.b2Verify(o[1].userData))}for(let e=0;e<this.m_moveCount;++e){const t=this.m_moveBuffer[e];t&&(t.moved=!1)}this.m_moveCount=0}Query(e,t){this.m_tree.Query(e,t)}QueryPoint(e,t){this.m_tree.QueryPoint(e,t)}RayCast(e,t){this.m_tree.RayCast(e,t)}GetTreeHeight(){return this.m_tree.GetHeight()}GetTreeBalance(){return this.m_tree.GetMaxBalance()}GetTreeQuality(){return this.m_tree.GetAreaRatio()}ShiftOrigin(e){this.m_tree.ShiftOrigin(e)}BufferMove(e){this.m_moveBuffer[this.m_moveCount]=e,++this.m_moveCount}UnBufferMove(e){const t=this.m_moveBuffer.indexOf(e);this.m_moveBuffer[t]=null}}exports.b2BroadPhase=r;
},{"../common/b2_common":"xZSi","./b2_dynamic_tree":"TnoZ"}],"GFfv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2TimeOfImpact=exports.b2TOIOutput=exports.b2TOIOutputState=exports.b2TOIInput=exports.b2Toi=void 0;const t=require("../common/b2_common"),e=require("../common/b2_settings"),s=require("../common/b2_math"),o=require("../common/b2_timer"),i=require("./b2_distance");exports.b2Toi={time:0,maxTime:0,calls:0,iters:0,maxIters:0,rootIters:0,maxRootIters:0,reset(){this.time=0,this.maxTime=0,this.calls=0,this.iters=0,this.maxIters=0,this.rootIters=0,this.maxRootIters=0}};const r=new s.b2Transform,a=new s.b2Transform,c=new s.b2Vec2,n=new s.b2Vec2,p=new s.b2Vec2,m=new s.b2Vec2,b=new s.b2Vec2;class _{constructor(){this.proxyA=new i.b2DistanceProxy,this.proxyB=new i.b2DistanceProxy,this.sweepA=new s.b2Sweep,this.sweepB=new s.b2Sweep,this.tMax=0}}var l,x;exports.b2TOIInput=_,function(t){t[t.e_unknown=0]="e_unknown",t[t.e_failed=1]="e_failed",t[t.e_overlapped=2]="e_overlapped",t[t.e_touching=3]="e_touching",t[t.e_separated=4]="e_separated"}(l=exports.b2TOIOutputState||(exports.b2TOIOutputState={}));class u{constructor(){this.state=l.e_unknown,this.t=0}}exports.b2TOIOutput=u,function(t){t[t.e_points=0]="e_points",t[t.e_faceA=1]="e_faceA",t[t.e_faceB=2]="e_faceB"}(x||(x={}));class V{constructor(){this.m_sweepA=new s.b2Sweep,this.m_sweepB=new s.b2Sweep,this.m_type=x.e_points,this.m_localPoint=new s.b2Vec2,this.m_axis=new s.b2Vec2}Initialize(t,e,o,i,m,b){this.m_proxyA=e,this.m_proxyB=i;const{count:_}=t;this.m_sweepA.Copy(o),this.m_sweepB.Copy(m);const l=this.m_sweepA.GetTransform(r,b),u=this.m_sweepB.GetTransform(a,b);if(1===_){this.m_type=x.e_points;const e=this.m_proxyA.GetVertex(t.indexA[0]),o=this.m_proxyB.GetVertex(t.indexB[0]),i=s.b2Transform.MultiplyVec2(l,e,c),r=s.b2Transform.MultiplyVec2(u,o,n);return s.b2Vec2.Subtract(r,i,this.m_axis),this.m_axis.Normalize()}if(t.indexA[0]===t.indexA[1]){this.m_type=x.e_faceB;const e=this.m_proxyB.GetVertex(t.indexB[0]),o=this.m_proxyB.GetVertex(t.indexB[1]);s.b2Vec2.CrossVec2One(s.b2Vec2.Subtract(o,e,s.b2Vec2.s_t0),this.m_axis).Normalize();const i=s.b2Rot.MultiplyVec2(u.q,this.m_axis,p);s.b2Vec2.Mid(e,o,this.m_localPoint);const r=s.b2Transform.MultiplyVec2(u,this.m_localPoint,n),a=this.m_proxyA.GetVertex(t.indexA[0]),m=s.b2Transform.MultiplyVec2(l,a,c);let b=s.b2Vec2.Dot(s.b2Vec2.Subtract(m,r,s.b2Vec2.s_t0),i);return b<0&&(this.m_axis.Negate(),b=-b),b}this.m_type=x.e_faceA;const V=this.m_proxyA.GetVertex(t.indexA[0]),h=this.m_proxyA.GetVertex(t.indexA[1]);s.b2Vec2.CrossVec2One(s.b2Vec2.Subtract(h,V,s.b2Vec2.s_t0),this.m_axis).Normalize();const y=s.b2Rot.MultiplyVec2(l.q,this.m_axis,p);s.b2Vec2.Mid(V,h,this.m_localPoint);const f=s.b2Transform.MultiplyVec2(l,this.m_localPoint,c),T=this.m_proxyB.GetVertex(t.indexB[0]),w=s.b2Transform.MultiplyVec2(u,T,n);let M=s.b2Vec2.Dot(s.b2Vec2.Subtract(w,f,s.b2Vec2.s_t0),y);return M<0&&(this.m_axis.Negate(),M=-M),M}FindMinSeparation(t,e,o){const i=this.m_sweepA.GetTransform(r,o),_=this.m_sweepB.GetTransform(a,o);switch(this.m_type){case x.e_points:{const o=s.b2Rot.TransposeMultiplyVec2(i.q,this.m_axis,m),r=s.b2Rot.TransposeMultiplyVec2(_.q,s.b2Vec2.Negate(this.m_axis,s.b2Vec2.s_t0),b);t[0]=this.m_proxyA.GetSupport(o),e[0]=this.m_proxyB.GetSupport(r);const a=this.m_proxyA.GetVertex(t[0]),p=this.m_proxyB.GetVertex(e[0]),l=s.b2Transform.MultiplyVec2(i,a,c),x=s.b2Transform.MultiplyVec2(_,p,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(x,l,s.b2Vec2.s_t0),this.m_axis)}case x.e_faceA:{const o=s.b2Rot.MultiplyVec2(i.q,this.m_axis,p),r=s.b2Transform.MultiplyVec2(i,this.m_localPoint,c),a=s.b2Rot.TransposeMultiplyVec2(_.q,s.b2Vec2.Negate(o,s.b2Vec2.s_t0),b);t[0]=-1,e[0]=this.m_proxyB.GetSupport(a);const m=this.m_proxyB.GetVertex(e[0]),l=s.b2Transform.MultiplyVec2(_,m,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),o)}case x.e_faceB:{const o=s.b2Rot.MultiplyVec2(_.q,this.m_axis,p),r=s.b2Transform.MultiplyVec2(_,this.m_localPoint,n),a=s.b2Rot.TransposeMultiplyVec2(i.q,s.b2Vec2.Negate(o,s.b2Vec2.s_t0),m);e[0]=-1,t[0]=this.m_proxyA.GetSupport(a);const b=this.m_proxyA.GetVertex(t[0]),l=s.b2Transform.MultiplyVec2(i,b,c);return s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),o)}default:return t[0]=-1,e[0]=-1,0}}Evaluate(e,o,i){const m=this.m_sweepA.GetTransform(r,i),b=this.m_sweepB.GetTransform(a,i);switch(this.m_type){case x.e_points:{const t=this.m_proxyA.GetVertex(e),i=this.m_proxyB.GetVertex(o),r=s.b2Transform.MultiplyVec2(m,t,c),a=s.b2Transform.MultiplyVec2(b,i,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(a,r,s.b2Vec2.s_t0),this.m_axis)}case x.e_faceA:{const t=s.b2Rot.MultiplyVec2(m.q,this.m_axis,p),e=s.b2Transform.MultiplyVec2(m,this.m_localPoint,c),i=this.m_proxyB.GetVertex(o),r=s.b2Transform.MultiplyVec2(b,i,n);return s.b2Vec2.Dot(s.b2Vec2.Subtract(r,e,s.b2Vec2.s_t0),t)}case x.e_faceB:{const t=s.b2Rot.MultiplyVec2(b.q,this.m_axis,p),o=s.b2Transform.MultiplyVec2(b,this.m_localPoint,n),i=this.m_proxyA.GetVertex(e),r=s.b2Transform.MultiplyVec2(m,i,c);return s.b2Vec2.Dot(s.b2Vec2.Subtract(r,o,s.b2Vec2.s_t0),t)}default:return t.b2Assert(!1),0}}}const h=new o.b2Timer,y=new i.b2SimplexCache,f=new i.b2DistanceInput,T=new i.b2DistanceOutput,w=new V,M=[0],d=[0],A=new s.b2Sweep,B=new s.b2Sweep;function S(s,o){const c=h.Reset();++exports.b2Toi.calls,s.state=l.e_unknown,s.t=o.tMax;const{proxyA:n,proxyB:p,tMax:m}=o,b=Math.max(e.b2_maxPolygonVertices,n.m_count,p.m_count),_=A.Copy(o.sweepA),x=B.Copy(o.sweepB);_.Normalize(),x.Normalize();const u=n.m_radius+p.m_radius,V=Math.max(t.b2_linearSlop,u-3*t.b2_linearSlop),S=.25*t.b2_linearSlop;let G=0;let I=0;const O=y;O.count=0;const R=f;for(R.proxyA.Copy(o.proxyA),R.proxyB.Copy(o.proxyB),R.useRadii=!1;;){const t=_.GetTransform(r,G),e=x.GetTransform(a,G);R.transformA.Copy(t),R.transformB.Copy(e);const o=T;if(i.b2Distance(o,O,R),o.distance<=0){s.state=l.e_overlapped,s.t=0;break}if(o.distance<V+S){s.state=l.e_touching,s.t=G;break}const c=w;c.Initialize(O,n,_,p,x,G);let u=!1,h=m,y=0;for(;;){const t=M,e=d;let o=c.FindMinSeparation(t,e,h);if(o>V+S){s.state=l.e_separated,s.t=m,u=!0;break}if(o>V-S){G=h;break}let i=c.Evaluate(t[0],e[0],G);if(i<V-S){s.state=l.e_failed,s.t=G,u=!0;break}if(i<=V+S){s.state=l.e_touching,s.t=G,u=!0;break}let r=0,a=G,n=h;for(;;){let s;s=1&r?a+(V-i)*(n-a)/(o-i):.5*(a+n),++r,++exports.b2Toi.rootIters;const p=c.Evaluate(t[0],e[0],s);if(Math.abs(p-V)<S){h=s;break}if(p>V?(a=s,i=p):(n=s,o=p),50===r)break}if(exports.b2Toi.maxRootIters=Math.max(exports.b2Toi.maxRootIters,r),++y===b)break}if(++I,++exports.b2Toi.iters,u)break;if(20===I){s.state=l.e_failed,s.t=G;break}}exports.b2Toi.maxIters=Math.max(exports.b2Toi.maxIters,I);const k=c.GetMilliseconds();exports.b2Toi.maxTime=Math.max(exports.b2Toi.maxTime,k),exports.b2Toi.time+=k}exports.b2TimeOfImpact=S;
},{"../common/b2_common":"xZSi","../common/b2_settings":"nssz","../common/b2_math":"YmMi","../common/b2_timer":"KajI","./b2_distance":"XVAh"}],"JHeH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CollidePolygonAndCircle=exports.b2CollideCircles=void 0;const o=require("../common/b2_common"),e=require("../common/b2_math"),t=require("./b2_collision"),c=new e.b2Vec2,n=new e.b2Vec2;function i(o,i,l,r,a){o.pointCount=0;const p=e.b2Transform.MultiplyVec2(l,i.m_p,c),b=e.b2Transform.MultiplyVec2(a,r.m_p,n),s=e.b2Vec2.DistanceSquared(p,b),u=i.m_radius+r.m_radius;s>u*u||(o.type=t.b2ManifoldType.e_circles,o.localPoint.Copy(i.m_p),o.localNormal.SetZero(),o.pointCount=1,o.points[0].localPoint.Copy(r.m_p),o.points[0].id.key=0)}exports.b2CollideCircles=i;const l=new e.b2Vec2,r=new e.b2Vec2,a=new e.b2Vec2;function p(c,n,i,p,b){c.pointCount=0;const s=e.b2Transform.MultiplyVec2(b,p.m_p,l),u=e.b2Transform.TransposeMultiplyVec2(i,s,r);let m=0,_=-o.b2_maxFloat;const y=n.m_radius+p.m_radius,V=n.m_count,d=n.m_vertices,C=n.m_normals;for(let o=0;o<V;++o){const t=e.b2Vec2.Dot(C[o],e.b2Vec2.Subtract(u,d[o],e.b2Vec2.s_t0));if(t>y)return;t>_&&(_=t,m=o)}const f=m,P=f+1<V?f+1:0,M=d[f],S=d[P];if(_<o.b2_epsilon)return c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,c.localNormal.Copy(C[m]),e.b2Vec2.Mid(M,S,c.localPoint),c.points[0].localPoint.Copy(p.m_p),void(c.points[0].id.key=0);const T=e.b2Vec2.Dot(e.b2Vec2.Subtract(u,M,e.b2Vec2.s_t0),e.b2Vec2.Subtract(S,M,e.b2Vec2.s_t1)),D=e.b2Vec2.Dot(e.b2Vec2.Subtract(u,S,e.b2Vec2.s_t0),e.b2Vec2.Subtract(M,S,e.b2Vec2.s_t1));if(T<=0){if(e.b2Vec2.DistanceSquared(u,M)>y*y)return;c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,e.b2Vec2.Subtract(u,M,c.localNormal).Normalize(),c.localPoint.Copy(M),c.points[0].localPoint.Copy(p.m_p),c.points[0].id.key=0}else if(D<=0){if(e.b2Vec2.DistanceSquared(u,S)>y*y)return;c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,e.b2Vec2.Subtract(u,S,c.localNormal).Normalize(),c.localPoint.Copy(S),c.points[0].localPoint.Copy(p.m_p),c.points[0].id.key=0}else{const o=e.b2Vec2.Mid(M,S,a);if(e.b2Vec2.Dot(e.b2Vec2.Subtract(u,o,e.b2Vec2.s_t1),C[f])>y)return;c.pointCount=1,c.type=t.b2ManifoldType.e_faceA,c.localNormal.Copy(C[f]),c.localPoint.Copy(o),c.points[0].localPoint.Copy(p.m_p),c.points[0].id.key=0}}exports.b2CollidePolygonAndCircle=p;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_collision":"DOG3"}],"FXGt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CollidePolygons=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),o=require("./b2_collision"),n=new t.b2Transform,c=new t.b2Vec2,r=new t.b2Vec2;function i(o,i,l,b,s){const a=i.m_count,p=b.m_count,V=i.m_normals,m=i.m_vertices,u=b.m_vertices,y=t.b2Transform.TransposeMultiply(s,l,n);let f=0,_=-e.b2_maxFloat;for(let n=0;n<a;++n){const o=t.b2Rot.MultiplyVec2(y.q,V[n],c),i=t.b2Transform.MultiplyVec2(y,m[n],r);let l=e.b2_maxFloat;for(let e=0;e<p;++e){const n=t.b2Vec2.Dot(o,t.b2Vec2.Subtract(u[e],i,t.b2Vec2.s_t0));n<l&&(l=n)}l>_&&(_=l,f=n)}return o[0]=f,_}const l=new t.b2Vec2;function b(n,c,r,i,b,s){const a=c.m_normals,p=b.m_count,V=b.m_vertices,m=b.m_normals,u=t.b2Rot.TransposeMultiplyVec2(s.q,t.b2Rot.MultiplyVec2(r.q,a[i],t.b2Vec2.s_t0),l);let y=0,f=e.b2_maxFloat;for(let e=0;e<p;++e){const o=t.b2Vec2.Dot(u,m[e]);o<f&&(f=o,y=e)}const _=y,d=_+1<p?_+1:0,x=n[0];t.b2Transform.MultiplyVec2(s,V[_],x.v);const C=x.id.cf;C.indexA=i,C.indexB=_,C.typeA=o.b2ContactFeatureType.e_face,C.typeB=o.b2ContactFeatureType.e_vertex;const T=n[1];t.b2Transform.MultiplyVec2(s,V[d],T.v);const w=T.id.cf;w.indexA=i,w.indexB=d,w.typeA=o.b2ContactFeatureType.e_face,w.typeB=o.b2ContactFeatureType.e_vertex}const s=[new o.b2ClipVertex,new o.b2ClipVertex],a=[new o.b2ClipVertex,new o.b2ClipVertex],p=[new o.b2ClipVertex,new o.b2ClipVertex],V=[0],m=[0],u=new t.b2Vec2,y=new t.b2Vec2,f=new t.b2Vec2,_=new t.b2Vec2,d=new t.b2Vec2,x=new t.b2Vec2,C=new t.b2Vec2,T=new t.b2Vec2;function w(n,c,r,l,w){n.pointCount=0;const M=c.m_radius+l.m_radius,v=V,A=i(v,c,r,l,w);if(A>M)return;const B=m,q=i(B,l,w,c,r);if(q>M)return;let F,D,P,g,S,R;q>A+.1*e.b2_linearSlop?(F=l,D=c,P=w,g=r,S=B[0],n.type=o.b2ManifoldType.e_faceB,R=1):(F=c,D=l,P=r,g=w,S=v[0],n.type=o.b2ManifoldType.e_faceA,R=0);const N=s;b(N,F,P,S,D,g);const O=F.m_count,L=F.m_vertices,h=S,j=S+1<O?S+1:0;let z=L[h],k=L[j];const E=t.b2Vec2.Subtract(k,z,u);E.Normalize();const G=t.b2Vec2.CrossVec2One(E,y),H=t.b2Vec2.Mid(z,k,f),I=t.b2Rot.MultiplyVec2(P.q,E,d),J=t.b2Vec2.CrossVec2One(I,_);z=t.b2Transform.MultiplyVec2(P,z,C),k=t.b2Transform.MultiplyVec2(P,k,T);const K=t.b2Vec2.Dot(J,z),Q=-t.b2Vec2.Dot(I,z)+M,U=t.b2Vec2.Dot(I,k)+M,W=a,X=p,Y=t.b2Vec2.Negate(I,x);let Z=o.b2ClipSegmentToLine(W,N,Y,Q,h);if(Z<2)return;if((Z=o.b2ClipSegmentToLine(X,W,I,U,j))<2)return;n.localNormal.Copy(G),n.localPoint.Copy(H);let $=0;for(let o=0;o<e.b2_maxManifoldPoints;++o){const e=X[o];if(t.b2Vec2.Dot(J,e.v)-K<=M){const o=n.points[$];if(t.b2Transform.TransposeMultiplyVec2(g,e.v,o.localPoint),o.id.Copy(e.id),R){const{cf:e}=o.id;e.indexA=e.indexB,e.indexB=e.indexA,e.typeA=e.typeB,e.typeB=e.typeA}++$}}n.pointCount=$}exports.b2CollidePolygons=w;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_collision":"DOG3"}],"Xyzc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CollideEdgeAndPolygon=exports.b2CollideEdgeAndCircle=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),o=require("./b2_collision"),n=require("../common/b2_settings"),c=new t.b2Vec2,i=new t.b2Vec2,r=new t.b2Vec2,a=new t.b2Vec2,s=new t.b2Vec2,b=new t.b2Vec2,l=new t.b2Vec2,p=new o.b2ContactID;function d(e,n,d,f,m){e.pointCount=0;const y=t.b2Transform.TransposeMultiplyVec2(d,t.b2Transform.MultiplyVec2(m,f.m_p,t.b2Vec2.s_t0),c),V=n.m_vertex1,u=n.m_vertex2,_=t.b2Vec2.Subtract(u,V,i),x=l.Set(_.y,-_.x),C=t.b2Vec2.Dot(x,t.b2Vec2.Subtract(y,V,t.b2Vec2.s_t0));if(n.m_oneSided&&C<0)return;const v=t.b2Vec2.Dot(_,t.b2Vec2.Subtract(u,y,t.b2Vec2.s_t0)),w=t.b2Vec2.Dot(_,t.b2Vec2.Subtract(y,V,t.b2Vec2.s_t0)),S=n.m_radius+f.m_radius,A=p;if(A.cf.indexB=0,A.cf.typeB=o.b2ContactFeatureType.e_vertex,w<=0){const c=V,i=t.b2Vec2.Subtract(y,c,r);if(t.b2Vec2.Dot(i,i)>S*S)return;if(n.m_oneSided){const e=n.m_vertex0,o=V,c=t.b2Vec2.Subtract(o,e,a);if(t.b2Vec2.Dot(c,t.b2Vec2.Subtract(o,y,t.b2Vec2.s_t0))>0)return}return A.cf.indexA=0,A.cf.typeA=o.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=o.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(c),e.points[0].id.Copy(A),void e.points[0].localPoint.Copy(f.m_p)}if(v<=0){const c=u,i=t.b2Vec2.Subtract(y,c,r);if(t.b2Vec2.Dot(i,i)>S*S)return;if(n.m_oneSided){const e=n.m_vertex3,o=u,c=t.b2Vec2.Subtract(e,o,s);if(t.b2Vec2.Dot(c,t.b2Vec2.Subtract(y,o,t.b2Vec2.s_t0))>0)return}return A.cf.indexA=1,A.cf.typeA=o.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=o.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(c),e.points[0].id.Copy(A),void e.points[0].localPoint.Copy(f.m_p)}const T=t.b2Vec2.Dot(_,_),g=b;g.x=1/T*(v*V.x+w*u.x),g.y=1/T*(v*V.y+w*u.y);const N=t.b2Vec2.Subtract(y,g,r);t.b2Vec2.Dot(N,N)>S*S||(C<0&&x.Set(-x.x,-x.y),x.Normalize(),A.cf.indexA=0,A.cf.typeA=o.b2ContactFeatureType.e_face,e.pointCount=1,e.type=o.b2ManifoldType.e_faceA,e.localNormal.Copy(x),e.localPoint.Copy(V),e.points[0].id.Copy(A),e.points[0].localPoint.Copy(f.m_p))}var f;exports.b2CollideEdgeAndCircle=d,function(e){e[e.e_unknown=0]="e_unknown",e[e.e_edgeA=1]="e_edgeA",e[e.e_edgeB=2]="e_edgeB"}(f||(f={}));class m{constructor(){this.normal=new t.b2Vec2,this.type=f.e_unknown,this.index=0,this.separation=0}}class y{constructor(){this.vertices=e.b2MakeArray(n.b2_maxPolygonVertices,t.b2Vec2),this.normals=e.b2MakeArray(n.b2_maxPolygonVertices,t.b2Vec2),this.count=0}}class V{constructor(){this.i1=0,this.i2=0,this.v1=new t.b2Vec2,this.v2=new t.b2Vec2,this.normal=new t.b2Vec2,this.sideNormal1=new t.b2Vec2,this.sideOffset1=0,this.sideNormal2=new t.b2Vec2,this.sideOffset2=0}}const u=new m,_=[new t.b2Vec2,new t.b2Vec2];function x(o,n,c){const i=u;i.type=f.e_edgeA,i.index=-1,i.separation=-e.b2_maxFloat,i.normal.SetZero();const r=_;r[0].Copy(c),t.b2Vec2.Negate(c,r[1]);for(let a=0;a<2;++a){let c=e.b2_maxFloat;for(let e=0;e<o.count;++e){const i=t.b2Vec2.Dot(r[a],t.b2Vec2.Subtract(o.vertices[e],n,t.b2Vec2.s_t0));i<c&&(c=i)}c>i.separation&&(i.index=a,i.separation=c,i.normal.Copy(r[a]))}return i}const C=new m,v=new t.b2Vec2;function w(o,n,c){const i=C;i.type=f.e_unknown,i.index=-1,i.separation=-e.b2_maxFloat,i.normal.SetZero();for(let e=0;e<o.count;++e){const r=t.b2Vec2.Negate(o.normals[e],v),a=t.b2Vec2.Dot(r,t.b2Vec2.Subtract(o.vertices[e],n,t.b2Vec2.s_t0)),s=t.b2Vec2.Dot(r,t.b2Vec2.Subtract(o.vertices[e],c,t.b2Vec2.s_t0)),b=Math.min(a,s);b>i.separation&&(i.type=f.e_edgeB,i.index=e,i.separation=b,i.normal.Copy(r))}return i}const S=new t.b2Transform,A=new t.b2Vec2,T=new t.b2Vec2,g=new t.b2Vec2,N=new t.b2Vec2,D=new t.b2Vec2,M=new t.b2Vec2,h=new t.b2Vec2,B=new y,P=new V,F=[new o.b2ClipVertex,new o.b2ClipVertex],O=[new o.b2ClipVertex,new o.b2ClipVertex],k=[new o.b2ClipVertex,new o.b2ClipVertex];function q(n,c,i,r,a){n.pointCount=0;const s=t.b2Transform.TransposeMultiply(i,a,S),b=t.b2Transform.MultiplyVec2(s,r.m_centroid,A),l=c.m_vertex1,p=c.m_vertex2,d=t.b2Vec2.Subtract(p,l,T);d.Normalize();const m=g.Set(d.y,-d.x),y=t.b2Vec2.Dot(m,t.b2Vec2.Subtract(b,l,t.b2Vec2.s_t0)),V=c.m_oneSided;if(V&&y<0)return;const u=B;u.count=r.m_count;for(let e=0;e<r.m_count;++e)t.b2Transform.MultiplyVec2(s,r.m_vertices[e],u.vertices[e]),t.b2Rot.MultiplyVec2(s.q,r.m_normals[e],u.normals[e]);const _=r.m_radius+c.m_radius,C=x(u,l,m);if(C.separation>_)return;const v=w(u,l,p);if(v.separation>_)return;let q;if(q=v.separation-_>.98*(C.separation-_)+.001?v:C,V){const e=t.b2Vec2.Subtract(l,c.m_vertex0,N);e.Normalize();const o=D.Set(e.y,-e.x),n=t.b2Vec2.Cross(e,d)>=0,i=t.b2Vec2.Subtract(c.m_vertex3,p,M);i.Normalize();const r=h.Set(i.y,-i.x),a=t.b2Vec2.Cross(d,i)>=0,s=.1;if(t.b2Vec2.Dot(q.normal,d)<=0)if(n){if(t.b2Vec2.Cross(q.normal,o)>s)return}else q=C;else if(a){if(t.b2Vec2.Cross(r,q.normal)>s)return}else q=C}const z=F,E=P;if(q.type===f.e_edgeA){n.type=o.b2ManifoldType.e_faceA;let e=0,c=t.b2Vec2.Dot(q.normal,u.normals[0]);for(let o=1;o<u.count;++o){const n=t.b2Vec2.Dot(q.normal,u.normals[o]);n<c&&(c=n,e=o)}const i=e,r=i+1<u.count?i+1:0;z[0].v.Copy(u.vertices[i]),z[0].id.cf.indexA=0,z[0].id.cf.indexB=i,z[0].id.cf.typeA=o.b2ContactFeatureType.e_face,z[0].id.cf.typeB=o.b2ContactFeatureType.e_vertex,z[1].v.Copy(u.vertices[r]),z[1].id.cf.indexA=0,z[1].id.cf.indexB=r,z[1].id.cf.typeA=o.b2ContactFeatureType.e_face,z[1].id.cf.typeB=o.b2ContactFeatureType.e_vertex,E.i1=0,E.i2=1,E.v1.Copy(l),E.v2.Copy(p),E.normal.Copy(q.normal),t.b2Vec2.Negate(d,E.sideNormal1),E.sideNormal2.Copy(d)}else n.type=o.b2ManifoldType.e_faceB,z[0].v.Copy(p),z[0].id.cf.indexA=1,z[0].id.cf.indexB=q.index,z[0].id.cf.typeA=o.b2ContactFeatureType.e_vertex,z[0].id.cf.typeB=o.b2ContactFeatureType.e_face,z[1].v.Copy(l),z[1].id.cf.indexA=0,z[1].id.cf.indexB=q.index,z[1].id.cf.typeA=o.b2ContactFeatureType.e_vertex,z[1].id.cf.typeB=o.b2ContactFeatureType.e_face,E.i1=q.index,E.i2=E.i1+1<u.count?E.i1+1:0,E.v1.Copy(u.vertices[E.i1]),E.v2.Copy(u.vertices[E.i2]),E.normal.Copy(u.normals[E.i1]),E.sideNormal1.Set(E.normal.y,-E.normal.x),t.b2Vec2.Negate(E.sideNormal1,E.sideNormal2);E.sideOffset1=t.b2Vec2.Dot(E.sideNormal1,E.v1),E.sideOffset2=t.b2Vec2.Dot(E.sideNormal2,E.v2);const Z=O,L=k;let j;if((j=o.b2ClipSegmentToLine(Z,z,E.sideNormal1,E.sideOffset1,E.i1))<e.b2_maxManifoldPoints)return;if((j=o.b2ClipSegmentToLine(L,Z,E.sideNormal2,E.sideOffset2,E.i2))<e.b2_maxManifoldPoints)return;q.type===f.e_edgeA?(n.localNormal.Copy(E.normal),n.localPoint.Copy(E.v1)):(n.localNormal.Copy(r.m_normals[E.i1]),n.localPoint.Copy(r.m_vertices[E.i1]));let I=0;for(let o=0;o<e.b2_maxManifoldPoints;++o){if(t.b2Vec2.Dot(E.normal,t.b2Vec2.Subtract(L[o].v,E.v1,t.b2Vec2.s_t0))<=_){const e=n.points[I];q.type===f.e_edgeA?(t.b2Transform.TransposeMultiplyVec2(s,L[o].v,e.localPoint),e.id.Copy(L[o].id)):(e.localPoint.Copy(L[o].v),e.id.cf.typeA=L[o].id.cf.typeB,e.id.cf.typeB=L[o].id.cf.typeA,e.id.cf.indexA=L[o].id.cf.indexB,e.id.cf.indexB=L[o].id.cf.indexA),++I}}n.pointCount=I}exports.b2CollideEdgeAndPolygon=q;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_collision":"DOG3","../common/b2_settings":"nssz"}],"z0gE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CircleShape=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),s=require("./b2_shape");class r extends s.b2Shape{constructor(t=0){super(s.b2ShapeType.e_circle,t),this.m_p=new e.b2Vec2}Set(t,e=this.m_radius){return this.m_p.Copy(t),this.m_radius=e,this}Clone(){return(new r).Copy(this)}Copy(t){return super.Copy(t),this.m_p.Copy(t.m_p),this}GetChildCount(){return 1}TestPoint(t,s){const i=e.b2Transform.MultiplyVec2(t,this.m_p,r.TestPoint_s_center),o=e.b2Vec2.Subtract(s,i,r.TestPoint_s_d);return e.b2Vec2.Dot(o,o)<=this.m_radius**2}RayCast(s,i,o,_){const a=e.b2Transform.MultiplyVec2(o,this.m_p,r.RayCast_s_position),c=e.b2Vec2.Subtract(i.p1,a,r.RayCast_s_s),n=e.b2Vec2.Dot(c,c)-this.m_radius**2,p=e.b2Vec2.Subtract(i.p2,i.p1,r.RayCast_s_r),m=e.b2Vec2.Dot(c,p),u=e.b2Vec2.Dot(p,p),h=m*m-u*n;if(h<0||u<t.b2_epsilon)return!1;let b=-(m+Math.sqrt(h));return b>=0&&b<=i.maxFraction*u&&(b/=u,s.fraction=b,e.b2Vec2.AddScaled(c,b,p,s.normal).Normalize(),!0)}ComputeAABB(t,s,i){const o=e.b2Transform.MultiplyVec2(s,this.m_p,r.ComputeAABB_s_p);t.lowerBound.Set(o.x-this.m_radius,o.y-this.m_radius),t.upperBound.Set(o.x+this.m_radius,o.y+this.m_radius)}ComputeMass(t,s){const r=this.m_radius**2;t.mass=s*Math.PI*r,t.center.Copy(this.m_p),t.I=t.mass*(.5*r+e.b2Vec2.Dot(this.m_p,this.m_p))}SetupDistanceProxy(t,e){t.m_vertices=t.m_buffer,t.m_vertices[0].Copy(this.m_p),t.m_count=1,t.m_radius=this.m_radius}Draw(t,s){const r=this.m_p,i=this.m_radius,o=e.b2Vec2.UNITX;t.DrawSolidCircle(r,i,o,s)}}exports.b2CircleShape=r,r.TestPoint_s_center=new e.b2Vec2,r.TestPoint_s_d=new e.b2Vec2,r.RayCast_s_position=new e.b2Vec2,r.RayCast_s_s=new e.b2Vec2,r.RayCast_s_r=new e.b2Vec2,r.ComputeAABB_s_p=new e.b2Vec2;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_shape":"QXiX"}],"tJiR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PolygonShape=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),s=require("../common/b2_settings"),r=require("./b2_shape"),c={ComputeCentroid:{s:new e.b2Vec2,p1:new e.b2Vec2,p2:new e.b2Vec2,p3:new e.b2Vec2,e1:new e.b2Vec2,e2:new e.b2Vec2},TestPoint:{pLocal:new e.b2Vec2},ComputeAABB:{v:new e.b2Vec2},ComputeMass:{center:new e.b2Vec2,s:new e.b2Vec2,e1:new e.b2Vec2,e2:new e.b2Vec2},Validate:{e:new e.b2Vec2,v:new e.b2Vec2},Set:{r:new e.b2Vec2,v:new e.b2Vec2},RayCast:{p1:new e.b2Vec2,p2:new e.b2Vec2,d:new e.b2Vec2},SetAsBox:{xf:new e.b2Transform}},o=(.5*t.b2_linearSlop)**2;function n(t,s,r){const o=r;o.SetZero();let n=0;const{s:i,p1:m,p2:a,p3:b,e1:u,e2:_}=c.ComputeCentroid;i.Copy(t[0]);for(let c=0;c<s;++c){e.b2Vec2.Subtract(t[0],i,m),e.b2Vec2.Subtract(t[c],i,a),e.b2Vec2.Subtract(t[c+1<s?c+1:0],i,b),e.b2Vec2.Subtract(a,m,u),e.b2Vec2.Subtract(b,m,_);const r=.5*e.b2Vec2.Cross(u,_);n+=r,o.x+=r*(1/3)*(m.x+a.x+b.x),o.y+=r*(1/3)*(m.y+a.y+b.y)}const h=1/n;return o.x=h*o.x+i.x,o.y=h*o.y+i.y,o}class i extends r.b2Shape{constructor(){super(r.b2ShapeType.e_polygon,t.b2_polygonRadius),this.m_centroid=new e.b2Vec2,this.m_vertices=[],this.m_normals=[],this.m_count=0}Clone(){return(new i).Copy(this)}Copy(s){super.Copy(s),this.m_centroid.Copy(s.m_centroid),this.m_count=s.m_count,this.m_vertices=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_normals=t.b2MakeArray(this.m_count,e.b2Vec2);for(let t=0;t<this.m_count;++t)this.m_vertices[t].Copy(s.m_vertices[t]),this.m_normals[t].Copy(s.m_normals[t]);return this}GetChildCount(){return 1}Set(r,i=r.length){if(i<3)return this.SetAsBox(1,1);let m=Math.min(i,s.b2_maxPolygonVertices);const a=[];for(let t=0;t<m;++t){const s=r[t];a.every(t=>e.b2Vec2.DistanceSquared(s,t)>=o)&&a.push(s)}if((m=a.length)<3)return this.SetAsBox(1,1);let b=0,u=a[0].x;for(let t=1;t<m;++t){const{x:e}=a[t];(e>u||e===u&&a[t].y<a[b].y)&&(b=t,u=e)}const _=[];let h=0,l=b;for(;;){_[h]=l;let t=0;for(let s=1;s<m;++s){if(t===l){t=s;continue}const r=e.b2Vec2.Subtract(a[t],a[_[h]],c.Set.r),o=e.b2Vec2.Subtract(a[s],a[_[h]],c.Set.v),n=e.b2Vec2.Cross(r,o);n<0&&(t=s),0===n&&o.LengthSquared()>r.LengthSquared()&&(t=s)}if(++h,l=t,t===b)break}t.b2Assert(h>=3,"Polygon is degenerate"),this.m_count=h,this.m_vertices=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_normals=t.b2MakeArray(this.m_count,e.b2Vec2);for(let t=0;t<h;++t)this.m_vertices[t].Copy(a[_[t]]);for(let t=0;t<h;++t){const s=t,r=t+1<h?t+1:0,c=e.b2Vec2.Subtract(this.m_vertices[r],this.m_vertices[s],e.b2Vec2.s_t0);e.b2Vec2.CrossVec2One(c,this.m_normals[t]).Normalize()}return n(this.m_vertices,h,this.m_centroid),this}SetAsBox(s,r,o,n=0){if(this.m_count=4,this.m_vertices=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_normals=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_vertices[0].Set(-s,-r),this.m_vertices[1].Set(s,-r),this.m_vertices[2].Set(s,r),this.m_vertices[3].Set(-s,r),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),o){this.m_centroid.Copy(o);const{xf:t}=c.SetAsBox;t.SetPosition(o),t.SetRotationAngle(n);for(let s=0;s<this.m_count;++s)e.b2Transform.MultiplyVec2(t,this.m_vertices[s],this.m_vertices[s]),e.b2Rot.MultiplyVec2(t.q,this.m_normals[s],this.m_normals[s])}else this.m_centroid.SetZero();return this}TestPoint(t,s){const r=e.b2Transform.TransposeMultiplyVec2(t,s,c.TestPoint.pLocal);for(let c=0;c<this.m_count;++c){if(e.b2Vec2.Dot(this.m_normals[c],e.b2Vec2.Subtract(r,this.m_vertices[c],e.b2Vec2.s_t0))>0)return!1}return!0}RayCast(t,s,r,o){const n=e.b2Transform.TransposeMultiplyVec2(r,s.p1,c.RayCast.p1),i=e.b2Transform.TransposeMultiplyVec2(r,s.p2,c.RayCast.p2),m=e.b2Vec2.Subtract(i,n,c.RayCast.d);let a=0,b=s.maxFraction,u=-1;for(let c=0;c<this.m_count;++c){const t=e.b2Vec2.Dot(this.m_normals[c],e.b2Vec2.Subtract(this.m_vertices[c],n,e.b2Vec2.s_t0)),s=e.b2Vec2.Dot(this.m_normals[c],m);if(0===s){if(t<0)return!1}else s<0&&t<a*s?(a=t/s,u=c):s>0&&t<b*s&&(b=t/s);if(b<a)return!1}return u>=0&&(t.fraction=a,e.b2Rot.MultiplyVec2(r.q,this.m_normals[u],t.normal),!0)}ComputeAABB(t,s,r){const o=e.b2Transform.MultiplyVec2(s,this.m_vertices[0],t.lowerBound),n=t.upperBound.Copy(o);for(let m=1;m<this.m_count;++m){const t=e.b2Transform.MultiplyVec2(s,this.m_vertices[m],c.ComputeAABB.v);e.b2Vec2.Min(o,t,o),e.b2Vec2.Max(n,t,n)}const i=this.m_radius;o.SubtractXY(i,i),n.AddXY(i,i)}ComputeMass(t,s){const r=c.ComputeMass.center.SetZero();let o=0,n=0;const i=c.ComputeMass.s.Copy(this.m_vertices[0]);for(let m=0;m<this.m_count;++m){const t=e.b2Vec2.Subtract(this.m_vertices[m],i,c.ComputeMass.e1),s=e.b2Vec2.Subtract(this.m_vertices[m+1<this.m_count?m+1:0],i,c.ComputeMass.e2),a=e.b2Vec2.Cross(t,s),b=.5*a;o+=b,r.AddScaled(b*(1/3),e.b2Vec2.Add(t,s,e.b2Vec2.s_t0));const u=t.x,_=t.y,h=s.x,l=s.y;n+=1/3*.25*a*(u*u+h*u+h*h+(_*_+l*_+l*l))}t.mass=s*o,r.Scale(1/o),e.b2Vec2.Add(r,i,t.center),t.I=s*n,t.I+=t.mass*(e.b2Vec2.Dot(t.center,t.center)-e.b2Vec2.Dot(r,r))}Validate(){const{e:t,v:s}=c.Validate;for(let r=0;r<this.m_count;++r){const c=r,o=r<this.m_count-1?c+1:0,n=this.m_vertices[c];e.b2Vec2.Subtract(this.m_vertices[o],n,t);for(let r=0;r<this.m_count;++r){if(r===c||r===o)continue;if(e.b2Vec2.Subtract(this.m_vertices[r],n,s),e.b2Vec2.Cross(t,s)<0)return!1}}return!0}SetupDistanceProxy(t,e){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}Draw(t,e){const s=this.m_count,r=this.m_vertices;t.DrawSolidPolygon(r,s,e)}}exports.b2PolygonShape=i;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","../common/b2_settings":"nssz","./b2_shape":"QXiX"}],"xXrv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2EdgeShape=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),s=require("./b2_shape");class r extends s.b2Shape{constructor(){super(s.b2ShapeType.e_edge,e.b2_polygonRadius),this.m_vertex1=new t.b2Vec2,this.m_vertex2=new t.b2Vec2,this.m_vertex0=new t.b2Vec2,this.m_vertex3=new t.b2Vec2,this.m_oneSided=!1}SetOneSided(e,t,s,r){return this.m_vertex0.Copy(e),this.m_vertex1.Copy(t),this.m_vertex2.Copy(s),this.m_vertex3.Copy(r),this.m_oneSided=!0,this}SetTwoSided(e,t){return this.m_vertex1.Copy(e),this.m_vertex2.Copy(t),this.m_oneSided=!1,this}Clone(){return(new r).Copy(this)}Copy(e){return super.Copy(e),this.m_vertex1.Copy(e.m_vertex1),this.m_vertex2.Copy(e.m_vertex2),this.m_vertex0.Copy(e.m_vertex0),this.m_vertex3.Copy(e.m_vertex3),this.m_oneSided=e.m_oneSided,this}GetChildCount(){return 1}TestPoint(e,t){return!1}RayCast(e,s,o,_){const i=t.b2Transform.TransposeMultiplyVec2(o,s.p1,r.RayCast_s_p1),n=t.b2Transform.TransposeMultiplyVec2(o,s.p2,r.RayCast_s_p2),a=t.b2Vec2.Subtract(n,i,r.RayCast_s_d),m=this.m_vertex1,c=this.m_vertex2,p=t.b2Vec2.Subtract(c,m,r.RayCast_s_e),{normal:u}=e;u.Set(p.y,-p.x).Normalize();const b=t.b2Vec2.Dot(u,t.b2Vec2.Subtract(m,i,t.b2Vec2.s_t0));if(this.m_oneSided&&b>0)return!1;const h=t.b2Vec2.Dot(u,a);if(0===h)return!1;const d=b/h;if(d<0||s.maxFraction<d)return!1;const y=t.b2Vec2.AddScaled(i,d,a,r.RayCast_s_q),v=t.b2Vec2.Subtract(c,m,r.RayCast_s_r),C=t.b2Vec2.Dot(v,v);if(0===C)return!1;const x=t.b2Vec2.Dot(t.b2Vec2.Subtract(y,m,t.b2Vec2.s_t0),v)/C;return!(x<0||x>1)&&(e.fraction=d,t.b2Rot.MultiplyVec2(o.q,e.normal,e.normal),b>0&&e.normal.Negate(),!0)}ComputeAABB(e,s,o){const _=t.b2Transform.MultiplyVec2(s,this.m_vertex1,r.ComputeAABB_s_v1),i=t.b2Transform.MultiplyVec2(s,this.m_vertex2,r.ComputeAABB_s_v2);t.b2Vec2.Min(_,i,e.lowerBound),t.b2Vec2.Max(_,i,e.upperBound);const n=this.m_radius;e.lowerBound.SubtractXY(n,n),e.upperBound.AddXY(n,n)}ComputeMass(e,s){e.mass=0,t.b2Vec2.Mid(this.m_vertex1,this.m_vertex2,e.center),e.I=0}SetupDistanceProxy(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_vertex1),e.m_vertices[1].Copy(this.m_vertex2),e.m_count=2,e.m_radius=this.m_radius}Draw(e,t){const s=this.m_vertex1,r=this.m_vertex2;e.DrawSegment(s,r,t),!1===this.m_oneSided&&(e.DrawPoint(s,4,t),e.DrawPoint(r,4,t))}}exports.b2EdgeShape=r,r.RayCast_s_p1=new t.b2Vec2,r.RayCast_s_p2=new t.b2Vec2,r.RayCast_s_d=new t.b2Vec2,r.RayCast_s_e=new t.b2Vec2,r.RayCast_s_q=new t.b2Vec2,r.RayCast_s_r=new t.b2Vec2,r.ComputeAABB_s_v1=new t.b2Vec2,r.ComputeAABB_s_v2=new t.b2Vec2;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_shape":"QXiX"}],"xLFs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ChainShape=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),s=require("./b2_shape"),r=require("./b2_edge_shape");class i extends s.b2Shape{constructor(){super(s.b2ShapeType.e_chain,e.b2_polygonRadius),this.m_vertices=[],this.m_prevVertex=new t.b2Vec2,this.m_nextVertex=new t.b2Vec2}CreateLoop(e,s=e.length){if(s<3)return this;this.m_vertices.length=s+1;for(let r=0;r<s;++r){const{x:s,y:i}=e[r];this.m_vertices[r]=new t.b2Vec2(s,i)}return this.m_vertices[s]=this.m_vertices[0].Clone(),this.m_prevVertex.Copy(this.m_vertices[this.m_vertices.length-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this}CreateChain(e,s,r,i){this.m_vertices.length=s;for(let _=0;_<s;++_){const{x:s,y:r}=e[_];this.m_vertices[_]=new t.b2Vec2(s,r)}return this.m_prevVertex.Copy(r),this.m_nextVertex.Copy(i),this}Clone(){return(new i).Copy(this)}Copy(e){return super.Copy(e),this.CreateChain(e.m_vertices,e.m_vertices.length,e.m_prevVertex,e.m_nextVertex)}GetChildCount(){return this.m_vertices.length-1}GetChildEdge(e,t){e.m_radius=this.m_radius,e.m_vertex1.Copy(this.m_vertices[t]),e.m_vertex2.Copy(this.m_vertices[t+1]),e.m_oneSided=!0,t>0?e.m_vertex0.Copy(this.m_vertices[t-1]):e.m_vertex0.Copy(this.m_prevVertex),t<this.m_vertices.length-2?e.m_vertex3.Copy(this.m_vertices[t+2]):e.m_vertex3.Copy(this.m_nextVertex)}TestPoint(e,t){return!1}RayCast(e,t,s,r){const _=i.RayCast_s_edgeShape,m=r;let o=r+1;return o===this.m_vertices.length&&(o=0),_.m_vertex1.Copy(this.m_vertices[m]),_.m_vertex2.Copy(this.m_vertices[o]),_.RayCast(e,t,s,0)}ComputeAABB(e,s,r){const _=r;let m=r+1;m===this.m_vertices.length&&(m=0);const o=t.b2Transform.MultiplyVec2(s,this.m_vertices[_],i.ComputeAABB_s_v1),h=t.b2Transform.MultiplyVec2(s,this.m_vertices[m],i.ComputeAABB_s_v2),n=t.b2Vec2.Min(o,h,i.ComputeAABB_s_lower),c=t.b2Vec2.Max(o,h,i.ComputeAABB_s_upper);e.lowerBound.x=n.x-this.m_radius,e.lowerBound.y=n.y-this.m_radius,e.upperBound.x=c.x+this.m_radius,e.upperBound.y=c.y+this.m_radius}ComputeMass(e,t){e.mass=0,e.center.SetZero(),e.I=0}SetupDistanceProxy(e,t){e.m_vertices=e.m_buffer,e.m_vertices[0].Copy(this.m_vertices[t]),t+1<this.m_vertices.length?e.m_vertices[1].Copy(this.m_vertices[t+1]):e.m_vertices[1].Copy(this.m_vertices[0]),e.m_count=2,e.m_radius=this.m_radius}Draw(e,t){const s=this.m_vertices;let r=s[0];for(let i=1;i<s.length;++i){const _=s[i];e.DrawSegment(r,_,t),r=_}}}exports.b2ChainShape=i,i.RayCast_s_edgeShape=new r.b2EdgeShape,i.ComputeAABB_s_v1=new t.b2Vec2,i.ComputeAABB_s_v2=new t.b2Vec2,i.ComputeAABB_s_lower=new t.b2Vec2,i.ComputeAABB_s_upper=new t.b2Vec2;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_shape":"QXiX","./b2_edge_shape":"xXrv"}],"PxaZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Joint=exports.b2AngularStiffness=exports.b2LinearStiffness=exports.b2JointDef=exports.b2JointEdge=exports.b2JointType=void 0;const t=require("../common/b2_draw"),e=require("../common/b2_math"),n={pA:new e.b2Vec2,pB:new e.b2Vec2};var o;!function(t){t[t.e_unknownJoint=0]="e_unknownJoint",t[t.e_revoluteJoint=1]="e_revoluteJoint",t[t.e_prismaticJoint=2]="e_prismaticJoint",t[t.e_distanceJoint=3]="e_distanceJoint",t[t.e_pulleyJoint=4]="e_pulleyJoint",t[t.e_mouseJoint=5]="e_mouseJoint",t[t.e_gearJoint=6]="e_gearJoint",t[t.e_wheelJoint=7]="e_wheelJoint",t[t.e_weldJoint=8]="e_weldJoint",t[t.e_frictionJoint=9]="e_frictionJoint",t[t.e_motorJoint=10]="e_motorJoint",t[t.e_areaJoint=11]="e_areaJoint"}(o=exports.b2JointType||(exports.b2JointType={}));class i{constructor(t,e){this.prev=null,this.next=null,this.joint=t,this.other=e}}exports.b2JointEdge=i;class s{constructor(t){this.userData=null,this.collideConnected=!1,this.type=t}}function r(t,e,n,o,i){const s=o.GetMass(),r=i.GetMass();let a;a=s>0&&r>0?s*r/(s+r):s>0?s:r;const l=2*Math.PI*e;t.stiffness=a*l*l,t.damping=2*a*n*l}function a(t,e,n,o,i){const s=o.GetInertia(),r=i.GetInertia();let a;a=s>0&&r>0?s*r/(s+r):s>0?s:r;const l=2*Math.PI*e;t.stiffness=a*l*l,t.damping=2*a*n*l}exports.b2JointDef=s,exports.b2LinearStiffness=r,exports.b2AngularStiffness=a;class l{constructor(t){var e;this.m_type=o.e_unknownJoint,this.m_prev=null,this.m_next=null,this.m_islandFlag=!1,this.m_collideConnected=!1,this.m_userData=null,this.m_type=t.type,this.m_edgeA=new i(this,t.bodyB),this.m_edgeB=new i(this,t.bodyA),this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=null!==(e=t.collideConnected)&&void 0!==e&&e,this.m_userData=t.userData}GetType(){return this.m_type}GetBodyA(){return this.m_bodyA}GetBodyB(){return this.m_bodyB}GetNext(){return this.m_next}GetUserData(){return this.m_userData}SetUserData(t){this.m_userData=t}IsEnabled(){return this.m_bodyA.IsEnabled()&&this.m_bodyB.IsEnabled()}GetCollideConnected(){return this.m_collideConnected}ShiftOrigin(t){}Draw(e){const o=this.m_bodyA.GetTransform().p,i=this.m_bodyB.GetTransform().p,s=this.GetAnchorA(n.pA),r=this.GetAnchorB(n.pB);e.DrawSegment(o,s,t.debugColors.joint6),e.DrawSegment(s,r,t.debugColors.joint6),e.DrawSegment(i,r,t.debugColors.joint6)}}exports.b2Joint=l;
},{"../common/b2_draw":"J87F","../common/b2_math":"YmMi"}],"ZofS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2DistanceJoint=exports.b2DistanceJointDef=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),i=require("./b2_joint"),e=require("../common/b2_draw"),m={worldPointA:new s.b2Vec2,worldPointB:new s.b2Vec2,vpA:new s.b2Vec2,vpB:new s.b2Vec2,vpBA:new s.b2Vec2,P:new s.b2Vec2,qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,Draw:{pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,pRest:new s.b2Vec2,p1:new s.b2Vec2,p2:new s.b2Vec2}};class h extends i.b2JointDef{constructor(){super(i.b2JointType.e_distanceJoint),this.localAnchorA=new s.b2Vec2,this.localAnchorB=new s.b2Vec2,this.length=1,this.minLength=0,this.maxLength=t.b2_maxFloat,this.stiffness=0,this.damping=0}Initialize(i,e,m,h){this.bodyA=i,this.bodyB=e,this.bodyA.GetLocalPoint(m,this.localAnchorA),this.bodyB.GetLocalPoint(h,this.localAnchorB),this.length=Math.max(s.b2Vec2.Distance(m,h),t.b2_linearSlop),this.minLength=this.length,this.maxLength=this.length}}exports.b2DistanceJointDef=h;class n extends i.b2Joint{constructor(i){var e,m;super(i),this.m_bias=0,this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_gamma=0,this.m_impulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_indexA=0,this.m_indexB=0,this.m_u=new s.b2Vec2,this.m_rA=new s.b2Vec2,this.m_rB=new s.b2Vec2,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_currentLength=0,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_softMass=0,this.m_mass=0,this.m_localAnchorA.Copy(i.localAnchorA),this.m_localAnchorB.Copy(i.localAnchorB),this.m_length=Math.max(i.length,t.b2_linearSlop),this.m_minLength=Math.max(i.minLength,t.b2_linearSlop),this.m_maxLength=Math.max(i.maxLength,this.m_minLength),this.m_stiffness=null!==(e=i.stiffness)&&void 0!==e?e:0,this.m_damping=null!==(m=i.damping)&&void 0!==m?m:0}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){const i=t*(this.m_impulse+this.m_lowerImpulse-this.m_upperImpulse);return s.x=i*this.m_u.x,s.y=i*this.m_u.y,s}GetReactionTorque(t){return 0}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetLength(s){return this.m_impulse=0,this.m_length=Math.max(t.b2_linearSlop,s),this.m_length}GetLength(){return this.m_length}SetMinLength(i){return this.m_lowerImpulse=0,this.m_minLength=s.b2Clamp(i,t.b2_linearSlop,this.m_maxLength),this.m_minLength}GetMinLength(){return this.m_minLength}SetMaxLength(t){return this.m_upperImpulse=0,this.m_maxLength=Math.max(t,this.m_minLength),this.m_maxLength}GetMaxLength(){return this.m_maxLength}GetCurrentLength(){const t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,m.worldPointA),i=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,m.worldPointB);return s.b2Vec2.Distance(i,t)}SetStiffness(t){this.m_stiffness=t}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t}GetDamping(){return this.m_damping}InitVelocityConstraints(i){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=i.positions[this.m_indexA].c,h=i.positions[this.m_indexA].a,n=i.velocities[this.m_indexA].v;let o=i.velocities[this.m_indexA].w;const _=i.positions[this.m_indexB].c,c=i.positions[this.m_indexB].a,a=i.velocities[this.m_indexB].v;let r=i.velocities[this.m_indexB].w;const{qA:l,qB:b,lalcA:A,lalcB:d}=m;l.Set(h),b.Set(c),s.b2Rot.MultiplyVec2(l,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,A),this.m_rA),s.b2Rot.MultiplyVec2(b,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,d),this.m_rB),this.m_u.x=_.x+this.m_rB.x-e.x-this.m_rA.x,this.m_u.y=_.y+this.m_rB.y-e.y-this.m_rA.y,this.m_currentLength=this.m_u.Length(),this.m_currentLength>t.b2_linearSlop?this.m_u.Scale(1/this.m_currentLength):(this.m_u.SetZero(),this.m_mass=0,this.m_impulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0);const p=s.b2Vec2.Cross(this.m_rA,this.m_u),u=s.b2Vec2.Cross(this.m_rB,this.m_u);let B=this.m_invMassA+this.m_invIA*p*p+this.m_invMassB+this.m_invIB*u*u;if(this.m_mass=0!==B?1/B:0,this.m_stiffness>0&&this.m_minLength<this.m_maxLength){const t=this.m_currentLength-this.m_length,s=this.m_damping,e=this.m_stiffness,m=i.step.dt;this.m_gamma=m*(s+m*e),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=t*m*e*this.m_gamma,B+=this.m_gamma,this.m_softMass=0!==B?1/B:0}else this.m_gamma=0,this.m_bias=0,this.m_softMass=this.m_mass;if(i.step.warmStarting){this.m_impulse*=i.step.dtRatio,this.m_lowerImpulse*=i.step.dtRatio,this.m_upperImpulse*=i.step.dtRatio;const{P:t}=m;s.b2Vec2.Scale(this.m_impulse+this.m_lowerImpulse-this.m_upperImpulse,this.m_u,t),n.SubtractScaled(this.m_invMassA,t),o-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,t),a.AddScaled(this.m_invMassB,t),r+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,t)}else this.m_impulse=0;i.velocities[this.m_indexA].w=o,i.velocities[this.m_indexB].w=r}SolveVelocityConstraints(t){const i=t.velocities[this.m_indexA].v;let e=t.velocities[this.m_indexA].w;const h=t.velocities[this.m_indexB].v;let n=t.velocities[this.m_indexB].w;if(this.m_minLength<this.m_maxLength){if(this.m_stiffness>0){const t=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),o=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),_=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(o,t,m.vpBA)),c=-this.m_softMass*(_+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c;const a=s.b2Vec2.Scale(c,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,a),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,a),h.AddScaled(this.m_invMassB,a),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,a)}{const o=this.m_currentLength-this.m_minLength,_=Math.max(0,o)*t.step.inv_dt,c=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),a=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),r=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(a,c,m.vpBA));let l=-this.m_mass*(r+_);const b=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(0,this.m_lowerImpulse+l),l=this.m_lowerImpulse-b;const A=s.b2Vec2.Scale(l,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,A),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,A),h.AddScaled(this.m_invMassB,A),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,A)}{const o=this.m_maxLength-this.m_currentLength,_=Math.max(0,o)*t.step.inv_dt,c=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),a=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),r=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(c,a,m.vpBA));let l=-this.m_mass*(r+_);const b=this.m_upperImpulse;this.m_upperImpulse=Math.max(0,this.m_upperImpulse+l),l=this.m_upperImpulse-b;const A=s.b2Vec2.Scale(-l,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,A),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,A),h.AddScaled(this.m_invMassB,A),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,A)}}else{const t=s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m.vpA),o=s.b2Vec2.AddCrossScalarVec2(h,n,this.m_rB,m.vpB),_=s.b2Vec2.Dot(this.m_u,s.b2Vec2.Subtract(o,t,m.vpBA)),c=-this.m_mass*_;this.m_impulse+=c;const a=s.b2Vec2.Scale(c,this.m_u,m.P);i.SubtractScaled(this.m_invMassA,a),e-=this.m_invIA*s.b2Vec2.Cross(this.m_rA,a),h.AddScaled(this.m_invMassB,a),n+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,a)}t.velocities[this.m_indexA].w=e,t.velocities[this.m_indexB].w=n}SolvePositionConstraints(i){const e=i.positions[this.m_indexA].c;let h=i.positions[this.m_indexA].a;const n=i.positions[this.m_indexB].c;let o=i.positions[this.m_indexB].a;const{qA:_,qB:c,lalcA:a,lalcB:r,P:l}=m;_.Set(h),c.Set(o);const b=s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,a),this.m_rA),A=s.b2Rot.MultiplyVec2(c,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,r),this.m_rB);this.m_u.x=n.x+A.x-e.x-b.x,this.m_u.y=n.y+A.y-e.y-b.y;const d=this.m_u.Normalize();let p;if(this.m_minLength===this.m_maxLength)p=d-this.m_minLength;else if(d<this.m_minLength)p=d-this.m_minLength;else{if(!(this.m_maxLength<d))return!0;p=d-this.m_maxLength}const u=-this.m_mass*p;return s.b2Vec2.Scale(u,this.m_u,l),e.SubtractScaled(this.m_invMassA,l),h-=this.m_invIA*s.b2Vec2.Cross(b,l),n.AddScaled(this.m_invMassB,l),o+=this.m_invIB*s.b2Vec2.Cross(A,l),i.positions[this.m_indexA].a=h,i.positions[this.m_indexB].a=o,Math.abs(p)<t.b2_linearSlop}Draw(i){const{pA:h,pB:n,axis:o,pRest:_}=m.Draw,c=this.m_bodyA.GetTransform(),a=this.m_bodyB.GetTransform();if(s.b2Transform.MultiplyVec2(c,this.m_localAnchorA,h),s.b2Transform.MultiplyVec2(a,this.m_localAnchorB,n),s.b2Vec2.Subtract(n,h,o),o.Normalize(),i.DrawSegment(h,n,e.debugColors.joint5),s.b2Vec2.AddScaled(h,this.m_length,o,_),i.DrawPoint(_,8,e.debugColors.joint1),this.m_minLength!==this.m_maxLength){if(this.m_minLength>t.b2_linearSlop){const t=s.b2Vec2.AddScaled(h,this.m_minLength,o,m.Draw.p1);i.DrawPoint(t,4,e.debugColors.joint2)}if(this.m_maxLength<t.b2_maxFloat){const t=s.b2Vec2.AddScaled(h,this.m_maxLength,o,m.Draw.p1);i.DrawPoint(t,4,e.debugColors.joint3)}}}}exports.b2DistanceJoint=n;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_joint":"PxaZ","../common/b2_draw":"J87F"}],"z4M5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2AreaJoint=exports.b2AreaJointDef=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),e=require("./b2_joint"),i=require("./b2_distance_joint");class n extends e.b2JointDef{constructor(){super(e.b2JointType.e_areaJoint),this.bodies=[],this.stiffness=0,this.damping=0}AddBody(t){this.bodies.push(t),1===this.bodies.length?this.bodyA=t:2===this.bodies.length&&(this.bodyB=t)}}exports.b2AreaJointDef=n;class o extends e.b2Joint{constructor(e){var n,o;super(e),this.m_stiffness=0,this.m_damping=0,this.m_impulse=0,this.m_targetArea=0,this.m_joints=[],this.m_delta=new s.b2Vec2,this.m_bodies=e.bodies,this.m_stiffness=null!==(n=e.stiffness)&&void 0!==n?n:0,this.m_damping=null!==(o=e.damping)&&void 0!==o?o:0,this.m_targetLengths=t.b2MakeNumberArray(e.bodies.length),this.m_normals=t.b2MakeArray(e.bodies.length,s.b2Vec2),this.m_deltas=t.b2MakeArray(e.bodies.length,s.b2Vec2);const m=new i.b2DistanceJointDef;m.stiffness=this.m_stiffness,m.damping=this.m_damping,this.m_targetArea=0;for(let t=0;t<this.m_bodies.length;++t){const e=this.m_bodies[t],i=this.m_bodies[(t+1)%this.m_bodies.length],n=e.GetWorldCenter(),o=i.GetWorldCenter();this.m_targetLengths[t]=s.b2Vec2.Distance(n,o),this.m_targetArea+=s.b2Vec2.Cross(n,o),m.Initialize(e,i,n,o),this.m_joints[t]=e.GetWorld().CreateJoint(m)}this.m_targetArea*=.5}GetAnchorA(t){return t}GetAnchorB(t){return t}GetReactionForce(t,s){return s}GetReactionTorque(t){return 0}SetStiffness(t){this.m_stiffness=t;for(const s of this.m_joints)s.SetStiffness(t)}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t;for(const s of this.m_joints)s.SetDamping(t)}GetDamping(){return this.m_damping}InitVelocityConstraints(t){for(let e=0;e<this.m_bodies.length;++e){const i=this.m_bodies[(e+this.m_bodies.length-1)%this.m_bodies.length],n=this.m_bodies[(e+1)%this.m_bodies.length],o=t.positions[i.m_islandIndex].c,m=t.positions[n.m_islandIndex].c,r=this.m_deltas[e];s.b2Vec2.Subtract(m,o,r)}if(t.step.warmStarting){this.m_impulse*=t.step.dtRatio;for(let s=0;s<this.m_bodies.length;++s){const e=this.m_bodies[s],i=t.velocities[e.m_islandIndex].v,n=this.m_deltas[s];i.x+=e.m_invMass*n.y*.5*this.m_impulse,i.y+=e.m_invMass*-n.x*.5*this.m_impulse}}else this.m_impulse=0}SolveVelocityConstraints(t){let e=0,i=0;for(let o=0;o<this.m_bodies.length;++o){const n=this.m_bodies[o],m=t.velocities[n.m_islandIndex].v,r=this.m_deltas[o];e+=r.LengthSquared()/n.GetMass(),i+=s.b2Vec2.Cross(m,r)}const n=-2*i/e;this.m_impulse+=n;for(let s=0;s<this.m_bodies.length;++s){const e=this.m_bodies[s],i=t.velocities[e.m_islandIndex].v,o=this.m_deltas[s];i.x+=e.m_invMass*o.y*.5*n,i.y+=e.m_invMass*-o.x*.5*n}}SolvePositionConstraints(e){let i=0,n=0;for(let r=0;r<this.m_bodies.length;++r){const o=this.m_bodies[r],m=this.m_bodies[(r+1)%this.m_bodies.length],h=e.positions[o.m_islandIndex].c,a=e.positions[m.m_islandIndex].c,_=s.b2Vec2.Subtract(a,h,this.m_delta);let d=_.Length();d<t.b2_epsilon&&(d=1),this.m_normals[r].x=_.y/d,this.m_normals[r].y=-_.x/d,i+=d,n+=s.b2Vec2.Cross(h,a)}n*=.5;const o=.5*(this.m_targetArea-n)/i;let m=!0;for(let r=0;r<this.m_bodies.length;++r){const i=this.m_bodies[r],n=e.positions[i.m_islandIndex].c,h=(r+1)%this.m_bodies.length,a=s.b2Vec2.Add(this.m_normals[r],this.m_normals[h],this.m_delta);a.Scale(o);const _=a.LengthSquared();_>t.b2_maxLinearCorrection**2&&a.Scale(t.b2_maxLinearCorrection/Math.sqrt(_)),_>t.b2_linearSlop**2&&(m=!1),n.Add(a)}return m}}exports.b2AreaJoint=o;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_joint":"PxaZ","./b2_distance_joint":"ZofS"}],"BvwH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2FrictionJoint=exports.b2FrictionJointDef=void 0;const t=require("../common/b2_math"),s=require("./b2_joint"),i={qA:new t.b2Rot,qB:new t.b2Rot,lalcA:new t.b2Vec2,lalcB:new t.b2Vec2,Cdot:new t.b2Vec2,impulse:new t.b2Vec2,oldImpulse:new t.b2Vec2};class e extends s.b2JointDef{constructor(){super(s.b2JointType.e_frictionJoint),this.localAnchorA=new t.b2Vec2,this.localAnchorB=new t.b2Vec2,this.maxForce=0,this.maxTorque=0}Initialize(t,s,i){this.bodyA=t,this.bodyB=s,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB)}}exports.b2FrictionJointDef=e;class n extends s.b2Joint{constructor(s){var i,e;super(s),this.m_localAnchorA=new t.b2Vec2,this.m_localAnchorB=new t.b2Vec2,this.m_linearImpulse=new t.b2Vec2,this.m_angularImpulse=0,this.m_maxForce=0,this.m_maxTorque=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new t.b2Vec2,this.m_rB=new t.b2Vec2,this.m_localCenterA=new t.b2Vec2,this.m_localCenterB=new t.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new t.b2Mat22,this.m_angularMass=0,this.m_localAnchorA.Copy(s.localAnchorA),this.m_localAnchorB.Copy(s.localAnchorB),this.m_linearImpulse.SetZero(),this.m_maxForce=null!==(i=s.maxForce)&&void 0!==i?i:0,this.m_maxTorque=null!==(e=s.maxTorque)&&void 0!==e?e:0}InitVelocityConstraints(s){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=s.positions[this.m_indexA].a,n=s.velocities[this.m_indexA].v;let o=s.velocities[this.m_indexA].w;const m=s.positions[this.m_indexB].a,l=s.velocities[this.m_indexB].v;let r=s.velocities[this.m_indexB].w;const{qA:a,qB:h,lalcA:c,lalcB:_}=i;a.Set(e),h.Set(m),t.b2Rot.MultiplyVec2(a,t.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,c),this.m_rA),t.b2Rot.MultiplyVec2(h,t.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,_),this.m_rB);const u=this.m_invMassA,A=this.m_invMassB,d=this.m_invIA,b=this.m_invIB,x=this.m_linearMass;if(x.ex.x=u+A+d*this.m_rA.y*this.m_rA.y+b*this.m_rB.y*this.m_rB.y,x.ex.y=-d*this.m_rA.x*this.m_rA.y-b*this.m_rB.x*this.m_rB.y,x.ey.x=x.ex.y,x.ey.y=u+A+d*this.m_rA.x*this.m_rA.x+b*this.m_rB.x*this.m_rB.x,x.Inverse(),this.m_angularMass=d+b,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),s.step.warmStarting){this.m_linearImpulse.Scale(s.step.dtRatio),this.m_angularImpulse*=s.step.dtRatio;const i=this.m_linearImpulse;n.SubtractScaled(u,i),o-=d*(t.b2Vec2.Cross(this.m_rA,i)+this.m_angularImpulse),l.AddScaled(A,i),r+=b*(t.b2Vec2.Cross(this.m_rB,i)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;s.velocities[this.m_indexA].w=o,s.velocities[this.m_indexB].w=r}SolveVelocityConstraints(s){const e=s.velocities[this.m_indexA].v;let n=s.velocities[this.m_indexA].w;const o=s.velocities[this.m_indexB].v;let m=s.velocities[this.m_indexB].w;const l=this.m_invMassA,r=this.m_invMassB,a=this.m_invIA,h=this.m_invIB,c=s.step.dt;{const s=m-n;let i=-this.m_angularMass*s;const e=this.m_angularImpulse,o=c*this.m_maxTorque;this.m_angularImpulse=t.b2Clamp(this.m_angularImpulse+i,-o,o),n-=a*(i=this.m_angularImpulse-e),m+=h*i}{const{Cdot:s,impulse:_,oldImpulse:u}=i;t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(o,m,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(e,n,this.m_rA,t.b2Vec2.s_t1),s),t.b2Mat22.MultiplyVec2(this.m_linearMass,s,_).Negate(),u.Copy(this.m_linearImpulse),this.m_linearImpulse.Add(_);const A=c*this.m_maxForce;this.m_linearImpulse.LengthSquared()>A*A&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Scale(A)),t.b2Vec2.Subtract(this.m_linearImpulse,u,_),e.SubtractScaled(l,_),n-=a*t.b2Vec2.Cross(this.m_rA,_),o.AddScaled(r,_),m+=h*t.b2Vec2.Cross(this.m_rB,_)}s.velocities[this.m_indexA].w=n,s.velocities[this.m_indexB].w=m}SolvePositionConstraints(t){return!0}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){return s.x=t*this.m_linearImpulse.x,s.y=t*this.m_linearImpulse.y,s}GetReactionTorque(t){return t*this.m_angularImpulse}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetMaxTorque(t){this.m_maxTorque=t}GetMaxTorque(){return this.m_maxTorque}}exports.b2FrictionJoint=n;
},{"../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"hOU7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2GearJoint=exports.b2GearJointDef=void 0;const t=require("../common/b2_common"),i=require("../common/b2_math"),s=require("./b2_joint"),e={qA:new i.b2Rot,qB:new i.b2Rot,qC:new i.b2Rot,qD:new i.b2Rot,lalcA:new i.b2Vec2,lalcB:new i.b2Vec2,lalcC:new i.b2Vec2,lalcD:new i.b2Vec2,u:new i.b2Vec2,rA:new i.b2Vec2,rB:new i.b2Vec2,rC:new i.b2Vec2,rD:new i.b2Vec2,JvAC:new i.b2Vec2,JvBD:new i.b2Vec2};class m extends s.b2JointDef{constructor(){super(s.b2JointType.e_gearJoint),this.ratio=1}}exports.b2GearJointDef=m;class _ extends s.b2Joint{constructor(t){var e;let m,_;super(t),this.m_typeA=s.b2JointType.e_unknownJoint,this.m_typeB=s.b2JointType.e_unknownJoint,this.m_localAnchorA=new i.b2Vec2,this.m_localAnchorB=new i.b2Vec2,this.m_localAnchorC=new i.b2Vec2,this.m_localAnchorD=new i.b2Vec2,this.m_localAxisC=new i.b2Vec2,this.m_localAxisD=new i.b2Vec2,this.m_referenceAngleA=0,this.m_referenceAngleB=0,this.m_constant=0,this.m_ratio=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_indexC=0,this.m_indexD=0,this.m_lcA=new i.b2Vec2,this.m_lcB=new i.b2Vec2,this.m_lcC=new i.b2Vec2,this.m_lcD=new i.b2Vec2,this.m_mA=0,this.m_mB=0,this.m_mC=0,this.m_mD=0,this.m_iA=0,this.m_iB=0,this.m_iC=0,this.m_iD=0,this.m_JvAC=new i.b2Vec2,this.m_JvBD=new i.b2Vec2,this.m_JwA=0,this.m_JwB=0,this.m_JwC=0,this.m_JwD=0,this.m_mass=0,this.m_joint1=t.joint1,this.m_joint2=t.joint2,this.m_typeA=this.m_joint1.GetType(),this.m_typeB=this.m_joint2.GetType(),this.m_bodyC=this.m_joint1.GetBodyA(),this.m_bodyA=this.m_joint1.GetBodyB();const o=this.m_bodyA.m_xf,h=this.m_bodyA.m_sweep.a,c=this.m_bodyC.m_xf,l=this.m_bodyC.m_sweep.a;if(this.m_typeA===s.b2JointType.e_revoluteJoint){const i=t.joint1;this.m_localAnchorC.Copy(i.m_localAnchorA),this.m_localAnchorA.Copy(i.m_localAnchorB),this.m_referenceAngleA=i.m_referenceAngle,this.m_localAxisC.SetZero(),m=h-l-this.m_referenceAngleA}else{const s=t.joint1;this.m_localAnchorC.Copy(s.m_localAnchorA),this.m_localAnchorA.Copy(s.m_localAnchorB),this.m_referenceAngleA=s.m_referenceAngle,this.m_localAxisC.Copy(s.m_localXAxisA);const e=this.m_localAnchorC,_=i.b2Rot.TransposeMultiplyVec2(c.q,i.b2Rot.MultiplyVec2(o.q,this.m_localAnchorA,i.b2Vec2.s_t0).Add(o.p).Subtract(c.p),i.b2Vec2.s_t0);m=i.b2Vec2.Dot(_.Subtract(e),this.m_localAxisC)}this.m_bodyD=this.m_joint2.GetBodyA(),this.m_bodyB=this.m_joint2.GetBodyB();const n=this.m_bodyB.m_xf,r=this.m_bodyB.m_sweep.a,a=this.m_bodyD.m_xf,A=this.m_bodyD.m_sweep.a;if(this.m_typeB===s.b2JointType.e_revoluteJoint){const i=t.joint2;this.m_localAnchorD.Copy(i.m_localAnchorA),this.m_localAnchorB.Copy(i.m_localAnchorB),this.m_referenceAngleB=i.m_referenceAngle,this.m_localAxisD.SetZero(),_=r-A-this.m_referenceAngleB}else{const s=t.joint2;this.m_localAnchorD.Copy(s.m_localAnchorA),this.m_localAnchorB.Copy(s.m_localAnchorB),this.m_referenceAngleB=s.m_referenceAngle,this.m_localAxisD.Copy(s.m_localXAxisA);const e=this.m_localAnchorD,m=i.b2Rot.TransposeMultiplyVec2(a.q,i.b2Rot.MultiplyVec2(n.q,this.m_localAnchorB,i.b2Vec2.s_t0).Add(n.p).Subtract(a.p),i.b2Vec2.s_t0);_=i.b2Vec2.Dot(m.Subtract(e),this.m_localAxisD)}this.m_ratio=null!==(e=t.ratio)&&void 0!==e?e:1,this.m_constant=m+this.m_ratio*_,this.m_impulse=0}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;const m=t.positions[this.m_indexA].a,_=t.velocities[this.m_indexA].v;let o=t.velocities[this.m_indexA].w;const h=t.positions[this.m_indexB].a,c=t.velocities[this.m_indexB].v;let l=t.velocities[this.m_indexB].w;const n=t.positions[this.m_indexC].a,r=t.velocities[this.m_indexC].v;let a=t.velocities[this.m_indexC].w;const A=t.positions[this.m_indexD].a,b=t.velocities[this.m_indexD].v;let d=t.velocities[this.m_indexD].w;const{qA:p,qB:C,qC:B,qD:y}=e;if(p.Set(m),C.Set(h),B.Set(n),y.Set(A),this.m_mass=0,this.m_typeA===s.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{const{u:t,rC:s,rA:m,lalcA:_,lalcC:o}=e;i.b2Rot.MultiplyVec2(B,this.m_localAxisC,t),i.b2Rot.MultiplyVec2(B,i.b2Vec2.Subtract(this.m_localAnchorC,this.m_lcC,o),s),i.b2Rot.MultiplyVec2(p,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_lcA,_),m),this.m_JvAC.Copy(t),this.m_JwC=i.b2Vec2.Cross(s,t),this.m_JwA=i.b2Vec2.Cross(m,t),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===s.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{const{u:t,rB:s,rD:m,lalcB:_,lalcD:o}=e;i.b2Rot.MultiplyVec2(y,this.m_localAxisD,t),i.b2Rot.MultiplyVec2(y,i.b2Vec2.Subtract(this.m_localAnchorD,this.m_lcD,o),m),i.b2Rot.MultiplyVec2(C,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_lcB,_),s),i.b2Vec2.Scale(this.m_ratio,t,this.m_JvBD),this.m_JwD=this.m_ratio*i.b2Vec2.Cross(m,t),this.m_JwB=this.m_ratio*i.b2Vec2.Cross(s,t),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.step.warmStarting?(_.AddScaled(this.m_mA*this.m_impulse,this.m_JvAC),o+=this.m_iA*this.m_impulse*this.m_JwA,c.AddScaled(this.m_mB*this.m_impulse,this.m_JvBD),l+=this.m_iB*this.m_impulse*this.m_JwB,r.SubtractScaled(this.m_mC*this.m_impulse,this.m_JvAC),a-=this.m_iC*this.m_impulse*this.m_JwC,b.SubtractScaled(this.m_mD*this.m_impulse,this.m_JvBD),d-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,t.velocities[this.m_indexA].w=o,t.velocities[this.m_indexB].w=l,t.velocities[this.m_indexC].w=a,t.velocities[this.m_indexD].w=d}SolveVelocityConstraints(t){const s=t.velocities[this.m_indexA].v;let e=t.velocities[this.m_indexA].w;const m=t.velocities[this.m_indexB].v;let _=t.velocities[this.m_indexB].w;const o=t.velocities[this.m_indexC].v;let h=t.velocities[this.m_indexC].w;const c=t.velocities[this.m_indexD].v;let l=t.velocities[this.m_indexD].w,n=i.b2Vec2.Dot(this.m_JvAC,i.b2Vec2.Subtract(s,o,i.b2Vec2.s_t0))+i.b2Vec2.Dot(this.m_JvBD,i.b2Vec2.Subtract(m,c,i.b2Vec2.s_t0));n+=this.m_JwA*e-this.m_JwC*h+(this.m_JwB*_-this.m_JwD*l);const r=-this.m_mass*n;this.m_impulse+=r,s.AddScaled(this.m_mA*r,this.m_JvAC),e+=this.m_iA*r*this.m_JwA,m.AddScaled(this.m_mB*r,this.m_JvBD),_+=this.m_iB*r*this.m_JwB,o.SubtractScaled(this.m_mC*r,this.m_JvAC),h-=this.m_iC*r*this.m_JwC,c.SubtractScaled(this.m_mD*r,this.m_JvBD),l-=this.m_iD*r*this.m_JwD,t.velocities[this.m_indexA].w=e,t.velocities[this.m_indexB].w=_,t.velocities[this.m_indexC].w=h,t.velocities[this.m_indexD].w=l}SolvePositionConstraints(m){const _=m.positions[this.m_indexA].c;let o=m.positions[this.m_indexA].a;const h=m.positions[this.m_indexB].c;let c=m.positions[this.m_indexB].a;const l=m.positions[this.m_indexC].c;let n=m.positions[this.m_indexC].a;const r=m.positions[this.m_indexD].c;let a=m.positions[this.m_indexD].a;const{qA:A,qB:b,qC:d,qD:p,JvAC:C,JvBD:B}=e;A.Set(o),b.Set(c),d.Set(n),p.Set(a);let y,u,D,w,V,J,x=0;if(this.m_typeA===s.b2JointType.e_revoluteJoint)C.SetZero(),D=1,V=1,x+=this.m_iA+this.m_iC,y=o-n-this.m_referenceAngleA;else{const{u:t,rC:s,rA:m,lalcC:o,lalcA:h}=e;i.b2Rot.MultiplyVec2(d,this.m_localAxisC,t),i.b2Rot.MultiplyVec2(d,i.b2Vec2.Subtract(this.m_localAnchorC,this.m_lcC,o),s),i.b2Rot.MultiplyVec2(A,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_lcA,h),m),C.Copy(t),V=i.b2Vec2.Cross(s,t),D=i.b2Vec2.Cross(m,t),x+=this.m_mC+this.m_mA+this.m_iC*V*V+this.m_iA*D*D;const c=o,n=i.b2Rot.TransposeMultiplyVec2(d,i.b2Vec2.Add(m,_,i.b2Vec2.s_t0).Subtract(l),i.b2Vec2.s_t0);y=i.b2Vec2.Dot(i.b2Vec2.Subtract(n,c,i.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===s.b2JointType.e_revoluteJoint)B.SetZero(),w=this.m_ratio,J=this.m_ratio,x+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),u=c-a-this.m_referenceAngleB;else{const{u:t,rD:s,rB:m,lalcD:_,lalcB:o}=e;i.b2Rot.MultiplyVec2(p,this.m_localAxisD,t),i.b2Rot.MultiplyVec2(p,i.b2Vec2.Subtract(this.m_localAnchorD,this.m_lcD,_),s),i.b2Rot.MultiplyVec2(b,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_lcB,o),m),i.b2Vec2.Scale(this.m_ratio,t,B),J=this.m_ratio*i.b2Vec2.Cross(s,t),w=this.m_ratio*i.b2Vec2.Cross(m,t),x+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*J*J+this.m_iB*w*w;const c=_,l=i.b2Rot.TransposeMultiplyVec2(p,i.b2Vec2.Add(m,h,i.b2Vec2.s_t0).Subtract(r),i.b2Vec2.s_t0);u=i.b2Vec2.Dot(l.Subtract(c),this.m_localAxisD)}const v=y+this.m_ratio*u-this.m_constant;let S=0;return x>0&&(S=-v/x),_.AddScaled(this.m_mA*S,C),o+=this.m_iA*S*D,h.AddScaled(this.m_mB*S,B),c+=this.m_iB*S*w,l.SubtractScaled(this.m_mC*S,C),n-=this.m_iC*S*V,r.SubtractScaled(this.m_mD*S,B),a-=this.m_iD*S*J,m.positions[this.m_indexA].a=o,m.positions[this.m_indexB].a=c,m.positions[this.m_indexC].a=n,m.positions[this.m_indexD].a=a,0<t.b2_linearSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){return i.b2Vec2.Scale(t*this.m_impulse,this.m_JvAC,s)}GetReactionTorque(t){return t*this.m_impulse*this.m_JwA}GetJoint1(){return this.m_joint1}GetJoint2(){return this.m_joint2}GetRatio(){return this.m_ratio}SetRatio(t){this.m_ratio=t}}exports.b2GearJoint=_;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"Wvkp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2MotorJoint=exports.b2MotorJointDef=void 0;const t=require("../common/b2_math"),e=require("./b2_joint"),s={qA:new t.b2Rot,qB:new t.b2Rot,K:new t.b2Mat22,Cdot:new t.b2Vec2,impulse:new t.b2Vec2,oldImpulse:new t.b2Vec2};class i extends e.b2JointDef{constructor(){super(e.b2JointType.e_motorJoint),this.linearOffset=new t.b2Vec2,this.angularOffset=0,this.maxForce=1,this.maxTorque=1,this.correctionFactor=.3}Initialize(t,e){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(e.GetPosition(),this.linearOffset);const s=t.GetAngle(),i=e.GetAngle();this.angularOffset=i-s}}exports.b2MotorJointDef=i;class n extends e.b2Joint{constructor(e){var s,i,n,r,o;super(e),this.m_linearOffset=new t.b2Vec2,this.m_linearImpulse=new t.b2Vec2,this.m_angularImpulse=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new t.b2Vec2,this.m_rB=new t.b2Vec2,this.m_localCenterA=new t.b2Vec2,this.m_localCenterB=new t.b2Vec2,this.m_linearError=new t.b2Vec2,this.m_angularError=0,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_linearMass=new t.b2Mat22,this.m_angularMass=0,this.m_linearOffset.Copy(null!==(s=e.linearOffset)&&void 0!==s?s:t.b2Vec2.ZERO),this.m_angularOffset=null!==(i=e.angularOffset)&&void 0!==i?i:0,this.m_linearImpulse.SetZero(),this.m_maxForce=null!==(n=e.maxForce)&&void 0!==n?n:1,this.m_maxTorque=null!==(r=e.maxTorque)&&void 0!==r?r:1,this.m_correctionFactor=null!==(o=e.correctionFactor)&&void 0!==o?o:.3}GetAnchorA(t){const e=this.m_bodyA.GetPosition();return t.x=e.x,t.y=e.y,t}GetAnchorB(t){const e=this.m_bodyB.GetPosition();return t.x=e.x,t.y=e.y,t}GetReactionForce(e,s){return t.b2Vec2.Scale(e,this.m_linearImpulse,s)}GetReactionTorque(t){return t*this.m_angularImpulse}SetLinearOffset(e){t.b2Vec2.Equals(e,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(e))}GetLinearOffset(){return this.m_linearOffset}SetAngularOffset(t){t!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=t)}GetAngularOffset(){return this.m_angularOffset}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetMaxTorque(t){this.m_maxTorque=t}GetMaxTorque(){return this.m_maxTorque}GetCorrectionFactor(){return this.m_correctionFactor}SetCorrectionFactor(t){this.m_correctionFactor=t}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=e.positions[this.m_indexA].c,n=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v;let o=e.velocities[this.m_indexA].w;const a=e.positions[this.m_indexB].c,m=e.positions[this.m_indexB].a,l=e.velocities[this.m_indexB].v;let _=e.velocities[this.m_indexB].w;const{qA:c,qB:h}=s;c.Set(n),h.Set(m);const u=t.b2Rot.MultiplyVec2(c,t.b2Vec2.Subtract(this.m_linearOffset,this.m_localCenterA,t.b2Vec2.s_t0),this.m_rA),d=t.b2Rot.MultiplyVec2(h,t.b2Vec2.Negate(this.m_localCenterB,t.b2Vec2.s_t0),this.m_rB),b=this.m_invMassA,x=this.m_invMassB,p=this.m_invIA,A=this.m_invIB,v=this.m_linearMass;if(v.ex.x=b+x+p*u.y*u.y+A*d.y*d.y,v.ex.y=-p*u.x*u.y-A*d.x*d.y,v.ey.x=v.ex.y,v.ey.y=b+x+p*u.x*u.x+A*d.x*d.x,v.Inverse(),this.m_angularMass=p+A,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.b2Vec2.Subtract(t.b2Vec2.Add(a,d,t.b2Vec2.s_t0),t.b2Vec2.Add(i,u,t.b2Vec2.s_t1),this.m_linearError),this.m_angularError=m-n-this.m_angularOffset,e.step.warmStarting){this.m_linearImpulse.Scale(e.step.dtRatio),this.m_angularImpulse*=e.step.dtRatio;const s=this.m_linearImpulse;r.SubtractScaled(b,s),o-=p*(t.b2Vec2.Cross(u,s)+this.m_angularImpulse),l.AddScaled(x,s),_+=A*(t.b2Vec2.Cross(d,s)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;e.velocities[this.m_indexA].w=o,e.velocities[this.m_indexB].w=_}SolveVelocityConstraints(e){const i=e.velocities[this.m_indexA].v;let n=e.velocities[this.m_indexA].w;const r=e.velocities[this.m_indexB].v;let o=e.velocities[this.m_indexB].w;const a=this.m_invMassA,m=this.m_invMassB,l=this.m_invIA,_=this.m_invIB,c=e.step.dt,h=e.step.inv_dt;{const e=o-n+h*this.m_correctionFactor*this.m_angularError;let s=-this.m_angularMass*e;const i=this.m_angularImpulse,r=c*this.m_maxTorque;this.m_angularImpulse=t.b2Clamp(this.m_angularImpulse+s,-r,r),n-=l*(s=this.m_angularImpulse-i),o+=_*s}{const{impulse:e,oldImpulse:u,Cdot:d}=s;t.b2Vec2.AddScaled(t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(r,o,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(i,n,this.m_rA,t.b2Vec2.s_t1),t.b2Vec2.s_t2),h*this.m_correctionFactor,this.m_linearError,d),t.b2Mat22.MultiplyVec2(this.m_linearMass,d,e).Negate(),u.Copy(this.m_linearImpulse),this.m_linearImpulse.Add(e);const b=c*this.m_maxForce;this.m_linearImpulse.LengthSquared()>b*b&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.Scale(b)),t.b2Vec2.Subtract(this.m_linearImpulse,u,e),i.SubtractScaled(a,e),n-=l*t.b2Vec2.Cross(this.m_rA,e),r.AddScaled(m,e),o+=_*t.b2Vec2.Cross(this.m_rB,e)}e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=o}SolvePositionConstraints(t){return!0}}exports.b2MotorJoint=n;
},{"../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"lM2e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2MouseJoint=exports.b2MouseJointDef=void 0;const t=require("../common/b2_draw"),s=require("../common/b2_math"),e=require("./b2_joint"),i={qB:new s.b2Rot,lalcB:new s.b2Vec2,Cdot:new s.b2Vec2,impulse:new s.b2Vec2,oldImpulse:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2};class m extends e.b2JointDef{constructor(){super(e.b2JointType.e_mouseJoint),this.target=new s.b2Vec2,this.maxForce=0,this.stiffness=0,this.damping=0}}exports.b2MouseJointDef=m;class n extends e.b2Joint{constructor(t){var e,i,m,n;super(t),this.m_localAnchorB=new s.b2Vec2,this.m_targetA=new s.b2Vec2,this.m_stiffness=0,this.m_damping=0,this.m_beta=0,this.m_impulse=new s.b2Vec2,this.m_maxForce=0,this.m_gamma=0,this.m_indexB=0,this.m_rB=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassB=0,this.m_invIB=0,this.m_mass=new s.b2Mat22,this.m_C=new s.b2Vec2,this.m_targetA.Copy(null!==(e=t.target)&&void 0!==e?e:s.b2Vec2.ZERO),s.b2Transform.TransposeMultiplyVec2(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB),this.m_maxForce=null!==(i=t.maxForce)&&void 0!==i?i:0,this.m_stiffness=null!==(m=t.stiffness)&&void 0!==m?m:0,this.m_damping=null!==(n=t.damping)&&void 0!==n?n:0,this.m_beta=0,this.m_gamma=0}SetTarget(t){s.b2Vec2.Equals(t,this.m_targetA)||(this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(t))}GetTarget(){return this.m_targetA}SetMaxForce(t){this.m_maxForce=t}GetMaxForce(){return this.m_maxForce}SetStiffness(t){this.m_stiffness=t}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t}GetDamping(){return this.m_damping}InitVelocityConstraints(t){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexB].c,m=t.positions[this.m_indexB].a,n=t.velocities[this.m_indexB].v;let o=t.velocities[this.m_indexB].w;const{qB:h,lalcB:r}=i;h.Set(m);const a=this.m_damping,_=this.m_stiffness,c=t.step.dt;this.m_gamma=c*(a+c*_),0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=c*_*this.m_gamma,s.b2Rot.MultiplyVec2(h,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,r),this.m_rB);const l=this.m_mass;l.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,l.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,l.ey.x=l.ex.y,l.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,l.Inverse(),s.b2Vec2.Add(e,this.m_rB,this.m_C).Subtract(this.m_targetA),this.m_C.Scale(this.m_beta),o*=.98,t.step.warmStarting?(this.m_impulse.Scale(t.step.dtRatio),n.AddScaled(this.m_invMassB,this.m_impulse),o+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),t.velocities[this.m_indexB].w=o}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexB].v;let m=t.velocities[this.m_indexB].w;const{Cdot:n,impulse:o,oldImpulse:h}=i;s.b2Vec2.AddCrossScalarVec2(e,m,this.m_rB,n),s.b2Mat22.MultiplyVec2(this.m_mass,s.b2Vec2.Add(n,this.m_C,o).AddScaled(this.m_gamma,this.m_impulse).Negate(),o),h.Copy(this.m_impulse),this.m_impulse.Add(o);const r=t.step.dt*this.m_maxForce;this.m_impulse.LengthSquared()>r*r&&this.m_impulse.Scale(r/this.m_impulse.Length()),s.b2Vec2.Subtract(this.m_impulse,h,o),e.AddScaled(this.m_invMassB,o),m+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,o),t.velocities[this.m_indexB].w=m}SolvePositionConstraints(t){return!0}GetAnchorA(t){return t.x=this.m_targetA.x,t.y=this.m_targetA.y,t}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){return s.b2Vec2.Scale(t,this.m_impulse,e)}GetReactionTorque(t){return 0}ShiftOrigin(t){this.m_targetA.Subtract(t)}Draw(s){const e=this.GetAnchorA(i.pA),m=this.GetAnchorB(i.pB);s.DrawPoint(e,4,t.debugColors.joint7),s.DrawPoint(m,4,t.debugColors.joint7),s.DrawSegment(e,m,t.debugColors.joint8)}}exports.b2MouseJoint=n;
},{"../common/b2_draw":"J87F","../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"TjHH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PrismaticJoint=exports.b2PrismaticJointDef=void 0;const t=require("../common/b2_common"),e=require("../common/b2_draw"),s=require("../common/b2_math"),i=require("./b2_joint"),o={K3:new s.b2Mat33,K2:new s.b2Mat22,qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,rA:new s.b2Vec2,rB:new s.b2Vec2,GetJointTranslation:{pA:new s.b2Vec2,pB:new s.b2Vec2,d:new s.b2Vec2,axis:new s.b2Vec2},InitVelocityConstraints:{d:new s.b2Vec2,P:new s.b2Vec2},SolveVelocityConstraints:{P:new s.b2Vec2,df:new s.b2Vec2},SolvePositionConstraints:{d:new s.b2Vec2,impulse:new s.b2Vec3,impulse1:new s.b2Vec2,P:new s.b2Vec2},Draw:{p1:new s.b2Vec2,p2:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,lower:new s.b2Vec2,upper:new s.b2Vec2,perp:new s.b2Vec2}};class l extends i.b2JointDef{constructor(){super(i.b2JointType.e_prismaticJoint),this.localAnchorA=new s.b2Vec2,this.localAnchorB=new s.b2Vec2,this.localAxisA=new s.b2Vec2(1,0),this.referenceAngle=0,this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorForce=0,this.motorSpeed=0}Initialize(t,e,s,i){this.bodyA=t,this.bodyB=e,this.bodyA.GetLocalPoint(s,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.bodyA.GetLocalVector(i,this.localAxisA),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}exports.b2PrismaticJointDef=l;class m extends i.b2Joint{constructor(t){var e,i,o,l,m,n,a,c,r,h;super(t),this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_localXAxisA=new s.b2Vec2,this.m_localYAxisA=new s.b2Vec2,this.m_referenceAngle=0,this.m_impulse=new s.b2Vec2,this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_lowerTranslation=0,this.m_upperTranslation=0,this.m_maxMotorForce=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_enableMotor=!1,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_axis=new s.b2Vec2,this.m_perp=new s.b2Vec2,this.m_s1=0,this.m_s2=0,this.m_a1=0,this.m_a2=0,this.m_K=new s.b2Mat22,this.m_translation=0,this.m_axialMass=0,this.m_localAnchorA.Copy(null!==(e=t.localAnchorA)&&void 0!==e?e:s.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(i=t.localAnchorB)&&void 0!==i?i:s.b2Vec2.ZERO),s.b2Vec2.Normalize(null!==(o=t.localAxisA)&&void 0!==o?o:s.b2Vec2.UNITX,this.m_localXAxisA),s.b2Vec2.CrossOneVec2(this.m_localXAxisA,this.m_localYAxisA),this.m_referenceAngle=null!==(l=t.referenceAngle)&&void 0!==l?l:0,this.m_lowerTranslation=null!==(m=t.lowerTranslation)&&void 0!==m?m:0,this.m_upperTranslation=null!==(n=t.upperTranslation)&&void 0!==n?n:0,this.m_maxMotorForce=null!==(a=t.maxMotorForce)&&void 0!==a?a:0,this.m_motorSpeed=null!==(c=t.motorSpeed)&&void 0!==c?c:0,this.m_enableLimit=null!==(r=t.enableLimit)&&void 0!==r&&r,this.m_enableMotor=null!==(h=t.enableMotor)&&void 0!==h&&h}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=t.positions[this.m_indexA].c,i=t.positions[this.m_indexA].a,l=t.velocities[this.m_indexA].v;let m=t.velocities[this.m_indexA].w;const n=t.positions[this.m_indexB].c,a=t.positions[this.m_indexB].a,c=t.velocities[this.m_indexB].v;let r=t.velocities[this.m_indexB].w;const{qA:h,qB:_,lalcA:b,lalcB:p,rA:d,rB:A}=o;h.Set(i),_.Set(a),s.b2Rot.MultiplyVec2(h,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,b),d),s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,p),A);const u=s.b2Vec2.Subtract(n,e,o.InitVelocityConstraints.d).Add(A).Subtract(d),V=this.m_invMassA,x=this.m_invMassB,S=this.m_invIA,w=this.m_invIB;s.b2Rot.MultiplyVec2(h,this.m_localXAxisA,this.m_axis),this.m_a1=s.b2Vec2.Cross(s.b2Vec2.Add(u,d,s.b2Vec2.s_t0),this.m_axis),this.m_a2=s.b2Vec2.Cross(A,this.m_axis),this.m_axialMass=V+x+S*this.m_a1*this.m_a1+w*this.m_a2*this.m_a2,this.m_axialMass>0&&(this.m_axialMass=1/this.m_axialMass),s.b2Rot.MultiplyVec2(h,this.m_localYAxisA,this.m_perp),this.m_s1=s.b2Vec2.Cross(s.b2Vec2.Add(u,d,s.b2Vec2.s_t0),this.m_perp),this.m_s2=s.b2Vec2.Cross(A,this.m_perp);const y=V+x+S*this.m_s1*this.m_s1+w*this.m_s2*this.m_s2,M=S*this.m_s1+w*this.m_s2;let B=S+w;if(0===B&&(B=1),this.m_K.ex.Set(y,M),this.m_K.ey.Set(M,B),this.m_enableLimit?this.m_translation=s.b2Vec2.Dot(this.m_axis,u):(this.m_lowerImpulse=0,this.m_upperImpulse=0),this.m_enableMotor||(this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse.Scale(t.step.dtRatio),this.m_motorImpulse*=t.step.dtRatio,this.m_lowerImpulse*=t.step.dtRatio,this.m_upperImpulse*=t.step.dtRatio;const e=this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse,{P:i}=o.InitVelocityConstraints;s.b2Vec2.Scale(this.m_impulse.x,this.m_perp,i).AddScaled(e,this.m_axis);const n=this.m_impulse.x*this.m_s1+this.m_impulse.y+e*this.m_a1,a=this.m_impulse.x*this.m_s2+this.m_impulse.y+e*this.m_a2;l.SubtractScaled(V,i),m-=S*n,c.AddScaled(x,i),r+=w*a}else this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0;t.velocities[this.m_indexA].w=m,t.velocities[this.m_indexB].w=r}SolveVelocityConstraints(t){const e=t.velocities[this.m_indexA].v;let i=t.velocities[this.m_indexA].w;const l=t.velocities[this.m_indexB].v;let m=t.velocities[this.m_indexB].w;const n=this.m_invMassA,a=this.m_invMassB,c=this.m_invIA,r=this.m_invIB,{P:h,df:_}=o.SolveVelocityConstraints;if(this.m_enableMotor){const o=s.b2Vec2.Dot(this.m_axis,s.b2Vec2.Subtract(l,e,s.b2Vec2.s_t0))+this.m_a2*m-this.m_a1*i;let _=this.m_axialMass*(this.m_motorSpeed-o);const b=this.m_motorImpulse,p=t.step.dt*this.m_maxMotorForce;this.m_motorImpulse=s.b2Clamp(this.m_motorImpulse+_,-p,p),_=this.m_motorImpulse-b,s.b2Vec2.Scale(_,this.m_axis,h);const d=_*this.m_a1,A=_*this.m_a2;e.SubtractScaled(n,h),i-=c*d,l.AddScaled(a,h),m+=r*A}if(this.m_enableLimit){{const o=this.m_translation-this.m_lowerTranslation,_=s.b2Vec2.Dot(this.m_axis,s.b2Vec2.Subtract(l,e,s.b2Vec2.s_t0))+this.m_a2*m-this.m_a1*i;let b=-this.m_axialMass*(_+Math.max(o,0)*t.step.inv_dt);const p=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(this.m_lowerImpulse+b,0),b=this.m_lowerImpulse-p,s.b2Vec2.Scale(b,this.m_axis,h);const d=b*this.m_a1,A=b*this.m_a2;e.SubtractScaled(n,h),i-=c*d,l.AddScaled(a,h),m+=r*A}{const o=this.m_upperTranslation-this.m_translation,_=s.b2Vec2.Dot(this.m_axis,s.b2Vec2.Subtract(e,l,s.b2Vec2.s_t0))+this.m_a1*i-this.m_a2*m;let b=-this.m_axialMass*(_+Math.max(o,0)*t.step.inv_dt);const p=this.m_upperImpulse;this.m_upperImpulse=Math.max(this.m_upperImpulse+b,0),b=this.m_upperImpulse-p,s.b2Vec2.Scale(b,this.m_axis,h);const d=b*this.m_a1,A=b*this.m_a2;e.AddScaled(n,h),i+=c*d,l.SubtractScaled(a,h),m-=r*A}}{const t=s.b2Vec2.Dot(this.m_perp,s.b2Vec2.Subtract(l,e,s.b2Vec2.s_t0))+this.m_s2*m-this.m_s1*i,o=m-i;this.m_K.Solve(-t,-o,_),this.m_impulse.Add(_),s.b2Vec2.Scale(_.x,this.m_perp,h);const b=_.x*this.m_s1+_.y,p=_.x*this.m_s2+_.y;e.SubtractScaled(n,h),i-=c*b,l.AddScaled(a,h),m+=r*p}t.velocities[this.m_indexA].w=i,t.velocities[this.m_indexB].w=m}SolvePositionConstraints(e){const i=e.positions[this.m_indexA].c;let l=e.positions[this.m_indexA].a;const m=e.positions[this.m_indexB].c;let n=e.positions[this.m_indexB].a;const{qA:a,qB:c,lalcA:r,lalcB:h,rA:_,rB:b}=o;a.Set(l),c.Set(n);const p=this.m_invMassA,d=this.m_invMassB,A=this.m_invIA,u=this.m_invIB,{d:V,impulse:x,P:S}=o.SolvePositionConstraints;s.b2Rot.MultiplyVec2(a,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),_),s.b2Rot.MultiplyVec2(c,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,h),b),s.b2Vec2.Add(m,b,V).Subtract(i).Subtract(_);const w=s.b2Rot.MultiplyVec2(a,this.m_localXAxisA,this.m_axis),y=s.b2Vec2.Cross(s.b2Vec2.Add(V,_,s.b2Vec2.s_t0),w),M=s.b2Vec2.Cross(b,w),B=s.b2Rot.MultiplyVec2(a,this.m_localYAxisA,this.m_perp),v=s.b2Vec2.Cross(s.b2Vec2.Add(V,_,s.b2Vec2.s_t0),B),I=s.b2Vec2.Cross(b,B),C=s.b2Vec2.Dot(B,V),T=n-l-this.m_referenceAngle;let G=Math.abs(C);const f=Math.abs(T);let g=!1,D=0;if(this.m_enableLimit){const e=s.b2Vec2.Dot(w,V);Math.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?(D=e,G=Math.max(G,Math.abs(e)),g=!0):e<=this.m_lowerTranslation?(D=Math.min(e-this.m_lowerTranslation,0),G=Math.max(G,this.m_lowerTranslation-e),g=!0):e>=this.m_upperTranslation&&(D=Math.max(e-this.m_upperTranslation,0),G=Math.max(G,e-this.m_upperTranslation),g=!0)}if(g){const t=p+d+A*v*v+u*I*I,e=A*v+u*I,s=A*v*y+u*I*M;let i=A+u;0===i&&(i=1);const l=A*y+u*M,m=p+d+A*y*y+u*M*M,n=o.K3;n.ex.Set(t,e,s),n.ey.Set(e,i,l),n.ez.Set(s,l,m),n.Solve33(-C,-T,-D,x)}else{const t=p+d+A*v*v+u*I*I,e=A*v+u*I;let s=A+u;0===s&&(s=1);const i=o.K2;i.ex.Set(t,e),i.ey.Set(e,s);const l=i.Solve(-C,-T,o.SolvePositionConstraints.impulse1);x.x=l.x,x.y=l.y,x.z=0}s.b2Vec2.Scale(x.x,B,S).AddScaled(x.z,w);const R=x.x*v+x.y+x.z*y,L=x.x*I+x.y+x.z*M;return i.SubtractScaled(p,S),l-=A*R,m.AddScaled(d,S),n+=u*L,e.positions[this.m_indexA].a=l,e.positions[this.m_indexB].a=n,G<=t.b2_linearSlop&&f<=t.b2_angularSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,e){const s=this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse;return e.x=t*(this.m_impulse.x*this.m_perp.x+s*this.m_axis.x),e.y=t*(this.m_impulse.x*this.m_perp.y+s*this.m_axis.y),e}GetReactionTorque(t){return t*this.m_impulse.y}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetLocalAxisA(){return this.m_localXAxisA}GetReferenceAngle(){return this.m_referenceAngle}GetJointTranslation(){const{pA:t,pB:e,axis:i,d:l}=o.GetJointTranslation;return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t),this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e),s.b2Vec2.Subtract(e,t,l),this.m_bodyA.GetWorldVector(this.m_localXAxisA,i),s.b2Vec2.Dot(l,i)}GetJointSpeed(){const t=this.m_bodyA,e=this.m_bodyB,{lalcA:i,lalcB:l,rA:m,rB:n}=o;s.b2Rot.MultiplyVec2(t.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorA,t.m_sweep.localCenter,i),m),s.b2Rot.MultiplyVec2(e.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorB,e.m_sweep.localCenter,l),n);const a=s.b2Vec2.Add(t.m_sweep.c,m,s.b2Vec2.s_t0),c=s.b2Vec2.Add(e.m_sweep.c,n,s.b2Vec2.s_t1),r=s.b2Vec2.Subtract(c,a,s.b2Vec2.s_t2),h=s.b2Rot.MultiplyVec2(t.m_xf.q,this.m_localXAxisA,this.m_axis),_=t.m_linearVelocity,b=e.m_linearVelocity,p=t.m_angularVelocity,d=e.m_angularVelocity;return s.b2Vec2.Dot(r,s.b2Vec2.CrossScalarVec2(p,h,s.b2Vec2.s_t0))+s.b2Vec2.Dot(h,s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(b,d,n,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(_,p,m,s.b2Vec2.s_t1),s.b2Vec2.s_t0))}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(t){return t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_lowerImpulse=0,this.m_upperImpulse=0),t}GetLowerLimit(){return this.m_lowerTranslation}GetUpperLimit(){return this.m_upperTranslation}SetLimits(t,e){t===this.m_lowerTranslation&&e===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_lowerImpulse=0,this.m_upperImpulse=0)}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){return t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t),t}SetMotorSpeed(t){return t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t),t}GetMotorSpeed(){return this.m_motorSpeed}SetMaxMotorForce(t){t!==this.m_maxMotorForce&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=t)}GetMaxMotorForce(){return this.m_maxMotorForce}GetMotorForce(t){return t*this.m_motorImpulse}Draw(t){const{p1:i,p2:l,pA:m,pB:n,axis:a}=o.Draw,c=this.m_bodyA.GetTransform(),r=this.m_bodyB.GetTransform();if(s.b2Transform.MultiplyVec2(c,this.m_localAnchorA,m),s.b2Transform.MultiplyVec2(r,this.m_localAnchorB,n),s.b2Rot.MultiplyVec2(c.q,this.m_localXAxisA,a),t.DrawSegment(m,n,e.debugColors.joint5),this.m_enableLimit){const{lower:n,upper:r,perp:h}=o.Draw;s.b2Vec2.AddScaled(m,this.m_lowerTranslation,a,n),s.b2Vec2.AddScaled(m,this.m_upperTranslation,a,r),s.b2Rot.MultiplyVec2(c.q,this.m_localYAxisA,h),t.DrawSegment(n,r,e.debugColors.joint1),t.DrawSegment(s.b2Vec2.SubtractScaled(n,.5,h,i),s.b2Vec2.AddScaled(n,.5,h,l),e.debugColors.joint2),t.DrawSegment(s.b2Vec2.SubtractScaled(r,.5,h,i),s.b2Vec2.AddScaled(r,.5,h,l),e.debugColors.joint3)}else t.DrawSegment(s.b2Vec2.Subtract(m,a,i),s.b2Vec2.Add(m,a,l),e.debugColors.joint1);t.DrawPoint(m,5,e.debugColors.joint1),t.DrawPoint(n,5,e.debugColors.joint4)}}exports.b2PrismaticJoint=m;
},{"../common/b2_common":"xZSi","../common/b2_draw":"J87F","../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"Jd4O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PulleyJoint=exports.b2PulleyJointDef=exports.b2_minPulleyLength=void 0;const t=require("../common/b2_common"),i=require("../common/b2_draw"),s=require("../common/b2_math"),e=require("./b2_joint");exports.b2_minPulleyLength=2;const n={qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,p:new s.b2Vec2,PA:new s.b2Vec2,PB:new s.b2Vec2,vpA:new s.b2Vec2,vpB:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2};class o extends e.b2JointDef{constructor(){super(e.b2JointType.e_pulleyJoint),this.groundAnchorA=new s.b2Vec2(-1,1),this.groundAnchorB=new s.b2Vec2(1,1),this.localAnchorA=new s.b2Vec2(-1,0),this.localAnchorB=new s.b2Vec2(1,0),this.lengthA=0,this.lengthB=0,this.ratio=1,this.collideConnected=!0}Initialize(t,i,e,n,o,h,c){this.bodyA=t,this.bodyB=i,this.groundAnchorA.Copy(e),this.groundAnchorB.Copy(n),this.bodyA.GetLocalPoint(o,this.localAnchorA),this.bodyB.GetLocalPoint(h,this.localAnchorB),this.lengthA=s.b2Vec2.Distance(o,e),this.lengthB=s.b2Vec2.Distance(h,n),this.ratio=c}}exports.b2PulleyJointDef=o;const h=new s.b2Vec2(-1,1),c=s.b2Vec2.UNITX,r=new s.b2Vec2(-1,0),m=s.b2Vec2.UNITX;class _ extends e.b2Joint{constructor(t){var i,e,n,o,_,l,A;super(t),this.m_groundAnchorA=new s.b2Vec2,this.m_groundAnchorB=new s.b2Vec2,this.m_lengthA=0,this.m_lengthB=0,this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_constant=0,this.m_ratio=0,this.m_impulse=0,this.m_indexA=0,this.m_indexB=0,this.m_uA=new s.b2Vec2,this.m_uB=new s.b2Vec2,this.m_rA=new s.b2Vec2,this.m_rB=new s.b2Vec2,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=0,this.m_groundAnchorA.Copy(null!==(i=t.groundAnchorA)&&void 0!==i?i:h),this.m_groundAnchorB.Copy(null!==(e=t.groundAnchorB)&&void 0!==e?e:c),this.m_localAnchorA.Copy(null!==(n=t.localAnchorA)&&void 0!==n?n:r),this.m_localAnchorB.Copy(null!==(o=t.localAnchorB)&&void 0!==o?o:m),this.m_lengthA=null!==(_=t.lengthA)&&void 0!==_?_:0,this.m_lengthB=null!==(l=t.lengthB)&&void 0!==l?l:0,this.m_ratio=null!==(A=t.ratio)&&void 0!==A?A:1,this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0}InitVelocityConstraints(i){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const e=i.positions[this.m_indexA].c,o=i.positions[this.m_indexA].a,h=i.velocities[this.m_indexA].v;let c=i.velocities[this.m_indexA].w;const r=i.positions[this.m_indexB].c,m=i.positions[this.m_indexB].a,_=i.velocities[this.m_indexB].v;let l=i.velocities[this.m_indexB].w;const{qA:A,qB:a,lalcA:d,lalcB:b}=n;A.Set(o),a.Set(m),s.b2Rot.MultiplyVec2(A,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,d),this.m_rA),s.b2Rot.MultiplyVec2(a,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,b),this.m_rB),s.b2Vec2.Add(e,this.m_rA,this.m_uA).Subtract(this.m_groundAnchorA),s.b2Vec2.Add(r,this.m_rB,this.m_uB).Subtract(this.m_groundAnchorB);const u=this.m_uA.Length(),B=this.m_uB.Length();u>10*t.b2_linearSlop?this.m_uA.Scale(1/u):this.m_uA.SetZero(),B>10*t.b2_linearSlop?this.m_uB.Scale(1/B):this.m_uB.SetZero();const V=s.b2Vec2.Cross(this.m_rA,this.m_uA),v=s.b2Vec2.Cross(this.m_rB,this.m_uB),p=this.m_invMassA+this.m_invIA*V*V,g=this.m_invMassB+this.m_invIB*v*v;if(this.m_mass=p+this.m_ratio*this.m_ratio*g,this.m_mass>0&&(this.m_mass=1/this.m_mass),i.step.warmStarting){this.m_impulse*=i.step.dtRatio;const{PA:t,PB:e}=n;s.b2Vec2.Scale(-this.m_impulse,this.m_uA,t),s.b2Vec2.Scale(-this.m_ratio*this.m_impulse,this.m_uB,e),h.AddScaled(this.m_invMassA,t),c+=this.m_invIA*s.b2Vec2.Cross(this.m_rA,t),_.AddScaled(this.m_invMassB,e),l+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,e)}else this.m_impulse=0;i.velocities[this.m_indexA].w=c,i.velocities[this.m_indexB].w=l}SolveVelocityConstraints(t){const i=t.velocities[this.m_indexA].v;let e=t.velocities[this.m_indexA].w;const o=t.velocities[this.m_indexB].v;let h=t.velocities[this.m_indexB].w;const{PA:c,PB:r,vpA:m,vpB:_}=n;s.b2Vec2.AddCrossScalarVec2(i,e,this.m_rA,m),s.b2Vec2.AddCrossScalarVec2(o,h,this.m_rB,_);const l=-s.b2Vec2.Dot(this.m_uA,m)-this.m_ratio*s.b2Vec2.Dot(this.m_uB,_),A=-this.m_mass*l;this.m_impulse+=A,s.b2Vec2.Scale(-A,this.m_uA,c),s.b2Vec2.Scale(-this.m_ratio*A,this.m_uB,r),i.AddScaled(this.m_invMassA,c),e+=this.m_invIA*s.b2Vec2.Cross(this.m_rA,c),o.AddScaled(this.m_invMassB,r),h+=this.m_invIB*s.b2Vec2.Cross(this.m_rB,r),t.velocities[this.m_indexA].w=e,t.velocities[this.m_indexB].w=h}SolvePositionConstraints(i){const e=i.positions[this.m_indexA].c;let o=i.positions[this.m_indexA].a;const h=i.positions[this.m_indexB].c;let c=i.positions[this.m_indexB].a;const{qA:r,qB:m,lalcA:_,lalcB:l,PA:A,PB:a}=n;r.Set(o),m.Set(c);const d=s.b2Rot.MultiplyVec2(r,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,_),this.m_rA),b=s.b2Rot.MultiplyVec2(m,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,l),this.m_rB),u=s.b2Vec2.Add(e,d,this.m_uA).Subtract(this.m_groundAnchorA),B=s.b2Vec2.Add(h,b,this.m_uB).Subtract(this.m_groundAnchorB),V=u.Length(),v=B.Length();V>10*t.b2_linearSlop?u.Scale(1/V):u.SetZero(),v>10*t.b2_linearSlop?B.Scale(1/v):B.SetZero();const p=s.b2Vec2.Cross(d,u),g=s.b2Vec2.Cross(b,B),S=this.m_invMassA+this.m_invIA*p*p,w=this.m_invMassB+this.m_invIB*g*g;let y=S+this.m_ratio*this.m_ratio*w;y>0&&(y=1/y);const x=this.m_constant-V-this.m_ratio*v,C=Math.abs(x),G=-y*x;return s.b2Vec2.Scale(-G,u,A),s.b2Vec2.Scale(-this.m_ratio*G,B,a),e.AddScaled(this.m_invMassA,A),o+=this.m_invIA*s.b2Vec2.Cross(d,A),h.AddScaled(this.m_invMassB,a),c+=this.m_invIB*s.b2Vec2.Cross(b,a),i.positions[this.m_indexA].a=o,i.positions[this.m_indexB].a=c,C<t.b2_linearSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,i){return i.x=t*this.m_impulse*this.m_uB.x,i.y=t*this.m_impulse*this.m_uB.y,i}GetReactionTorque(t){return 0}GetGroundAnchorA(){return this.m_groundAnchorA}GetGroundAnchorB(){return this.m_groundAnchorB}GetLengthA(){return this.m_lengthA}GetLengthB(){return this.m_lengthB}GetRatio(){return this.m_ratio}GetCurrentLengthA(){const t=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,n.p),i=this.m_groundAnchorA;return s.b2Vec2.Distance(t,i)}GetCurrentLengthB(){const t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,n.p),i=this.m_groundAnchorB;return s.b2Vec2.Distance(t,i)}ShiftOrigin(t){this.m_groundAnchorA.Subtract(t),this.m_groundAnchorB.Subtract(t)}Draw(t){const s=this.GetAnchorA(n.pA),e=this.GetAnchorB(n.pB),o=this.GetGroundAnchorA(),h=this.GetGroundAnchorB();t.DrawSegment(o,s,i.debugColors.joint6),t.DrawSegment(h,e,i.debugColors.joint6),t.DrawSegment(o,h,i.debugColors.joint6)}}exports.b2PulleyJoint=_;
},{"../common/b2_common":"xZSi","../common/b2_draw":"J87F","../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"AIPE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2RevoluteJoint=exports.b2RevoluteJointDef=void 0;const e=require("../common/b2_common"),t=require("../common/b2_draw"),i=require("../common/b2_math"),s=require("./b2_joint"),o={qA:new i.b2Rot,qB:new i.b2Rot,lalcA:new i.b2Vec2,lalcB:new i.b2Vec2,P:new i.b2Vec2,Cdot:new i.b2Vec2,C:new i.b2Vec2,impulse:new i.b2Vec2,p2:new i.b2Vec2,r:new i.b2Vec2,pA:new i.b2Vec2,pB:new i.b2Vec2,rlo:new i.b2Vec2,rhi:new i.b2Vec2};class m extends s.b2JointDef{constructor(){super(s.b2JointType.e_revoluteJoint),this.localAnchorA=new i.b2Vec2,this.localAnchorB=new i.b2Vec2,this.referenceAngle=0,this.enableLimit=!1,this.lowerAngle=0,this.upperAngle=0,this.enableMotor=!1,this.motorSpeed=0,this.maxMotorTorque=0}Initialize(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}exports.b2RevoluteJointDef=m;class l extends s.b2Joint{constructor(e){var t,s,o,m,l,n,r,h,_;super(e),this.m_localAnchorA=new i.b2Vec2,this.m_localAnchorB=new i.b2Vec2,this.m_impulse=new i.b2Vec2,this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_enableMotor=!1,this.m_maxMotorTorque=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_referenceAngle=0,this.m_lowerAngle=0,this.m_upperAngle=0,this.m_indexA=0,this.m_indexB=0,this.m_rA=new i.b2Vec2,this.m_rB=new i.b2Vec2,this.m_localCenterA=new i.b2Vec2,this.m_localCenterB=new i.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_K=new i.b2Mat22,this.m_angle=0,this.m_axialMass=0,this.m_localAnchorA.Copy(null!==(t=e.localAnchorA)&&void 0!==t?t:i.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(s=e.localAnchorB)&&void 0!==s?s:i.b2Vec2.ZERO),this.m_referenceAngle=null!==(o=e.referenceAngle)&&void 0!==o?o:0,this.m_impulse.SetZero(),this.m_lowerAngle=null!==(m=e.lowerAngle)&&void 0!==m?m:0,this.m_upperAngle=null!==(l=e.upperAngle)&&void 0!==l?l:0,this.m_maxMotorTorque=null!==(n=e.maxMotorTorque)&&void 0!==n?n:0,this.m_motorSpeed=null!==(r=e.motorSpeed)&&void 0!==r?r:0,this.m_enableLimit=null!==(h=e.enableLimit)&&void 0!==h&&h,this.m_enableMotor=null!==(_=e.enableMotor)&&void 0!==_&&_}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const t=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v;let m=e.velocities[this.m_indexA].w;const l=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v;let r=e.velocities[this.m_indexB].w;const{qA:h,qB:_,lalcA:a,lalcB:c}=o;h.Set(t),_.Set(l),i.b2Rot.MultiplyVec2(h,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,a),this.m_rA),i.b2Rot.MultiplyVec2(_,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,c),this.m_rB);const p=this.m_invMassA,A=this.m_invMassB,u=this.m_invIA,b=this.m_invIB;let d;if(this.m_K.ex.x=p+A+this.m_rA.y*this.m_rA.y*u+this.m_rB.y*this.m_rB.y*b,this.m_K.ey.x=-this.m_rA.y*this.m_rA.x*u-this.m_rB.y*this.m_rB.x*b,this.m_K.ex.y=this.m_K.ey.x,this.m_K.ey.y=p+A+this.m_rA.x*this.m_rA.x*u+this.m_rB.x*this.m_rB.x*b,this.m_axialMass=u+b,this.m_axialMass>0?(this.m_axialMass=1/this.m_axialMass,d=!1):d=!0,this.m_angle=l-t-this.m_referenceAngle,(!1===this.m_enableLimit||d)&&(this.m_lowerImpulse=0,this.m_upperImpulse=0),(!1===this.m_enableMotor||d)&&(this.m_motorImpulse=0),e.step.warmStarting){this.m_impulse.Scale(e.step.dtRatio),this.m_motorImpulse*=e.step.dtRatio,this.m_lowerImpulse*=e.step.dtRatio,this.m_upperImpulse*=e.step.dtRatio;const t=this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse,l=o.P.Set(this.m_impulse.x,this.m_impulse.y);s.SubtractScaled(p,l),m-=u*(i.b2Vec2.Cross(this.m_rA,l)+t),n.AddScaled(A,l),r+=b*(i.b2Vec2.Cross(this.m_rB,l)+t)}else this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0;e.velocities[this.m_indexA].w=m,e.velocities[this.m_indexB].w=r}SolveVelocityConstraints(e){const t=e.velocities[this.m_indexA].v;let s=e.velocities[this.m_indexA].w;const m=e.velocities[this.m_indexB].v;let l=e.velocities[this.m_indexB].w;const n=this.m_invMassA,r=this.m_invMassB,h=this.m_invIA,_=this.m_invIB,a=h+_===0;if(this.m_enableMotor&&!a){const t=l-s-this.m_motorSpeed;let o=-this.m_axialMass*t;const m=this.m_motorImpulse,n=e.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=i.b2Clamp(this.m_motorImpulse+o,-n,n),s-=h*(o=this.m_motorImpulse-m),l+=_*o}if(this.m_enableLimit&&!a){{const t=this.m_angle-this.m_lowerAngle,i=l-s;let o=-this.m_axialMass*(i+Math.max(t,0)*e.step.inv_dt);const m=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(this.m_lowerImpulse+o,0),s-=h*(o=this.m_lowerImpulse-m),l+=_*o}{const t=this.m_upperAngle-this.m_angle,i=s-l;let o=-this.m_axialMass*(i+Math.max(t,0)*e.step.inv_dt);const m=this.m_upperImpulse;this.m_upperImpulse=Math.max(this.m_upperImpulse+o,0),s+=h*(o=this.m_upperImpulse-m),l-=_*o}}{const{Cdot:e,impulse:a}=o;i.b2Vec2.Subtract(i.b2Vec2.AddCrossScalarVec2(m,l,this.m_rB,i.b2Vec2.s_t0),i.b2Vec2.AddCrossScalarVec2(t,s,this.m_rA,i.b2Vec2.s_t1),e),this.m_K.Solve(-e.x,-e.y,a),this.m_impulse.x+=a.x,this.m_impulse.y+=a.y,t.SubtractScaled(n,a),s-=h*i.b2Vec2.Cross(this.m_rA,a),m.AddScaled(r,a),l+=_*i.b2Vec2.Cross(this.m_rB,a)}e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=l}SolvePositionConstraints(t){const s=t.positions[this.m_indexA].c;let m=t.positions[this.m_indexA].a;const l=t.positions[this.m_indexB].c;let n=t.positions[this.m_indexB].a;const{qA:r,qB:h,lalcA:_,lalcB:a,impulse:c}=o;r.Set(m),h.Set(n);let p=0,A=0;const u=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&!u){const t=n-m-this.m_referenceAngle;let s=0;Math.abs(this.m_upperAngle-this.m_lowerAngle)<2*e.b2_angularSlop?s=i.b2Clamp(t-this.m_lowerAngle,-e.b2_maxAngularCorrection,e.b2_maxAngularCorrection):t<=this.m_lowerAngle?s=i.b2Clamp(t-this.m_lowerAngle+e.b2_angularSlop,-e.b2_maxAngularCorrection,0):t>=this.m_upperAngle&&(s=i.b2Clamp(t-this.m_upperAngle-e.b2_angularSlop,0,e.b2_maxAngularCorrection));const o=-this.m_axialMass*s;m-=this.m_invIA*o,n+=this.m_invIB*o,p=Math.abs(s)}{r.Set(m),h.Set(n);const e=i.b2Rot.MultiplyVec2(r,i.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,_),this.m_rA),t=i.b2Rot.MultiplyVec2(h,i.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,a),this.m_rB),p=i.b2Vec2.Add(l,t,o.C).Subtract(s).Subtract(e);A=p.Length();const u=this.m_invMassA,b=this.m_invMassB,d=this.m_invIA,x=this.m_invIB,w=this.m_K;w.ex.x=u+b+d*e.y*e.y+x*t.y*t.y,w.ex.y=-d*e.x*e.y-x*t.x*t.y,w.ey.x=w.ex.y,w.ey.y=u+b+d*e.x*e.x+x*t.x*t.x,w.Solve(p.x,p.y,c).Negate(),s.SubtractScaled(u,c),m-=d*i.b2Vec2.Cross(e,c),l.AddScaled(b,c),n+=x*i.b2Vec2.Cross(t,c)}return t.positions[this.m_indexA].a=m,t.positions[this.m_indexB].a=n,A<=e.b2_linearSlop&&p<=e.b2_angularSlop}GetAnchorA(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}GetAnchorB(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}GetReactionForce(e,t){return t.x=e*this.m_impulse.x,t.y=e*this.m_impulse.y,t}GetReactionTorque(e){return e*(this.m_motorImpulse+this.m_lowerImpulse-this.m_upperImpulse)}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetReferenceAngle(){return this.m_referenceAngle}GetJointAngle(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle}GetJointSpeed(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(e){return e!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e),e}GetMotorTorque(e){return e*this.m_motorImpulse}GetMotorSpeed(){return this.m_motorSpeed}SetMaxMotorTorque(e){e!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=e)}GetMaxMotorTorque(){return this.m_maxMotorTorque}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(e){return e!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e,this.m_lowerImpulse=0,this.m_upperImpulse=0),e}GetLowerLimit(){return this.m_lowerAngle}GetUpperLimit(){return this.m_upperAngle}SetLimits(e,t){e===this.m_lowerAngle&&t===this.m_upperAngle||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_lowerAngle=e,this.m_upperAngle=t)}SetMotorSpeed(e){return e!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e),e}Draw(e){const{p2:s,r:m,pA:l,pB:n}=o,r=this.m_bodyA.GetTransform(),h=this.m_bodyB.GetTransform();i.b2Transform.MultiplyVec2(r,this.m_localAnchorA,l),i.b2Transform.MultiplyVec2(h,this.m_localAnchorB,n),e.DrawPoint(l,5,t.debugColors.joint4),e.DrawPoint(n,5,t.debugColors.joint5);const _=this.m_bodyA.GetAngle(),a=this.m_bodyB.GetAngle()-_-this.m_referenceAngle;if(m.Set(Math.cos(a),Math.sin(a)).Scale(.5),e.DrawSegment(n,i.b2Vec2.Add(n,m,s),t.debugColors.joint1),e.DrawCircle(n,.5,t.debugColors.joint1),this.m_enableLimit){const{rlo:m,rhi:l}=o;m.Set(Math.cos(this.m_lowerAngle),Math.sin(this.m_lowerAngle)).Scale(.5),l.Set(Math.cos(this.m_upperAngle),Math.sin(this.m_upperAngle)).Scale(.5),e.DrawSegment(n,i.b2Vec2.Add(n,m,s),t.debugColors.joint2),e.DrawSegment(n,i.b2Vec2.Add(n,l,s),t.debugColors.joint3)}e.DrawSegment(r.p,l,t.debugColors.joint6),e.DrawSegment(l,n,t.debugColors.joint6),e.DrawSegment(h.p,n,t.debugColors.joint6)}}exports.b2RevoluteJoint=l;
},{"../common/b2_common":"xZSi","../common/b2_draw":"J87F","../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"lC1O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2WeldJoint=exports.b2WeldJointDef=void 0;const e=require("../common/b2_common"),t=require("../common/b2_math"),s=require("./b2_joint"),i={qA:new t.b2Rot,qB:new t.b2Rot,rA:new t.b2Vec2,rB:new t.b2Vec2,lalcA:new t.b2Vec2,lalcB:new t.b2Vec2,K:new t.b2Mat33,P:new t.b2Vec2,Cdot1:new t.b2Vec3,impulse1:new t.b2Vec2,impulse:new t.b2Vec3,C1:new t.b2Vec2,C:new t.b2Vec3};class m extends s.b2JointDef{constructor(){super(s.b2JointType.e_weldJoint),this.localAnchorA=new t.b2Vec2,this.localAnchorB=new t.b2Vec2,this.referenceAngle=0,this.stiffness=0,this.damping=0}Initialize(e,t,s){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(s,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngle()-this.bodyA.GetAngle()}}exports.b2WeldJointDef=m;class n extends s.b2Joint{constructor(e){var s,i,m,n,c;super(e),this.m_stiffness=0,this.m_damping=0,this.m_bias=0,this.m_localAnchorA=new t.b2Vec2,this.m_localAnchorB=new t.b2Vec2,this.m_referenceAngle=0,this.m_gamma=0,this.m_impulse=new t.b2Vec3,this.m_indexA=0,this.m_indexB=0,this.m_rA=new t.b2Vec2,this.m_rB=new t.b2Vec2,this.m_localCenterA=new t.b2Vec2,this.m_localCenterB=new t.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_mass=new t.b2Mat33,this.m_localAnchorA.Copy(null!==(s=e.localAnchorA)&&void 0!==s?s:t.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(i=e.localAnchorB)&&void 0!==i?i:t.b2Vec2.ZERO),this.m_referenceAngle=null!==(m=e.referenceAngle)&&void 0!==m?m:0,this.m_stiffness=null!==(n=e.stiffness)&&void 0!==n?n:0,this.m_damping=null!==(c=e.damping)&&void 0!==c?c:0}InitVelocityConstraints(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const s=e.positions[this.m_indexA].a,m=e.velocities[this.m_indexA].v;let n=e.velocities[this.m_indexA].w;const c=e.positions[this.m_indexB].a,o=e.velocities[this.m_indexB].v;let h=e.velocities[this.m_indexB].w;const{qA:l,qB:_,lalcA:r,lalcB:a,K:A}=i;l.Set(s),_.Set(c),t.b2Rot.MultiplyVec2(l,t.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),this.m_rA),t.b2Rot.MultiplyVec2(_,t.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,a),this.m_rB);const b=this.m_invMassA,d=this.m_invMassB,x=this.m_invIA,y=this.m_invIB;if(A.ex.x=b+d+this.m_rA.y*this.m_rA.y*x+this.m_rB.y*this.m_rB.y*y,A.ey.x=-this.m_rA.y*this.m_rA.x*x-this.m_rB.y*this.m_rB.x*y,A.ez.x=-this.m_rA.y*x-this.m_rB.y*y,A.ex.y=A.ey.x,A.ey.y=b+d+this.m_rA.x*this.m_rA.x*x+this.m_rB.x*this.m_rB.x*y,A.ez.y=this.m_rA.x*x+this.m_rB.x*y,A.ex.z=A.ez.x,A.ey.z=A.ez.y,A.ez.z=x+y,this.m_stiffness>0){A.GetInverse22(this.m_mass);let t=x+y;const i=c-s-this.m_referenceAngle,m=this.m_damping,n=this.m_stiffness,o=e.step.dt;this.m_gamma=o*(m+o*n),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=i*o*n*this.m_gamma,t+=this.m_gamma,this.m_mass.ez.z=0!==t?1/t:0}else 0===A.ez.z?(A.GetInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(A.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(e.step.warmStarting){this.m_impulse.Scale(e.step.dtRatio);const{P:s}=i;s.Copy(this.m_impulse),m.SubtractScaled(b,s),n-=x*(t.b2Vec2.Cross(this.m_rA,s)+this.m_impulse.z),o.AddScaled(d,s),h+=y*(t.b2Vec2.Cross(this.m_rB,s)+this.m_impulse.z)}else this.m_impulse.SetZero();e.velocities[this.m_indexA].w=n,e.velocities[this.m_indexB].w=h}SolveVelocityConstraints(e){const s=e.velocities[this.m_indexA].v;let m=e.velocities[this.m_indexA].w;const n=e.velocities[this.m_indexB].v;let c=e.velocities[this.m_indexB].w;const o=this.m_invMassA,h=this.m_invMassB,l=this.m_invIA,_=this.m_invIB;if(this.m_stiffness>0){const e=c-m,r=-this.m_mass.ez.z*(e+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=r,m-=l*r,c+=_*r;const{Cdot1:a,impulse1:A}=i;t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(n,c,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(s,m,this.m_rA,t.b2Vec2.s_t1),a),t.b2Mat33.MultiplyVec2(this.m_mass,a,A).Negate(),this.m_impulse.x+=A.x,this.m_impulse.y+=A.y;const b=A;s.SubtractScaled(o,b),m-=l*t.b2Vec2.Cross(this.m_rA,b),n.AddScaled(h,b),c+=_*t.b2Vec2.Cross(this.m_rB,b)}else{const{Cdot1:e,impulse:r,P:a}=i;t.b2Vec2.Subtract(t.b2Vec2.AddCrossScalarVec2(n,c,this.m_rB,t.b2Vec2.s_t0),t.b2Vec2.AddCrossScalarVec2(s,m,this.m_rA,t.b2Vec2.s_t1),e),e.z=c-m,t.b2Mat33.MultiplyVec3(this.m_mass,e,r).Negate(),this.m_impulse.Add(r),a.Set(r.x,r.y),s.SubtractScaled(o,a),m-=l*(t.b2Vec2.Cross(this.m_rA,a)+r.z),n.AddScaled(h,a),c+=_*(t.b2Vec2.Cross(this.m_rB,a)+r.z)}e.velocities[this.m_indexA].w=m,e.velocities[this.m_indexB].w=c}SolvePositionConstraints(s){const m=s.positions[this.m_indexA].c;let n=s.positions[this.m_indexA].a;const c=s.positions[this.m_indexB].c;let o=s.positions[this.m_indexB].a;const{qA:h,qB:l,lalcA:_,lalcB:r,K:a,C1:A,P:b,rA:d,rB:x}=i;h.Set(n),l.Set(o);const y=this.m_invMassA,u=this.m_invMassB,B=this.m_invIA,p=this.m_invIB;let V,v;if(t.b2Rot.MultiplyVec2(h,t.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,_),d),t.b2Rot.MultiplyVec2(l,t.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,r),x),a.ex.x=y+u+d.y*d.y*B+x.y*x.y*p,a.ey.x=-d.y*d.x*B-x.y*x.x*p,a.ez.x=-d.y*B-x.y*p,a.ex.y=a.ey.x,a.ey.y=y+u+d.x*d.x*B+x.x*x.x*p,a.ez.y=d.x*B+x.x*p,a.ex.z=a.ez.x,a.ey.z=a.ez.y,a.ez.z=B+p,this.m_stiffness>0)t.b2Vec2.Add(c,x,A).Subtract(m).Subtract(d),V=A.Length(),v=0,a.Solve22(A.x,A.y,b).Negate(),m.SubtractScaled(y,b),n-=B*t.b2Vec2.Cross(d,b),c.AddScaled(u,b),o+=p*t.b2Vec2.Cross(x,b);else{t.b2Vec2.Add(c,x,A).Subtract(m).Subtract(d),t.b2Vec2.Subtract(t.b2Vec2.Add(c,x,t.b2Vec2.s_t0),t.b2Vec2.Add(m,d,t.b2Vec2.s_t1),A);const e=o-n-this.m_referenceAngle;V=A.Length(),v=Math.abs(e);const{impulse:s,C:h}=i;h.Set(A.x,A.y,e),a.ez.z>0?a.Solve33(h.x,h.y,h.z,s).Negate():(a.Solve22(A.x,A.y,s).Negate(),s.z=0),b.Copy(s),m.SubtractScaled(y,b),n-=B*(t.b2Vec2.Cross(d,b)+s.z),c.AddScaled(u,b),o+=p*(t.b2Vec2.Cross(x,b)+s.z)}return s.positions[this.m_indexA].a=n,s.positions[this.m_indexB].a=o,V<=e.b2_linearSlop&&v<=e.b2_angularSlop}GetAnchorA(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)}GetAnchorB(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)}GetReactionForce(e,t){return t.x=e*this.m_impulse.x,t.y=e*this.m_impulse.y,t}GetReactionTorque(e){return e*this.m_impulse.z}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetReferenceAngle(){return this.m_referenceAngle}SetStiffness(e){this.m_stiffness=e}GetStiffness(){return this.m_stiffness}SetDamping(e){this.m_damping=e}GetDamping(){return this.m_damping}}exports.b2WeldJoint=n;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_joint":"PxaZ"}],"EFh3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2WheelJoint=exports.b2WheelJointDef=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),i=require("./b2_joint"),e=require("../common/b2_draw"),m={qA:new s.b2Rot,qB:new s.b2Rot,lalcA:new s.b2Vec2,lalcB:new s.b2Vec2,rA:new s.b2Vec2,rB:new s.b2Vec2,d:new s.b2Vec2,P:new s.b2Vec2,ay:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,Draw:{p1:new s.b2Vec2,p2:new s.b2Vec2,pA:new s.b2Vec2,pB:new s.b2Vec2,axis:new s.b2Vec2,lower:new s.b2Vec2,upper:new s.b2Vec2,perp:new s.b2Vec2}};class o extends i.b2JointDef{constructor(){super(i.b2JointType.e_wheelJoint),this.localAnchorA=new s.b2Vec2,this.localAnchorB=new s.b2Vec2,this.localAxisA=new s.b2Vec2(1,0),this.enableLimit=!1,this.lowerTranslation=0,this.upperTranslation=0,this.enableMotor=!1,this.maxMotorTorque=0,this.motorSpeed=0,this.stiffness=0,this.damping=0}Initialize(t,s,i,e){this.bodyA=t,this.bodyB=s,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(e,this.localAxisA)}}exports.b2WheelJointDef=o;class a extends i.b2Joint{constructor(t){var i,e,m,o,a,l,h,n,_,r,c;super(t),this.m_localAnchorA=new s.b2Vec2,this.m_localAnchorB=new s.b2Vec2,this.m_localXAxisA=new s.b2Vec2,this.m_localYAxisA=new s.b2Vec2,this.m_impulse=0,this.m_motorImpulse=0,this.m_springImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0,this.m_translation=0,this.m_lowerTranslation=0,this.m_upperTranslation=0,this.m_maxMotorTorque=0,this.m_motorSpeed=0,this.m_enableLimit=!1,this.m_enableMotor=!1,this.m_stiffness=0,this.m_damping=0,this.m_indexA=0,this.m_indexB=0,this.m_localCenterA=new s.b2Vec2,this.m_localCenterB=new s.b2Vec2,this.m_invMassA=0,this.m_invMassB=0,this.m_invIA=0,this.m_invIB=0,this.m_ax=new s.b2Vec2,this.m_ay=new s.b2Vec2,this.m_sAx=0,this.m_sBx=0,this.m_sAy=0,this.m_sBy=0,this.m_mass=0,this.m_motorMass=0,this.m_axialMass=0,this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_localAnchorA.Copy(null!==(i=t.localAnchorA)&&void 0!==i?i:s.b2Vec2.ZERO),this.m_localAnchorB.Copy(null!==(e=t.localAnchorB)&&void 0!==e?e:s.b2Vec2.ZERO),this.m_localXAxisA.Copy(null!==(m=t.localAxisA)&&void 0!==m?m:s.b2Vec2.UNITX),s.b2Vec2.CrossOneVec2(this.m_localXAxisA,this.m_localYAxisA),this.m_lowerTranslation=null!==(o=t.lowerTranslation)&&void 0!==o?o:0,this.m_upperTranslation=null!==(a=t.upperTranslation)&&void 0!==a?a:0,this.m_enableLimit=null!==(l=t.enableLimit)&&void 0!==l&&l,this.m_maxMotorTorque=null!==(h=t.maxMotorTorque)&&void 0!==h?h:0,this.m_motorSpeed=null!==(n=t.motorSpeed)&&void 0!==n?n:0,this.m_enableMotor=null!==(_=t.enableMotor)&&void 0!==_&&_,this.m_ax.SetZero(),this.m_ay.SetZero(),this.m_stiffness=null!==(r=t.stiffness)&&void 0!==r?r:0,this.m_damping=null!==(c=t.damping)&&void 0!==c?c:0}GetMotorSpeed(){return this.m_motorSpeed}GetMaxMotorTorque(){return this.m_maxMotorTorque}SetStiffness(t){this.m_stiffness=t}GetStiffness(){return this.m_stiffness}SetDamping(t){this.m_damping=t}GetDamping(){return this.m_damping}InitVelocityConstraints(t){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;const i=this.m_invMassA,e=this.m_invMassB,o=this.m_invIA,a=this.m_invIB,l=t.positions[this.m_indexA].c,h=t.positions[this.m_indexA].a,n=t.velocities[this.m_indexA].v;let _=t.velocities[this.m_indexA].w;const r=t.positions[this.m_indexB].c,c=t.positions[this.m_indexB].a,b=t.velocities[this.m_indexB].v;let p=t.velocities[this.m_indexB].w;const{qA:A,qB:u,lalcA:d,lalcB:V,rA:x,rB:S,d:B}=m;A.Set(h),u.Set(c),s.b2Rot.MultiplyVec2(A,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,d),x),s.b2Rot.MultiplyVec2(u,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,V),S),s.b2Vec2.Add(r,S,B).Subtract(l).Subtract(x),s.b2Rot.MultiplyVec2(A,this.m_localYAxisA,this.m_ay),this.m_sAy=s.b2Vec2.Cross(s.b2Vec2.Add(B,x,s.b2Vec2.s_t0),this.m_ay),this.m_sBy=s.b2Vec2.Cross(S,this.m_ay),this.m_mass=i+e+o*this.m_sAy*this.m_sAy+a*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),s.b2Rot.MultiplyVec2(A,this.m_localXAxisA,this.m_ax),this.m_sAx=s.b2Vec2.Cross(s.b2Vec2.Add(B,x,s.b2Vec2.s_t0),this.m_ax),this.m_sBx=s.b2Vec2.Cross(S,this.m_ax);const y=i+e+o*this.m_sAx*this.m_sAx+a*this.m_sBx*this.m_sBx;if(this.m_axialMass=y>0?1/y:0,this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_stiffness>0&&y>0){this.m_springMass=1/y;const i=s.b2Vec2.Dot(B,this.m_ax),e=t.step.dt;this.m_gamma=e*(this.m_damping+e*this.m_stiffness),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=i*e*this.m_stiffness*this.m_gamma,this.m_springMass=y+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}else this.m_springImpulse=0;if(this.m_enableLimit?this.m_translation=s.b2Vec2.Dot(this.m_ax,B):(this.m_lowerImpulse=0,this.m_upperImpulse=0),this.m_enableMotor?(this.m_motorMass=o+a,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.step.warmStarting){this.m_impulse*=t.step.dtRatio,this.m_springImpulse*=t.step.dtRatio,this.m_motorImpulse*=t.step.dtRatio;const i=this.m_springImpulse+this.m_lowerImpulse-this.m_upperImpulse,{P:e}=m;s.b2Vec2.Scale(this.m_impulse,this.m_ay,e).AddScaled(i,this.m_ax);const o=this.m_impulse*this.m_sAy+i*this.m_sAx+this.m_motorImpulse,a=this.m_impulse*this.m_sBy+i*this.m_sBx+this.m_motorImpulse;n.SubtractScaled(this.m_invMassA,e),_-=this.m_invIA*o,b.AddScaled(this.m_invMassB,e),p+=this.m_invIB*a}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0,this.m_lowerImpulse=0,this.m_upperImpulse=0;t.velocities[this.m_indexA].w=_,t.velocities[this.m_indexB].w=p}SolveVelocityConstraints(t){const i=this.m_invMassA,e=this.m_invMassB,o=this.m_invIA,a=this.m_invIB,l=t.velocities[this.m_indexA].v;let h=t.velocities[this.m_indexA].w;const n=t.velocities[this.m_indexB].v;let _=t.velocities[this.m_indexB].w;const{P:r}=m;{const t=s.b2Vec2.Dot(this.m_ax,s.b2Vec2.Subtract(n,l,s.b2Vec2.s_t0))+this.m_sBx*_-this.m_sAx*h,m=-this.m_springMass*(t+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=m,s.b2Vec2.Scale(m,this.m_ax,r);const c=m*this.m_sAx,b=m*this.m_sBx;l.SubtractScaled(i,r),h-=o*c,n.AddScaled(e,r),_+=a*b}{const i=_-h-this.m_motorSpeed;let e=-this.m_motorMass*i;const m=this.m_motorImpulse,l=t.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.b2Clamp(this.m_motorImpulse+e,-l,l),h-=o*(e=this.m_motorImpulse-m),_+=a*e}if(this.m_enableLimit){{const m=this.m_translation-this.m_lowerTranslation,c=s.b2Vec2.Dot(this.m_ax,s.b2Vec2.Subtract(n,l,s.b2Vec2.s_t0))+this.m_sBx*_-this.m_sAx*h;let b=-this.m_axialMass*(c+Math.max(m,0)*t.step.inv_dt);const p=this.m_lowerImpulse;this.m_lowerImpulse=Math.max(this.m_lowerImpulse+b,0),b=this.m_lowerImpulse-p,s.b2Vec2.Scale(b,this.m_ax,r);const A=b*this.m_sAx,u=b*this.m_sBx;l.SubtractScaled(i,r),h-=o*A,n.AddScaled(e,r),_+=a*u}{const m=this.m_upperTranslation-this.m_translation,c=s.b2Vec2.Dot(this.m_ax,s.b2Vec2.Subtract(l,n,s.b2Vec2.s_t0))+this.m_sAx*h-this.m_sBx*_;let b=-this.m_axialMass*(c+Math.max(m,0)*t.step.inv_dt);const p=this.m_upperImpulse;this.m_upperImpulse=Math.max(this.m_upperImpulse+b,0),b=this.m_upperImpulse-p,s.b2Vec2.Scale(b,this.m_ax,r);const A=b*this.m_sAx,u=b*this.m_sBx;l.AddScaled(i,r),h+=o*A,n.SubtractScaled(e,r),_-=a*u}}{const t=s.b2Vec2.Dot(this.m_ay,s.b2Vec2.Subtract(n,l,s.b2Vec2.s_t0))+this.m_sBy*_-this.m_sAy*h,m=-this.m_mass*t;this.m_impulse+=m,s.b2Vec2.Scale(m,this.m_ay,r);const c=m*this.m_sAy,b=m*this.m_sBy;l.SubtractScaled(i,r),h-=o*c,n.AddScaled(e,r),_+=a*b}t.velocities[this.m_indexA].w=h,t.velocities[this.m_indexB].w=_}SolvePositionConstraints(i){const e=i.positions[this.m_indexA].c;let o=i.positions[this.m_indexA].a;const a=i.positions[this.m_indexB].c;let l=i.positions[this.m_indexB].a,h=0;const{qA:n,qB:_,lalcA:r,lalcB:c,rA:b,rB:p,d:A,P:u,ay:d}=m;if(this.m_enableLimit){n.Set(o),_.Set(l),s.b2Rot.MultiplyVec2(n,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),b),s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,c),p),s.b2Vec2.Subtract(a,e,A).Add(p).Subtract(b);const i=s.b2Rot.MultiplyVec2(n,this.m_localXAxisA,this.m_ax),m=s.b2Vec2.Cross(s.b2Vec2.Add(A,b,s.b2Vec2.s_t0),this.m_ax),d=s.b2Vec2.Cross(p,this.m_ax);let V=0;const x=s.b2Vec2.Dot(i,A);if(Math.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*t.b2_linearSlop?V=x:x<=this.m_lowerTranslation?V=Math.min(x-this.m_lowerTranslation,0):x>=this.m_upperTranslation&&(V=Math.max(x-this.m_upperTranslation,0)),0!==V){const t=this.m_invMassA+this.m_invMassB+this.m_invIA*m*m+this.m_invIB*d*d;let n=0;0!==t&&(n=-V/t),s.b2Vec2.Scale(n,i,u);const _=n*m,r=n*d;e.SubtractScaled(this.m_invMassA,u),o-=this.m_invIA*_,a.AddScaled(this.m_invMassB,u),l+=this.m_invIB*r,h=Math.abs(V)}}{n.Set(o),_.Set(l),s.b2Rot.MultiplyVec2(n,s.b2Vec2.Subtract(this.m_localAnchorA,this.m_localCenterA,r),b),s.b2Rot.MultiplyVec2(_,s.b2Vec2.Subtract(this.m_localAnchorB,this.m_localCenterB,c),p),s.b2Vec2.Subtract(a,e,A).Add(p).Subtract(b),s.b2Rot.MultiplyVec2(n,this.m_localYAxisA,d);const t=s.b2Vec2.Cross(s.b2Vec2.Add(A,b,s.b2Vec2.s_t0),d),i=s.b2Vec2.Cross(p,d),m=s.b2Vec2.Dot(A,d),V=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;let x=0;0!==V&&(x=-m/V),s.b2Vec2.Scale(x,d,u);const S=x*t,B=x*i;e.SubtractScaled(this.m_invMassA,u),o-=this.m_invIA*S,a.AddScaled(this.m_invMassB,u),l+=this.m_invIB*B,h=Math.max(h,Math.abs(m))}return i.positions[this.m_indexA].a=o,i.positions[this.m_indexB].a=l,h<=t.b2_linearSlop}GetAnchorA(t){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,t)}GetAnchorB(t){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,t)}GetReactionForce(t,s){const i=this.m_springImpulse+this.m_lowerImpulse-this.m_upperImpulse;return s.x=t*(this.m_impulse*this.m_ay.x+i*this.m_ax.x),s.y=t*(this.m_impulse*this.m_ay.y+i*this.m_ax.y),s}GetReactionTorque(t){return t*this.m_motorImpulse}GetLocalAnchorA(){return this.m_localAnchorA}GetLocalAnchorB(){return this.m_localAnchorB}GetLocalAxisA(){return this.m_localXAxisA}GetJointTranslation(){const t=this.m_bodyA,i=this.m_bodyB,{pA:e,pB:o,d:a,axis:l}=m;return t.GetWorldPoint(this.m_localAnchorA,e),i.GetWorldPoint(this.m_localAnchorB,o),s.b2Vec2.Subtract(o,e,a),t.GetWorldVector(this.m_localXAxisA,l),s.b2Vec2.Dot(a,l)}GetJointLinearSpeed(){const t=this.m_bodyA,i=this.m_bodyB,{rA:e,rB:o,lalcA:a,lalcB:l,axis:h}=m;s.b2Rot.MultiplyVec2(t.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorA,t.m_sweep.localCenter,a),e),s.b2Rot.MultiplyVec2(i.m_xf.q,s.b2Vec2.Subtract(this.m_localAnchorB,i.m_sweep.localCenter,l),o);const n=s.b2Vec2.Add(t.m_sweep.c,e,s.b2Vec2.s_t0),_=s.b2Vec2.Add(i.m_sweep.c,o,s.b2Vec2.s_t1),r=s.b2Vec2.Subtract(_,n,s.b2Vec2.s_t2);s.b2Rot.MultiplyVec2(t.m_xf.q,this.m_localXAxisA,h);const c=t.m_linearVelocity,b=i.m_linearVelocity,p=t.m_angularVelocity,A=i.m_angularVelocity;return s.b2Vec2.Dot(r,s.b2Vec2.CrossScalarVec2(p,h,s.b2Vec2.s_t0))+s.b2Vec2.Dot(h,s.b2Vec2.AddCrossScalarVec2(b,A,o,s.b2Vec2.s_t0).Subtract(c).Subtract(s.b2Vec2.CrossScalarVec2(p,e,s.b2Vec2.s_t1)))}GetJointAngle(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a}GetJointAngularSpeed(){const t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t}IsMotorEnabled(){return this.m_enableMotor}EnableMotor(t){return t!==this.m_enableMotor&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=t),t}SetMotorSpeed(t){return t!==this.m_motorSpeed&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=t),t}SetMaxMotorTorque(t){t!==this.m_maxMotorTorque&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=t)}GetMotorTorque(t){return t*this.m_motorImpulse}IsLimitEnabled(){return this.m_enableLimit}EnableLimit(t){return t!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=t,this.m_lowerImpulse=0,this.m_upperImpulse=0),t}GetLowerLimit(){return this.m_lowerTranslation}GetUpperLimit(){return this.m_upperTranslation}SetLimits(t,s){t===this.m_lowerTranslation&&s===this.m_upperTranslation||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=s,this.m_lowerImpulse=0,this.m_upperImpulse=0)}Draw(t){const{p1:i,p2:o,pA:a,pB:l,axis:h}=m.Draw,n=this.m_bodyA.GetTransform(),_=this.m_bodyB.GetTransform();if(s.b2Transform.MultiplyVec2(n,this.m_localAnchorA,a),s.b2Transform.MultiplyVec2(_,this.m_localAnchorB,l),s.b2Rot.MultiplyVec2(n.q,this.m_localXAxisA,h),t.DrawSegment(a,l,e.debugColors.joint5),this.m_enableLimit){const{lower:l,upper:_,perp:r}=m.Draw;s.b2Vec2.AddScaled(a,this.m_lowerTranslation,h,l),s.b2Vec2.AddScaled(a,this.m_upperTranslation,h,_),s.b2Rot.MultiplyVec2(n.q,this.m_localYAxisA,r),t.DrawSegment(l,_,e.debugColors.joint1),t.DrawSegment(s.b2Vec2.SubtractScaled(l,.5,r,i),s.b2Vec2.AddScaled(l,.5,r,o),e.debugColors.joint2),t.DrawSegment(s.b2Vec2.SubtractScaled(_,.5,r,i),s.b2Vec2.AddScaled(_,.5,r,o),e.debugColors.joint3)}else t.DrawSegment(s.b2Vec2.Subtract(a,h,i),s.b2Vec2.Add(a,h,o),e.debugColors.joint1);t.DrawPoint(a,5,e.debugColors.joint1),t.DrawPoint(l,5,e.debugColors.joint4)}}exports.b2WheelJoint=a;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","./b2_joint":"PxaZ","../common/b2_draw":"J87F"}],"yXDC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Contact=exports.b2ContactEdge=exports.b2MixRestitutionThreshold=exports.b2MixRestitution=exports.b2MixFriction=void 0;const t=require("../common/b2_common"),i=require("../collision/b2_collision");function e(t,i){return Math.sqrt(t*i)}function s(t,i){return t>i?t:i}function n(t,i){return t<i?t:i}exports.b2MixFriction=e,exports.b2MixRestitution=s,exports.b2MixRestitutionThreshold=n;class o{constructor(t){this.m_other=null,this.prev=null,this.next=null,this.contact=t}get other(){return t.b2Assert(null!==this.m_other),this.m_other}set other(i){t.b2Assert(null===this.m_other),this.m_other=i}Reset(){this.m_other=null,this.prev=null,this.next=null}}exports.b2ContactEdge=o;class h{constructor(){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_prev=null,this.m_next=null,this.m_nodeA=new o(this),this.m_nodeB=new o(this),this.m_indexA=0,this.m_indexB=0,this.m_manifold=new i.b2Manifold,this.m_toiCount=0,this.m_toi=0,this.m_friction=0,this.m_restitution=0,this.m_restitutionThreshold=0,this.m_tangentSpeed=0,this.m_oldManifold=new i.b2Manifold}GetManifold(){return this.m_manifold}GetWorldManifold(t){const i=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),s=this.GetShapeA(),n=this.GetShapeB();t.Initialize(this.m_manifold,i.GetTransform(),s.m_radius,e.GetTransform(),n.m_radius)}IsTouching(){return this.m_touchingFlag}SetEnabled(t){this.m_enabledFlag=t}IsEnabled(){return this.m_enabledFlag}GetNext(){return this.m_next}GetFixtureA(){return this.m_fixtureA}GetChildIndexA(){return this.m_indexA}GetShapeA(){return this.m_fixtureA.GetShape()}GetFixtureB(){return this.m_fixtureB}GetChildIndexB(){return this.m_indexB}GetShapeB(){return this.m_fixtureB.GetShape()}FlagForFiltering(){this.m_filterFlag=!0}SetFriction(t){this.m_friction=t}GetFriction(){return this.m_friction}ResetFriction(){this.m_friction=e(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)}SetRestitution(t){this.m_restitution=t}GetRestitution(){return this.m_restitution}ResetRestitution(){this.m_restitution=s(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)}SetRestitutionThreshold(t){this.m_restitutionThreshold=t}GetRestitutionThreshold(){return this.m_restitutionThreshold}ResetRestitutionThreshold(){this.m_restitutionThreshold=n(this.m_fixtureA.m_restitutionThreshold,this.m_fixtureB.m_restitutionThreshold)}SetTangentSpeed(t){this.m_tangentSpeed=t}GetTangentSpeed(){return this.m_tangentSpeed}Reset(t,i,o,h){this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_enabledFlag=!0,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.m_toiFlag=!1,this.m_fixtureA=t,this.m_fixtureB=o,this.m_indexA=i,this.m_indexB=h,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.Reset(),this.m_nodeB.Reset(),this.m_toiCount=0,this.m_friction=e(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=s(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_restitutionThreshold=n(this.m_fixtureA.m_restitutionThreshold,this.m_fixtureB.m_restitutionThreshold)}Update(t){const e=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=e,this.m_enabledFlag=!0;let s=!1;const n=this.m_touchingFlag,o=this.m_fixtureA.IsSensor(),h=this.m_fixtureB.IsSensor(),r=o||h,m=this.m_fixtureA.GetBody(),l=this.m_fixtureB.GetBody(),_=m.GetTransform(),u=l.GetTransform();if(r){const t=this.GetShapeA(),e=this.GetShapeB();s=i.b2TestOverlap(t,this.m_indexA,e,this.m_indexB,_,u),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,_,u),s=this.m_manifold.pointCount>0;for(let t=0;t<this.m_manifold.pointCount;++t){const i=this.m_manifold.points[t];i.normalImpulse=0,i.tangentImpulse=0;const e=i.id;for(let t=0;t<this.m_oldManifold.pointCount;++t){const s=this.m_oldManifold.points[t];if(s.id.key===e.key){i.normalImpulse=s.normalImpulse,i.tangentImpulse=s.tangentImpulse;break}}}s!==n&&(m.SetAwake(!0),l.SetAwake(!0))}this.m_touchingFlag=s,!n&&s&&t&&t.BeginContact(this),n&&!s&&t&&t.EndContact(this),!r&&s&&t&&t.PreSolve(this,this.m_oldManifold)}}exports.b2Contact=h;
},{"../common/b2_common":"xZSi","../collision/b2_collision":"DOG3"}],"IXQ3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2CircleContact=void 0;const e=require("../collision/b2_collide_circle"),t=require("./b2_contact");class c extends t.b2Contact{Evaluate(t,c,i){e.b2CollideCircles(t,this.GetShapeA(),c,this.GetShapeB(),i)}}exports.b2CircleContact=c;
},{"../collision/b2_collide_circle":"JHeH","./b2_contact":"yXDC"}],"DGrp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PolygonContact=void 0;const e=require("../collision/b2_collide_polygon"),o=require("./b2_contact");class t extends o.b2Contact{Evaluate(o,t,l){e.b2CollidePolygons(o,this.GetShapeA(),t,this.GetShapeB(),l)}}exports.b2PolygonContact=t;
},{"../collision/b2_collide_polygon":"FXGt","./b2_contact":"yXDC"}],"En2B":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2PolygonAndCircleContact=void 0;const e=require("../collision/b2_collide_circle"),t=require("./b2_contact");class o extends t.b2Contact{Evaluate(t,o,l){e.b2CollidePolygonAndCircle(t,this.GetShapeA(),o,this.GetShapeB(),l)}}exports.b2PolygonAndCircleContact=o;
},{"../collision/b2_collide_circle":"JHeH","./b2_contact":"yXDC"}],"laQ5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2EdgeAndCircleContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("./b2_contact");class o extends t.b2Contact{Evaluate(t,o,c){e.b2CollideEdgeAndCircle(t,this.GetShapeA(),o,this.GetShapeB(),c)}}exports.b2EdgeAndCircleContact=o;
},{"../collision/b2_collide_edge":"Xyzc","./b2_contact":"yXDC"}],"ZEo6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2EdgeAndPolygonContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("./b2_contact");class o extends t.b2Contact{Evaluate(t,o,n){e.b2CollideEdgeAndPolygon(t,this.GetShapeA(),o,this.GetShapeB(),n)}}exports.b2EdgeAndPolygonContact=o;
},{"../collision/b2_collide_edge":"Xyzc","./b2_contact":"yXDC"}],"aagP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ChainAndCircleContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("../collision/b2_edge_shape"),i=require("./b2_contact");class s extends i.b2Contact{Evaluate(t,i,a){const d=s.Evaluate_s_edge;this.GetShapeA().GetChildEdge(d,this.m_indexA),e.b2CollideEdgeAndCircle(t,d,i,this.GetShapeB(),a)}}exports.b2ChainAndCircleContact=s,s.Evaluate_s_edge=new t.b2EdgeShape;
},{"../collision/b2_collide_edge":"Xyzc","../collision/b2_edge_shape":"xXrv","./b2_contact":"yXDC"}],"B22y":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ChainAndPolygonContact=void 0;const e=require("../collision/b2_collide_edge"),t=require("../collision/b2_edge_shape"),o=require("./b2_contact");class n extends o.b2Contact{Evaluate(t,o,i){const s=n.Evaluate_s_edge;this.GetShapeA().GetChildEdge(s,this.m_indexA),e.b2CollideEdgeAndPolygon(t,s,o,this.GetShapeB(),i)}}exports.b2ChainAndPolygonContact=n,n.Evaluate_s_edge=new t.b2EdgeShape;
},{"../collision/b2_collide_edge":"Xyzc","../collision/b2_edge_shape":"xXrv","./b2_contact":"yXDC"}],"VHzU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactFactory=void 0;const e=require("../collision/b2_shape"),t=require("./b2_circle_contact"),c=require("./b2_polygon_contact"),o=require("./b2_polygon_circle_contact"),r=require("./b2_edge_circle_contact"),n=require("./b2_edge_polygon_contact"),p=require("./b2_chain_circle_contact"),y=require("./b2_chain_polygon_contact");class i{constructor(){const i=new Array(e.b2ShapeType.e_typeCount);for(let t=0;t<e.b2ShapeType.e_typeCount;t++)i[t]=new Array(e.b2ShapeType.e_typeCount);this.m_registers=i,this.AddType(t.b2CircleContact,e.b2ShapeType.e_circle,e.b2ShapeType.e_circle),this.AddType(o.b2PolygonAndCircleContact,e.b2ShapeType.e_polygon,e.b2ShapeType.e_circle),this.AddType(c.b2PolygonContact,e.b2ShapeType.e_polygon,e.b2ShapeType.e_polygon),this.AddType(r.b2EdgeAndCircleContact,e.b2ShapeType.e_edge,e.b2ShapeType.e_circle),this.AddType(n.b2EdgeAndPolygonContact,e.b2ShapeType.e_edge,e.b2ShapeType.e_polygon),this.AddType(p.b2ChainAndCircleContact,e.b2ShapeType.e_chain,e.b2ShapeType.e_circle),this.AddType(y.b2ChainAndPolygonContact,e.b2ShapeType.e_chain,e.b2ShapeType.e_polygon)}AddType(e,t,c){const o=[],r=e=>{o.push(e)};this.m_registers[t][c]={createFcn(t,c,r,n){var p;const y=null!==(p=o.pop())&&void 0!==p?p:new e;return y.Reset(t,c,r,n),y},destroyFcn:r},t!==c&&(this.m_registers[c][t]={createFcn(t,c,r,n){var p;const y=null!==(p=o.pop())&&void 0!==p?p:new e;return y.Reset(r,n,t,c),y},destroyFcn:r})}Create(e,t,c,o){const r=e.GetType(),n=c.GetType(),p=this.m_registers[r][n];return p?p.createFcn(e,t,c,o):null}Destroy(e){const t=e.m_fixtureA.GetType(),c=e.m_fixtureB.GetType(),o=this.m_registers[t][c];null==o||o.destroyFcn(e)}}exports.b2ContactFactory=i;
},{"../collision/b2_shape":"QXiX","./b2_circle_contact":"IXQ3","./b2_polygon_contact":"DGrp","./b2_polygon_circle_contact":"En2B","./b2_edge_circle_contact":"laQ5","./b2_edge_polygon_contact":"ZEo6","./b2_chain_circle_contact":"aagP","./b2_chain_polygon_contact":"B22y"}],"pQVy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactListener=exports.b2ContactImpulse=exports.b2ContactFilter=exports.b2DestructionListener=void 0;const t=require("../common/b2_common");class e{SayGoodbyeJoint(t){}SayGoodbyeFixture(t){}}exports.b2DestructionListener=e;class o{ShouldCollide(t,e){const o=t.GetFilterData(),s=e.GetFilterData();return o.groupIndex===s.groupIndex&&0!==o.groupIndex?o.groupIndex>0:0!=(o.maskBits&s.categoryBits)&&0!=(o.categoryBits&s.maskBits)}}exports.b2ContactFilter=o,o.b2_defaultFilter=new o;class s{constructor(){this.normalImpulses=t.b2MakeNumberArray(t.b2_maxManifoldPoints),this.tangentImpulses=t.b2MakeNumberArray(t.b2_maxManifoldPoints),this.count=0}}exports.b2ContactImpulse=s;class r{BeginContact(t){}EndContact(t){}PreSolve(t,e){}PostSolve(t,e){}}exports.b2ContactListener=r,r.b2_defaultListener=new r;
},{"../common/b2_common":"xZSi"}],"up2J":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactManager=void 0;const t=require("../collision/b2_broad_phase"),e=require("./b2_contact_factory"),n=require("./b2_body"),o=require("./b2_world_callbacks");class i{constructor(){this.m_broadPhase=new t.b2BroadPhase,this.m_contactList=null,this.m_contactCount=0,this.m_contactFilter=o.b2ContactFilter.b2_defaultFilter,this.m_contactListener=o.b2ContactListener.b2_defaultListener,this.m_contactFactory=new e.b2ContactFactory,this.AddPair=((t,e)=>{let n=t.fixture,o=e.fixture,i=t.childIndex,c=e.childIndex,r=n.GetBody(),_=o.GetBody();if(r===_)return;let s=_.GetContactList();for(;s;){if(s.other===r){const t=s.contact.GetFixtureA(),e=s.contact.GetFixtureB(),r=s.contact.GetChildIndexA(),_=s.contact.GetChildIndexB();if(t===n&&e===o&&r===i&&_===c)return;if(t===o&&e===n&&r===c&&_===i)return}s=s.next}if(!1===_.ShouldCollide(r))return;if(this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(n,o))return;const a=this.m_contactFactory.Create(n,i,o,c);null!==a&&(n=a.GetFixtureA(),o=a.GetFixtureB(),i=a.GetChildIndexA(),c=a.GetChildIndexB(),r=n.m_body,_=o.m_body,a.m_prev=null,a.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=a),this.m_contactList=a,a.m_nodeA.other=_,a.m_nodeA.prev=null,a.m_nodeA.next=r.m_contactList,null!==r.m_contactList&&(r.m_contactList.prev=a.m_nodeA),r.m_contactList=a.m_nodeA,a.m_nodeB.other=r,a.m_nodeB.prev=null,a.m_nodeB.next=_.m_contactList,null!==_.m_contactList&&(_.m_contactList.prev=a.m_nodeB),_.m_contactList=a.m_nodeB,++this.m_contactCount)})}FindNewContacts(){this.m_broadPhase.UpdatePairs(this.AddPair)}Destroy(t){const e=t.GetFixtureA(),n=t.GetFixtureB(),o=e.GetBody(),i=n.GetBody();this.m_contactListener&&t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_contactList&&(this.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===i.m_contactList&&(i.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&!e.IsSensor()&&!n.IsSensor()&&(e.GetBody().SetAwake(!0),n.GetBody().SetAwake(!0)),this.m_contactFactory.Destroy(t),--this.m_contactCount}Collide(){let t=this.m_contactList;for(;t;){const e=t.GetFixtureA(),o=t.GetFixtureB(),i=t.GetChildIndexA(),c=t.GetChildIndexB(),r=e.GetBody(),_=o.GetBody();if(t.m_filterFlag){if(!_.ShouldCollide(r)||this.m_contactFilter&&!this.m_contactFilter.ShouldCollide(e,o)){const e=t;t=e.m_next,this.Destroy(e);continue}t.m_filterFlag=!1}const s=r.IsAwake()&&r.m_type!==n.b2BodyType.b2_staticBody,a=_.IsAwake()&&_.m_type!==n.b2BodyType.b2_staticBody;if(!s&&!a){t=t.m_next;continue}const m=e.m_proxies[i].treeNode,d=o.m_proxies[c].treeNode;if(m.aabb.TestOverlap(d.aabb))t.Update(this.m_contactListener),t=t.m_next;else{const e=t;t=e.m_next,this.Destroy(e)}}}}exports.b2ContactManager=i;
},{"../collision/b2_broad_phase":"r8Yy","./b2_contact_factory":"VHzU","./b2_body":"hxRe","./b2_world_callbacks":"pQVy"}],"RCRk":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2SolverData=exports.b2Velocity=exports.b2Position=exports.b2TimeStep=exports.b2Profile=void 0;const t=require("../common/b2_math");class s{constructor(){this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0}Reset(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this}}exports.b2Profile=s;class i{constructor(){this.dt=0,this.inv_dt=0,this.dtRatio=0,this.config={velocityIterations:0,positionIterations:0},this.warmStarting=!1}static Create(){return new i}Copy(t){return this.dt=t.dt,this.inv_dt=t.inv_dt,this.dtRatio=t.dtRatio,this.config={...t.config},this.warmStarting=t.warmStarting,this}}exports.b2TimeStep=i;class o{constructor(){this.c=new t.b2Vec2,this.a=0}}exports.b2Position=o;class e{constructor(){this.v=new t.b2Vec2,this.w=0}}exports.b2Velocity=e;class r{constructor(){this.step=i.Create()}}exports.b2SolverData=r;
},{"../common/b2_math":"YmMi"}],"ZGZd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2ContactSolver=exports.b2ContactSolverDef=exports.b2ContactVelocityConstraint=exports.b2GetBlockSolve=exports.b2SetBlockSolve=void 0;const t=require("../common/b2_common"),s=require("../common/b2_math"),o=require("../collision/b2_collision"),e=require("./b2_time_step");let i=!0;function n(t){i=t}function a(){return i}exports.b2SetBlockSolve=n,exports.b2GetBlockSolve=a;class c{constructor(){this.rA=new s.b2Vec2,this.rB=new s.b2Vec2,this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}}class r{constructor(){this.points=t.b2MakeArray(t.b2_maxManifoldPoints,c),this.normal=new s.b2Vec2,this.tangent=new s.b2Vec2,this.normalMass=new s.b2Mat22,this.K=new s.b2Mat22,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.invIA=0,this.invIB=0,this.friction=0,this.restitution=0,this.threshold=0,this.tangentSpeed=0,this.pointCount=0,this.contactIndex=0}}exports.b2ContactVelocityConstraint=r;class l{constructor(){this.localPoints=t.b2MakeArray(t.b2_maxManifoldPoints,s.b2Vec2),this.localNormal=new s.b2Vec2,this.localPoint=new s.b2Vec2,this.indexA=0,this.indexB=0,this.invMassA=0,this.invMassB=0,this.localCenterA=new s.b2Vec2,this.localCenterB=new s.b2Vec2,this.invIA=0,this.invIB=0,this.type=o.b2ManifoldType.e_circles,this.radiusA=0,this.radiusB=0,this.pointCount=0}}class _{constructor(){this.step=e.b2TimeStep.Create(),this.count=0}}exports.b2ContactSolverDef=_;class b{constructor(){this.normal=new s.b2Vec2,this.point=new s.b2Vec2,this.separation=0}Initialize(t,e,i,n){const a=b.Initialize_s_pointA,c=b.Initialize_s_pointB,r=b.Initialize_s_planePoint,l=b.Initialize_s_clipPoint;switch(t.type){case o.b2ManifoldType.e_circles:s.b2Transform.MultiplyVec2(e,t.localPoint,a),s.b2Transform.MultiplyVec2(i,t.localPoints[0],c),s.b2Vec2.Subtract(c,a,this.normal).Normalize(),s.b2Vec2.Mid(a,c,this.point),this.separation=s.b2Vec2.Dot(s.b2Vec2.Subtract(c,a,s.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB;break;case o.b2ManifoldType.e_faceA:s.b2Rot.MultiplyVec2(e.q,t.localNormal,this.normal),s.b2Transform.MultiplyVec2(e,t.localPoint,r),s.b2Transform.MultiplyVec2(i,t.localPoints[n],l),this.separation=s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB,this.point.Copy(l);break;case o.b2ManifoldType.e_faceB:s.b2Rot.MultiplyVec2(i.q,t.localNormal,this.normal),s.b2Transform.MultiplyVec2(i,t.localPoint,r),s.b2Transform.MultiplyVec2(e,t.localPoints[n],l),this.separation=s.b2Vec2.Dot(s.b2Vec2.Subtract(l,r,s.b2Vec2.s_t0),this.normal)-t.radiusA-t.radiusB,this.point.Copy(l),this.normal.Negate()}}}b.Initialize_s_pointA=new s.b2Vec2,b.Initialize_s_pointB=new s.b2Vec2,b.Initialize_s_planePoint=new s.b2Vec2,b.Initialize_s_clipPoint=new s.b2Vec2;class m{constructor(){this.m_step=e.b2TimeStep.Create(),this.m_positionConstraints=t.b2MakeArray(1024,l),this.m_velocityConstraints=t.b2MakeArray(1024,r),this.m_count=0}Initialize(t){if(this.m_step.Copy(t.step),this.m_count=t.count,this.m_positionConstraints.length<this.m_count){const t=Math.max(2*this.m_positionConstraints.length,this.m_count);for(;this.m_positionConstraints.length<t;)this.m_positionConstraints[this.m_positionConstraints.length]=new l}if(this.m_velocityConstraints.length<this.m_count){const t=Math.max(2*this.m_velocityConstraints.length,this.m_count);for(;this.m_velocityConstraints.length<t;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new r}this.m_positions=t.positions,this.m_velocities=t.velocities,this.m_contacts=t.contacts;for(let s=0;s<this.m_count;++s){const t=this.m_contacts[s],o=t.m_fixtureA,e=t.m_fixtureB,i=o.GetShape(),n=e.GetShape(),a=i.m_radius,c=n.m_radius,r=o.GetBody(),l=e.GetBody(),_=t.GetManifold(),{pointCount:b}=_,m=this.m_velocityConstraints[s];m.friction=t.m_friction,m.restitution=t.m_restitution,m.threshold=t.m_restitutionThreshold,m.tangentSpeed=t.m_tangentSpeed,m.indexA=r.m_islandIndex,m.indexB=l.m_islandIndex,m.invMassA=r.m_invMass,m.invMassB=l.m_invMass,m.invIA=r.m_invI,m.invIB=l.m_invI,m.contactIndex=s,m.pointCount=b,m.K.SetZero(),m.normalMass.SetZero();const V=this.m_positionConstraints[s];V.indexA=r.m_islandIndex,V.indexB=l.m_islandIndex,V.invMassA=r.m_invMass,V.invMassB=l.m_invMass,V.localCenterA.Copy(r.m_sweep.localCenter),V.localCenterB.Copy(l.m_sweep.localCenter),V.invIA=r.m_invI,V.invIB=l.m_invI,V.localNormal.Copy(_.localNormal),V.localPoint.Copy(_.localPoint),V.pointCount=b,V.radiusA=a,V.radiusB=c,V.type=_.type;for(let s=0;s<b;++s){const t=_.points[s],o=m.points[s];this.m_step.warmStarting?(o.normalImpulse=this.m_step.dtRatio*t.normalImpulse,o.tangentImpulse=this.m_step.dtRatio*t.tangentImpulse):(o.normalImpulse=0,o.tangentImpulse=0),o.rA.SetZero(),o.rB.SetZero(),o.normalMass=0,o.tangentMass=0,o.velocityBias=0,V.localPoints[s].Copy(t.localPoint)}}return this}InitializeVelocityConstraints(){const t=m.InitializeVelocityConstraints_s_xfA,o=m.InitializeVelocityConstraints_s_xfB,e=m.InitializeVelocityConstraints_s_worldManifold;for(let n=0;n<this.m_count;++n){const a=this.m_velocityConstraints[n],c=this.m_positionConstraints[n],{radiusA:r,radiusB:l,localCenterA:_,localCenterB:b}=c,m=this.m_contacts[a.contactIndex].GetManifold(),{indexA:V,indexB:p,tangent:C,pointCount:S}=a,h=a.invMassA,u=a.invMassB,v=a.invIA,d=a.invIB,y=this.m_positions[V].c,A=this.m_positions[V].a,I=this.m_velocities[V].v,B=this.m_velocities[V].w,x=this.m_positions[p].c,M=this.m_positions[p].a,f=this.m_velocities[p].v,w=this.m_velocities[p].w;t.q.Set(A),o.q.Set(M),s.b2Vec2.Subtract(y,s.b2Rot.MultiplyVec2(t.q,_,s.b2Vec2.s_t0),t.p),s.b2Vec2.Subtract(x,s.b2Rot.MultiplyVec2(o.q,b,s.b2Vec2.s_t0),o.p),e.Initialize(m,t,r,o,l),a.normal.Copy(e.normal),s.b2Vec2.CrossVec2One(a.normal,C);for(let t=0;t<S;++t){const o=a.points[t];s.b2Vec2.Subtract(e.points[t],y,o.rA),s.b2Vec2.Subtract(e.points[t],x,o.rB);const i=s.b2Vec2.Cross(o.rA,a.normal),n=s.b2Vec2.Cross(o.rB,a.normal),c=h+u+v*i*i+d*n*n;o.normalMass=c>0?1/c:0;const r=s.b2Vec2.Cross(o.rA,C),l=s.b2Vec2.Cross(o.rB,C),_=h+u+v*r*r+d*l*l;o.tangentMass=_>0?1/_:0,o.velocityBias=0;const b=s.b2Vec2.Dot(a.normal,s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,o.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(I,B,o.rA,s.b2Vec2.s_t1),s.b2Vec2.s_t0));b<-a.threshold&&(o.velocityBias=-a.restitution*b)}if(2===a.pointCount&&i){const t=a.points[0],o=a.points[1],e=s.b2Vec2.Cross(t.rA,a.normal),i=s.b2Vec2.Cross(t.rB,a.normal),n=s.b2Vec2.Cross(o.rA,a.normal),c=s.b2Vec2.Cross(o.rB,a.normal),r=h+u+v*e*e+d*i*i,l=h+u+v*n*n+d*c*c,_=h+u+v*e*n+d*i*c;r*r<1e3*(r*l-_*_)?(a.K.ex.Set(r,_),a.K.ey.Set(_,l),a.K.GetInverse(a.normalMass)):a.pointCount=1}}}WarmStart(){const t=m.WarmStart_s_P;for(let o=0;o<this.m_count;++o){const e=this.m_velocityConstraints[o],{indexA:i,indexB:n,pointCount:a,normal:c,tangent:r}=e,l=e.invMassA,_=e.invIA,b=e.invMassB,m=e.invIB,V=this.m_velocities[i].v;let p=this.m_velocities[i].w;const C=this.m_velocities[n].v;let S=this.m_velocities[n].w;for(let o=0;o<a;++o){const i=e.points[o];s.b2Vec2.Add(s.b2Vec2.Scale(i.normalImpulse,c,s.b2Vec2.s_t0),s.b2Vec2.Scale(i.tangentImpulse,r,s.b2Vec2.s_t1),t),p-=_*s.b2Vec2.Cross(i.rA,t),V.SubtractScaled(l,t),S+=m*s.b2Vec2.Cross(i.rB,t),C.AddScaled(b,t)}this.m_velocities[i].w=p,this.m_velocities[n].w=S}}SolveVelocityConstraints(){const t=m.SolveVelocityConstraints_s_dv,o=m.SolveVelocityConstraints_s_dv1,e=m.SolveVelocityConstraints_s_dv2,n=m.SolveVelocityConstraints_s_P,a=m.SolveVelocityConstraints_s_a,c=m.SolveVelocityConstraints_s_b,r=m.SolveVelocityConstraints_s_x,l=m.SolveVelocityConstraints_s_d,_=m.SolveVelocityConstraints_s_P1,b=m.SolveVelocityConstraints_s_P2,V=m.SolveVelocityConstraints_s_P1P2;for(let m=0;m<this.m_count;++m){const p=this.m_velocityConstraints[m],{indexA:C,indexB:S,pointCount:h,normal:u,tangent:v,friction:d}=p,y=p.invMassA,A=p.invIA,I=p.invMassB,B=p.invIB,x=this.m_velocities[C].v;let M=this.m_velocities[C].w;const f=this.m_velocities[S].v;let w=this.m_velocities[S].w;for(let o=0;o<h;++o){const e=p.points[o];s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,e.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,e.rA,s.b2Vec2.s_t1),t);const i=s.b2Vec2.Dot(t,v)-p.tangentSpeed;let a=e.tangentMass*-i;const c=d*e.normalImpulse,r=s.b2Clamp(e.tangentImpulse+a,-c,c);a=r-e.tangentImpulse,e.tangentImpulse=r,s.b2Vec2.Scale(a,v,n),x.SubtractScaled(y,n),M-=A*s.b2Vec2.Cross(e.rA,n),f.AddScaled(I,n),w+=B*s.b2Vec2.Cross(e.rB,n)}if(1===p.pointCount||!1===i)for(let o=0;o<h;++o){const e=p.points[o];s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,e.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,e.rA,s.b2Vec2.s_t1),t);const i=s.b2Vec2.Dot(t,u);let a=-e.normalMass*(i-e.velocityBias);const c=Math.max(e.normalImpulse+a,0);a=c-e.normalImpulse,e.normalImpulse=c,s.b2Vec2.Scale(a,u,n),x.SubtractScaled(y,n),M-=A*s.b2Vec2.Cross(e.rA,n),f.AddScaled(I,n),w+=B*s.b2Vec2.Cross(e.rB,n)}else{const t=p.points[0],i=p.points[1];a.Set(t.normalImpulse,i.normalImpulse),s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,t.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,t.rA,s.b2Vec2.s_t1),o),s.b2Vec2.Subtract(s.b2Vec2.AddCrossScalarVec2(f,w,i.rB,s.b2Vec2.s_t0),s.b2Vec2.AddCrossScalarVec2(x,M,i.rA,s.b2Vec2.s_t1),e);let n=s.b2Vec2.Dot(o,u),m=s.b2Vec2.Dot(e,u);for(c.x=n-t.velocityBias,c.y=m-i.velocityBias,c.Subtract(s.b2Mat22.MultiplyVec2(p.K,a,s.b2Vec2.s_t0));;){if(s.b2Mat22.MultiplyVec2(p.normalMass,c,r).Negate(),r.x>=0&&r.y>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}if(r.x=-t.normalMass*c.x,r.y=0,n=0,m=p.K.ex.y*r.x+c.y,r.x>=0&&m>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}if(r.x=0,r.y=-i.normalMass*c.y,n=p.K.ey.x*r.y+c.x,m=0,r.y>=0&&n>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}if(r.x=0,r.y=0,n=c.x,m=c.y,n>=0&&m>=0){s.b2Vec2.Subtract(r,a,l),s.b2Vec2.Scale(l.x,u,_),s.b2Vec2.Scale(l.y,u,b),s.b2Vec2.Add(_,b,V),x.SubtractScaled(y,V),M-=A*(s.b2Vec2.Cross(t.rA,_)+s.b2Vec2.Cross(i.rA,b)),f.AddScaled(I,V),w+=B*(s.b2Vec2.Cross(t.rB,_)+s.b2Vec2.Cross(i.rB,b)),t.normalImpulse=r.x,i.normalImpulse=r.y;break}break}}this.m_velocities[C].w=M,this.m_velocities[S].w=w}}StoreImpulses(){for(let t=0;t<this.m_count;++t){const s=this.m_velocityConstraints[t],o=this.m_contacts[s.contactIndex].GetManifold();for(let t=0;t<s.pointCount;++t)o.points[t].normalImpulse=s.points[t].normalImpulse,o.points[t].tangentImpulse=s.points[t].tangentImpulse}}SolvePositionConstraints(){const o=m.SolvePositionConstraints_s_xfA,e=m.SolvePositionConstraints_s_xfB,i=m.SolvePositionConstraints_s_psm,n=m.SolvePositionConstraints_s_rA,a=m.SolvePositionConstraints_s_rB,c=m.SolvePositionConstraints_s_P;let r=0;for(let l=0;l<this.m_count;++l){const _=this.m_positionConstraints[l],{indexA:b,indexB:m,localCenterA:V,localCenterB:p,pointCount:C}=_,S=_.invMassA,h=_.invIA,u=_.invMassB,v=_.invIB,d=this.m_positions[b].c;let y=this.m_positions[b].a;const A=this.m_positions[m].c;let I=this.m_positions[m].a;for(let l=0;l<C;++l){o.q.Set(y),e.q.Set(I),s.b2Vec2.Subtract(d,s.b2Rot.MultiplyVec2(o.q,V,s.b2Vec2.s_t0),o.p),s.b2Vec2.Subtract(A,s.b2Rot.MultiplyVec2(e.q,p,s.b2Vec2.s_t0),e.p),i.Initialize(_,o,e,l);const{normal:b,point:m,separation:C}=i;s.b2Vec2.Subtract(m,d,n),s.b2Vec2.Subtract(m,A,a),r=Math.min(r,C);const B=s.b2Clamp(t.b2_baumgarte*(C+t.b2_linearSlop),-t.b2_maxLinearCorrection,0),x=s.b2Vec2.Cross(n,b),M=s.b2Vec2.Cross(a,b),f=S+u+h*x*x+v*M*M,w=f>0?-B/f:0;s.b2Vec2.Scale(w,b,c),d.SubtractScaled(S,c),y-=h*s.b2Vec2.Cross(n,c),A.AddScaled(u,c),I+=v*s.b2Vec2.Cross(a,c)}this.m_positions[b].c.Copy(d),this.m_positions[b].a=y,this.m_positions[m].c.Copy(A),this.m_positions[m].a=I}return r>=-3*t.b2_linearSlop}SolveTOIPositionConstraints(o,e){const i=m.SolveTOIPositionConstraints_s_xfA,n=m.SolveTOIPositionConstraints_s_xfB,a=m.SolveTOIPositionConstraints_s_psm,c=m.SolveTOIPositionConstraints_s_rA,r=m.SolveTOIPositionConstraints_s_rB,l=m.SolveTOIPositionConstraints_s_P;let _=0;for(let b=0;b<this.m_count;++b){const m=this.m_positionConstraints[b],{indexA:V,indexB:p,localCenterA:C,localCenterB:S,pointCount:h}=m;let u=0,v=0;V!==o&&V!==e||(u=m.invMassA,v=m.invIA);let d=0,y=0;p!==o&&p!==e||(d=m.invMassB,y=m.invIB);const A=this.m_positions[V].c;let I=this.m_positions[V].a;const B=this.m_positions[p].c;let x=this.m_positions[p].a;for(let o=0;o<h;++o){i.q.Set(I),n.q.Set(x),s.b2Vec2.Subtract(A,s.b2Rot.MultiplyVec2(i.q,C,s.b2Vec2.s_t0),i.p),s.b2Vec2.Subtract(B,s.b2Rot.MultiplyVec2(n.q,S,s.b2Vec2.s_t0),n.p),a.Initialize(m,i,n,o);const{normal:e,point:b,separation:V}=a;s.b2Vec2.Subtract(b,A,c),s.b2Vec2.Subtract(b,B,r),_=Math.min(_,V);const p=s.b2Clamp(t.b2_toiBaumgarte*(V+t.b2_linearSlop),-t.b2_maxLinearCorrection,0),h=s.b2Vec2.Cross(c,e),M=s.b2Vec2.Cross(r,e),f=u+d+v*h*h+y*M*M,w=f>0?-p/f:0;s.b2Vec2.Scale(w,e,l),A.SubtractScaled(u,l),I-=v*s.b2Vec2.Cross(c,l),B.AddScaled(d,l),x+=y*s.b2Vec2.Cross(r,l)}this.m_positions[V].a=I,this.m_positions[p].a=x}return _>=-1.5*t.b2_linearSlop}}exports.b2ContactSolver=m,m.InitializeVelocityConstraints_s_xfA=new s.b2Transform,m.InitializeVelocityConstraints_s_xfB=new s.b2Transform,m.InitializeVelocityConstraints_s_worldManifold=new o.b2WorldManifold,m.WarmStart_s_P=new s.b2Vec2,m.SolveVelocityConstraints_s_dv=new s.b2Vec2,m.SolveVelocityConstraints_s_dv1=new s.b2Vec2,m.SolveVelocityConstraints_s_dv2=new s.b2Vec2,m.SolveVelocityConstraints_s_P=new s.b2Vec2,m.SolveVelocityConstraints_s_a=new s.b2Vec2,m.SolveVelocityConstraints_s_b=new s.b2Vec2,m.SolveVelocityConstraints_s_x=new s.b2Vec2,m.SolveVelocityConstraints_s_d=new s.b2Vec2,m.SolveVelocityConstraints_s_P1=new s.b2Vec2,m.SolveVelocityConstraints_s_P2=new s.b2Vec2,m.SolveVelocityConstraints_s_P1P2=new s.b2Vec2,m.SolvePositionConstraints_s_xfA=new s.b2Transform,m.SolvePositionConstraints_s_xfB=new s.b2Transform,m.SolvePositionConstraints_s_psm=new b,m.SolvePositionConstraints_s_rA=new s.b2Vec2,m.SolvePositionConstraints_s_rB=new s.b2Vec2,m.SolvePositionConstraints_s_P=new s.b2Vec2,m.SolveTOIPositionConstraints_s_xfA=new s.b2Transform,m.SolveTOIPositionConstraints_s_xfB=new s.b2Transform,m.SolveTOIPositionConstraints_s_psm=new b,m.SolveTOIPositionConstraints_s_rA=new s.b2Vec2,m.SolveTOIPositionConstraints_s_rB=new s.b2Vec2,m.SolveTOIPositionConstraints_s_P=new s.b2Vec2;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","../collision/b2_collision":"DOG3","./b2_time_step":"RCRk"}],"zv4G":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Island=void 0;const t=require("../common/b2_common"),o=require("../common/b2_math"),i=require("../common/b2_timer"),s=require("./b2_contact_solver"),e=require("./b2_body"),n=require("./b2_time_step"),a=require("./b2_world_callbacks");class m{constructor(o,i,s,e){this.m_bodyCount=0,this.m_jointCount=0,this.m_contactCount=0,this.m_bodyCapacity=o,this.m_listener=e,this.m_bodies=new Array(o),this.m_contacts=new Array(i),this.m_joints=new Array(s),this.m_velocities=t.b2MakeArray(o,n.b2Velocity),this.m_positions=t.b2MakeArray(o,n.b2Position),this.Resize(o)}Resize(t){for(;this.m_bodyCapacity<t;)this.m_velocities[this.m_bodyCapacity]=new n.b2Velocity,this.m_positions[this.m_bodyCapacity]=new n.b2Position,this.m_bodyCapacity++}Clear(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}AddBody(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount]=t,++this.m_bodyCount}AddContact(t){this.m_contacts[this.m_contactCount++]=t}AddJoint(t){this.m_joints[this.m_jointCount++]=t}Solve(i,s,n,a){const c=m.s_timer.Reset(),_=s.dt;for(let t=0;t<this.m_bodyCount;++t){const o=this.m_bodies[t];this.m_positions[t].c.Copy(o.m_sweep.c);const{a:i}=o.m_sweep,s=this.m_velocities[t].v.Copy(o.m_linearVelocity);let a=o.m_angularVelocity;o.m_sweep.c0.Copy(o.m_sweep.c),o.m_sweep.a0=o.m_sweep.a,o.m_type===e.b2BodyType.b2_dynamicBody&&(s.x+=_*o.m_invMass*(o.m_gravityScale*o.m_mass*n.x+o.m_force.x),s.y+=_*o.m_invMass*(o.m_gravityScale*o.m_mass*n.y+o.m_force.y),a+=_*o.m_invI*o.m_torque,s.Scale(1/(1+_*o.m_linearDamping)),a*=1/(1+_*o.m_angularDamping)),this.m_positions[t].a=i,this.m_velocities[t].w=a}c.Reset();const l=m.s_solverData;l.step.Copy(s),l.positions=this.m_positions,l.velocities=this.m_velocities;const r=m.s_contactSolverDef;r.step.Copy(s),r.contacts=this.m_contacts,r.count=this.m_contactCount,r.positions=this.m_positions,r.velocities=this.m_velocities;const h=m.s_contactSolver.Initialize(r);h.InitializeVelocityConstraints(),s.warmStarting&&h.WarmStart();for(let t=0;t<this.m_jointCount;++t)this.m_joints[t].InitVelocityConstraints(l);i.solveInit=c.GetMilliseconds(),c.Reset();for(let t=0;t<s.config.velocityIterations;++t){for(let t=0;t<this.m_jointCount;++t)this.m_joints[t].SolveVelocityConstraints(l);h.SolveVelocityConstraints()}h.StoreImpulses(),i.solveVelocity=c.GetMilliseconds();for(let e=0;e<this.m_bodyCount;++e){const{c:i}=this.m_positions[e];let{a:s}=this.m_positions[e];const{v:n}=this.m_velocities[e];let{w:a}=this.m_velocities[e];const c=o.b2Vec2.Scale(_,n,m.s_translation);if(o.b2Vec2.Dot(c,c)>t.b2_maxTranslationSquared){const o=t.b2_maxTranslation/c.Length();n.Scale(o)}const l=_*a;if(l*l>t.b2_maxRotationSquared){a*=t.b2_maxRotation/Math.abs(l)}i.AddScaled(_,n),s+=_*a,this.m_positions[e].a=s,this.m_velocities[e].w=a}c.Reset();let p=!1;for(let t=0;t<s.config.positionIterations;++t){const t=h.SolvePositionConstraints();let o=!0;for(let i=0;i<this.m_jointCount;++i){const t=this.m_joints[i].SolvePositionConstraints(l);o=o&&t}if(t&&o){p=!0;break}}for(let t=0;t<this.m_bodyCount;++t){const o=this.m_bodies[t];o.m_sweep.c.Copy(this.m_positions[t].c),o.m_sweep.a=this.m_positions[t].a,o.m_linearVelocity.Copy(this.m_velocities[t].v),o.m_angularVelocity=this.m_velocities[t].w,o.SynchronizeTransform()}if(i.solvePosition=c.GetMilliseconds(),this.Report(h.m_velocityConstraints),a){let i=t.b2_maxFloat;const s=t.b2_linearSleepTolerance*t.b2_linearSleepTolerance,n=t.b2_angularSleepTolerance*t.b2_angularSleepTolerance;for(let t=0;t<this.m_bodyCount;++t){const a=this.m_bodies[t];a.GetType()!==e.b2BodyType.b2_staticBody&&(!a.m_autoSleepFlag||a.m_angularVelocity*a.m_angularVelocity>n||o.b2Vec2.Dot(a.m_linearVelocity,a.m_linearVelocity)>s?(a.m_sleepTime=0,i=0):(a.m_sleepTime+=_,i=Math.min(i,a.m_sleepTime)))}if(i>=t.b2_timeToSleep&&p)for(let t=0;t<this.m_bodyCount;++t){this.m_bodies[t].SetAwake(!1)}}}SolveTOI(i,s,e){for(let t=0;t<this.m_bodyCount;++t){const o=this.m_bodies[t];this.m_positions[t].c.Copy(o.m_sweep.c),this.m_positions[t].a=o.m_sweep.a,this.m_velocities[t].v.Copy(o.m_linearVelocity),this.m_velocities[t].w=o.m_angularVelocity}const n=m.s_contactSolverDef;n.contacts=this.m_contacts,n.count=this.m_contactCount,n.step.Copy(i),n.positions=this.m_positions,n.velocities=this.m_velocities;const a=m.s_contactSolver.Initialize(n);for(let t=0;t<i.config.positionIterations;++t){if(a.SolveTOIPositionConstraints(s,e))break}this.m_bodies[s].m_sweep.c0.Copy(this.m_positions[s].c),this.m_bodies[s].m_sweep.a0=this.m_positions[s].a,this.m_bodies[e].m_sweep.c0.Copy(this.m_positions[e].c),this.m_bodies[e].m_sweep.a0=this.m_positions[e].a,a.InitializeVelocityConstraints();for(let t=0;t<i.config.velocityIterations;++t)a.SolveVelocityConstraints();const c=i.dt;for(let _=0;_<this.m_bodyCount;++_){const{c:i}=this.m_positions[_];let{a:s}=this.m_positions[_];const{v:e}=this.m_velocities[_];let{w:n}=this.m_velocities[_];const a=o.b2Vec2.Scale(c,e,m.s_translation);if(o.b2Vec2.Dot(a,a)>t.b2_maxTranslationSquared){const o=t.b2_maxTranslation/a.Length();e.Scale(o)}const l=c*n;if(l*l>t.b2_maxRotationSquared){n*=t.b2_maxRotation/Math.abs(l)}i.AddScaled(c,e),s+=c*n,this.m_positions[_].a=s,this.m_velocities[_].w=n;const r=this.m_bodies[_];r.m_sweep.c.Copy(i),r.m_sweep.a=s,r.m_linearVelocity.Copy(e),r.m_angularVelocity=n,r.SynchronizeTransform()}this.Report(a.m_velocityConstraints)}Report(t){for(let o=0;o<this.m_contactCount;++o){const i=this.m_contacts[o],s=t[o],e=m.s_impulse;e.count=s.pointCount;for(let t=0;t<s.pointCount;++t)e.normalImpulses[t]=s.points[t].normalImpulse,e.tangentImpulses[t]=s.points[t].tangentImpulse;this.m_listener.PostSolve(i,e)}}}exports.b2Island=m,m.s_timer=new i.b2Timer,m.s_solverData=new n.b2SolverData,m.s_contactSolverDef=new s.b2ContactSolverDef,m.s_contactSolver=new s.b2ContactSolver,m.s_translation=new o.b2Vec2,m.s_impulse=new a.b2ContactImpulse;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","../common/b2_timer":"KajI","./b2_contact_solver":"ZGZd","./b2_body":"hxRe","./b2_time_step":"RCRk","./b2_world_callbacks":"pQVy"}],"Me8u":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2World=void 0;const t=require("../common/b2_common"),e=require("../common/b2_math"),i=require("../common/b2_timer"),n=require("../collision/b2_collision"),o=require("../collision/b2_time_of_impact"),s=require("./b2_joint"),r=require("./b2_area_joint"),_=require("./b2_distance_joint"),a=require("./b2_friction_joint"),m=require("./b2_gear_joint"),l=require("./b2_motor_joint"),c=require("./b2_mouse_joint"),u=require("./b2_prismatic_joint"),d=require("./b2_pulley_joint"),p=require("./b2_revolute_joint"),h=require("./b2_weld_joint"),y=require("./b2_wheel_joint"),b=require("./b2_body"),g=require("./b2_contact_manager"),S=require("./b2_island"),f=require("./b2_time_step");class x{constructor(i){this.m_contactManager=new g.b2ContactManager,this.m_bodyList=null,this.m_jointList=null,this.m_bodyCount=0,this.m_jointCount=0,this.m_gravity=new e.b2Vec2,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_inv_dt0=0,this.m_newContacts=!1,this.m_locked=!1,this.m_clearForces=!0,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new f.b2Profile,this.m_island=new S.b2Island(2*t.b2_maxTOIContacts,t.b2_maxTOIContacts,0,this.m_contactManager.m_contactListener),this.s_stack=[],this.m_gravity.Copy(i)}static Create(t){return new x(t)}SetDestructionListener(t){this.m_destructionListener=t}GetDestructionListener(){return this.m_destructionListener}SetContactFilter(t){this.m_contactManager.m_contactFilter=t}SetContactListener(t){this.m_contactManager.m_contactListener=t,this.m_island.m_listener=t}CreateBody(e={}){t.b2Assert(!this.IsLocked());const i=new b.b2Body(e,this);return i.m_prev=null,i.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=i),this.m_bodyList=i,++this.m_bodyCount,i}DestroyBody(e){var i,n;t.b2Assert(!this.IsLocked());let o=e.m_jointList;for(;o;){const t=o;o=o.next,null===(i=this.m_destructionListener)||void 0===i||i.SayGoodbyeJoint(t.joint),this.DestroyJoint(t.joint),e.m_jointList=o}e.m_jointList=null;let s=e.m_contactList;for(;s;){const t=s;s=s.next,this.m_contactManager.Destroy(t.contact)}e.m_contactList=null;const r=this.m_contactManager.m_broadPhase;let _=e.m_fixtureList;for(;_;){const t=_;_=_.m_next,null===(n=this.m_destructionListener)||void 0===n||n.SayGoodbyeFixture(t),t.DestroyProxies(r),e.m_fixtureList=_,e.m_fixtureCount-=1}e.m_fixtureList=null,e.m_fixtureCount=0,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_bodyList&&(this.m_bodyList=e.m_next),--this.m_bodyCount}static Joint_Create(t){switch(t.type){case s.b2JointType.e_distanceJoint:return new _.b2DistanceJoint(t);case s.b2JointType.e_mouseJoint:return new c.b2MouseJoint(t);case s.b2JointType.e_prismaticJoint:return new u.b2PrismaticJoint(t);case s.b2JointType.e_revoluteJoint:return new p.b2RevoluteJoint(t);case s.b2JointType.e_pulleyJoint:return new d.b2PulleyJoint(t);case s.b2JointType.e_gearJoint:return new m.b2GearJoint(t);case s.b2JointType.e_wheelJoint:return new y.b2WheelJoint(t);case s.b2JointType.e_weldJoint:return new h.b2WeldJoint(t);case s.b2JointType.e_frictionJoint:return new a.b2FrictionJoint(t);case s.b2JointType.e_motorJoint:return new l.b2MotorJoint(t);case s.b2JointType.e_areaJoint:return new r.b2AreaJoint(t)}throw new Error}CreateJoint(e){t.b2Assert(!this.IsLocked());const i=x.Joint_Create(e);i.m_prev=null,i.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=i),this.m_jointList=i,++this.m_jointCount,i.m_edgeA.prev=null,i.m_edgeA.next=i.m_bodyA.m_jointList,i.m_bodyA.m_jointList&&(i.m_bodyA.m_jointList.prev=i.m_edgeA),i.m_bodyA.m_jointList=i.m_edgeA,i.m_edgeB.prev=null,i.m_edgeB.next=i.m_bodyB.m_jointList,i.m_bodyB.m_jointList&&(i.m_bodyB.m_jointList.prev=i.m_edgeB),i.m_bodyB.m_jointList=i.m_edgeB;const n=i.m_bodyA,o=i.m_bodyB;if(!e.collideConnected){let t=o.GetContactList();for(;t;)t.other===n&&t.contact.FlagForFiltering(),t=t.next}return i}DestroyJoint(e){t.b2Assert(!this.IsLocked()),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_jointList&&(this.m_jointList=e.m_next);const i=e.m_bodyA,n=e.m_bodyB,o=e.m_collideConnected;if(i.SetAwake(!0),n.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA===i.m_jointList&&(i.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB===n.m_jointList&&(n.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,--this.m_jointCount,!o){let t=n.GetContactList();for(;t;)t.other===i&&t.contact.FlagForFiltering(),t=t.next}}Step(t,e){const i=x.Step_s_stepTimer.Reset();this.m_newContacts&&(this.m_contactManager.FindNewContacts(),this.m_newContacts=!1),this.m_locked=!0;const n=x.Step_s_step;n.dt=t,n.config={...e},n.inv_dt=t>0?1/t:0,n.dtRatio=this.m_inv_dt0*t,n.warmStarting=this.m_warmStarting;{const t=x.Step_s_timer.Reset();this.m_contactManager.Collide(),this.m_profile.collide=t.GetMilliseconds()}if(this.m_stepComplete&&n.dt>0){const t=x.Step_s_timer.Reset();this.Solve(n),this.m_profile.solve=t.GetMilliseconds()}if(this.m_continuousPhysics&&n.dt>0){const t=x.Step_s_timer.Reset();this.SolveTOI(n),this.m_profile.solveTOI=t.GetMilliseconds()}n.dt>0&&(this.m_inv_dt0=n.inv_dt),this.m_clearForces&&this.ClearForces(),this.m_locked=!1,this.m_profile.step=i.GetMilliseconds()}ClearForces(){for(let t=this.m_bodyList;t;t=t.GetNext())t.m_force.SetZero(),t.m_torque=0}QueryAABB(e,i){this.m_contactManager.m_broadPhase.Query(e,e=>{const n=t.b2Verify(e.userData);return i(n.fixture)})}QueryAllAABB(t,e=[]){return this.QueryAABB(t,t=>(e.push(t),!0)),e}QueryPointAABB(e,i){this.m_contactManager.m_broadPhase.QueryPoint(e,e=>{const n=t.b2Verify(e.userData);return i(n.fixture)})}QueryAllPointAABB(t,e=[]){return this.QueryPointAABB(t,t=>(e.push(t),!0)),e}QueryFixtureShape(e,i,o,s){const r=x.QueryFixtureShape_s_aabb;e.ComputeAABB(r,o,i),this.m_contactManager.m_broadPhase.Query(r,r=>{const _=t.b2Verify(r.userData),{fixture:a}=_;return!n.b2TestOverlap(e,i,a.GetShape(),_.childIndex,o,a.GetBody().GetTransform())||s(a)})}QueryAllFixtureShape(t,e,i,n=[]){return this.QueryFixtureShape(t,e,i,t=>(n.push(t),!0)),n}QueryFixturePoint(e,i){this.m_contactManager.m_broadPhase.QueryPoint(e,n=>{const o=t.b2Verify(n.userData),{fixture:s}=o;return!s.TestPoint(e)||i(s)})}QueryAllFixturePoint(t,e=[]){return this.QueryFixturePoint(t,t=>(e.push(t),!0)),e}RayCast(e,i,n){const o=x.RayCast_s_input;o.maxFraction=1,o.p1.Copy(e),o.p2.Copy(i),this.m_contactManager.m_broadPhase.RayCast(o,(o,s)=>{const r=t.b2Verify(s.userData),{fixture:_}=r,a=r.childIndex,m=x.RayCast_s_output;if(_.RayCast(m,o,a)){const{fraction:t}=m,o=x.RayCast_s_point;return o.Set((1-t)*e.x+t*i.x,(1-t)*e.y+t*i.y),n(_,o,m.normal,t)}return o.maxFraction})}RayCastOne(t,e){let i=null,n=1;return this.RayCast(t,e,(t,e,o,s)=>(s<n&&(n=s,i=t),n)),i}RayCastAll(t,e,i=[]){return this.RayCast(t,e,t=>(i.push(t),1)),i}GetBodyList(){return this.m_bodyList}GetJointList(){return this.m_jointList}GetContactList(){return this.m_contactManager.m_contactList}SetAllowSleeping(t){if(t!==this.m_allowSleep&&(this.m_allowSleep=t,!this.m_allowSleep))for(let e=this.m_bodyList;e;e=e.m_next)e.SetAwake(!0)}GetAllowSleeping(){return this.m_allowSleep}SetWarmStarting(t){this.m_warmStarting=t}GetWarmStarting(){return this.m_warmStarting}SetContinuousPhysics(t){this.m_continuousPhysics=t}GetContinuousPhysics(){return this.m_continuousPhysics}SetSubStepping(t){this.m_subStepping=t}GetSubStepping(){return this.m_subStepping}GetProxyCount(){return this.m_contactManager.m_broadPhase.GetProxyCount()}GetBodyCount(){return this.m_bodyCount}GetJointCount(){return this.m_jointCount}GetContactCount(){return this.m_contactManager.m_contactCount}GetTreeHeight(){return this.m_contactManager.m_broadPhase.GetTreeHeight()}GetTreeBalance(){return this.m_contactManager.m_broadPhase.GetTreeBalance()}GetTreeQuality(){return this.m_contactManager.m_broadPhase.GetTreeQuality()}SetGravity(t){this.m_gravity.Copy(t)}GetGravity(){return this.m_gravity}IsLocked(){return this.m_locked}SetAutoClearForces(t){this.m_clearForces=t}GetAutoClearForces(){return this.m_clearForces}ShiftOrigin(e){t.b2Assert(!this.IsLocked());for(let t=this.m_bodyList;t;t=t.m_next)t.m_xf.p.Subtract(e),t.m_sweep.c0.Subtract(e),t.m_sweep.c.Subtract(e);for(let t=this.m_jointList;t;t=t.m_next)t.ShiftOrigin(e);this.m_contactManager.m_broadPhase.ShiftOrigin(e)}GetContactManager(){return this.m_contactManager}GetProfile(){return this.m_profile}Solve(e){this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;const n=this.m_island;n.Resize(this.m_bodyCount),n.Clear();for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=this.m_contactManager.m_contactList;t;t=t.m_next)t.m_islandFlag=!1;for(let t=this.m_jointList;t;t=t.m_next)t.m_islandFlag=!1;const o=this.s_stack;for(let i=this.m_bodyList;i;i=i.m_next){if(i.m_islandFlag)continue;if(!i.IsAwake()||!i.IsEnabled())continue;if(i.GetType()===b.b2BodyType.b2_staticBody)continue;n.Clear();let s=0;for(o[s++]=i,i.m_islandFlag=!0;s>0;){const e=o[--s];if(t.b2Assert(null!==e),n.AddBody(e),e.GetType()!==b.b2BodyType.b2_staticBody){e.m_awakeFlag=!0;for(let t=e.m_contactList;t;t=t.next){const{contact:e}=t;if(e.m_islandFlag)continue;if(!e.IsEnabled()||!e.IsTouching())continue;const i=e.m_fixtureA.m_isSensor,r=e.m_fixtureB.m_isSensor;if(i||r)continue;n.AddContact(e),e.m_islandFlag=!0;const{other:_}=t;_.m_islandFlag||(o[s++]=_,_.m_islandFlag=!0)}for(let t=e.m_jointList;t;t=t.next){if(t.joint.m_islandFlag)continue;const{other:e}=t;e.IsEnabled()&&(n.AddJoint(t.joint),t.joint.m_islandFlag=!0,e.m_islandFlag||(o[s++]=e,e.m_islandFlag=!0))}}}const r=new f.b2Profile;n.Solve(r,e,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=r.solveInit,this.m_profile.solveVelocity+=r.solveVelocity,this.m_profile.solvePosition+=r.solvePosition;for(let t=0;t<n.m_bodyCount;++t){const e=n.m_bodies[t];e.GetType()===b.b2BodyType.b2_staticBody&&(e.m_islandFlag=!1)}}for(let t=0;t<o.length&&o[t];++t)o[t]=null;const s=new i.b2Timer;for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag&&t.GetType()!==b.b2BodyType.b2_staticBody&&t.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=s.GetMilliseconds()}SolveTOI(e){const i=this.m_island;if(i.Clear(),this.m_stepComplete){for(let t=this.m_bodyList;t;t=t.m_next)t.m_islandFlag=!1,t.m_sweep.alpha0=0;for(let t=this.m_contactManager.m_contactList;t;t=t.m_next)t.m_toiFlag=!1,t.m_islandFlag=!1,t.m_toiCount=0,t.m_toi=1}for(;;){let n=null,s=1;for(let e=this.m_contactManager.m_contactList;e;e=e.m_next){if(!e.IsEnabled())continue;if(e.m_toiCount>t.b2_maxSubSteps)continue;let i=1;if(e.m_toiFlag)i=e.m_toi;else{const t=e.GetFixtureA(),n=e.GetFixtureB();if(t.IsSensor()||n.IsSensor())continue;const s=t.GetBody(),r=n.GetBody(),_=s.m_type,a=r.m_type,m=s.IsAwake()&&_!==b.b2BodyType.b2_staticBody,l=r.IsAwake()&&a!==b.b2BodyType.b2_staticBody;if(!m&&!l)continue;const c=s.IsBullet()||_!==b.b2BodyType.b2_dynamicBody,u=r.IsBullet()||a!==b.b2BodyType.b2_dynamicBody;if(!c&&!u)continue;let{alpha0:d}=s.m_sweep;s.m_sweep.alpha0<r.m_sweep.alpha0?(d=r.m_sweep.alpha0,s.m_sweep.Advance(d)):r.m_sweep.alpha0<s.m_sweep.alpha0&&(d=s.m_sweep.alpha0,r.m_sweep.Advance(d));const p=e.GetChildIndexA(),h=e.GetChildIndexB(),y=x.SolveTOI_s_toi_input;y.proxyA.SetShape(t.GetShape(),p),y.proxyB.SetShape(n.GetShape(),h),y.sweepA.Copy(s.m_sweep),y.sweepB.Copy(r.m_sweep),y.tMax=1;const g=x.SolveTOI_s_toi_output;o.b2TimeOfImpact(g,y);const S=g.t;i=g.state===o.b2TOIOutputState.e_touching?Math.min(d+(1-d)*S,1):1,e.m_toi=i,e.m_toiFlag=!0}i<s&&(n=e,s=i)}if(null===n||1-10*t.b2_epsilon<s){this.m_stepComplete=!0;break}const r=n.GetFixtureA(),_=n.GetFixtureB(),a=r.GetBody(),m=_.GetBody(),l=x.SolveTOI_s_backup1.Copy(a.m_sweep),c=x.SolveTOI_s_backup2.Copy(m.m_sweep);if(a.Advance(s),m.Advance(s),n.Update(this.m_contactManager.m_contactListener),n.m_toiFlag=!1,++n.m_toiCount,!n.IsEnabled()||!n.IsTouching()){n.SetEnabled(!1),a.m_sweep.Copy(l),m.m_sweep.Copy(c),a.SynchronizeTransform(),m.SynchronizeTransform();continue}a.SetAwake(!0),m.SetAwake(!0),i.Clear(),i.AddBody(a),i.AddBody(m),i.AddContact(n),a.m_islandFlag=!0,m.m_islandFlag=!0,n.m_islandFlag=!0;for(let e=0;e<2;++e){const n=0===e?a:m;if(n.m_type===b.b2BodyType.b2_dynamicBody)for(let e=n.m_contactList;e&&i.m_bodyCount!==i.m_bodyCapacity&&i.m_contactCount!==t.b2_maxTOIContacts;e=e.next){const{contact:t}=e;if(t.m_islandFlag)continue;const{other:o}=e;if(o.m_type===b.b2BodyType.b2_dynamicBody&&!n.IsBullet()&&!o.IsBullet())continue;const r=t.m_fixtureA.m_isSensor,_=t.m_fixtureB.m_isSensor;if(r||_)continue;const a=x.SolveTOI_s_backup.Copy(o.m_sweep);o.m_islandFlag||o.Advance(s),t.Update(this.m_contactManager.m_contactListener),t.IsEnabled()&&t.IsTouching()?(t.m_islandFlag=!0,i.AddContact(t),o.m_islandFlag||(o.m_islandFlag=!0,o.m_type!==b.b2BodyType.b2_staticBody&&o.SetAwake(!0),i.AddBody(o))):(o.m_sweep.Copy(a),o.SynchronizeTransform())}}const u=x.SolveTOI_s_subStep;u.dt=(1-s)*e.dt,u.inv_dt=1/u.dt,u.dtRatio=1,u.config={...e.config,positionIterations:20},u.warmStarting=!1,i.SolveTOI(u,a.m_islandIndex,m.m_islandIndex);for(let t=0;t<i.m_bodyCount;++t){const e=i.m_bodies[t];if(e.m_islandFlag=!1,e.m_type===b.b2BodyType.b2_dynamicBody){e.SynchronizeFixtures();for(let t=e.m_contactList;t;t=t.next)t.contact.m_toiFlag=!1,t.contact.m_islandFlag=!1}}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}}}exports.b2World=x,x.Step_s_step=f.b2TimeStep.Create(),x.Step_s_stepTimer=new i.b2Timer,x.Step_s_timer=new i.b2Timer,x.QueryFixtureShape_s_aabb=new n.b2AABB,x.RayCast_s_input=new n.b2RayCastInput,x.RayCast_s_output=new n.b2RayCastOutput,x.RayCast_s_point=new e.b2Vec2,x.SolveTOI_s_subStep=f.b2TimeStep.Create(),x.SolveTOI_s_backup=new e.b2Sweep,x.SolveTOI_s_backup1=new e.b2Sweep,x.SolveTOI_s_backup2=new e.b2Sweep,x.SolveTOI_s_toi_input=new o.b2TOIInput,x.SolveTOI_s_toi_output=new o.b2TOIOutput;
},{"../common/b2_common":"xZSi","../common/b2_math":"YmMi","../common/b2_timer":"KajI","../collision/b2_collision":"DOG3","../collision/b2_time_of_impact":"GFfv","./b2_joint":"PxaZ","./b2_area_joint":"z4M5","./b2_distance_joint":"ZofS","./b2_friction_joint":"BvwH","./b2_gear_joint":"hOU7","./b2_motor_joint":"Wvkp","./b2_mouse_joint":"lM2e","./b2_prismatic_joint":"TjHH","./b2_pulley_joint":"Jd4O","./b2_revolute_joint":"AIPE","./b2_weld_joint":"lC1O","./b2_wheel_joint":"EFh3","./b2_body":"hxRe","./b2_contact_manager":"up2J","./b2_island":"zv4G","./b2_time_step":"RCRk"}],"uajD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2Rope=exports.b2RopeTuning=exports.b2BendingModel=exports.b2StretchingModel=void 0;const t=require("../common/b2_common"),s=require("../common/b2_draw"),e=require("../common/b2_math"),i={J1:new e.b2Vec2,J2:new e.b2Vec2,J3:new e.b2Vec2,r:new e.b2Vec2,e1:new e.b2Vec2,e2:new e.b2Vec2,Jd1:new e.b2Vec2,Jd2:new e.b2Vec2,d:new e.b2Vec2,u:new e.b2Vec2,dp1:new e.b2Vec2,dp2:new e.b2Vec2,dp3:new e.b2Vec2,d1:new e.b2Vec2,d2:new e.b2Vec2,dHat:new e.b2Vec2};var n,o;!function(t){t[t.b2_pbdStretchingModel=0]="b2_pbdStretchingModel",t[t.b2_xpbdStretchingModel=1]="b2_xpbdStretchingModel"}(n=exports.b2StretchingModel||(exports.b2StretchingModel={})),function(t){t[t.b2_springAngleBendingModel=0]="b2_springAngleBendingModel",t[t.b2_pbdAngleBendingModel=1]="b2_pbdAngleBendingModel",t[t.b2_xpbdAngleBendingModel=2]="b2_xpbdAngleBendingModel",t[t.b2_pbdDistanceBendingModel=3]="b2_pbdDistanceBendingModel",t[t.b2_pbdHeightBendingModel=4]="b2_pbdHeightBendingModel",t[t.b2_pbdTriangleBendingModel=5]="b2_pbdTriangleBendingModel"}(o=exports.b2BendingModel||(exports.b2BendingModel={}));class c{constructor(){this.stretchingModel=n.b2_pbdStretchingModel,this.bendingModel=o.b2_pbdAngleBendingModel,this.damping=0,this.stretchStiffness=1,this.stretchHertz=0,this.stretchDamping=0,this.bendStiffness=.5,this.bendHertz=1,this.bendDamping=0,this.isometric=!1,this.fixedEffectiveMass=!1,this.warmStart=!1}Copy(t){return this.stretchingModel=t.stretchingModel,this.bendingModel=t.bendingModel,this.damping=t.damping,this.stretchStiffness=t.stretchStiffness,this.stretchHertz=t.stretchHertz,this.stretchDamping=t.stretchDamping,this.bendStiffness=t.bendStiffness,this.bendHertz=t.bendHertz,this.bendDamping=t.bendDamping,this.isometric=t.isometric,this.fixedEffectiveMass=t.fixedEffectiveMass,this.warmStart=t.warmStart,this}}exports.b2RopeTuning=c;class h{constructor(){this.i1=0,this.i2=0,this.invMass1=0,this.invMass2=0,this.L=0,this.lambda=0,this.spring=0,this.damper=0}}class a{constructor(){this.i1=0,this.i2=0,this.i3=0,this.invMass1=0,this.invMass2=0,this.invMass3=0,this.invEffectiveMass=0,this.lambda=0,this.L1=0,this.L2=0,this.alpha1=0,this.alpha2=0,this.spring=0,this.damper=0}}class d{constructor(s){this.m_position=new e.b2Vec2,this.m_count=0,this.m_stretchCount=0,this.m_bendCount=0,this.m_gravity=new e.b2Vec2,this.m_tuning=new c,t.b2Assert(s.vertices.length>=3),this.m_position.Copy(s.position),this.m_count=s.vertices.length,this.m_bindPositions=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_ps=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_p0s=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_vs=t.b2MakeArray(this.m_count,e.b2Vec2),this.m_invMasses=t.b2MakeNumberArray(this.m_count);for(let t=0;t<this.m_count;++t){this.m_bindPositions[t].Copy(s.vertices[t]),e.b2Vec2.Add(s.vertices[t],this.m_position,this.m_ps[t]),e.b2Vec2.Add(s.vertices[t],this.m_position,this.m_p0s[t]),this.m_vs[t].SetZero();const i=s.masses[t];this.m_invMasses[t]=i>0?1/i:0}this.m_stretchCount=this.m_count-1,this.m_bendCount=this.m_count-2,this.m_stretchConstraints=new Array(this.m_stretchCount);for(let t=0;t<this.m_stretchCount;t++)this.m_stretchConstraints[t]=new h;this.m_bendConstraints=new Array(this.m_bendCount);for(let t=0;t<this.m_bendCount;t++)this.m_bendConstraints[t]=new a;for(let t=0;t<this.m_stretchCount;++t){const s=this.m_stretchConstraints[t],i=this.m_ps[t],n=this.m_ps[t+1];s.i1=t,s.i2=t+1,s.L=e.b2Vec2.Distance(i,n),s.invMass1=this.m_invMasses[t],s.invMass2=this.m_invMasses[t+1],s.lambda=0,s.damper=0,s.spring=0}const{J1:n,J2:o,r:d,e1:b,e2:r,Jd1:m,Jd2:_}=i;for(let t=0;t<this.m_bendCount;++t){const s=this.m_bendConstraints[t],i=this.m_ps[t],c=this.m_ps[t+1],h=this.m_ps[t+2];s.i1=t,s.i2=t+1,s.i3=t+2,s.invMass1=this.m_invMasses[t],s.invMass2=this.m_invMasses[t+1],s.invMass3=this.m_invMasses[t+2],s.invEffectiveMass=0,s.L1=e.b2Vec2.Distance(i,c),s.L2=e.b2Vec2.Distance(c,h),s.lambda=0,e.b2Vec2.Subtract(c,i,b),e.b2Vec2.Subtract(h,c,r);const a=b.LengthSquared(),l=r.LengthSquared();if(a*l==0)continue;e.b2Vec2.Skew(b,m).Scale(-1/a),e.b2Vec2.Skew(r,_).Scale(1/l),e.b2Vec2.Negate(m,n),e.b2Vec2.Subtract(m,_,o);const p=_;s.invEffectiveMass=s.invMass1*e.b2Vec2.Dot(n,n)+s.invMass2*e.b2Vec2.Dot(o,o)+s.invMass3*e.b2Vec2.Dot(p,p),e.b2Vec2.Subtract(h,i,d);const g=d.LengthSquared();0!==g&&(s.alpha1=e.b2Vec2.Dot(r,d)/g,s.alpha2=e.b2Vec2.Dot(b,d)/g)}this.m_gravity.Copy(s.gravity),this.SetTuning(s.tuning)}SetTuning(t){this.m_tuning.Copy(t);const s=2*Math.PI*this.m_tuning.bendHertz;for(let i=0;i<this.m_bendCount;++i){const t=this.m_bendConstraints[i],e=t.L1*t.L1,n=t.L2*t.L2;if(e*n==0){t.spring=0,t.damper=0;continue}const o=1/t.L1+1/t.L2,c=t.invMass1/e+t.invMass2*o*o+t.invMass3/n;if(0===c){t.spring=0,t.damper=0;continue}const h=1/c;t.spring=h*s*s,t.damper=2*h*this.m_tuning.bendDamping*s}const e=2*Math.PI*this.m_tuning.stretchHertz;for(let i=0;i<this.m_stretchCount;++i){const t=this.m_stretchConstraints[i],s=t.invMass1+t.invMass2;if(0===s)continue;const n=1/s;t.spring=n*e*e,t.damper=2*n*this.m_tuning.stretchDamping*e}}Step(t,s,e){if(0===t)return;const i=1/t,c=Math.exp(-t*this.m_tuning.damping);for(let n=0;n<this.m_count;++n)this.m_invMasses[n]>0?(this.m_vs[n].Scale(c),this.m_vs[n].AddScaled(t,this.m_gravity)):(this.m_vs[n].x=i*(this.m_bindPositions[n].x+e.x-this.m_p0s[n].x),this.m_vs[n].y=i*(this.m_bindPositions[n].y+e.y-this.m_p0s[n].y));this.m_tuning.bendingModel===o.b2_springAngleBendingModel&&this.ApplyBendForces(t);for(let n=0;n<this.m_bendCount;++n)this.m_bendConstraints[n].lambda=0;for(let n=0;n<this.m_stretchCount;++n)this.m_stretchConstraints[n].lambda=0;for(let n=0;n<this.m_count;++n)this.m_ps[n].AddScaled(t,this.m_vs[n]);for(let h=0;h<s;++h)this.m_tuning.bendingModel===o.b2_pbdAngleBendingModel?this.SolveBend_PBD_Angle():this.m_tuning.bendingModel===o.b2_xpbdAngleBendingModel?this.SolveBend_XPBD_Angle(t):this.m_tuning.bendingModel===o.b2_pbdDistanceBendingModel?this.SolveBend_PBD_Distance():this.m_tuning.bendingModel===o.b2_pbdHeightBendingModel?this.SolveBend_PBD_Height():this.m_tuning.bendingModel===o.b2_pbdTriangleBendingModel&&this.SolveBend_PBD_Triangle(),this.m_tuning.stretchingModel===n.b2_pbdStretchingModel?this.SolveStretch_PBD():this.m_tuning.stretchingModel===n.b2_xpbdStretchingModel&&this.SolveStretch_XPBD(t);for(let n=0;n<this.m_count;++n)this.m_vs[n].x=i*(this.m_ps[n].x-this.m_p0s[n].x),this.m_vs[n].y=i*(this.m_ps[n].y-this.m_p0s[n].y),this.m_p0s[n].Copy(this.m_ps[n])}Reset(t){this.m_position.Copy(t);for(let s=0;s<this.m_count;++s)e.b2Vec2.Add(this.m_bindPositions[s],this.m_position,this.m_ps[s]),this.m_p0s[s].Copy(this.m_ps[s]),this.m_vs[s].SetZero();for(let s=0;s<this.m_bendCount;++s)this.m_bendConstraints[s].lambda=0;for(let s=0;s<this.m_stretchCount;++s)this.m_stretchConstraints[s].lambda=0}SolveStretch_PBD(){const t=this.m_tuning.stretchStiffness,{d:s}=i;for(let i=0;i<this.m_stretchCount;++i){const n=this.m_stretchConstraints[i],o=this.m_ps[n.i1],c=this.m_ps[n.i2];e.b2Vec2.Subtract(c,o,s);const h=s.Normalize(),a=n.invMass1+n.invMass2;if(0===a)continue;const d=n.invMass1/a,b=n.invMass2/a;o.SubtractScaled(t*d*(n.L-h),s),c.AddScaled(t*b*(n.L-h),s)}}SolveStretch_XPBD(t){const{dp1:s,dp2:n,u:o,J1:c}=i;for(let i=0;i<this.m_stretchCount;++i){const h=this.m_stretchConstraints[i],a=this.m_ps[h.i1],d=this.m_ps[h.i2];e.b2Vec2.Subtract(a,this.m_p0s[h.i1],s),e.b2Vec2.Subtract(d,this.m_p0s[h.i2],n),e.b2Vec2.Subtract(d,a,o);const b=o.Normalize();e.b2Vec2.Negate(o,c);const r=o,m=h.invMass1+h.invMass2;if(0===m)continue;const _=1/(h.spring*t*t),l=_*(t*t*h.damper)/t,p=b-h.L,g=e.b2Vec2.Dot(c,s)+e.b2Vec2.Dot(r,n),u=-(p+_*h.lambda+l*g)/((1+l)*m+_);a.AddScaled(h.invMass1*u,c),d.AddScaled(h.invMass2*u,r),h.lambda+=u}}SolveBend_PBD_Angle(){const t=this.m_tuning.bendStiffness,{Jd1:s,Jd2:n,J1:o,J2:c,d1:h,d2:a}=i;for(let i=0;i<this.m_bendCount;++i){const d=this.m_bendConstraints[i],b=this.m_ps[d.i1],r=this.m_ps[d.i2],m=this.m_ps[d.i3];e.b2Vec2.Subtract(r,b,h),e.b2Vec2.Subtract(m,r,a);const _=e.b2Vec2.Cross(h,a),l=e.b2Vec2.Dot(h,a),p=Math.atan2(_,l);let g,u;if(this.m_tuning.isometric?(g=d.L1*d.L1,u=d.L2*d.L2):(g=h.LengthSquared(),u=a.LengthSquared()),g*u==0)continue;e.b2Vec2.Skew(h,s).Scale(-1/g),e.b2Vec2.Skew(a,n).Scale(1/u),e.b2Vec2.Negate(s,o),e.b2Vec2.Subtract(s,n,c);const M=n;let v;0===(v=this.m_tuning.fixedEffectiveMass?d.invEffectiveMass:d.invMass1*e.b2Vec2.Dot(o,o)+d.invMass2*e.b2Vec2.Dot(c,c)+d.invMass3*e.b2Vec2.Dot(M,M))&&(v=d.invEffectiveMass);const S=-t*p/v;b.AddScaled(d.invMass1*S,o),r.AddScaled(d.invMass2*S,c),m.AddScaled(d.invMass3*S,M)}}SolveBend_XPBD_Angle(t){const{dp1:s,dp2:n,dp3:o,d1:c,d2:h,Jd1:a,Jd2:d,J1:b,J2:r}=i;for(let i=0;i<this.m_bendCount;++i){const m=this.m_bendConstraints[i],_=this.m_ps[m.i1],l=this.m_ps[m.i2],p=this.m_ps[m.i3];let g,u;if(e.b2Vec2.Subtract(_,this.m_p0s[m.i1],s),e.b2Vec2.Subtract(l,this.m_p0s[m.i2],n),e.b2Vec2.Subtract(p,this.m_p0s[m.i3],o),e.b2Vec2.Subtract(l,_,c),e.b2Vec2.Subtract(p,l,h),this.m_tuning.isometric?(g=m.L1*m.L1,u=m.L2*m.L2):(g=c.LengthSquared(),u=h.LengthSquared()),g*u==0)continue;const M=e.b2Vec2.Cross(c,h),v=e.b2Vec2.Dot(c,h),S=Math.atan2(M,v);e.b2Vec2.Skew(c,a).Scale(-1/g),e.b2Vec2.Skew(h,d).Scale(1/u),e.b2Vec2.Negate(a,b),e.b2Vec2.Subtract(a,d,r);const f=d;let V;if(0===(V=this.m_tuning.fixedEffectiveMass?m.invEffectiveMass:m.invMass1*e.b2Vec2.Dot(b,b)+m.invMass2*e.b2Vec2.Dot(r,r)+m.invMass3*e.b2Vec2.Dot(f,f)))continue;const D=1/(m.spring*t*t),C=D*(t*t*m.damper)/t,A=S,B=e.b2Vec2.Dot(b,s)+e.b2Vec2.Dot(r,n)+e.b2Vec2.Dot(f,o),L=-(A+D*m.lambda+C*B)/((1+C)*V+D);_.AddScaled(m.invMass1*L,b),l.AddScaled(m.invMass2*L,r),p.AddScaled(m.invMass3*L,f),m.lambda+=L}}SolveBend_PBD_Distance(){const t=this.m_tuning.bendStiffness,{d:s}=i;for(let i=0;i<this.m_bendCount;++i){const n=this.m_bendConstraints[i],{i1:o}=n,c=n.i3,h=this.m_ps[o],a=this.m_ps[c];e.b2Vec2.Subtract(a,h,s);const d=s.Normalize(),b=n.invMass1+n.invMass3;if(0===b)continue;const r=n.invMass1/b,m=n.invMass3/b;h.SubtractScaled(t*r*(n.L1+n.L2-d),s),a.AddScaled(t*m*(n.L1+n.L2-d),s)}}SolveBend_PBD_Height(){const t=this.m_tuning.bendStiffness,{dHat:s,J1:n,J2:o,J3:c,d:h}=i;for(let i=0;i<this.m_bendCount;++i){const a=this.m_bendConstraints[i],d=this.m_ps[a.i1],b=this.m_ps[a.i2],r=this.m_ps[a.i3];h.x=a.alpha1*d.x+a.alpha2*r.x-b.x,h.y=a.alpha1*d.y+a.alpha2*r.y-b.y;const m=h.Length();if(0===m)continue;e.b2Vec2.Scale(1/m,h,s),e.b2Vec2.Scale(a.alpha1,s,n),e.b2Vec2.Negate(s,o),e.b2Vec2.Scale(a.alpha2,s,c);const _=a.invMass1*a.alpha1*a.alpha1+a.invMass2+a.invMass3*a.alpha2*a.alpha2;if(0===_)continue;const l=-t*(1/_)*m;d.AddScaled(a.invMass1*l,n),b.AddScaled(a.invMass2*l,o),r.AddScaled(a.invMass3*l,c)}}SolveBend_PBD_Triangle(){const t=this.m_tuning.bendStiffness,{d:s}=i;for(let e=0;e<this.m_bendCount;++e){const i=this.m_bendConstraints[e],n=this.m_ps[i.i1],o=this.m_ps[i.i2],c=this.m_ps[i.i3],h=i.invMass1,a=i.invMass2,d=i.invMass3,b=t/(h+d+2*a);s.x=o.x-1/3*(n.x+o.x+c.x),s.y=o.y-1/3*(n.y+o.y+c.y),n.AddScaled(2*h*b,s),o.AddScaled(-4*a*b,s),c.AddScaled(2*d*b,s)}}ApplyBendForces(t){const s=2*Math.PI*this.m_tuning.bendHertz,{d1:n,d2:o,Jd1:c,Jd2:h,J1:a,J2:d}=i;for(let i=0;i<this.m_bendCount;++i){const b=this.m_bendConstraints[i],r=this.m_ps[b.i1],m=this.m_ps[b.i2],_=this.m_ps[b.i3],l=this.m_vs[b.i1],p=this.m_vs[b.i2],g=this.m_vs[b.i3];let u,M;if(e.b2Vec2.Subtract(m,r,n),e.b2Vec2.Subtract(_,m,o),this.m_tuning.isometric?(u=b.L1*b.L1,M=b.L2*b.L2):(u=n.LengthSquared(),M=o.LengthSquared()),u*M==0)continue;const v=e.b2Vec2.Cross(n,o),S=e.b2Vec2.Dot(n,o),f=Math.atan2(v,S);e.b2Vec2.Skew(n,c).Scale(-1/u),e.b2Vec2.Skew(o,h).Scale(1/M),e.b2Vec2.Negate(c,a),e.b2Vec2.Subtract(c,h,d);const V=h;let D;if(0===(D=this.m_tuning.fixedEffectiveMass?b.invEffectiveMass:b.invMass1*e.b2Vec2.Dot(a,a)+b.invMass2*e.b2Vec2.Dot(d,d)+b.invMass3*e.b2Vec2.Dot(V,V)))continue;const C=1/D,A=-t*(C*s*s*f+2*C*this.m_tuning.bendDamping*s*(e.b2Vec2.Dot(a,l)+e.b2Vec2.Dot(d,p)+e.b2Vec2.Dot(V,g)));this.m_vs[b.i1].AddScaled(b.invMass1*A,a),this.m_vs[b.i2].AddScaled(b.invMass2*A,d),this.m_vs[b.i3].AddScaled(b.invMass3*A,V)}}Draw(t){for(let i=0;i<this.m_count-1;++i){t.DrawSegment(this.m_ps[i],this.m_ps[i+1],s.debugColors.rope);const e=this.m_invMasses[i]>0?s.debugColors.ropePointD:s.debugColors.ropePointG;t.DrawPoint(this.m_ps[i],5,e)}const e=this.m_invMasses[this.m_count-1]>0?s.debugColors.ropePointD:s.debugColors.ropePointG;t.DrawPoint(this.m_ps[this.m_count-1],5,e)}}exports.b2Rope=d;
},{"../common/b2_common":"xZSi","../common/b2_draw":"J87F","../common/b2_math":"YmMi"}],"kjbO":[function(require,module,exports) {
"use strict";var e=this&&this.__createBinding||(Object.create?function(e,r,o,i){void 0===i&&(i=o),Object.defineProperty(e,i,{enumerable:!0,get:function(){return r[o]}})}:function(e,r,o,i){void 0===i&&(i=o),e[i]=r[o]}),r=this&&this.__exportStar||function(r,o){for(var i in r)"default"===i||Object.prototype.hasOwnProperty.call(o,i)||e(o,r,i)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2GetBlockSolve=exports.b2SetBlockSolve=exports.b2World=exports.b2BodyType=exports.b2Body=void 0,r(require("./common/b2_common"),exports),r(require("./common/b2_settings"),exports),r(require("./common/b2_math"),exports),r(require("./common/b2_draw"),exports),r(require("./common/b2_draw_helper"),exports),r(require("./common/b2_timer"),exports),r(require("./common/b2_augment"),exports),r(require("./collision/b2_collision"),exports),r(require("./collision/b2_distance"),exports),r(require("./collision/b2_broad_phase"),exports),r(require("./collision/b2_dynamic_tree"),exports),r(require("./collision/b2_time_of_impact"),exports),r(require("./collision/b2_collide_circle"),exports),r(require("./collision/b2_collide_polygon"),exports),r(require("./collision/b2_collide_edge"),exports),r(require("./collision/b2_shape"),exports),r(require("./collision/b2_circle_shape"),exports),r(require("./collision/b2_polygon_shape"),exports),r(require("./collision/b2_edge_shape"),exports),r(require("./collision/b2_chain_shape"),exports),r(require("./dynamics/b2_fixture"),exports);var o=require("./dynamics/b2_body");Object.defineProperty(exports,"b2Body",{enumerable:!0,get:function(){return o.b2Body}}),Object.defineProperty(exports,"b2BodyType",{enumerable:!0,get:function(){return o.b2BodyType}});var i=require("./dynamics/b2_world");Object.defineProperty(exports,"b2World",{enumerable:!0,get:function(){return i.b2World}}),r(require("./dynamics/b2_world_callbacks"),exports),r(require("./dynamics/b2_island"),exports),r(require("./dynamics/b2_time_step"),exports),r(require("./dynamics/b2_contact_manager"),exports),r(require("./dynamics/b2_contact"),exports),r(require("./dynamics/b2_contact_factory"),exports);var t=require("./dynamics/b2_contact_solver");Object.defineProperty(exports,"b2SetBlockSolve",{enumerable:!0,get:function(){return t.b2SetBlockSolve}}),Object.defineProperty(exports,"b2GetBlockSolve",{enumerable:!0,get:function(){return t.b2GetBlockSolve}}),r(require("./dynamics/b2_joint"),exports),r(require("./dynamics/b2_area_joint"),exports),r(require("./dynamics/b2_distance_joint"),exports),r(require("./dynamics/b2_friction_joint"),exports),r(require("./dynamics/b2_gear_joint"),exports),r(require("./dynamics/b2_motor_joint"),exports),r(require("./dynamics/b2_mouse_joint"),exports),r(require("./dynamics/b2_prismatic_joint"),exports),r(require("./dynamics/b2_pulley_joint"),exports),r(require("./dynamics/b2_revolute_joint"),exports),r(require("./dynamics/b2_weld_joint"),exports),r(require("./dynamics/b2_wheel_joint"),exports),r(require("./rope/b2_rope"),exports);
},{"./common/b2_common":"xZSi","./common/b2_settings":"nssz","./common/b2_math":"YmMi","./common/b2_draw":"J87F","./common/b2_draw_helper":"VBK5","./common/b2_timer":"KajI","./common/b2_augment":"O0IN","./collision/b2_collision":"DOG3","./collision/b2_distance":"XVAh","./collision/b2_broad_phase":"r8Yy","./collision/b2_dynamic_tree":"TnoZ","./collision/b2_time_of_impact":"GFfv","./collision/b2_collide_circle":"JHeH","./collision/b2_collide_polygon":"FXGt","./collision/b2_collide_edge":"Xyzc","./collision/b2_shape":"QXiX","./collision/b2_circle_shape":"z0gE","./collision/b2_polygon_shape":"tJiR","./collision/b2_edge_shape":"xXrv","./collision/b2_chain_shape":"xLFs","./dynamics/b2_fixture":"MuJF","./dynamics/b2_body":"hxRe","./dynamics/b2_world":"Me8u","./dynamics/b2_world_callbacks":"pQVy","./dynamics/b2_island":"zv4G","./dynamics/b2_time_step":"RCRk","./dynamics/b2_contact_manager":"up2J","./dynamics/b2_contact":"yXDC","./dynamics/b2_contact_factory":"VHzU","./dynamics/b2_contact_solver":"ZGZd","./dynamics/b2_joint":"PxaZ","./dynamics/b2_area_joint":"z4M5","./dynamics/b2_distance_joint":"ZofS","./dynamics/b2_friction_joint":"BvwH","./dynamics/b2_gear_joint":"hOU7","./dynamics/b2_motor_joint":"Wvkp","./dynamics/b2_mouse_joint":"lM2e","./dynamics/b2_prismatic_joint":"TjHH","./dynamics/b2_pulley_joint":"Jd4O","./dynamics/b2_revolute_joint":"AIPE","./dynamics/b2_weld_joint":"lC1O","./dynamics/b2_wheel_joint":"EFh3","./rope/b2_rope":"uajD"}],"yWA3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Challenge=void 0;class t{constructor(){this.allParts=new Array,this.circlesAllowed=!0,this.rectanglesAllowed=!0,this.trianglesAllowed=!0,this.fixedJointsAllowed=!0,this.rotatingJointsAllowed=!0,this.slidingJointsAllowed=!0,this.thrustersAllowed=!0,this.cannonsAllowed=!0,this.fixateAllowed=!1,this.nonCollidingAllowed=!0,this.mouseDragAllowed=!1,this.botControlAllowed=!0,this.showConditions=!1,this.minDensity=-Number.MAX_VALUE,this.maxDensity=Number.MAX_VALUE,this.maxRJStrength=Number.MAX_VALUE,this.maxRJSpeed=Number.MAX_VALUE,this.maxSJStrength=Number.MAX_VALUE,this.maxSJSpeed=Number.MAX_VALUE,this.maxThrusterStrength=Number.MAX_VALUE,this.cameraX=Number.MAX_VALUE,this.cameraY=Number.MAX_VALUE,this.zoomLevel=Number.MAX_VALUE,this.buildAreas=new Array,this.winConditions=new Array,this.lossConditions=new Array,this.winConditionsAnded=!0}cosntructor(t){this.settings=t}}exports.Challenge=t;
},{}],"odHz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Replay=void 0;class s{constructor(){this.cont=null,this.syncPointIndex=0,this.cameraMovementIndex=0,this.keyPressIndex=0}Replay(s,e,t,n,i){this.cameraMovements=s,this.syncPoints=e,this.keyPresses=t,this.numFrames=n,this.version=i}Update(s){for(;this.cameraMovementIndex<this.cameraMovements.length&&this.cameraMovements[this.cameraMovementIndex].frame==s;)this.cont&&this.cont.MoveCameraForReplay(this.cameraMovements[this.cameraMovementIndex]),this.cameraMovementIndex++;if(this.syncPointIndex<this.syncPoints.length)if(s>=this.syncPoints[this.syncPointIndex].frame){var e=this.syncPoints[this.syncPointIndex];this.cont&&this.cont.SyncReplay(e),this.syncPointIndex++}else{var t=this.syncPoints[this.syncPointIndex-1],n=this.syncPoints[this.syncPointIndex];this.cont&&this.cont.SyncReplay2(t,n)}for(;this.keyPressIndex<this.keyPresses.length&&this.keyPresses[this.keyPressIndex].frame==s;)this.cont&&this.cont.keyInput(this.keyPresses[this.keyPressIndex].key,!0),this.keyPressIndex++;return s>=this.numFrames}}exports.Replay=s;
},{}],"H0hU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Robot=void 0;class e{constructor(e,t=null,s=Number.MAX_VALUE,r=Number.MAX_VALUE,o=Number.MAX_VALUE){this.settings=null,this.challenge=null,this.cameraX=Number.MAX_VALUE,this.cameraY=Number.MAX_VALUE,this.zoomLevel=Number.MAX_VALUE,this.allParts=e,this.settings=t,this.cameraX=s,this.cameraY=r,this.zoomLevel=o}}exports.Robot=e;
},{}],"ZSAP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SandboxSettings=void 0;class R{constructor(R,A,t,N,_,s=0,S=0,e=0){this.gravity=R,this.size=A,this.terrainType=t,this.terrainTheme=N,this.background=_,this.backgroundR=s,this.backgroundG=S,this.backgroundB=e}}exports.SandboxSettings=R,R.SIZE_SMALL=0,R.SIZE_MEDIUM=1,R.SIZE_LARGE=2,R.TERRAIN_LAND=0,R.TERRAIN_BOX=1,R.TERRAIN_EMPTY=2,R.TERRAIN_GRASS=0,R.TERRAIN_DIRT=1,R.TERRAIN_SAND=2,R.TERRAIN_ROCK=3,R.TERRAIN_SNOW=4,R.TERRAIN_MOON=5,R.TERRAIN_MARS=6,R.BACKGROUND_SKY=0,R.BACKGROUND_SPACE=1,R.BACKGROUND_NIGHT=2,R.BACKGROUND_DUSK=3,R.BACKGROUND_MARS=4,R.BACKGROUND_SUNSET=5,R.BACKGROUND_SOLID_COLOUR=6;
},{}],"Zvyo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Util=void 0;const t=require("@box2d/core");class r{static Vector(r,e){var a=new t.b2Vec2;return a.x=r,a.y=e,a}static RangedRandom(t,r){return t+Math.random()*(r-t)}static NearestInt(t){return t-Math.floor(t)>=.5?Math.floor(t)+1:Math.floor(t)}static FormatDate(t){if(isNaN(t))return"Oct. 17, 2008";var r=new Date;return r.setTime(t),["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."][r.getMonth()]+" "+r.getDate()+", "+r.getFullYear()}static GetDist(t,r,e,a){return Math.sqrt((t-e)*(t-e)+(r-a)*(r-a))}static GetAngle(t){return Math.atan2(t.y,t.x)}static NormalizeAngle(t){for(;t>=2*Math.PI;)t-=2*Math.PI;for(;t<0;)t+=2*Math.PI;return t}static Midpoint(r,e){return new t.b2Vec2((r.x+e.x)/2,(r.y+e.y)/2)}static HexColour(t,r,e){return e|r<<8|t<<16}static HexColourString(t,r,e){return`#${[t,r,e].map(t=>t.toString(16).padStart(2,"0")).join("")}`}static b2ColorToHex(t){return 255*t.b|255*t.g<<8|255*t.r<<16}static ObjectInArray(t,r){if(!r)return!1;for(var e=0;e<r.length;e++)if(t==r[e])return!0;return!1}static RemoveFromArray(t,r){for(var e=new Array,a=0;a<r.length;a++)t!=r[a]&&e.push(r[a]);return e}static InsertIntoArray(t,r,e){for(var a=new Array,n=0;n<r.length;n++)n==e&&a.push(t),a.push(r[n]);return n<=e&&a.push(t),a}static RemoveDuplicates(t){for(var r=new Array,e=0;e<t.length;e++){for(var a=!1,n=0;n<e;n++)if(t[e]==t[n]){a=!0;break}a||r.push(t[e])}return r}static SegmentsIntersect(t,r,e,a,n,o,i,s){if(t==n&&r==o||t==i&&r==s||e==n&&a==o||e==i&&a==s)return!1;Math.abs(t-e)<1e-5&&(e+=1e-4);var c=(a-r)/(e-t);Math.abs(n-i)<1e-5&&(i+=1e-4);var u=(s-o)/(i-n);if(c==u)return!1;var l=(o-n*u-(r-t*c))/(c-u);return(l>=t&&l<=e||l<=t&&l>=e)&&(l>=n&&l<=i||l<=n&&l>=i)}static DistanceFromPointToLine(e,a,n){n.Normalize();var o=new t.b2Vec2(a.x-e.x,a.y-e.y);return Math.abs(r.Determinant(new t.b2Mat22(0,n,o)))}static Determinant(t){return t.col1.x*t.col2.y-t.col1.y*t.col2.x}}exports.Util=r;
},{"@box2d/core":"kjbO"}],"CVYw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Database=void 0;const e=require("../Game/Challenge"),r=require("../Game/Globals/ControllerGameGlobals"),t=require("../Game/Replay"),a=require("../Game/Robot"),n=require("../Game/SandboxSettings"),o=require("./Util");class s{static Encrypt(e){return e}static AddUser(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=addUser&user="+escape(e)+"&password="+MD5.encrypt(r)));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_ADD_USER,s.nonfatalErrorOccurred=!0,s.latestCompletionFunction=t,s.StartTimer()}}static Login(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=login&user="+escape(e)+"&password="+MD5.encrypt(r)));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_LOGIN,s.nonfatalErrorOccurred=!0,s.latestCompletionFunction=t,s.StartTimer(),s.waitingForResponse=!0,s.curTransactionType=s.curAction}}static LoginGold(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=goldLogin&user="+escape(e)+"&password="+MD5.encrypt(r)));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_LOGIN_GOLD,s.nonfatalErrorOccurred=!0,s.latestCompletionFunction=t,s.StartTimer(),s.waitingForResponse=!0,s.curTransactionType=s.curAction}}static SaveRobot(e,r,t,a,n,o,i,d,l,E){if(!s.waitingForResponse){var R=s.PutRobotIntoByteArray(t);R.compress(),s.loader=new URLLoader;var c=new URLRequest(s.Encrypt(s.BASE_URL+"op=uploadRobot&user="+escape(e)+"&password="+r+"&shared="+o+"&allowEdit="+i+"&prop="+d+(null==a?"":"&name="+escape(a))+(null==n?"":"&desc="+escape(n))+(""==l?"":"&challenge="+l)));c.data=R,c.method=URLRequestMethod.POST,c.contentType="application/octet-stream",s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,E),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(c),s.curAction=s.ACTION_SAVE_ROBOT,s.latestCompletionFunction=E,s.StartTimer()}}static ExportRobot(e,r,t,a,n,o,i){var d=s.PutRobotIntoByteArray(e),l=new ByteArray;l.writeUTF(r),l.writeUTF(t),l.writeInt(a),l.writeInt(n),l.writeInt(o),d.position=0,l.writeBytes(d),l.compress(),l.position=0;var E=new Base64Encoder;E.encodeBytes(l),i(E.toString(),"robot")}static ExportReplay(e,r,t,a,n,o,i,d,l){var E=s.PutRobotIntoByteArray(n);E.compress();var R=s.PutReplayIntoByteArray(e);R.compress();var c=new ByteArray;for(c.writeInt(R.length),c.writeInt(E.length),R.position=0;R.position!=R.length;)c.writeByte(R.readByte());for(E.position=0;E.position!=E.length;)c.writeByte(E.readByte());c.writeUTF(r),c.writeUTF(t),c.writeUTF(a),c.writeInt(o),c.writeUTF(i),c.writeInt(d),c.compress(),c.position=0;var u=new Base64Encoder;u.encodeBytes(c),l(u.toString(),"replay")}static ExportChallenge(e,r,t,a,n,o){var i=s.PutChallengeIntoByteArray(e),d=new ByteArray;d.writeUTF(r),d.writeUTF(t),d.writeInt(a),d.writeInt(n),i.position=0,d.writeBytes(i),d.compress(),d.position=0;var l=new Base64Encoder;l.encodeBytes(d),o(l.toString(),"challenge")}static GetRobotData(e,r,t,a,n,o,i,d){if(!s.waitingForResponse){s.robotType=t?s.SHARED:s.NORMAL,s.curShared=t,s.curSortType=a,s.curSortPeriod=n,s.curRobotPage=o,s.curSearch=i,s.loader=new URLLoader;var l=new URLRequest(s.Encrypt(s.BASE_URL+"op=getRobots&user="+(t?"_Public":escape(e))+"&password="+r+"&sortType="+a+"&sortPeriod="+n+"&page="+o+"&search="+escape(i)));l.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,d),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(l),s.curAction=s.ACTION_GET_ROBOT_DATA,s.latestCompletionFunction=d,s.StartTimer()}}static LoadRobot(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadRobot&user="+escape(e)+"&password="+r+"&id="+s.robotList[t].id));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener(Event.COMPLETE,a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_LOAD_ROBOT,s.latestCompletionFunction=a,s.StartTimer()}}static LoadRobotByID(e,r){if(!s.waitingForResponse){s.loader=new URLLoader;var t=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadRobot&user=_Public&password=blah&id="+e));t.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener("complete",r),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(t),s.curAction=s.ACTION_LOAD_ROBOT,s.latestCompletionFunction=r,s.StartTimer()}}static DeleteRobot(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=deleteRobot&user="+escape(e)+"&password="+r+"&id="+s.robotList[t].id));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_DELETE_ROBOT,s.deleteNumber=t,s.nonfatalErrorOccurred=!0,s.latestCompletionFunction=a,s.StartTimer()}}static SaveReplay(e,r,t,a,n,o,i,d,l,E,R){if(!s.waitingForResponse){var c=new ByteArray,u=s.PutReplayIntoByteArray(t);for(u.compress(),u.position=0;u.position!=u.length;)c.writeByte(u.readByte());s.loader=new URLLoader;var p=new URLRequest(s.Encrypt(s.BASE_URL+"op=uploadReplay&user="+escape(e)+"&password="+r+"&shared="+E+(null==a?"":"&name="+escape(a))+(null==n?"":"&desc="+escape(n))+"&robot="+o+"&replayLength="+c.length+"&score="+d+"&challenge="+l));if(""==o){var O=s.PutRobotIntoByteArray(i);for(O.compress(),O.position=0;O.position!=O.length;)c.writeByte(O.readByte())}p.data=c,p.method=URLRequestMethod.POST,p.contentType="application/octet-stream",s.loader.addEventListener(Event.COMPLETE,R),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(p),s.curAction=s.ACTION_SAVE_REPLAY,s.latestCompletionFunction=R,s.StartTimer()}}static GetReplayData(e,r,t,a,n,o,i,d){if(!s.waitingForResponse){s.replayType=t?s.SHARED:s.NORMAL,s.curShared=t,s.curSortType=a,s.curSortPeriod=n,s.curReplayPage=o,s.curSearch=i,s.loader=new URLLoader;var l=new URLRequest(s.Encrypt(s.BASE_URL+"op=getReplays&user="+(t?"_Public":escape(e))+"&password="+r+"&sortType="+a+"&sortPeriod="+n+"&page="+o+"&search="+escape(i)));l.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,d),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(l),s.curAction=s.ACTION_GET_REPLAY_DATA,s.latestCompletionFunction=d,s.StartTimer()}}static LoadReplay(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadReplay&user="+escape(e)+"&password="+r+"&id="+s.replayList[t].id+"&robot="+s.replayList[t].robotID));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener("complete",a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_LOAD_REPLAY,s.latestCompletionFunction=a,s.StartTimer()}}static LoadReplayByID(e,r){if(!s.waitingForResponse){s.loader=new URLLoader;var t=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadReplay&user=_Public&password=blah&id="+e+"&robot=-1"));t.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener("complete",r),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(t),s.curAction=s.ACTION_LOAD_REPLAY,s.latestCompletionFunction=r,s.StartTimer()}}static LoadReplayFromScore(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadReplay&user="+escape(e)+"&password="+r+"&id="+s.scoreList[t].replayID+"&robot="+s.scoreList[t].robotID));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener("complete",a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_LOAD_REPLAY,s.latestCompletionFunction=a,s.StartTimer()}}static DeleteReplay(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=deleteReplay&user="+escape(e)+"&password="+r+"&id="+s.replayList[t].id));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener("complete",a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_DELETE_REPLAY,s.deleteNumber=t,s.nonfatalErrorOccurred=!0,s.latestCompletionFunction=a,s.StartTimer()}}static GetScoreData(e,r,t,a,n,o,i,d,l){if(!s.waitingForResponse){s.highScoresChallenge=t,s.highScoresDaily=a,s.highScoresPersonal=n,s.scoreType=a?s.DAILY:n?s.PERSONAL:s.ALLTIME,s.highScoresSortType=o,s.curScorePage=i,s.curSearch=d,s.loader=new URLLoader;var E=new URLRequest(s.Encrypt(s.BASE_URL+"op=getScores&user="+escape(e)+"&password="+r+"&challenge="+t+"&daily="+(a?1:0)+"&personal="+(n?1:0)+"&sortType="+o+"&page="+i+"&search="+escape(d)));E.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,l),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(E),s.curAction=s.ACTION_GET_SCORE_DATA,s.latestCompletionFunction=l,s.StartTimer()}}static SaveChallenge(e,r,t,a,n,o,i,d,l){if(!s.waitingForResponse){t.allParts=o;var E=s.PutChallengeIntoByteArray(t);E.compress(),s.loader=new URLLoader;var R=new URLRequest(s.Encrypt(s.BASE_URL+"op=uploadChallenge&user="+escape(e)+"&password="+r+"&shared="+i+"&allowEdit="+d+(null==a?"":"&name="+escape(a))+(null==n?"":"&desc="+escape(n))));R.data=E,R.method=URLRequestMethod.POST,R.contentType="application/octet-stream",s.loader.addEventListener(Event.COMPLETE,l),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(R),s.curAction=s.ACTION_SAVE_CHALLENGE,s.latestCompletionFunction=l,s.StartTimer()}}static GetChallengeData(e,r,t,a,n,o,i,d){if(!s.waitingForResponse){s.challengeType=t?s.SHARED:s.NORMAL,s.curShared=t,s.curSortType=a,s.curSortPeriod=n,s.curChallengePage=o,s.curSearch=i,s.loader=new URLLoader;var l=new URLRequest(s.Encrypt(s.BASE_URL+"op=getChallenges&user="+(t?"_Public":escape(e))+"&password="+r+"&sortType="+a+"&sortPeriod="+n+"&page="+o+"&search="+escape(i)));l.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,d),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(l),s.curAction=s.ACTION_GET_CHALLENGE_DATA,s.latestCompletionFunction=d,s.StartTimer()}}static LoadChallenge(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadChallenge&user="+escape(e)+"&password="+r+"&id="+s.challengeList[t].id));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener("complete",a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_LOAD_CHALLENGE,s.latestCompletionFunction=a,s.StartTimer()}}static LoadChallengeByID(e,r){if(!s.waitingForResponse){s.loader=new URLLoader;var t=new URLRequest(s.Encrypt(s.BASE_URL+"op=downloadChallenge&user=_Public&password=blah&id="+e));t.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.BINARY,s.loader.addEventListener("complete",r),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(t),s.curAction=s.ACTION_LOAD_CHALLENGE,s.latestCompletionFunction=r,s.StartTimer()}}static DeleteChallenge(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=deleteChallenge&user="+escape(e)+"&password="+r+"&id="+s.challengeList[t].id));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener("complete",a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_DELETE_CHALLENGE,s.deleteNumber=t,s.nonfatalErrorOccurred=!0,s.latestCompletionFunction=a,s.StartTimer()}}static CommentOnRobot(e,r){if(!s.waitingForResponse){s.loader=new URLLoader;var t=new URLRequest(s.Encrypt(s.BASE_URL+"op=commentRobot&id="+e));t.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,r),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(t),s.curAction=s.ACTION_COMMENT_ROBOT,s.latestCompletionFunction=r,s.StartTimer()}}static CommentOnReplay(e,r){if(!s.waitingForResponse){s.loader=new URLLoader;var t=new URLRequest(s.Encrypt(s.BASE_URL+"op=commentReplay&id="+e));t.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,r),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(t),s.curAction=s.ACTION_COMMENT_REPLAY,s.latestCompletionFunction=r,s.StartTimer()}}static CommentOnChallenge(e,r){if(!s.waitingForResponse){s.loader=new URLLoader;var t=new URLRequest(s.Encrypt(s.BASE_URL+"op=commentChallenge&id="+e));t.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,r),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(t),s.curAction=s.ACTION_COMMENT_CHALLENGE,s.latestCompletionFunction=r,s.StartTimer()}}static ReportRobot(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=reportRobot&id="+e+"&user="+escape(r)+"&desc="+escape(t)));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_REPORT_ROBOT,s.latestCompletionFunction=a,s.StartTimer()}}static ReportReplay(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=reportReplay&id="+e+"&user="+escape(r)+"&desc="+escape(t)));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_REPORT_REPLAY,s.latestCompletionFunction=a,s.StartTimer()}}static ReportChallenge(e,r,t,a){if(!s.waitingForResponse){s.loader=new URLLoader;var n=new URLRequest(s.Encrypt(s.BASE_URL+"op=reportChallenge&id="+e+"&user="+escape(r)+"&desc="+escape(t)));n.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,a),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(n),s.curAction=s.ACTION_REPORT_CHALLENGE,s.latestCompletionFunction=a,s.StartTimer()}}static RateRobot(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=rateRobot&id="+e+"&rating="+r));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_RATE_ROBOT,s.latestCompletionFunction=t,s.StartTimer()}}static RateReplay(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=rateReplay&id="+e+"&rating="+r));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_RATE_REPLAY,s.latestCompletionFunction=t,s.StartTimer()}}static RateChallenge(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=rateChallenge&id="+e+"&rating="+r));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_RATE_CHALLENGE,s.latestCompletionFunction=t,s.StartTimer()}}static FeatureRobot(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=featureRobot&id="+e+"&featured="+(r?1:0)));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_FEATURE_ROBOT,s.latestCompletionFunction=t,s.StartTimer()}}static FeatureReplay(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=featureReplay&id="+e+"&featured="+(r?1:0)));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_FEATURE_ROBOT,s.latestCompletionFunction=t,s.StartTimer()}}static FeatureChallenge(e,r,t){if(!s.waitingForResponse){s.loader=new URLLoader;var a=new URLRequest(s.Encrypt(s.BASE_URL+"op=featureChallenge&id="+e+"&featured="+(r?1:0)));a.method=URLRequestMethod.GET,s.loader.dataFormat=URLLoaderDataFormat.TEXT,s.loader.addEventListener(Event.COMPLETE,t),s.loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.addEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.loader.load(a),s.curAction=s.ACTION_FEATURE_CHALLENGE,s.latestCompletionFunction=t,s.StartTimer()}}static FinishFeaturing(e){s.StopTimer();var r=e.target.data.substring(4);if(0==r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),!1;try{return s.nonfatalErrorOccurred=!1,1==parseInt(r)}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static FinishRating(e){s.StopTimer();var r=e.target.data.substring(4);if(0==r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),!1;try{return s.nonfatalErrorOccurred=!1,1==parseInt(r)}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static FinishCommenting(e){s.StopTimer();var r=e.target.data.substring(4);if(0==r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),-1;if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),-1;try{return s.nonfatalErrorOccurred=!1,parseInt(r)}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return-1}static FinishReporting(e){s.StopTimer();var r=e.target.data.substring(4);if(0==r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),-1;if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),-1;try{return s.nonfatalErrorOccurred=!1,parseInt(r)}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return-1}static FinishAddingUser(e){s.StopTimer();var r=e.target.data.substring(4);return 0==r.search("ERROR")?(r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),""):0==r.length?(s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),""):(s.nonfatalErrorOccurred=!1,r)}static FinishLoggingIn(e){s.StopTimer();var r=e.target.data.substring(4);return 0==r.search("ERROR")?(r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),""):0==r.length?(s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),""):(s.nonfatalErrorOccurred=!1,r)}static FinishSavingRobot(e){s.StopTimer();var r=e.target.data.substring(4);return-1!=r.search("ERROR")?(r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),""):0==r.length?(s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),""):r}static FinishGettingRobotData(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR")&&r.search("ERROR")<5)return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;try{for(s.numPages=parseInt(r.substr(0,r.indexOf("\n"))),r=r.substr(r.indexOf("\n")+1),s.robotList=new Array;r.length>0;){var t=new Object;t.id=r.substr(0,r.indexOf("\t")),r=r.substr(r.indexOf("\t")+1),t.user=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.name=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.description=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.editable=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.shared=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.viewCount=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.createTime=s.ParseTimestamp(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.editTime=s.ParseTimestamp(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.rating=parseFloat(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.numRatings=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.featured=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.prop=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.challenge=r.substr(0,r.indexOf("\n")),r=r.substr(r.indexOf("\n")+1),s.robotList.push(t)}return!0}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static ImportRobot(e){var t=new Base64Decoder;t.decode(e);var a=t.toByteArray();return a.uncompress(),a.readUTF(),a.readUTF(),a.readInt(),a.readInt(),r.ControllerGameGlobals.potentialRobotPublic=!0,r.ControllerGameGlobals.potentialRobotEditable=!0,a.readInt(),s.ExtractRobotFromByteArray(a)}static ImportReplay(e){var t=new Base64Decoder;t.decode(e);var a=t.toByteArray();a.uncompress();for(var n=a.readInt(),o=a.readInt(),i=new ByteArray,d=new ByteArray;a.position<n+8;)i.writeByte(a.readByte());for(i.uncompress();a.position<n+o+8;)d.writeByte(a.readByte());d.uncompress();var l=s.ExtractReplayFromByteArray(i),E=s.ExtractRobotFromByteArray(d);return a.readUTF(),a.readUTF(),a.readUTF(),a.readInt(),a.readUTF(),r.ControllerGameGlobals.potentialReplayPublic=!0,[l,E]}static ImportChallenge(e){var t=new Base64Decoder;t.decode(e);var a=t.toByteArray();return a.uncompress(),a.readUTF(),a.readUTF(),a.readInt(),a.readInt(),r.ControllerGameGlobals.potentialChallengePublic=!0,r.ControllerGameGlobals.potentialChallengeEditable=!0,s.ExtractChallengeFromByteArray(a)}static FinishLoadingRobot(e){s.StopTimer();var r=s.StripNewlinesAndExtractByte(e.target.data);if(6==r.length||7==r.length){if("ERROR"==r.readUTFBytes(5))return s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r.readUTFBytes(r.bytesAvailable))]),null;r.position=0}else if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),null;try{for(var t="";r.position!=r.length;){var a=r.readByte();if(10==a)break;t=t.concat(String.fromCharCode(a))}var n=parseInt(t);r=s.StripNewlines(r);for(var o=new ByteArray,i=0;i<n;i++)o.writeByte(r.readByte());o.uncompress(),o.position=0;for(var d=s.ExtractRobotFromByteArray(o),l=new ByteArray;r.position!=r.length;)l.writeByte(r.readByte());return l.length>0&&(l.uncompress(),l.position=0,d.challenge=s.ExtractChallengeFromByteArray(l)),d}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return null}static FinishDeletingRobot(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),"";if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),"";try{var t=s.robotList[s.deleteNumber].id;return s.robotList=o.Util.RemoveFromArray(s.robotList[s.deleteNumber],s.robotList),s.nonfatalErrorOccurred=!1,t}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return""}static FinishSavingReplay(e){s.StopTimer();var r=e.target.data.substring(4);return-1!=r.search("ERROR")?(r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),""):0==r.length?(s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),""):r}static FinishGettingReplayData(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR")&&r.search("ERROR")<5)return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;try{for(s.numPages=parseInt(r.substr(0,r.indexOf("\n"))),r=r.substr(r.indexOf("\n")+1),s.replayList=new Array;r.length>0;){var t=new Object;t.id=r.substr(0,r.indexOf("\t")),r=r.substr(r.indexOf("\t")+1),t.user=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.name=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.description=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.robotID=r.substr(0,r.indexOf("\t")),r=r.substr(r.indexOf("\t")+1),t.shared=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.viewCount=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.createTime=s.ParseTimestamp(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.editTime=s.ParseTimestamp(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.rating=parseFloat(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.numRatings=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.featured=1==parseInt(r.substr(0,r.indexOf("\n"))),r=r.substr(r.indexOf("\n")+1),s.replayList.push(t)}return!0}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static FinishLoadingReplay(e){s.StopTimer();var r=s.StripNewlines(e.target.data);if(6==r.length||7==r.length){if("ERROR"==r.readUTFBytes(5))return s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r.readUTFBytes(r.bytesAvailable))]),null;r.position=0}else if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),null;try{for(var t="";r.position!=r.length;){var a=r.readByte();if(10==a)break;t=t.concat(String.fromCharCode(a))}var n=parseInt(t);r=s.StripNewlines(r);for(var o=new ByteArray,i=0;i<n;i++)o.writeByte(r.readByte());o.uncompress(),o.position=0;for(var d=s.ExtractReplayFromByteArray(o),l=new ByteArray;r.position!=r.length;)l.writeByte(r.readByte());l.uncompress(),l.position=0;var E=s.ExtractRobotFromByteArray(l),R=new Array;return R.push(d),R.push(E),R}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return null}static FinishDeletingReplay(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),!1;try{return s.replayList=o.Util.RemoveFromArray(s.replayList[s.deleteNumber],s.replayList),s.nonfatalErrorOccurred=!1,!0}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static FinishSavingChallenge(e){s.StopTimer();var r=e.target.data.substring(4);return-1!=r.search("ERROR")?(r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),""):0==r.length?(s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),""):r}static FinishGettingChallengeData(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR")&&r.search("ERROR")<5)return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;try{for(s.numPages=parseInt(r.substr(0,r.indexOf("\n"))),r=r.substr(r.indexOf("\n")+1),s.challengeList=new Array;r.length>0;){var t=new Object;t.id=r.substr(0,r.indexOf("\t")),r=r.substr(r.indexOf("\t")+1),t.user=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.name=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.description=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.editable=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.shared=1==parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.viewCount=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.createTime=s.ParseTimestamp(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.editTime=s.ParseTimestamp(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.rating=parseFloat(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.numRatings=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.featured=1==parseInt(r.substr(0,r.indexOf("\n"))),r=r.substr(r.indexOf("\n")+1),s.challengeList.push(t)}return!0}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static FinishLoadingChallenge(e){s.StopTimer();var r=s.StripNewlinesAndExtractByte(e.target.data);if(6==r.length||7==r.length){if("ERROR"==r.readUTFBytes(5))return s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r.readUTFBytes(r.bytesAvailable))]),null;r.position=0}else if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),null;try{return r.uncompress(),s.ExtractChallengeFromByteArray(r)}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return null}static FinishDeletingChallenge(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR"))return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;if(0==r.length)return s.ErrorHandler(new Event(""),s.NO_DATA_MESSAGE),!1;try{return s.challengeList=o.Util.RemoveFromArray(s.challengeList[s.deleteNumber],s.challengeList),s.nonfatalErrorOccurred=!1,!0}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static FinishGettingScoreData(e){s.StopTimer();var r=e.target.data.substring(4);if(-1!=r.search("ERROR")&&r.search("ERROR")<5)return r=r.substring(5),s.ErrorHandler(new Event(""),s.ERROR_MESSAGES[parseInt(r)]),!1;try{for(s.numPages=parseInt(r.substr(0,r.indexOf("\n"))),r=r.substr(r.indexOf("\n")+1),s.highScoresChallengeName=r.substr(0,r.indexOf("\n")),r=r.substr(r.indexOf("\n")+1),s.scoreList=new Array;r.length>0;){var t=new Object;t.user=unescape(r.substr(0,r.indexOf("\t"))).replace(/\+/g," "),r=r.substr(r.indexOf("\t")+1),t.score=parseInt(r.substr(0,r.indexOf("\t"))),r=r.substr(r.indexOf("\t")+1),t.replayID=r.substr(0,r.indexOf("\t")),r=r.substr(r.indexOf("\t")+1),t.robotID=r.substr(0,r.indexOf("\n")),r=r.substr(r.indexOf("\n")+1),s.scoreList.push(t)}return!0}catch(e){s.ErrorHandler(new Event(""),s.EXCEPTION_MESSAGE)}return!1}static StartTimer(){s.timeoutTimer=new Timer(1e3*s.TIMEOUT_SECONDS),s.timeoutTimer.addEventListener(TimerEvent.TIMER,s.TimeoutHandler),s.timeoutTimer.start(),s.waitingForResponse=!0,s.curTransactionType=s.curAction}static StopTimer(){s.waitingForResponse=!1,s.timeoutTimer&&(s.timeoutTimer.stop(),s.timeoutTimer.removeEventListener(TimerEvent.TIMER,s.TimeoutHandler))}static TimeoutHandler(e){s.loader.removeEventListener(Event.COMPLETE,s.latestCompletionFunction),s.loader.removeEventListener(SecurityErrorEvent.SECURITY_ERROR,s.ErrorHandler),s.loader.removeEventListener(IOErrorEvent.IO_ERROR,s.ErrorHandler),s.ErrorHandler(e,s.ERROR_MESSAGES[0])}static ErrorHandler(e,r=s.UNKNOWN_MESSAGE){s.StopTimer(),s.errorOccurred=!0,r==s.UNKNOWN_MESSAGE?(r=e instanceof SecurityErrorEvent?s.SECURITY_MESSAGE:s.IO_MESSAGE,s.lastErrorMsg="Error: "+r+"  Code: "+e.text):s.lastErrorMsg="Error: "+r,r==s.ERROR_MESSAGES[s.WRONG_VERSION_CODE]&&(s.versionErrorOccurred=!0)}static IsPartOfRobot(e,r,t){return e.drawAnyway}static IsShape(e,r,t){return e instanceof ShapePart}static PutChallengeIntoByteArray(e){var r=s.PutPartsIntoByteArray(e.allParts,new ByteArray);r.position=0;var t=s.ExtractPartsFromByteArray(r);r.writeObject(e.settings),r.writeBoolean(e.circlesAllowed),r.writeBoolean(e.rectanglesAllowed),r.writeBoolean(e.trianglesAllowed),r.writeBoolean(e.fixedJointsAllowed),r.writeBoolean(e.rotatingJointsAllowed),r.writeBoolean(e.slidingJointsAllowed),r.writeBoolean(e.thrustersAllowed),r.writeBoolean(e.fixateAllowed),r.writeBoolean(e.mouseDragAllowed),r.writeBoolean(e.botControlAllowed),r.writeDouble(e.minDensity),r.writeDouble(e.maxDensity),r.writeDouble(e.maxRJStrength),r.writeDouble(e.maxRJSpeed),r.writeDouble(e.maxSJStrength),r.writeDouble(e.maxSJSpeed),r.writeDouble(e.maxThrusterStrength),r.writeObject(e.buildAreas);for(var a=t.filter(s.IsShape),n=e.winConditions.length-1;n>=0;n--){if(e.winConditions[n].shape1)for(var i=0;i<a.length;i++)e.winConditions[n].shape1.equals(a[i])&&(e.winConditions[n].shape1Index=i);if(e.winConditions[n].shape2)for(i=0;i<a.length;i++)e.winConditions[n].shape2.equals(a[i])&&(e.winConditions[n].shape2Index=i);(0==e.winConditions[n].subject&&-1==e.winConditions[n].shape1Index||e.winConditions[n].object>4&&-1==e.winConditions[n].shape2Index)&&(e.winConditions=o.Util.RemoveFromArray(e.winConditions[n],e.winConditions))}for(n=e.lossConditions.length-1;n>=0;n--){if(e.lossConditions[n].shape1)for(i=0;i<a.length;i++)e.lossConditions[n].shape1.equals(a[i])&&(e.lossConditions[n].shape1Index=i);if(e.lossConditions[n].shape2)for(i=0;i<a.length;i++)e.lossConditions[n].shape2.equals(a[i])&&(e.lossConditions[n].shape2Index=i);(0==e.lossConditions[n].subject&&-1==e.lossConditions[n].shape1Index||e.lossConditions[n].object>4&&-1==e.lossConditions[n].shape2Index)&&(e.lossConditions=o.Util.RemoveFromArray(e.lossConditions[n],e.lossConditions))}for(r.writeObject(e.winConditions),r.writeObject(e.lossConditions),n=0;n<e.winConditions.length;n++)e.winConditions[n].shape1Index=-1,e.winConditions[n].shape2Index=-1;for(n=0;n<e.lossConditions.length;n++)e.lossConditions[n].shape1Index=-1,e.lossConditions[n].shape2Index=-1;return r.writeBoolean(e.winConditionsAnded),r.writeFloat(e.cameraX),r.writeFloat(e.cameraY),r.writeFloat(e.zoomLevel),r.writeBoolean(e.nonCollidingAllowed),r.writeBoolean(e.showConditions),r.writeBoolean(e.cannonsAllowed),r}static ExtractChallengeFromByteArray(r){var t=s.ExtractPartsFromByteArray(r),a=r.readObject(),i=new e.Challenge(new n.SandboxSettings(a.gravity,a.size,a.terrainType,a.terrainTheme,a.background,a.backgroundR,a.backgroundG,a.backgroundB));i.allParts=t,i.circlesAllowed=r.readBoolean(),i.rectanglesAllowed=r.readBoolean(),i.trianglesAllowed=r.readBoolean(),i.fixedJointsAllowed=r.readBoolean(),i.rotatingJointsAllowed=r.readBoolean(),i.slidingJointsAllowed=r.readBoolean(),i.thrustersAllowed=r.readBoolean(),i.fixateAllowed=r.readBoolean(),i.mouseDragAllowed=r.readBoolean(),i.botControlAllowed=r.readBoolean(),i.minDensity=r.readDouble(),i.maxDensity=r.readDouble(),i.maxRJStrength=r.readDouble(),i.maxRJSpeed=r.readDouble(),i.maxSJStrength=r.readDouble(),i.maxSJSpeed=r.readDouble(),i.maxThrusterStrength=r.readDouble();var d=r.readObject();i.buildAreas=new Array;for(var l=0;l<d.length;l++){var E=new b2AABB;E.lowerBound=o.Util.Vector(d[l].lowerBound.x,d[l].lowerBound.y),E.upperBound=o.Util.Vector(d[l].upperBound.x,d[l].upperBound.y),i.buildAreas.push(E)}var R=r.readObject(),c=t.filter(s.IsShape);for(l=0;l<R.length;l++){var u=new WinCondition(R[l].name,R[l].subject,R[l].object);u.minX=R[l].minX,u.maxX=R[l].maxX,u.minY=R[l].minY,u.maxY=R[l].maxY,-1!=R[l].shape1Index&&(u.shape1=c[R[l].shape1Index]),-1!=R[l].shape2Index&&(u.shape2=c[R[l].shape2Index]),i.winConditions.push(u)}for(R=r.readObject(),l=0;l<R.length;l++){var p=new LossCondition(R[l].name,R[l].subject,R[l].object,R[l].immediate);p.minX=R[l].minX,p.maxX=R[l].maxX,p.minY=R[l].minY,p.maxY=R[l].maxY,-1!=R[l].shape1Index&&(p.shape1=c[R[l].shape1Index]),-1!=R[l].shape2Index&&(p.shape2=c[R[l].shape2Index]),i.lossConditions.push(p)}return i.winConditionsAnded=r.readBoolean(),r.position!=r.length&&(i.cameraX=r.readFloat(),i.cameraY=r.readFloat(),i.zoomLevel=r.readFloat()),r.position!=r.length&&(i.nonCollidingAllowed=r.readBoolean(),i.showConditions=r.readBoolean()),r.position!=r.length?i.cannonsAllowed=r.readBoolean():i.cannonsAllowed=i.rectanglesAllowed&&i.slidingJointsAllowed&&i.rotatingJointsAllowed&&i.slidingJointsAllowed&&i.thrustersAllowed,i}static PutPartsIntoByteArray(e,r){e=e.filter(s.IsPartOfRobot);for(var t=new Array,a=0;a<e.length;a++)(e[a]instanceof ShapePart||e[a]instanceof TextPart)&&t.push(e[a]);var n=0;for(a=0;a<e.length;a++)e[a]instanceof JointPart||e[a]instanceof Thrusters?(t.push(e[a]),e[a]instanceof PrismaticJoint&&(e[a].arrayIndex=n,n++)):n++;for(a=0;a<t.length;a++)if(t[a]instanceof JointPart)for(var o=0;o<e.length;o++)t[o]==t[a].part1&&(t[a].part1Index=o),t[o]==t[a].part2&&(t[a].part2Index=o);else if(t[a]instanceof Thrusters)for(o=0;o<e.length;o++)t[o]==t[a].shape&&(t[a].shapeIndex=o);return r.writeObject(t),r}static ExtractPartsFromByteArray(e){console.log(e);for(var r=e.readObject(),t=new Array,a=0;a<r.length;a++){var n;if("Circle"==r[a].type||"Rectangle"==r[a].type||"Triangle"==r[a].type||"Cannon"==r[a].type)"Circle"==r[a].type?n=new Circle(r[a].centerX,r[a].centerY,r[a].radius,!1):"Rectangle"==r[a].type?n=new Rectangle(r[a].x,r[a].y,r[a].w,r[a].h,!1):"Triangle"==r[a].type?n=new Triangle(r[a].x1,r[a].y1,r[a].x2,r[a].y2,r[a].x3,r[a].y3):"Cannon"==r[a].type&&((n=new Cannon(r[a].x,r[a].y,r[a].w)).fireKey=r[a].fireKey,n.strength=r[a].strength),n.angle=r[a].angle,n.density=r[a].density,n.collide=r[a].collide,n.isStatic=r[a].isStatic,n.isCameraFocus=r[a].isCameraFocus,n.red=r[a].red,n.green=r[a].green,n.blue=r[a].blue,n.opacity=r[a].opacity,n.outline=r[a].outline,r[a].hasOwnProperty("terrain")&&(n.terrain=r[a].terrain),r[a].hasOwnProperty("undragable")&&(n.undragable=r[a].undragable),t.push(n);else if("TextPart"==r[a].type){var s=new TextPart(Main.m_curController,r[a].x,r[a].y,r[a].w,r[a].h,r[a].text,r[a].inFront);s.inFront=r[a].inFront,s.scaleWithZoom=r[a].scaleWithZoom,s.alwaysVisible=r[a].alwaysVisible,s.displayKey=r[a].displayKey,s.red=r[a].red,s.green=r[a].green,s.blue=r[a].blue,s.size=r[a].size,t.push(s)}else if("Thrusters"==r[a].type){if(r[a].shapeIndex>=0){var i=new Thrusters(t[r[a].shapeIndex],r[a].centerX,r[a].centerY);i.strength=r[a].strength,i.angle=r[a].angle,i.thrustKey=r[a].thrustKey,i.autoOn=r[a].autoOn,t.push(i)}}else if("FixedJoint"==r[a].type||"RevoluteJoint"==r[a].type||"PrismaticJoint"==r[a].type){var d;if(r[a].part1Index>=0&&r[a].part2Index>=0)"FixedJoint"==r[a].type?d=new FixedJoint(t[r[a].part1Index],t[r[a].part2Index],r[a].anchorX,r[a].anchorY):"RevoluteJoint"==r[a].type?((d=new RevoluteJoint(t[r[a].part1Index],t[r[a].part2Index],r[a].anchorX,r[a].anchorY)).enableMotor=r[a].enableMotor,d.motorCWKey=r[a].motorCWKey,d.motorCCWKey=r[a].motorCCWKey,d.motorStrength=r[a].motorStrength,d.motorSpeed=r[a].motorSpeed,d.motorLowerLimit=r[a].motorLowerLimit,d.motorUpperLimit=r[a].motorUpperLimit,d.isStiff=r[a].isStiff,d.autoCW=r[a].autoCW,d.autoCCW=r[a].autoCCW):"PrismaticJoint"==r[a].type&&((d=new PrismaticJoint(t[r[a].part1Index],t[r[a].part2Index],0,0,1,1)).anchorX=r[a].anchorX,d.anchorY=r[a].anchorY,d.axis=new b2Vec2(r[a].axis.x,r[a].axis.y),d.enablePiston=r[a].enablePiston,d.pistonUpKey=r[a].pistonUpKey,d.pistonDownKey=r[a].pistonDownKey,d.pistonStrength=r[a].pistonStrength,d.pistonSpeed=r[a].pistonSpeed,d.isStiff=r[a].isStiff,d.autoOscillate=r[a].autoOscillate,d.initLength=r[a].initLength,d.red=r[a].red,d.green=r[a].green,d.blue=r[a].blue,d.opacity=r[a].opacity,d.outline=r[a].outline,d.collide=r[a].collide,r[a].hasOwnProperty("arrayIndex")&&(d.arrayIndex=r[a].arrayIndex)),t.push(d)}}for(a=0;a<t.length;a++)if(t[a]instanceof PrismaticJoint&&-1!=t[a].arrayIndex){var l=t[a];t=o.Util.RemoveFromArray(l,t),t=o.Util.InsertIntoArray(l,t,l.arrayIndex)}return t}static PutRobotIntoByteArray(e){var r=s.PutPartsIntoByteArray(e.allParts,new ByteArray);return r.writeObject(e.settings),r.writeFloat(e.cameraX),r.writeFloat(e.cameraY),r.writeFloat(e.zoomLevel),r}static async ExtractRobotFromByteArray(e){e=e.arrayBuffer();var r=s.ExtractPartsFromByteArray(e);if(e.position==e.length)return new a.Robot(r,new n.SandboxSettings(15,1,0,0,0),Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);var t=e.readObject(),o=Number.MAX_VALUE,i=Number.MAX_VALUE,d=Number.MAX_VALUE;return e.position!=e.length&&(o=e.readFloat(),i=e.readFloat(),d=e.readFloat()),new a.Robot(r,new n.SandboxSettings(t.gravity,t.size,t.terrainType,t.terrainTheme,t.background,t.backgroundR,t.backgroundG,t.backgroundB),o,i,d)}static PutReplayIntoByteArray(e){for(var r=new ByteArray,t=0;t<e.cameraMovements.length;t++)s.WriteInt(r,e.cameraMovements[t].frame),s.WriteFloat(r,e.cameraMovements[t].x/100),s.WriteFloat(r,e.cameraMovements[t].y/100),s.WriteFloat(r,e.cameraMovements[t].scale);for(s.WriteInt(r,Number.MIN_VALUE),s.WriteInt(r,Number.MIN_VALUE),t=0;t<e.syncPoints.length;t++){s.WriteInt(r,e.syncPoints[t].frame);for(var a=0;a<e.syncPoints[t].positions.length;a++)0!=t&&t!=e.syncPoints.length-1&&e.syncPoints[t].positions[a].x==e.syncPoints[t-1].positions[a].x&&e.syncPoints[t].positions[a].y==e.syncPoints[t-1].positions[a].y&&e.syncPoints[t].angles[a]==e.syncPoints[t-1].angles[a]||(s.WriteFloat(r,e.syncPoints[t].positions[a].x),s.WriteFloat(r,e.syncPoints[t].positions[a].y),e.syncPoints[t].angles[a]<=-32.7||e.syncPoints[t].angles[a]>=32.8?s.WriteFloat(r,10*s.NormalizeAngle(e.syncPoints[t].angles[a])):s.WriteFloat(r,10*e.syncPoints[t].angles[a]),s.WriteInt(r,a));if(s.WriteFloat(r,Number.NEGATIVE_INFINITY),e.syncPoints[t].cannonballPositions.length>0){for(s.WriteInt(r,-1),a=0;a<e.syncPoints[t].cannonballPositions.length;a++)s.WriteFloat(r,e.syncPoints[t].cannonballPositions[a].x),s.WriteFloat(r,e.syncPoints[t].cannonballPositions[a].y);s.WriteFloat(r,Number.NEGATIVE_INFINITY)}}for(s.WriteInt(r,Number.MIN_VALUE),r.writeObject(e.version),s.WriteInt(r,e.numFrames),t=0;t<e.keyPresses.length;t++)s.WriteInt(r,e.keyPresses[t].frame),s.WriteInt(r,e.keyPresses[t].key);return s.WriteInt(r,Number.MIN_VALUE),r}static async ExtractReplayFromByteArray(e){console.log(e);await e.arrayBuffer();for(var r=new Array;;){var a=s.ReadInt(e);if(a==Number.MIN_VALUE)break;var n=100*s.ReadFloat(e),i=100*s.ReadFloat(e),d=s.ReadFloat(e);r.push(new CameraMovement(a,n,i,d))}var l=new Array,E=!1,R=!0;for((a=s.ReadInt(e))==Number.MIN_VALUE&&(E=!0,R=!1);R||(a=s.ReadInt(e)),R=!1,a!=Number.MIN_VALUE;)if(-1==a)for(;(n=s.ReadFloat(e))!=Number.NEGATIVE_INFINITY;)i=s.ReadFloat(e),l[l.length-1].cannonballPositions.push(o.Util.Vector(n,i));else{var c=new ReplaySyncPoint;c.frame=a;for(var u=0;;){if((n=s.ReadFloat(e))!=Number.NEGATIVE_INFINITY){i=s.ReadFloat(e);var p=s.ReadFloat(e);E&&(p/=10)}var O;if(n==Number.NEGATIVE_INFINITY){if(0==l.length)break;O=l[l.length-1].positions.length}else O=s.ReadInt(e);for(;u<O;)c.positions.push(l[l.length-1].positions[u]),c.angles.push(l[l.length-1].angles[u]),u++;if(n==Number.NEGATIVE_INFINITY)break;c.positions.push(o.Util.Vector(n,i)),c.angles.push(p),u++}l.push(c)}var L=e.readObject().toString(),A=s.ReadInt(e),T=new Array;if(e.position!=e.length)for(;(a=s.ReadInt(e))!=Number.MIN_VALUE;){var m=s.ReadInt(e);T.push(new KeyPress(a,m))}return new t.Replay(r,l,T,A,L)}static WriteFloat(e,r){if(r==Number.NEGATIVE_INFINITY)return e.writeByte(-128),void e.writeByte(-128);if(r==Number.POSITIVE_INFINITY)return e.writeByte(127),void e.writeByte(127);r+=327,r*=100;var t=o.Util.NearestInt(r),a=t/256,n=t%256;e.writeByte(a-128),e.writeByte(n-128)}static WriteInt(e,r){r==Number.MIN_VALUE?(e.writeByte(-1),e.writeByte(-1)):-1==r?(e.writeByte(0),e.writeByte(-1)):(e.writeByte(r/128),e.writeByte(r%128))}static ReadFloat(e){var r=e.readByte()+128,t=e.readByte()+128;if(0==r&&0==t)return Number.NEGATIVE_INFINITY;if(255==r&&255==t)return Number.POSITIVE_INFINITY;var a=Number(256*r+t);return a/=100,a-=327}static ReadInt(e){var r=e.readByte(),t=e.readByte();return-1==r&&-1==t?Number.MIN_VALUE:0==r&&-1==t?-1:128*r+t}static NormalizeAngle(e){for(;e>=32.8;)e-=10*Math.PI;for(;e<=-32.7;)e+=10*Math.PI;return e}static StripNewlines(e){var r=new ByteArray;for(e.position+=4;e.position!=e.length;)r.writeByte(e.readByte());return r.position=0,r}static StripNewlinesAndExtractByte(e){var t=new ByteArray;for(e.position+=4,r.ControllerGameGlobals.potentialRobotEditable=49==e.readByte();e.position!=e.length;)t.writeByte(e.readByte());return t.position=0,t}static ParseTimestamp(e){var r=Date.parse(e.replace("-","/").replace("-","/").replace("T"," "));return isNaN(r)&&14==e.length&&(e=e.substr(0,4)+"/"+e.substr(4,2)+"/"+e.substr(6,2)+" "+e.substr(8,2)+":"+e.substr(10,2)+":"+e.substr(12,2),r=Date.parse(e)),r}}exports.Database=s,s.waitingForResponse=!1,s.curTransactionType=0,s.errorOccurred=!1,s.versionErrorOccurred=!1,s.nonfatalErrorOccurred=!1,s.curRobotPage=1,s.curReplayPage=1,s.curScorePage=1,s.curChallengePage=1,s.numPages=-1,s.highScoresChallenge="",s.highScoresChallengeName="",s.highScoresSortType=-1,s.highScoresDaily=!1,s.highScoresPersonal=!1,s.curSortType=1,s.curSortPeriod=-1,s.curShared=!0,s.curSearch="",s.NORMAL=0,s.SHARED=1,s.ALLTIME=2,s.DAILY=3,s.PERSONAL=4,s.SORT_BY_SCORE=-1,s.SORT_BY_VIEW_COUNT=0,s.SORT_BY_CREATION_TIME=1,s.SORT_BY_EDIT_TIME=2,s.SORT_ALPHABETICALLY=3,s.SORT_BY_RATING=4,s.SORT_PERIOD_FEATURED=-1,s.SORT_PERIOD_ALLTIME=0,s.SORT_PERIOD_TODAY=1,s.SORT_PERIOD_7DAYS=2,s.SORT_PERIOD_30DAYS=3,s.SORT_PERIOD_PROP=4,s.NUM_ACTIONS=28,s.ACTION_SAVE_ROBOT=0,s.ACTION_GET_ROBOT_DATA=1,s.ACTION_LOAD_ROBOT=2,s.ACTION_DELETE_ROBOT=3,s.ACTION_SAVE_REPLAY=4,s.ACTION_GET_REPLAY_DATA=5,s.ACTION_LOAD_REPLAY=6,s.ACTION_DELETE_REPLAY=7,s.ACTION_GET_SCORE_DATA=8,s.ACTION_ADD_USER=9,s.ACTION_LOGIN=10,s.ACTION_COMMENT_ROBOT=11,s.ACTION_COMMENT_REPLAY=12,s.ACTION_REPORT_ROBOT=13,s.ACTION_REPORT_REPLAY=14,s.ACTION_RATE_ROBOT=15,s.ACTION_RATE_REPLAY=16,s.ACTION_FEATURE_ROBOT=17,s.ACTION_FEATURE_REPLAY=18,s.ACTION_LOGIN_GOLD=19,s.ACTION_SAVE_CHALLENGE=20,s.ACTION_GET_CHALLENGE_DATA=21,s.ACTION_LOAD_CHALLENGE=22,s.ACTION_DELETE_CHALLENGE=23,s.ACTION_COMMENT_CHALLENGE=24,s.ACTION_REPORT_CHALLENGE=25,s.ACTION_RATE_CHALLENGE=26,s.ACTION_FEATURE_CHALLENGE=27,s.WRONG_VERSION_CODE=17,s.VERSION_STRING_FOR_REPLAYS="0.03",s.BASE_URL="http://localhost:8888/incredibots2/database/ggscores.php?version="+s.VERSION_STRING_FOR_REPLAYS+"&",s.UNKNOWN_MESSAGE="UNKNOWN",s.IO_MESSAGE="An I/O error has occurred.",s.SECURITY_MESSAGE="A security error has occurred.",s.NO_DATA_MESSAGE="An unknown error has occurred.",s.EXCEPTION_MESSAGE="An error has occurred.",s.ERROR_MESSAGES=["Failed to connect to the server.","A URL error has occurred.","A URL error has occurred.","A URL error has occurred.","A URL error has occurred.","You don't have permission to access that robot.","An invalid robot ID was used.","An unknown error has occurred (code 7).","An incorrect password was used.","The given username instanceof already in use.","An invalid username was used.","The given name instanceof too long.","The given name contains invalid characters.","The given name contains profanity.","An unknown error has occurred (code 14).","A URL error has occurred.","A database error has occurred.","You are playing an old version of IncrediBots.  Click OK to redirect to the current version.","An invalid replay ID was used.","Sorry, that user instanceof not an IncrediBots supporter. Click Subscribe to become one.","Your IncrediBots Gold subscription has expired.  Click Subscribe to renew.","An invalid challenge ID was used."],s.TIMEOUT_SECONDS=20;
},{"../Game/Challenge":"yWA3","../Game/Globals/ControllerGameGlobals":"K8aL","../Game/Replay":"odHz","../Game/Robot":"H0hU","../Game/SandboxSettings":"ZSAP","./Util":"Zvyo"}],"unNJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LSOManager=void 0;const a=require("./Util");class e{static Init(){e.obj=localStorage.Incredibots?JSON.parse(localStorage.Incredibots):e.obj,e.obj.data.hasOwnProperty("levelCheckmarks")||(e.obj.data.levelCheckmarks=0,e.flush(e.obj)),e.obj.data.hasOwnProperty("robotsRated")||(e.obj.data.robotsRated=new Array,e.flush(e.obj)),e.obj.data.hasOwnProperty("replaysRated")||(e.obj.data.replaysRated=new Array,e.flush(e.obj)),e.obj.data.hasOwnProperty("challengesRated")||(e.obj.data.challengesRated=new Array,e.flush(e.obj)),e.obj.data.hasOwnProperty("readTerms2")||(e.obj.data.readTerms2=!1),e.flush(e.obj)}static IsLevelDone(a){return 0!=(e.obj.data.levelCheckmarks&1<<a)}static IsAnythingDone(){return 0!=e.obj.data.levelCheckmarks}static SetLevelDone(a){e.obj.data.levelCheckmarks|=1<<a,e.flush(e.obj)}static HasRatedRobot(t){return a.Util.ObjectInArray(t,e.obj.data.robotsRated)}static HasRatedReplay(t){return a.Util.ObjectInArray(t,e.obj.data.replaysRated)}static HasRatedChallenge(t){return a.Util.ObjectInArray(t,e.obj.data.challengesRated)}static SetRobotRated(a){e.obj.data.robotsRated.push(a),e.flush(e.obj)}static SetReplayRated(a){e.obj.data.replaysRated.push(a),e.flush(e.obj)}static SetChallengeRated(a){e.obj.data.challengesRated.push(a),e.flush(e.obj)}static HasReadTerms(){return e.obj.data.readTerms2}static SetTermsRead(){e.obj.data.readTerms2=!0,e.flush(e.obj)}static flush(a){localStorage.Incredibots=JSON.stringify(a)}}exports.LSOManager=e,e.obj={data:{levelCheckmarks:0,robotsRated:[],replaysRated:[],challengesRated:[],readTerms2:!1}};
},{"./Util":"Zvyo"}],"eAVa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Part=exports.IllegalOperationError=void 0;class t extends Error{}exports.IllegalOperationError=t;class e{constructor(){this.isEnabled=!0,this.isStatic=!1,this.isEditable=!0,this.isInitted=!1,this.checkedCollisionGroup=!1,this.drawAnyway=!0,this.isSandbox=!1}IsEnabled(t,e,a){return this.isEnabled}Init(t,e=null){this.isInitted=!0}UnInit(t){this.isInitted=!1}InsideShape(e,a,r){throw new t("abstract Part.InsideShape() called")}Move(e,a){throw new t("abstract Part.Move() called")}RotateAround(e,a,r){throw new t("abstract Part.RotateAround() called")}KeyInput(e,a,r){throw new t("abstract Part.KeyInput() called")}Update(e){throw new t("abstract Part.Update() called")}GetAttachedParts(e=null){throw new t("abstract Part.GetAttachedParts() called")}IntersectsBox(e,a,r,s){throw new t("abstract Part.IntersectsBox() called")}PrepareForResizing(){throw new t("abstract Part.PrepareForResizing() called")}ToString(){return"isEnabled="+this.isEnabled+", isStatic="+this.isStatic+", isEditable="+this.isEditable+", isInitted="+this.isInitted+", type="+this.type}}exports.Part=e;
},{}],"avwv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JointPart=void 0;const t=require("../General/Util"),r=require("./Part");class i extends r.Part{constructor(t,r){super(),this.part1Index=-1,this.part2Index=-1,this.m_joint=null,this.part1=t,this.part2=r,this.part1.AddJoint(this),this.part2.AddJoint(this)}GetJoint(){return this.m_joint}GetOtherPart(t){return t==this.part1?this.part2:t==this.part2?this.part1:null}UnInit(t){this.isInitted&&(super.UnInit(t),this.m_joint=null)}Move(t,r){this.anchorX=t,this.anchorY=r}RotateAround(r,i,s){var a=t.Util.GetDist(this.anchorX,this.anchorY,r,i),e=this.rotateAngle+s;this.Move(r+a*Math.cos(e),i+a*Math.sin(e))}MakeCopy(t,i){throw new r.IllegalOperationError("abstract JointPart.MakeCopy() called")}GetAttachedParts(t=null){null==t&&(t=new Array),t.push(this);for(var r=!1,i=!1,s=0;s<t.length;s++)this.part1==t[s]&&(r=!0),this.part2==t[s]&&(i=!0);return r||t.concat(this.part1.GetAttachedParts(t)),i||t.concat(this.part2.GetAttachedParts(t)),t}IntersectsBox(t,r,i,s){return this.anchorX>=t&&this.anchorX<=t+i&&this.anchorY>=r&&this.anchorY<=r+s}PrepareForResizing(){}ToString(){return"anchorX="+this.anchorX+", anchorY="+this.anchorY+", "+super.ToString()}}exports.JointPart=i;
},{"../General/Util":"Zvyo","./Part":"eAVa"}],"QW19":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FixedJoint=void 0;const t=require("../General/Util"),e=require("./JointPart");class i extends e.JointPart{constructor(t,e,i,r){super(t,e),this.anchorX=i,this.anchorY=r,this.type="FixedJoint"}Init(t,e=null){!this.isInitted&&this.part1.isInitted&&this.part2.isInitted&&super.Init(t)}MakeCopy(t,e){return new i(t,e,this.anchorX,this.anchorY)}Update(t){}InsideShape(e,i,r){return t.Util.GetDist(this.anchorX,this.anchorY,e,i)<.18*30/r}KeyInput(t,e,i){}ToString(){return"FixedJoint: "+super.ToString()}}exports.FixedJoint=i;
},{"../General/Util":"Zvyo","./JointPart":"avwv"}],"CDAe":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShapePart=void 0;const t=require("../Game/Globals/ControllerGameGlobals"),e=require("../General/Util"),i=require("./FixedJoint"),s=require("./Part");class r extends s.Part{constructor(e,i){super(),this.collide=!0,this.isCameraFocus=!1,this.m_collisionGroup=Number.MIN_SAFE_INTEGER,this.highlightForJoint=!1,this.isBullet=!1,this.m_body=null,this.m_shape=null,this.m_fixture=null,this.centerX=e,this.centerY=i,t.ControllerGameGlobals.minDensity>15?this.density=t.ControllerGameGlobals.minDensity:t.ControllerGameGlobals.maxDensity<15?this.density=t.ControllerGameGlobals.maxDensity:this.density=15,this.angle=0,this.red=t.ControllerGameGlobals.defaultR,this.green=t.ControllerGameGlobals.defaultG,this.blue=t.ControllerGameGlobals.defaultB,this.opacity=t.ControllerGameGlobals.defaultO,this.outline=!0,this.terrain=!1,this.undragable=!1,this.m_joints=new Array,this.m_thrusters=new Array}GetBody(){return this.m_body}GetShape(){return this.m_shape}GetFixture(){return this.m_fixture}GetUserData(){return this.m_body.GetUserData()||{}}AddJoint(t){this.m_joints.push(t)}AddThrusters(t){this.m_thrusters.push(t)}Move(t,e){this.centerX=t,this.centerY=e}RotateAround(t,i,s){var r=e.Util.GetDist(this.centerX,this.centerY,t,i),a=this.rotateAngle+s;this.Move(t+r*Math.cos(a),i+r*Math.sin(a)),this.angle=s+this.rotateOrientation}MakeCopy(){throw new s.IllegalOperationError("abstract ShapePart.MakeCopy() called")}HeavierThan(t){return this.m_body.GetMass()>t.GetBody().GetMass()}GetMass(){return this.m_body?this.m_body.GetMass():this.GetArea()*(this.density+5)/10}GetArea(){throw new s.IllegalOperationError("abstract ShapePart.GetArea() called")}UnInit(t){this.isInitted&&(super.UnInit(t),this.m_body&&(this.m_body.GetUserData()&&this.m_body.GetUserData().deleted||(t.DestroyBody(this.m_body),this.m_body.GetUserData()||this.m_body.SetUserData({}),this.m_body.GetUserData().deleted=!0),this.m_body=null))}Update(t){}KeyInput(t,e,i){}SetCollisionGroup(t){if(!this.checkedCollisionGroup){this.checkedCollisionGroup=!0,this.m_collisionGroup=t;for(var e=0;e<this.m_joints.length;e++)this.m_joints[e].isEnabled&&this.m_joints[e].GetOtherPart(this).SetCollisionGroup(t)}}GetActiveJoints(){return this.m_joints.filter(this.IsEnabled)}GetActiveThrusters(){return this.m_thrusters.filter(this.IsEnabled)}WillBeStatic(t=null){if(this.isStatic)return!0;null==t&&(t=new Array),t.push(this);for(var s=0;s<this.m_joints.length;s++)if(this.m_joints[s]instanceof i.FixedJoint){var r=this.m_joints[s].GetOtherPart(this);if(!e.Util.ObjectInArray(r,t)&&r.WillBeStatic(t))return!0}return!1}GetAttachedParts(t=null){null==t&&(t=new Array),t.push(this);for(var e=0;e<this.m_joints.length;e++)if(this.m_joints[e].isEnabled){for(var i=!1,s=0;s<t.length;s++)this.m_joints[e]==t[s]&&(i=!0);i||t.concat(this.m_joints[e].GetAttachedParts(t))}for(e=0;e<this.m_thrusters.length;e++)if(this.m_thrusters[e].isEnabled){for(i=!1,s=0;s<t.length;s++)this.m_thrusters[e]==t[s]&&(i=!0);i||t.concat(this.m_thrusters[e].GetAttachedParts(t))}return t}static GetOutlineVertices(t,i,s){var r=new Array;if(3==i){var a=e.Util.Vector((t[0].x+t[1].x+t[2].x)/3,(t[0].y+t[1].y+t[2].y)/3),l=e.Util.GetDist(t[0].x,t[0].y,t[1].x,t[1].y),h=e.Util.GetDist(t[0].x,t[0].y,t[2].x,t[2].y),n=e.Util.GetDist(t[1].x,t[1].y,t[2].x,t[2].y),o=(l+h+n)/3,u=e.Util.NormalizeAngle(Math.acos((l*l+h*h-n*n)/(2*l*h))),d=e.Util.NormalizeAngle(Math.acos((l*l+n*n-h*h)/(2*l*n))),m=e.Util.NormalizeAngle(Math.acos((h*h+n*n-l*l)/(2*h*n))),c=180*Math.min(u,d,m)/Math.PI,y=1+2.5*s/o*(c<30?30/c:1);r.push(e.Util.Vector(a.x+(t[0].x-a.x)*y,a.y+(t[0].y-a.y)*y)),r.push(e.Util.Vector(a.x+(t[1].x-a.x)*y,a.y+(t[1].y-a.y)*y)),r.push(e.Util.Vector(a.x+(t[2].x-a.x)*y,a.y+(t[2].y-a.y)*y))}else for(var G=0;G<i;G++){var b=0==G?t[i-1]:t[G-1],_=t[G],p=G==i-1?t[0]:t[G+1],x=Math.atan2(b.y-_.y,b.x-_.x),g=Math.atan2(p.y-_.y,p.x-_.x),M=e.Util.NormalizeAngle((x+g)/2+(Math.max(x,g)-Math.min(x,g)<Math.PI?Math.PI:0));r.push(e.Util.Vector(_.x+Math.cos(M)*s*1.1,_.y+Math.sin(M)*s*1.1))}return r}equals(t){return this.isStatic==t.isStatic&&this.NumbersEqual(this.centerX,t.centerX)&&this.NumbersEqual(this.centerY,t.centerY)&&this.NumbersEqual(this.density,t.density)&&this.NumbersEqual(this.angle,t.angle)&&this.collide==t.collide&&this.red==t.red&&this.green==t.green&&this.blue==t.blue&&this.opacity==t.opacity&&this.outline==t.outline&&this.terrain==t.terrain&&this.undragable==t.undragable}NumbersEqual(t,e){return Math.abs(t-e)<1e-4}ToString(){return"centerX="+this.centerX+", centerY="+this.centerY+", density="+this.density+", angle="+this.angle+", collide="+this.collide+", "+super.ToString()}}exports.ShapePart=r;
},{"../Game/Globals/ControllerGameGlobals":"K8aL","../General/Util":"Zvyo","./FixedJoint":"QW19","./Part":"eAVa"}],"PfXD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Circle=void 0;const t=require("@box2d/core"),i=require("../General/Util"),e=require("./FixedJoint"),s=require("./ShapePart");class r extends s.ShapePart{constructor(t,i,e,s=!0){super(t,i),s&&(e<r.MIN_RADIUS&&(e=r.MIN_RADIUS),e>r.MAX_RADIUS&&(e=r.MAX_RADIUS)),this.radius=e,this.type="Circle"}InsideShape(t,e,s){return i.Util.GetDist(this.centerX,this.centerY,t,e)<=this.radius}GetArea(){return Math.PI*this.radius*this.radius}MakeCopy(){var t=new r(this.centerX,this.centerY,this.radius);return t.density=this.density,t.angle=this.angle,t.collide=this.collide,t.isStatic=this.isStatic,t.red=this.red,t.green=this.green,t.blue=this.blue,t.opacity=this.opacity,t.outline=this.outline,t.terrain=this.terrain,t.undragable=this.undragable,t}Init(i,s=null){if(this.isInitted)return;super.Init(i);var r=new t.b2CircleShape;r.Set({x:this.centerX,y:this.centerY},this.radius);var n=!1;if(s)r.Set({x:this.centerX-s.GetPosition().x,y:this.centerY-s.GetPosition().y}),this.m_body=s,n=s.GetType()===t.b2BodyType.b2_staticBody;else{var h={position:{x:this.centerX,y:this.centerY},type:this.isStatic?t.b2BodyType.b2_staticBody:t.b2BodyType.b2_dynamicBody};if(this.isEditable){for(var a=!1,u=0;u<this.m_joints.length;u++)if(this.m_joints[u].isEnabled){a=!0;break}a||(h.bullet=!0)}this.isBullet&&(h.bullet=!0),this.m_body=i.CreateBody(h)}this.m_fixture=this.m_body.CreateFixture({shape:r,friction:.4,restitution:.3,density:(this.density+5)/10});const o=new Object;o.collide=this.collide,o.editable=this.isEditable,o.red=this.red,o.green=this.green,o.blue=this.blue,o.outline=this.outline,o.terrain=this.terrain,o.undragable=this.undragable,o.isPiston=-1,o.isSandbox=this.isSandbox,this.m_body.SetUserData(o),this.m_fixture.SetUserData(o),this.m_collisionGroup!=Number.MIN_VALUE&&this.m_fixture.SetFilterData({groupIndex:this.m_collisionGroup}),this.m_shape=r,this.isStatic||n?this.m_body.SetMassData(new t.b2MassData):this.m_body.ResetMassData();for(var d=0;d<this.m_joints.length;d++)if(this.m_joints[d].isEnabled&&this.m_joints[d]instanceof e.FixedJoint){var c=this.m_joints[d].GetOtherPart(this);c.isEnabled&&c.Init(i,this.m_body)}}IntersectsBox(t,e,s,r){if(this.centerX>=t&&this.centerX<=t+s&&this.centerY>=e&&this.centerY<=e+r)return!0;if(this.centerX>=t&&this.centerX<=t+s){if(Math.abs(e-this.centerY)<=this.radius)return!0;if(Math.abs(e+r-this.centerY)<=this.radius)return!0}if(this.centerY>=e&&this.centerY<=e+r){if(Math.abs(t-this.centerX)<=this.radius)return!0;if(Math.abs(t+s-this.centerX)<=this.radius)return!0}return i.Util.GetDist(this.centerX,this.centerY,t,e)<this.radius||(i.Util.GetDist(this.centerX,this.centerY,t+s,e)<this.radius||(i.Util.GetDist(this.centerX,this.centerY,t+s,e+r)<this.radius||i.Util.GetDist(this.centerX,this.centerY,t,e+r)<this.radius))}PrepareForResizing(){this.initRadius=this.radius}equals(t){return t instanceof r&&this.NumbersEqual(this.radius,t.radius)&&super.equals(t)}ToString(){return"Circle: radius="+this.radius+", "+super.ToString()}}exports.Circle=r,r.MIN_RADIUS=.1,r.MAX_RADIUS=5;
},{"@box2d/core":"kjbO","../General/Util":"Zvyo","./FixedJoint":"QW19","./ShapePart":"CDAe"}],"jYSx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Rectangle=void 0;const t=require("@box2d/core"),e=require("../General/Util"),i=require("./FixedJoint"),s=require("./ShapePart");class r extends s.ShapePart{constructor(t,e,i,s,h=!0){super(t+i/2,e+s/2),this.isTank=!1,h&&(i<0&&(t+=Math.max(-r.MAX_WIDTH,i),i=-i),s<0&&(e+=Math.max(-r.MAX_WIDTH,s),s=-s),i<r.MIN_WIDTH&&(i=r.MIN_WIDTH),s<r.MIN_WIDTH&&(s=r.MIN_WIDTH),i>r.MAX_WIDTH&&(i=r.MAX_WIDTH),s>r.MAX_WIDTH&&(s=r.MAX_WIDTH)),this.x=t,this.y=e,this.w=i,this.h=s,this.type="Rectangle"}GetArea(){return this.w*this.h}GetVertices(){var i=new Array(4);i[0]=new t.b2Vec2(this.x,this.y),i[1]=new t.b2Vec2(this.x+this.w,this.y),i[2]=new t.b2Vec2(this.x+this.w,this.y+this.h),i[3]=new t.b2Vec2(this.x,this.y+this.h);for(var s=Math.sqrt(this.w*this.w/4+this.h*this.h/4),r=0;r<4;r++){var h=Math.atan2(i[r].y-this.centerY,i[r].x-this.centerX);h=e.Util.NormalizeAngle(this.angle+h),i[r].x=this.centerX+s*Math.cos(h),i[r].y=this.centerY+s*Math.sin(h)}return i}InsideShape(t,e,i){for(var s=!0,r=this.GetVertices(),h=0;h<4;h++){var n;n=r[(h+1)%4].x==r[h].x?r[(h+1)%4].y>=r[h].y?1e8:-1e8:(r[(h+1)%4].y-r[h].y)/(r[(h+1)%4].x-r[h].x);var a=e-r[h].y-n*(t-r[h].x),o=r[(h+2)%4].y-r[h].y-n*(r[(h+2)%4].x-r[h].x);(a<0&&o>0||a>0&&o<0)&&(s=!1)}return s}Move(t,e){this.x=t-this.w/2,this.y=e-this.h/2,super.Move(t,e)}MakeCopy(){var t=new r(this.x,this.y,this.w,this.h);return t.density=this.density,t.angle=this.angle,t.collide=this.collide,t.isStatic=this.isStatic,t.red=this.red,t.green=this.green,t.blue=this.blue,t.opacity=this.opacity,t.outline=this.outline,t.terrain=this.terrain,t.undragable=this.undragable,t}Init(e,s=null){if(this.isInitted)return;super.Init(e);var r=new t.b2PolygonShape;r.Set(this.GetVertices(),4);var h,n=!1;if(s){for(h=0;h<4;h++)r.m_vertices[h].x-=s.GetPosition().x,r.m_vertices[h].y-=s.GetPosition().y;this.m_body=s,n=s.GetType()===t.b2BodyType.b2_staticBody}else{for(h=0;h<4;h++)r.m_vertices[h].x-=this.centerX,r.m_vertices[h].y-=this.centerY;var a={position:{x:this.centerX,y:this.centerY},type:this.isStatic?t.b2BodyType.b2_staticBody:t.b2BodyType.b2_dynamicBody};if(this.isEditable){for(var o=!1,l=0;l<this.m_joints.length;l++)if(this.m_joints[l].isEnabled){o=!0;break}o||(a.bullet=!0)}this.isBullet&&(a.bullet=!0),this.m_body=e.CreateBody(a)}this.m_fixture=this.m_body.CreateFixture({shape:r,friction:.4,restitution:.3,density:(this.density+5)/10}),this.m_collisionGroup!=Number.MIN_VALUE&&this.m_fixture.SetFilterData({groupIndex:this.m_collisionGroup});const c=new Object;for(c.collide=this.collide,c.editable=this.isEditable||this.isTank,c.red=this.red,c.green=this.green,c.blue=this.blue,c.outline=this.outline,c.terrain=this.terrain,c.undragable=this.undragable,c.isPiston=-1,c.isSandbox=this.isSandbox,this.m_body.SetUserData(c),this.m_fixture.SetUserData(c),this.m_shape=r,this.isStatic||n?this.m_body.SetMassData(new t.b2MassData):this.m_body.ResetMassData(),h=0;h<this.m_joints.length;h++)if(this.m_joints[h].isEnabled&&this.m_joints[h]instanceof i.FixedJoint){var u=this.m_joints[h].GetOtherPart(this);u.isEnabled&&u.Init(e,this.m_body)}}IntersectsBox(t,i,s,r){if(this.centerX>=t&&this.centerX<=t+s&&this.centerY>=i&&this.centerY<=i+r)return!0;for(var h=this.GetVertices(),n=0;n<4;n++){if(e.Util.SegmentsIntersect(h[n].x,h[n].y,h[(n+1)%4].x,h[(n+1)%4].y,t,i,t+s,i))return!0;if(e.Util.SegmentsIntersect(h[n].x,h[n].y,h[(n+1)%4].x,h[(n+1)%4].y,t+s,i,t+s,i+r))return!0;if(e.Util.SegmentsIntersect(h[n].x,h[n].y,h[(n+1)%4].x,h[(n+1)%4].y,t+s,i+r,t,i+r))return!0;if(e.Util.SegmentsIntersect(h[n].x,h[n].y,h[(n+1)%4].x,h[(n+1)%4].y,t,i+r,t,i))return!0}return!1}GetVerticesForOutline(t){return r.GetOutlineVertices(this.GetVertices(),4,t)}PrepareForResizing(){this.initW=this.w,this.initH=this.h}equals(t){return t instanceof r&&this.NumbersEqual(this.x,t.x)&&this.NumbersEqual(this.y,t.y)&&this.NumbersEqual(this.w,t.w)&&this.NumbersEqual(this.h,t.h)&&super.equals(t)}ToString(){return"Rectangle: x="+this.x+", y="+this.y+", w="+this.w+", h="+this.h+", "+super.ToString()}}exports.Rectangle=r,r.MIN_WIDTH=.1,r.MAX_WIDTH=10;
},{"@box2d/core":"kjbO","../General/Util":"Zvyo","./FixedJoint":"QW19","./ShapePart":"CDAe"}],"T0pq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextPart=void 0;const i=require("./Part");class t extends i.Part{constructor(i,t,s,h,e,n,r=!0){super(),this.alwaysVisible=!0,this.inFront=!0,this.scaleWithZoom=!0,this.displayKey=32,this.displayKeyPressed=!1,this.m_controller=i,this.x=t,this.y=s,this.w=h,this.h=e,this.text=n,this.red=0,this.green=0,this.blue=0,this.size=14,this.m_textField=new TextField,this.m_textField.text=n,this.m_textField.wordWrap=!0,i&&i.addChildAt(this.m_textField,i.getChildIndex(i.m_canvas)+(r?1:0)),this.type="TextPart"}Move(i,t){this.x=i,this.y=t}RotateAround(i,t,s){}KeyInput(i,t,s){i==this.displayKey&&t&&(this.displayKeyPressed=!this.displayKeyPressed)}Update(i){}GetAttachedParts(i=null){return null==i&&(i=new Array),i.push(this),i}MakeCopy(){var i=new t(this.m_controller,this.x,this.y,this.w,this.h,this.text);return i.inFront=this.inFront,i.scaleWithZoom=this.scaleWithZoom,i.alwaysVisible=this.alwaysVisible,i.displayKey=this.displayKey,i.red=this.red,i.green=this.green,i.blue=this.blue,i.size=this.size,i}Resize(i,t){0==this.corner?(this.x=this.initX+i,this.w=this.initW-i,this.w<1&&(this.x=this.initX+this.initW-1,this.w=1),this.y=this.initY+t,this.h=this.initH-t,this.h<1&&(this.y=this.initY+this.initH-1,this.h=1)):1==this.corner?(this.w=this.initW+i,this.w<1&&(this.w=1),this.y=this.initY+t,this.h=this.initH-t,this.h<1&&(this.y=this.initY+this.initH-1,this.h=1)):2==this.corner?(this.w=this.initW+i,this.w<1&&(this.w=1),this.h=this.initH+t,this.h<1&&(this.h=1)):(this.x=this.initX+i,this.w=this.initW-i,this.w<1&&(this.x=this.initX+this.initW-1,this.w=1),this.h=this.initH+t,this.h<1&&(this.h=1))}InsideShape(i,t,s){return this.x+this.w>=i&&this.x<i&&this.y+this.h>=t&&this.y<t}InsideMoveBox(i,t,s,h=!1){return Math.abs(i-this.x)<6/s&&Math.abs(t-this.y)<6/s?(h&&(this.corner=0,this.initX=this.x,this.initY=this.y,this.initW=this.w,this.initH=this.h),!0):Math.abs(i-this.x-this.w)<6/s&&Math.abs(t-this.y)<6/s?(h&&(this.corner=1,this.initX=this.x,this.initY=this.y,this.initW=this.w,this.initH=this.h),!0):Math.abs(i-this.x-this.w)<6/s&&Math.abs(t-this.y-this.h)<6/s?(h&&(this.corner=2,this.initX=this.x,this.initY=this.y,this.initW=this.w,this.initH=this.h),!0):Math.abs(i-this.x)<6/s&&Math.abs(t-this.y-this.h)<6/s&&(h&&(this.corner=3,this.initX=this.x,this.initY=this.y,this.initW=this.w,this.initH=this.h),!0)}IntersectsBox(i,t,s,h){return this.x+this.w>=i&&this.x<i+s&&this.y+this.h>=t&&this.y<t+h}Init(i,t=null){super.Init(i),this.displayKeyPressed=!1}PrepareForResizing(){this.initW=this.w,this.initH=this.h}ToString(){return"TextPart: "+super.ToString()}}exports.TextPart=t;
},{"./Part":"eAVa"}],"vdN1":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Cannon=void 0;const t=require("@box2d/core"),e=require("../General/Util"),i=require("./FixedJoint"),s=require("./ShapePart");class n extends s.ShapePart{constructor(t,e,i,s=!0){super(t+i/2,e+i/4),this.createCannonball=!1,this.cannonballs=new Array,this.cannonballCounters=new Array;var r=!1;s&&(i<0&&(t+=Math.max(-n.MAX_WIDTH,i),e+=Math.max(-n.MAX_WIDTH/2,i/2),i=-i,r=!0),i<n.MIN_WIDTH&&(i=n.MIN_WIDTH),i>n.MAX_WIDTH&&(i=n.MAX_WIDTH)),this.x=t,this.y=e,this.w=i,this.fireKey=40,this.strength=15,r&&(this.angle=Math.PI),this.type="Cannon"}GetArea(){return this.w*this.w/2}Move(t,e){this.x=t-this.w/2,this.y=e-this.w/4,super.Move(t,e)}GetVertices(){var i=new Array(4);i[0]=new t.b2Vec2(this.x,this.y),i[1]=new t.b2Vec2(this.x+this.w,this.y),i[2]=new t.b2Vec2(this.x+this.w,this.y+this.w/2),i[3]=new t.b2Vec2(this.x,this.y+this.w/2);for(var s=Math.sqrt(5*this.w*this.w/16),n=0;n<4;n++){var r=Math.atan2(i[n].y-this.centerY,i[n].x-this.centerX);r=e.Util.NormalizeAngle(this.angle+r),i[n].x=this.centerX+s*Math.cos(r),i[n].y=this.centerY+s*Math.sin(r)}return i}GetSpawnPoint(){return e.Util.Vector(this.centerX+2*Math.cos(this.angle)*this.w/3,this.centerY+2*Math.sin(this.angle)*this.w/3)}InsideShape(t,e,i){for(var s=!0,n=this.GetVertices(),r=0;r<4;r++){var a;a=n[(r+1)%4].x==n[r].x?n[(r+1)%4].y>=n[r].y?1e8:-1e8:(n[(r+1)%4].y-n[r].y)/(n[(r+1)%4].x-n[r].x);var h=e-n[r].y-a*(t-n[r].x),o=n[(r+2)%4].y-n[r].y-a*(n[(r+2)%4].x-n[r].x);(h<0&&o>0||h>0&&o<0)&&(s=!1)}return s}MakeCopy(){var t=new n(this.x,this.y,this.w);return t.density=this.density,t.angle=this.angle,t.collide=this.collide,t.isStatic=this.isStatic,t.red=this.red,t.green=this.green,t.blue=this.blue,t.opacity=this.opacity,t.outline=this.outline,t.terrain=this.terrain,t.undragable=this.undragable,t.fireKey=this.fireKey,t.strength=this.strength,t}Init(s,n=null){if(!this.isInitted){super.Init(s);var r=new t.b2PolygonDef;r.friction=.4,r.restitution=.3,r.density=(this.density+5)/10,r.vertexCount=4,this.m_collisionGroup!=Number.MIN_VALUE&&(r.filter.groupIndex=this.m_collisionGroup),r.vertices=this.GetVertices();var a,h=!1;if(n){for(a=0;a<4;a++)r.vertices[a].x-=n.GetPosition().x,r.vertices[a].y-=n.GetPosition().y;this.m_body=n,h=n.IsStatic()}else{for(a=0;a<4;a++)r.vertices[a].x-=this.centerX,r.vertices[a].y-=this.centerY;var o=new t.b2BodyDef;o.position.Set(this.centerX,this.centerY),this.m_body=s.CreateBody(o)}for(r.userData=new Object,r.userData.collide=this.collide,r.userData.editable=this.isEditable,r.userData.red=this.red,r.userData.green=this.green,r.userData.blue=this.blue,r.userData.outline=this.outline,r.userData.terrain=this.terrain,r.userData.undragable=this.undragable,r.userData.isPiston=-1,this.m_shape=this.m_body.CreateShape(r),this.isStatic||h?this.m_body.SetMass(new t.b2MassData):this.m_body.SetMassFromShapes(),this.cannonballs.length=0,this.cannonballCounters.length=0,a=0;a<this.m_joints.length;a++)if(this.m_joints[a].isEnabled&&this.m_joints[a]instanceof i.FixedJoint){var l=this.m_joints[a].GetOtherPart(this);l.isEnabled&&l.Init(s,this.m_body)}this.relativeCannonPos=e.Util.Vector(this.centerX,this.centerY),this.relativeCannonPos.Subtract(this.m_body.GetPosition())}}KeyInput(t,e,i){t==this.fireKey&&e&&(this.createCannonball=!0)}Update(t){this.isInitted&&this.createCannonball&&this.cannonballs.length<50&&this.CreateCannonball(t),this.createCannonball=!1;for(var e=0;e<this.cannonballCounters.length;e++)this.cannonballCounters[e]--,0==this.cannonballCounters[e]&&(this.cannonballs[e].GetShapeList().m_filter.groupIndex=0)}CreateCannonball(i){var s=new t.b2CircleDef;s.radius=this.w/6,s.friction=.4,s.restitution=.3,s.density=(this.density+5)/10,this.m_collisionGroup!=Number.MIN_VALUE&&(s.filter.groupIndex=this.m_collisionGroup);var n=new t.b2BodyDef,r=this.GetSpawnPoint();r.Subtract(e.Util.Vector(this.centerX,this.centerY)),r.Add(this.relativeCannonPos),n.position.SetV(this.m_body.GetWorldPoint(r)),n.isBullet=!0;var a=i.CreateBody(n);this.cannonballs.push(a),s.userData=new Object,s.userData.collide=!0,s.userData.editable=this.isEditable,s.userData.red=this.red,s.userData.green=this.green,s.userData.blue=this.blue,s.userData.outline=this.outline,s.userData.terrain=!1,s.userData.undragable=!0,s.userData.isPiston=-1,a.CreateShape(s),a.SetMassFromShapes();var h=this.angle+this.m_body.GetAngle(),o=.15*this.w*this.w*s.density*(4+2*this.strength),l=e.Util.Vector(Math.cos(h)*o,Math.sin(h)*o),u=this.m_body.GetWorldPoint(this.relativeCannonPos);a.ApplyImpulse(l,a.GetWorldCenter()),l=l.Negative(),this.m_body.ApplyImpulse(l,u),this.cannonballCounters.push(5)}IntersectsBox(t,i,s,n){if(this.centerX>=t&&this.centerX<=t+s&&this.centerY>=i&&this.centerY<=i+n)return!0;for(var r=this.GetVertices(),a=0;a<4;a++){if(e.Util.SegmentsIntersect(r[a].x,r[a].y,r[(a+1)%4].x,r[(a+1)%4].y,t,i,t+s,i))return!0;if(e.Util.SegmentsIntersect(r[a].x,r[a].y,r[(a+1)%4].x,r[(a+1)%4].y,t+s,i,t+s,i+n))return!0;if(e.Util.SegmentsIntersect(r[a].x,r[a].y,r[(a+1)%4].x,r[(a+1)%4].y,t+s,i+n,t,i+n))return!0;if(e.Util.SegmentsIntersect(r[a].x,r[a].y,r[(a+1)%4].x,r[(a+1)%4].y,t,i+n,t,i))return!0}return!1}PrepareForResizing(){this.initW=this.w}GetVerticesForOutline(t){return n.GetOutlineVertices(this.GetVertices(),4,t)}equals(t){return t instanceof n&&this.x==t.x&&this.y==t.y&&this.w==t.w&&this.fireKey==t.fireKey&&this.strength==t.strength&&super.equals(t)}ToString(){return"Cannon: x="+this.x+", y="+this.y+", w="+this.w+", fireKey="+this.fireKey+", strength="+this.strength+super.ToString()}}exports.Cannon=n,n.MIN_WIDTH=.5,n.MAX_WIDTH=10;
},{"@box2d/core":"kjbO","../General/Util":"Zvyo","./FixedJoint":"QW19","./ShapePart":"CDAe"}],"nZSh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrismaticJoint=void 0;const t=require("@box2d/core"),i=require("../Game/Globals/ControllerGameGlobals"),e=require("../General/Util"),s=require("./JointPart");class n extends s.JointPart{constructor(s,h,a,o,r,l){if(super(s,h),this.collide=!0,this.arrayIndex=-1,this.isKeyDown1=!1,this.isKeyDown2=!1,this.wasKeyDown1=!1,this.wasKeyDown2=!1,this.expanding=!0,n.jbTutorial&&s.centerY>h.centerY){var p=h;h=s,s=p;var c=r;r=a,a=c,c=l,l=o,o=c,n.jbTutorial=!1}this.anchorX=(a+r)/2,this.anchorY=(o+l)/2,this.axis=new t.b2Vec2(r-a,l-o),this.axis.Normalize(),this.enablePiston=!1,this.isStiff=!1,this.autoOscillate=!1,this.pistonUpKey=38,this.pistonDownKey=40,i.ControllerGameGlobals.maxSJStrength<15?this.pistonStrength=i.ControllerGameGlobals.maxSJStrength:this.pistonStrength=15,i.ControllerGameGlobals.maxSJSpeed<15?this.pistonSpeed=i.ControllerGameGlobals.maxSJSpeed:this.pistonSpeed=15,this.red=i.ControllerGameGlobals.defaultR,this.green=i.ControllerGameGlobals.defaultG,this.blue=i.ControllerGameGlobals.defaultB,this.opacity=i.ControllerGameGlobals.defaultO,this.outline=!0,this.initLength=e.Util.GetDist(a,o,r,l),this.type="PrismaticJoint"}SetJointProperties(t){this.enablePiston=t.enablePiston,this.pistonUpKey=t.pistonUpKey,this.pistonDownKey=t.pistonDownKey,this.pistonStrength=t.pistonStrength,this.pistonSpeed=t.pistonSpeed,this.isStiff=t.isStiff,this.autoOscillate=t.autoOscillate,this.red=t.red,this.green=t.green,this.blue=t.blue,this.opacity=t.opacity,this.outline=t.outline,this.collide=t.collide}RotateAround(i,e,s){super.RotateAround(i,e,s);var n=s+this.rotateOrientation;this.axis=new t.b2Vec2(Math.cos(n),Math.sin(n))}MakeCopy(t,i){var e=this.anchorX-this.axis.x*this.initLength/2,s=this.anchorY-this.axis.y*this.initLength/2,h=this.anchorX+this.axis.x*this.initLength/2,a=this.anchorY+this.axis.y*this.initLength/2,o=new n(t,i,e,s,h,a);return o.enablePiston=this.enablePiston,o.pistonUpKey=this.pistonUpKey,o.pistonDownKey=this.pistonDownKey,o.pistonStrength=this.pistonStrength,o.pistonSpeed=this.pistonSpeed,o.isStiff=this.isStiff,o.autoOscillate=this.autoOscillate,o.red=this.red,o.green=this.green,o.blue=this.blue,o.opacity=this.opacity,o.outline=this.outline,o.collide=this.collide,o}InsideShape(i,e,s){var n=!0,h=new Array,a=this.anchorX-this.axis.x*this.initLength/2,o=this.anchorY-this.axis.y*this.initLength/2,r=this.anchorX+this.axis.x*this.initLength/2,l=this.anchorY+this.axis.y*this.initLength/2,p=Math.atan2(this.axis.y,this.axis.x)+Math.PI/2;h[0]=new t.b2Vec2(a-.25*Math.cos(p),o-.25*Math.sin(p)),h[1]=new t.b2Vec2(a+.25*Math.cos(p),o+.25*Math.sin(p)),h[2]=new t.b2Vec2(r+.25*Math.cos(p),l+.25*Math.sin(p)),h[3]=new t.b2Vec2(r-.25*Math.cos(p),l-.25*Math.sin(p));for(var c=0;c<4;c++){var y;y=h[(c+1)%4].x==h[c].x?h[(c+1)%4].y>=h[c].y?1e8:-1e8:(h[(c+1)%4].y-h[c].y)/(h[(c+1)%4].x-h[c].x);var g=e-h[c].y-y*(i-h[c].x),M=h[(c+2)%4].y-h[c].y-y*(h[(c+2)%4].x-h[c].x);(g<0&&M>0||g>0&&M<0)&&(n=!1)}return n}Init(s,n=null){if(!this.isInitted&&this.part1.isInitted&&this.part2.isInitted&&(super.Init(s),this.expanding=!0,this.m_shapes=new Array,this.part1.GetBody()!=this.part2.GetBody())){var h=i.ControllerGameGlobals.collisionGroup;this.part1.GetFixture().SetFilterData({categoryBits:h,maskBits:65535^h,groupIndex:this.part1.GetFixture().GetFilterData().groupIndex}),this.part2.GetFixture().SetFilterData({categoryBits:h,maskBits:65535^h,groupIndex:this.part1.GetFixture().GetFilterData().groupIndex});var a=this.anchorX-this.axis.x*this.initLength/2,o=this.anchorY-this.axis.y*this.initLength/2,r=this.anchorX+this.axis.x*this.initLength/2,l=this.anchorY+this.axis.y*this.initLength/2,p=Math.atan2(this.axis.y,this.axis.x),c=new t.b2PolygonShape;const n={friction:.4,restitution:.3,density:5},b=new Object;b.red=this.red,b.green=this.green,b.blue=this.blue,b.outline=this.outline,b.collide=this.collide,b.editable=this.isEditable,b.isPiston=h,this.part1.GetBody().SetUserData(b);var y=new Array;y[0]=new t.b2Vec2(a-.25,o-.05),y[1]=new t.b2Vec2(a+.25,o-.05),y[2]=new t.b2Vec2(a+.25,o+.05),y[3]=new t.b2Vec2(a-.25,o+.05);for(var g=Math.sqrt(.065),M=0;M<4;M++){var d=Math.atan2(y[M].y-o,y[M].x-a);d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=a+g*Math.cos(d)-this.part1.GetBody().GetPosition().x,y[M].y=o+g*Math.sin(d)-this.part1.GetBody().GetPosition().y}c.Set(y),this.part1.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c),c=new t.b2PolygonShape;var x=a+(g=Math.sqrt(.2*.2+this.initLength*this.initLength/4))*Math.cos(Math.atan2(-this.initLength/2,-.2)+p+Math.PI/2),w=o+g*Math.sin(Math.atan2(-this.initLength/2,-.2)+p+Math.PI/2);for(y[0]=new t.b2Vec2(a-.05,o-this.initLength/2),y[1]=new t.b2Vec2(a+.05,o-this.initLength/2),y[2]=new t.b2Vec2(a+.05,o+this.initLength/2),y[3]=new t.b2Vec2(a-.05,o+this.initLength/2),g=Math.sqrt(.05*.05+this.initLength*this.initLength/4),M=0;M<4;M++)d=Math.atan2(y[M].y-o,y[M].x-a),d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=x+g*Math.cos(d)-this.part1.GetBody().GetPosition().x,y[M].y=w+g*Math.sin(d)-this.part1.GetBody().GetPosition().y;for(c.Set(y),this.part1.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c),c=new t.b2PolygonShape,x=a+(g=Math.sqrt(.2*.2+this.initLength*this.initLength/4))*Math.cos(Math.atan2(-this.initLength/2,.2)+p+Math.PI/2),w=o+g*Math.sin(Math.atan2(-this.initLength/2,.2)+p+Math.PI/2),y[0]=new t.b2Vec2(a-.05,o-this.initLength/2),y[1]=new t.b2Vec2(a+.05,o-this.initLength/2),y[2]=new t.b2Vec2(a+.05,o+this.initLength/2),y[3]=new t.b2Vec2(a-.05,o+this.initLength/2),g=Math.sqrt(.05*.05+this.initLength*this.initLength/4),M=0;M<4;M++)d=Math.atan2(y[M].y-o,y[M].x-a),d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=x+g*Math.cos(d)-this.part1.GetBody().GetPosition().x,y[M].y=w+g*Math.sin(d)-this.part1.GetBody().GetPosition().y;for(c.Set(y),this.part1.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c),c=new t.b2PolygonShape,x=a+(g=Math.sqrt(.0225+this.initLength*this.initLength))*Math.cos(Math.atan2(-this.initLength,-.15)+p+Math.PI/2),w=o+g*Math.sin(Math.atan2(-this.initLength,-.15)+p+Math.PI/2),y[0]=new t.b2Vec2(a-.095,o-.05),y[1]=new t.b2Vec2(a+.095,o-.05),y[2]=new t.b2Vec2(a+.095,o+.05),y[3]=new t.b2Vec2(a-.095,o+.05),g=Math.sqrt(.011525),M=0;M<4;M++)d=Math.atan2(y[M].y-o,y[M].x-a),d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=x+g*Math.cos(d)-this.part1.GetBody().GetPosition().x,y[M].y=w+g*Math.sin(d)-this.part1.GetBody().GetPosition().y;for(c.Set(y),this.part1.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c),c=new t.b2PolygonShape,x=a+(g=Math.sqrt(.0225+this.initLength*this.initLength))*Math.cos(Math.atan2(-this.initLength,.15)+p+Math.PI/2),w=o+g*Math.sin(Math.atan2(-this.initLength,.15)+p+Math.PI/2),y[0]=new t.b2Vec2(a-.095,o-.05),y[1]=new t.b2Vec2(a+.095,o-.05),y[2]=new t.b2Vec2(a+.095,o+.05),y[3]=new t.b2Vec2(a-.095,o+.05),g=Math.sqrt(.011525),M=0;M<4;M++)d=Math.atan2(y[M].y-o,y[M].x-a),d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=x+g*Math.cos(d)-this.part1.GetBody().GetPosition().x,y[M].y=w+g*Math.sin(d)-this.part1.GetBody().GetPosition().y;for(c.Set(y),this.part1.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c),c=new t.b2PolygonShape,x=r+(g=this.initLength/2-.1)*Math.cos(Math.atan2(this.initLength/2-.1,0)+p+Math.PI/2),w=l+g*Math.sin(Math.atan2(this.initLength/2-.1,0)+p+Math.PI/2),y[0]=new t.b2Vec2(r-.05,l-this.initLength/2),y[1]=new t.b2Vec2(r+.05,l-this.initLength/2),y[2]=new t.b2Vec2(r+.05,l+this.initLength/2),y[3]=new t.b2Vec2(r-.05,l+this.initLength/2),g=Math.sqrt(.05*.05+this.initLength*this.initLength/4),M=0;M<4;M++)d=Math.atan2(y[M].y-l,y[M].x-r),d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=x+g*Math.cos(d)-this.part2.GetBody().GetPosition().x,y[M].y=w+g*Math.sin(d)-this.part2.GetBody().GetPosition().y;for(c.Set(y),this.part2.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c),c=new t.b2PolygonShape,x=r+(g=this.initLength-.1)*Math.cos(Math.atan2(this.initLength-.1,0)+p+Math.PI/2),w=l+g*Math.sin(Math.atan2(this.initLength-.1,0)+p+Math.PI/2),y[0]=new t.b2Vec2(r-.14,l-.05),y[1]=new t.b2Vec2(r+.14,l-.05),y[2]=new t.b2Vec2(r+.14,l+.05),y[3]=new t.b2Vec2(r-.14,l+.05),g=Math.sqrt(.0221),M=0;M<4;M++)d=Math.atan2(y[M].y-l,y[M].x-r),d=e.Util.NormalizeAngle(p+d+Math.PI/2),y[M].x=x+g*Math.cos(d)-this.part2.GetBody().GetPosition().x,y[M].y=w+g*Math.sin(d)-this.part2.GetBody().GetPosition().y;c.Set(y),this.part2.GetBody().CreateFixture({shape:c,...n}),this.m_shapes.push(c);var G=new t.b2PrismaticJointDef;G.enableMotor=this.enablePiston,G.maxMotorForce=30*this.pistonStrength,G.enableLimit=!0,G.lowerTranslation=0,G.upperTranslation=this.initLength-.2,G.collideConnected=!0,G.Initialize(this.part1.GetBody(),this.part2.GetBody(),new t.b2Vec2(this.anchorX,this.anchorY),this.axis),G.userData=new Object,G.userData.localPoint1=new t.b2Vec2(a-this.part1.centerX,o-this.part1.centerY),G.userData.localPoint2=new t.b2Vec2(r-this.part2.centerX,l-this.part2.centerY),this.m_joint=s.CreateJoint(G),this.targetJointDisp=0,this.part1.WillBeStatic()||this.part1.GetBody().ResetMassData(),this.part2.WillBeStatic()||this.part2.GetBody().ResetMassData(),this.part1.isStatic||this.part2.isStatic||this.part2.GetBody().SetBullet(!0),this.isKeyDown1=!1,this.isKeyDown2=!1,this.wasKeyDown1=!1,this.wasKeyDown2=!1}}GetJointPerpTranslation(){var i=this.part1.GetBody(),s=this.part2.GetBody();const n=new t.b2Vec2,h=new t.b2Vec2,a=new t.b2Vec2,o=new t.b2Vec2;i.GetWorldPoint(this.m_joint.m_localAnchorA,n),s.GetWorldPoint(this.m_joint.m_localAnchorB,h),i.GetWorldVector(this.m_joint.m_localXAxisA,a),i.GetWorldPoint(this.m_joint.GetUserData().localPoint1,o);var r=e.Util.DistanceFromPointToLine(n,o,a),l=e.Util.DistanceFromPointToLine(h,o,a);return Math.max(r,l)}CheckForBreakage(t){if(this.m_joint){var i=this.m_joint;Math.abs(i.GetBodyA().GetAngle()-i.GetBodyA().GetAngle())>90*Math.PI/180&&(t.DestroyJoint(this.m_joint),this.m_joint=null)}}Update(t){if(this.m_joint&&this.enablePiston){var i=this.m_joint;(this.isKeyDown1||this.isKeyDown2)&&(i.EnableMotor(!0),i.m_maxMotorForce=30*this.pistonStrength,this.part1.GetBody().SetAwake(!0),this.part2.GetBody().SetAwake(!0)),this.isKeyDown1&&(!this.autoOscillate||this.expanding)||this.autoOscillate&&this.expanding?(i.SetMotorSpeed(.4*this.pistonSpeed),this.isStiff&&this.wasKeyDown1&&i.GetJointTranslation()<this.prevJointDisp&&(i.SetMotorSpeed(0),i.m_maxMotorForce=3e3*this.pistonStrength),i.GetJointTranslation()>this.initLength-.4&&(this.expanding=!1)):this.isKeyDown2||this.autoOscillate&&!this.expanding?(i.SetMotorSpeed(.4*(0-this.pistonSpeed)),this.isStiff&&this.wasKeyDown2&&i.GetJointTranslation()>this.prevJointDisp&&(i.SetMotorSpeed(0),i.m_maxMotorForce=3e3*this.pistonStrength),i.GetJointTranslation()<.1&&(this.expanding=!0)):((this.wasKeyDown1||this.wasKeyDown2)&&(this.targetJointDisp=i.GetJointTranslation()),i.EnableMotor(this.isStiff),i.SetMotorSpeed(0),i.m_maxMotorForce=3e3*this.pistonStrength),this.wasKeyDown1=this.isKeyDown1,this.wasKeyDown2=this.isKeyDown2,this.prevJointDisp=i.GetJointTranslation()}}GetShapes(){return this.m_shapes}KeyInput(t,i,e){t==this.pistonUpKey&&(this.isKeyDown1=!i),t==this.pistonDownKey&&(this.isKeyDown2=!i)}PrepareForResizing(){this.initInitLength=this.initLength}ToString(){return"PrismaticJoint: axis=("+this.axis.x+","+this.axis.y+"), initLength="+this.initLength+", enablePiston="+this.enablePiston+", pistonUpKey="+this.pistonUpKey+", pistonDownKey="+this.pistonDownKey+", pistonStrength="+this.pistonStrength+", pistonSpeed="+this.pistonSpeed+", isStiff="+this.isStiff+", "+super.ToString()}}exports.PrismaticJoint=n,n.jbTutorial=!1;
},{"@box2d/core":"kjbO","../Game/Globals/ControllerGameGlobals":"K8aL","../General/Util":"Zvyo","./JointPart":"avwv"}],"AUAw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RevoluteJoint=void 0;const t=require("@box2d/core"),o=require("../Game/Globals/ControllerGameGlobals"),e=require("../General/Util"),i=require("./Circle"),r=require("./JointPart");class s extends r.JointPart{constructor(t,e,i,r){super(t,e),this.isKeyDown1=!1,this.isKeyDown2=!1,this.wasKeyDown1=!1,this.wasKeyDown2=!1,this.anchorX=i,this.anchorY=r,this.enableMotor=!1,this.isStiff=!1,this.autoCW=!1,this.autoCCW=!1,this.motorCWKey=39,this.motorCCWKey=37,o.ControllerGameGlobals.maxRJStrength<15?this.motorStrength=o.ControllerGameGlobals.maxRJStrength:this.motorStrength=15,o.ControllerGameGlobals.maxRJSpeed<15?this.motorSpeed=o.ControllerGameGlobals.maxRJSpeed:this.motorSpeed=15,this.motorLowerLimit=-Number.MAX_VALUE,this.motorUpperLimit=Number.MAX_VALUE,this.type="RevoluteJoint"}SetJointProperties(t){this.enableMotor=t.enableMotor,this.motorCWKey=t.motorCWKey,this.motorCCWKey=t.motorCCWKey,this.motorStrength=t.motorStrength,this.motorSpeed=t.motorSpeed,this.motorLowerLimit=t.motorLowerLimit,this.motorUpperLimit=t.motorUpperLimit,this.isStiff=t.isStiff,this.autoCW=t.autoCW,this.autoCCW=t.autoCCW}MakeCopy(t,o){var e=new s(t,o,this.anchorX,this.anchorY);return e.enableMotor=this.enableMotor,e.motorCWKey=this.motorCWKey,e.motorCCWKey=this.motorCCWKey,e.motorStrength=this.motorStrength,e.motorSpeed=this.motorSpeed,e.motorLowerLimit=this.motorLowerLimit,e.motorUpperLimit=this.motorUpperLimit,e.isStiff=this.isStiff,e.autoCW=this.autoCW,e.autoCCW=this.autoCCW,e}Init(o,e=null){if(!this.isInitted&&this.part1.isInitted&&this.part2.isInitted&&(super.Init(o),this.part1.GetBody()!=this.part2.GetBody())){var r=new t.b2RevoluteJointDef;r.enableMotor=this.enableMotor,r.maxMotorTorque=30*this.motorStrength,r.enableLimit=this.motorLowerLimit!=-Number.MAX_VALUE||this.motorUpperLimit!=Number.MAX_VALUE,this.motorLowerLimit==-Number.MAX_VALUE?r.lowerAngle=-Number.MAX_VALUE:r.lowerAngle=this.motorLowerLimit*Math.PI/180,this.motorUpperLimit==Number.MAX_VALUE?r.upperAngle=Number.MAX_VALUE:r.upperAngle=this.motorUpperLimit*Math.PI/180,this.part1 instanceof i.Circle&&!(this.part2 instanceof i.Circle)?r.Initialize(this.part2.GetBody(),this.part1.GetBody(),new t.b2Vec2(this.anchorX,this.anchorY)):this.part2 instanceof i.Circle&&!(this.part1 instanceof i.Circle)?r.Initialize(this.part1.GetBody(),this.part2.GetBody(),new t.b2Vec2(this.anchorX,this.anchorY)):this.part1.HeavierThan(this.part2)?r.Initialize(this.part1.GetBody(),this.part2.GetBody(),new t.b2Vec2(this.anchorX,this.anchorY)):r.Initialize(this.part2.GetBody(),this.part1.GetBody(),new t.b2Vec2(this.anchorX,this.anchorY)),this.m_joint=o.CreateJoint(r),this.targetJointAngle=0,this.isKeyDown1=!1,this.isKeyDown2=!1,this.wasKeyDown1=!1,this.wasKeyDown2=!1}}CheckForBreakage(o){if(this.m_joint){var i=this.m_joint;const r=new t.b2Vec2,s=new t.b2Vec2;i.GetAnchorA(r),i.GetAnchorB(s),e.Util.GetDist(r.x,r.y,s.x,s.y)>3&&(o.DestroyJoint(this.m_joint),this.m_joint=null)}}Update(t){if(this.m_joint&&this.enableMotor){var o=this.m_joint;(this.isKeyDown1||this.isKeyDown2)&&(o.EnableMotor(!0),o.m_maxMotorTorque=30*this.motorStrength,this.part1.GetBody().SetAwake(!0),this.part2.GetBody().SetAwake(!0)),this.isKeyDown1||this.autoCW&&!this.isKeyDown2?(o.SetMotorSpeed(this.motorSpeed),this.isStiff&&this.wasKeyDown1&&o.GetJointAngle()<this.prevJointAngle&&(o.SetMotorSpeed(0),o.m_maxMotorTorque=3e3*this.motorStrength)):this.isKeyDown2||this.autoCCW?(o.SetMotorSpeed(0-this.motorSpeed),this.isStiff&&this.wasKeyDown2&&o.GetJointAngle()>this.prevJointAngle&&(o.SetMotorSpeed(0),o.m_maxMotorTorque=3e3*this.motorStrength)):((this.wasKeyDown1||this.wasKeyDown2)&&(this.targetJointAngle=o.GetJointAngle()),o.EnableMotor(this.isStiff),o.SetMotorSpeed(0),o.m_maxMotorTorque=3e3*this.motorStrength),this.wasKeyDown1=this.isKeyDown1,this.wasKeyDown2=this.isKeyDown2,this.prevJointAngle=o.GetJointAngle()}}InsideShape(t,o,i){return e.Util.GetDist(this.anchorX,this.anchorY,t,o)<.18*30/i}KeyInput(t,o,e){t==this.motorCWKey&&(this.isKeyDown1=!o),t==this.motorCCWKey&&(this.isKeyDown2=!o)}ToString(){return"RevoluteJoint: enableMotor="+this.enableMotor+", motorCWKey="+this.motorCWKey+", motorCCWKey="+this.motorCCWKey+", motorStrength="+this.motorStrength+", motorSpeed="+this.motorSpeed+", motorLowerLimit="+this.motorLowerLimit+", motorUpperLimit="+this.motorUpperLimit+", isStiff="+this.isStiff+", "+super.ToString()}}exports.RevoluteJoint=s;
},{"@box2d/core":"kjbO","../Game/Globals/ControllerGameGlobals":"K8aL","../General/Util":"Zvyo","./Circle":"PfXD","./JointPart":"avwv"}],"Yw1p":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Thrusters=void 0;const t=require("@box2d/core"),e=require("../Game/Globals/ControllerGameGlobals"),s=require("../General/Util"),r=require("./Part");class h extends r.Part{constructor(t,s,r){super(),this.isBalloon=!1,this.shapeIndex=-1,this.isKeyDown=!1,this.shape=t,this.centerX=s,this.centerY=r,this.type="Thrusters",e.ControllerGameGlobals.maxThrusterStrength<15?this.strength=e.ControllerGameGlobals.maxThrusterStrength:this.strength=15,this.angle=-Math.PI/2,this.thrustKey=38,this.autoOn=!1,this.shape.AddThrusters(this)}MakeCopy(t){var e=new h(t,this.centerX,this.centerY);return e.strength=this.strength,e.autoOn=this.autoOn,e.thrustKey=this.thrustKey,e.angle=this.angle,e}InsideShape(t,e,r){return s.Util.GetDist(this.centerX,this.centerY,t,e)<7.5/r}Init(t,e=null){!this.isInitted&&this.shape.isInitted&&(super.Init(t),this.isKeyDown=!1,this.relativeThrusterPos=s.Util.Vector(this.centerX,this.centerY),this.relativeThrusterPos.Subtract(this.shape.GetBody().GetPosition()))}KeyInput(t,e,s){t==this.thrustKey&&(this.isKeyDown=!e)}Update(e){if(this.isInitted&&(this.isKeyDown||this.autoOn)){var r=this.angle+this.shape.GetBody().GetAngle();this.isBalloon&&(r=-Math.PI/2);var h=10+this.strength*this.strength*10,i=s.Util.Vector(Math.cos(r)*h,Math.sin(r)*h),n=new t.b2Vec2;this.shape.GetBody().GetWorldPoint(this.relativeThrusterPos,n),this.shape.GetBody().ApplyForce(i,n)}}Move(t,e){this.centerX=t,this.centerY=e}RotateAround(t,e,r){var h=s.Util.GetDist(this.centerX,this.centerY,t,e),i=this.rotateAngle+r;this.Move(t+h*Math.cos(i),e+h*Math.sin(i)),this.angle=r+this.rotateOrientation}GetAttachedParts(t=null){null==t&&(t=new Array),t.push(this);for(var e=!1,s=0;s<t.length;s++)this.shape==t[s]&&(e=!0);return e||t.concat(this.shape.GetAttachedParts(t)),t}IntersectsBox(t,e,s,r){return this.centerX>=t&&this.centerX<=t+s&&this.centerY>=e&&this.centerY<=e+r}PrepareForResizing(){}ToString(){return"Thrusters: x="+this.centerX+", y="+this.centerY+", strength="+this.strength+", "+super.ToString()}}exports.Thrusters=h;
},{"@box2d/core":"kjbO","../Game/Globals/ControllerGameGlobals":"K8aL","../General/Util":"Zvyo","./Part":"eAVa"}],"CRRv":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Triangle=void 0;const t=require("@box2d/core"),i=require("../General/Util"),e=require("./FixedJoint"),s=require("./ShapePart");class h extends s.ShapePart{constructor(t,i,e,s,h,r){super(t,e),this.x1=t,this.y1=i,this.x2=e,this.y2=s,this.x3=h,this.y3=r,this.SwapVertices();this.x1,this.x2,this.x3,this.y1,this.y2,this.y3;this.type="Triangle"}SwapVertices(){var t=i.Util.NormalizeAngle(Math.atan2(this.y1-this.y2,this.x2-this.x1)),e=i.Util.NormalizeAngle(Math.atan2(this.y1-this.y3,this.x3-this.x1));if(e<t&&(e+=2*Math.PI),e-t<=Math.PI){var s=this.x2,h=this.y2;this.x2=this.x3,this.y2=this.y3,this.x3=s,this.y3=h}}GetArea(){var t=i.Util.GetDist(this.x1,this.y1,this.x2,this.y2),e=i.Util.GetDist(this.x1,this.y1,this.x3,this.y3),s=i.Util.GetDist(this.x2,this.y2,this.x3,this.y3);return Math.sqrt(Math.pow(t*t+e*e+s*s,2)-2*(t*t*t*t+e*e*e*e+s*s*s*s))/4}GetVertices(){var e=new Array(3);e[0]=new t.b2Vec2(this.x1,this.y1),e[1]=new t.b2Vec2(this.x2,this.y2),e[2]=new t.b2Vec2(this.x3,this.y3);for(var s=0;s<3;s++){var h=i.Util.GetDist(this.centerX,this.centerY,e[s].x,e[s].y),r=Math.atan2(e[s].y-this.centerY,e[s].x-this.centerX);r=i.Util.NormalizeAngle(this.angle+r),e[s].x=this.centerX+h*Math.cos(r),e[s].y=this.centerY+h*Math.sin(r)}return e}GetVerticesForOutline(t){return h.GetOutlineVertices(this.GetVertices(),3,t)}InsideShape(t,i,e){for(var s=!0,h=this.GetVertices(),r=0;r<3;r++){var n;n=h[(r+1)%3].x==h[r].x?h[(r+1)%3].y>=h[r].y?1e8:-1e8:(h[(r+1)%3].y-h[r].y)/(h[(r+1)%3].x-h[r].x);var a=i-h[r].y-n*(t-h[r].x),y=h[(r+2)%3].y-h[r].y-n*(h[(r+2)%3].x-h[r].x);(a<0&&y>0||a>0&&y<0)&&(s=!1)}return s}Move(t,i){this.x1=t+(this.x1-this.centerX),this.y1=i+(this.y1-this.centerY),this.x2=t+(this.x2-this.centerX),this.y2=i+(this.y2-this.centerY),this.x3=t+(this.x3-this.centerX),this.y3=i+(this.y3-this.centerY),super.Move(t,i)}MakeCopy(){var t=new h(this.x1,this.y1,this.x2,this.y2,this.x3,this.y3);return t.density=this.density,t.angle=this.angle,t.collide=this.collide,t.isStatic=this.isStatic,t.red=this.red,t.green=this.green,t.blue=this.blue,t.opacity=this.opacity,t.outline=this.outline,t.terrain=this.terrain,t.undragable=this.undragable,t}Init(i,s=null){if(this.isInitted)return;super.Init(i);var h=new t.b2PolygonShape;h.Set(this.GetVertices(),3);var r,n=!1;if(s){for(r=0;r<3;r++)h.m_vertices[r].x-=s.GetPosition().x,h.m_vertices[r].y-=s.GetPosition().y;this.m_body=s,n=s.GetType()===t.b2BodyType.b2_staticBody}else{for(r=0;r<3;r++)h.m_vertices[r].x-=this.centerX,h.m_vertices[r].y-=this.centerY;var a={position:{x:this.centerX,y:this.centerY},type:this.isStatic?t.b2BodyType.b2_staticBody:t.b2BodyType.b2_dynamicBody};if(this.isEditable){for(var y=!1,o=0;o<this.m_joints.length;o++)if(this.m_joints[o].isEnabled){y=!0;break}y||(a.bullet=!0)}this.isBullet&&(a.bullet=!0),this.m_body=i.CreateBody(a)}this.m_fixture=this.m_body.CreateFixture({shape:h,friction:.4,restitution:.3,density:(this.density+5)/10}),this.m_collisionGroup!=Number.MIN_VALUE&&this.m_fixture.SetFilterData({groupIndex:this.m_collisionGroup});const x=new Object;for(x.collide=this.collide,x.editable=this.isEditable,x.red=this.red,x.green=this.green,x.blue=this.blue,x.outline=this.outline,x.terrain=this.terrain,x.undragable=this.undragable,x.isPiston=-1,x.isSandbox=this.isSandbox,this.m_body.SetUserData(x),this.m_fixture.SetUserData(x),this.m_shape=h,this.isStatic||n?this.m_body.SetMassData(new t.b2MassData):this.m_body.ResetMassData(),r=0;r<this.m_joints.length;r++)if(this.m_joints[r].isEnabled&&this.m_joints[r]instanceof e.FixedJoint){var l=this.m_joints[r].GetOtherPart(this);l.isEnabled&&l.Init(i,this.m_body)}}IntersectsBox(t,e,s,h){if(this.centerX>=t&&this.centerX<=t+s&&this.centerY>=e&&this.centerY<=e+h)return!0;for(var r=this.GetVertices(),n=0;n<3;n++){if(i.Util.SegmentsIntersect(r[n].x,r[n].y,r[(n+1)%3].x,r[(n+1)%3].y,t,e,t+s,e))return!0;if(i.Util.SegmentsIntersect(r[n].x,r[n].y,r[(n+1)%3].x,r[(n+1)%3].y,t+s,e,t+s,e+h))return!0;if(i.Util.SegmentsIntersect(r[n].x,r[n].y,r[(n+1)%3].x,r[(n+1)%3].y,t+s,e+h,t,e+h))return!0;if(i.Util.SegmentsIntersect(r[n].x,r[n].y,r[(n+1)%3].x,r[(n+1)%3].y,t,e+h,t,e))return!0}return!1}PrepareForResizing(){this.initX1=this.x1-this.centerX,this.initY1=this.y1-this.centerY,this.initX2=this.x2-this.centerX,this.initY2=this.y2-this.centerY,this.initX3=this.x3-this.centerX,this.initY3=this.y3-this.centerY}equals(t){return t instanceof h&&this.NumbersEqual(this.x1,t.x1)&&this.NumbersEqual(this.y1,t.y1)&&this.NumbersEqual(this.x2,t.x2)&&this.NumbersEqual(this.y2,t.y2)&&this.NumbersEqual(this.x3,t.x3)&&this.NumbersEqual(this.y3,t.y3)&&super.equals(t)}ToString(){return"Triangle: x1="+this.x1+", y1="+this.y1+", x2="+this.x2+", y2="+this.y2+", x3="+this.x3+", y3="+this.y3+super.ToString()}}exports.Triangle=h,h.MIN_SIDE_LENGTH=.1,h.MAX_SIDE_LENGTH=10,h.MIN_TRIANGLE_ANGLE=5*Math.PI/180;
},{"@box2d/core":"kjbO","../General/Util":"Zvyo","./FixedJoint":"QW19","./ShapePart":"CDAe"}],"s2SF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CameraMovement=void 0;class e{constructor(e,t,s,r){this.frame=e,this.x=t,this.y=s,this.scale=r}}exports.CameraMovement=e;
},{}],"T7gT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Controller=void 0;const e=require("pixi.js");class n extends Error{}class o extends e.Container{constructor(){super(...arguments),this.controllerType="controller"}Update(){throw new n("abstract function Controller.Update() called")}ShowDialog(e){}ShowDialog2(e){}ShowDialog3(e){}ShowLinkDialog(e,n,o=!1,t="",i=!1){}HideDialog(e){}HideLinkDialog(e){}HideExportDialog(e){}HideImportDialog(e){}ShowImportWindow(e){}ShowConfirmDialog(e,n){}HideConfirmDialog(e){}ConfirmDeleteRobot(e){}ConfirmDeleteReplay(e){}ConfirmDeleteChallenge(e){}ConfirmLogout(e){}DialogOK(e){}finishGettingLoadRobotData(e){}finishGettingLoadReplayData(e){}finishGettingLoadChallengeData(e){}finishGettingLoadChallengeForScoreData(e){}finishGettingScoreData(e){}finishLoading(e){}finishLoadingReplay(e){}finishLoadingChallenge(e){}finishDeleting(e){}finishDeletingReplay(e){}finishDeletingChallenge(e){}loginButton(e,n=!1,o=!1,t=!1){}finishLoggingIn(e){}finishAddingUser(e){}finishExporting(e,n){}commentButton(e,n="",o=!1){}linkButton(e,n="",o=!1){}embedButton(e,n="",o=!1){}commentReplayButton(e,n="",o=!1){}linkReplayButton(e,n="",o=!1){}embedReplayButton(e,n="",o=!1){}commentChallengeButton(e,n="",o=!1){}linkChallengeButton(e,n="",o=!1){}embedChallengeButton(e,n="",o=!1){}processLoadedRobot(e){}processLoadedReplay(e){}processLoadedChallenge(e){}GuiCallback(e){}IsPaused(){return!1}GetPhysScale(){return 30}GetMinX(){return-25}GetMaxX(){return 25}GetMinY(){return-25}GetMaxY(){return 25}World2ScreenX(e){return 40*e}World2ScreenY(e){return 40*e}keyInput(e,n){}SyncReplay(e){}SyncReplay2(e,n){}MoveCameraForReplay(e){}}exports.Controller=o;
},{"pixi.js":"aQiP"}],"H8Kw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.b2DebugDraw=void 0;const i=require("@box2d/core"),t=require("../../General/Util");class r{constructor(){this.drawColours=!0,this.m_drawScale=1,this.m_drawXOff=0,this.m_drawYOff=0,this.m_lineThickness=.08,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_drawFlags=0}SetFlags(i){this.m_drawFlags=i}GetFlags(){return this.m_drawFlags}AppendFlags(i){this.m_drawFlags|=i}ClearFlags(i){this.m_drawFlags&=~i}DrawPolygon(i,r,s){if(this.IsPolygonOnScreen(i,r)){this.m_sprite.lineStyle(1,t.Util.b2ColorToHex(s),this.m_alpha),this.m_sprite.moveTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff);for(var a=1;a<r;a++)this.m_sprite.lineTo(i[a].x*this.m_drawScale-this.m_drawXOff,i[a].y*this.m_drawScale-this.m_drawYOff);this.m_sprite.lineTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff)}}DrawSolidPolygon(i,s,a,e=!1,h=!0){if(this.IsPolygonOnScreen(i,s)){var l=r.DarkenColour(a);h?this.m_sprite.lineStyle(this.m_lineThickness*this.m_drawScale,this.drawColours?t.Util.b2ColorToHex(e?r.DarkenColour(l):l):t.Util.b2ColorToHex(a),this.m_alpha):this.m_sprite.lineStyle(0,0,0),this.m_sprite.moveTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.beginFill(this.drawColours&&e?t.Util.b2ColorToHex(r.BrightenColour(a)):t.Util.b2ColorToHex(a),this.m_fillAlpha*(e?.8:1));for(var m=1;m<s;m++)this.m_sprite.lineTo(i[m].x*this.m_drawScale-this.m_drawXOff,i[m].y*this.m_drawScale-this.m_drawYOff);this.m_sprite.lineTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.endFill()}}DrawSolidCannon(i,s,a,e=!1,h=!0){if(this.IsPolygonOnScreen(i,s)){var l=r.DarkenColour(a);h?this.m_sprite.lineStyle(this.m_lineThickness*this.m_drawScale,this.drawColours?t.Util.b2ColorToHex(e?r.DarkenColour(l):l):t.Util.b2ColorToHex(a),this.m_alpha):this.m_sprite.lineStyle(0,0,0),this.m_sprite.moveTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.beginFill(t.Util.b2ColorToHex(a),this.m_fillAlpha*(e?.8:1)),this.m_sprite.lineTo(i[1].x*this.m_drawScale-this.m_drawXOff,i[1].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(i[2].x*this.m_drawScale-this.m_drawXOff,i[2].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(i[3].x*this.m_drawScale-this.m_drawXOff,i[3].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.endFill(),this.m_sprite.moveTo(i[0].x*this.m_drawScale-this.m_drawXOff,i[0].y*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(.5*(i[1].x+i[2].x)*this.m_drawScale-this.m_drawXOff,.5*(i[1].y+i[2].y)*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(i[3].x*this.m_drawScale-this.m_drawXOff,i[3].y*this.m_drawScale-this.m_drawYOff)}}DrawCircle(i,r,s){this.IsCircleOnScreen(i,r)&&(this.m_sprite.lineStyle(1,t.Util.b2ColorToHex(s),this.m_alpha),this.m_sprite.drawCircle(i.x*this.m_drawScale-this.m_drawXOff,i.y*this.m_drawScale-this.m_drawYOff,r*this.m_drawScale))}DrawSolidCircle(i,s,a,e,h=!1,l=!0,m=!1){if(this.IsCircleOnScreen(i,s)){var _=r.DarkenColour(e);if(l?this.m_sprite.lineStyle(this.m_lineThickness*this.m_drawScale,this.drawColours?t.Util.b2ColorToHex(h?r.DarkenColour(_):_):t.Util.b2ColorToHex(e),this.m_alpha):this.m_sprite.lineStyle(0,0,0),this.m_sprite.moveTo(0,0),this.m_sprite.beginFill(this.drawColours?t.Util.b2ColorToHex(h?r.BrightenColour(e):e):t.Util.b2ColorToHex(e),this.m_fillAlpha*(h?.8:1)),this.m_sprite.drawCircle(i.x*this.m_drawScale-this.m_drawXOff,i.y*this.m_drawScale-this.m_drawYOff,s*this.m_drawScale),this.m_sprite.endFill(),l&&!m)for(var o=0;o<16;o++){var d=Math.atan2(a.s,a.c)+2*o*Math.PI/16;this.m_sprite.moveTo((i.x+Math.cos(d)*(.9*s))*this.m_drawScale-this.m_drawXOff,(i.y+Math.sin(d)*(.9*s))*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo((i.x+Math.cos(d)*s)*this.m_drawScale-this.m_drawXOff,(i.y+Math.sin(d)*s)*this.m_drawScale-this.m_drawYOff)}}}DrawSegment(i,r,s){this.m_sprite.lineStyle(1,t.Util.b2ColorToHex(s),this.m_alpha),this.m_sprite.moveTo(i.x*this.m_drawScale-this.m_drawXOff,i.y*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(r.x*this.m_drawScale-this.m_drawXOff,r.y*this.m_drawScale-this.m_drawYOff)}DrawSolidSegment(i,r,s){this.m_sprite.lineStyle(this.m_lineThickness*this.m_drawScale,t.Util.b2ColorToHex(s),this.m_alpha),this.m_sprite.moveTo(i.x*this.m_drawScale-this.m_drawXOff,i.y*this.m_drawScale-this.m_drawYOff),this.m_sprite.lineTo(r.x*this.m_drawScale-this.m_drawXOff,r.y*this.m_drawScale-this.m_drawYOff)}IsPolygonOnScreen(i,t){var r,s;r=i[0].x<-5,s=i[0].y<-5;for(var a=0;a<t;a++){var e=i[a].x*this.m_drawScale-this.m_drawXOff,h=i[a].y*this.m_drawScale-this.m_drawYOff;if((e>=-5||!r)&&(e<805||r)&&(h>=-5||!s)&&(h<605||s))return!0}return!1}IsCircleOnScreen(t,r){var s=new i.b2Vec2,a=r*this.m_drawScale;return s.x=t.x*this.m_drawScale-this.m_drawXOff,s.y=t.y*this.m_drawScale-this.m_drawYOff,s.x+a>=-5&&s.x-a<805&&s.y+a>=-5&&s.y-a<605}static BrightenColour(t){var s,a,e,h=r.GetR(t),l=r.GetG(t),m=r.GetB(t),_=Math.max(h,l,m),o=100*_/255+20;return 0==h&&(h=1),0==l&&(l=1),0==m&&(m=1),0==_&&(_=1),s=255*h/_*o/100,a=255*l/_*o/100,e=255*m/_*o/100,s=Math.min(s,255),a=Math.min(a,255),e=Math.min(e,255),new i.b2Color(s/255,a/255,e/255)}static DarkenColour(t){var s,a,e,h=r.GetR(t),l=r.GetG(t),m=r.GetB(t),_=Math.max(h,l,m),o=100*_/255-40;return s=255*h/_*o/100,a=255*l/_*o/100,e=255*m/_*o/100,s=Math.max(s,0),a=Math.max(a,0),e=Math.max(e,0),new i.b2Color(s/255,a/255,e/255)}static GetR(i){return(16711680&t.Util.b2ColorToHex(i))>>16}static GetG(i){return(65280&t.Util.b2ColorToHex(i))>>8}static GetB(i){return 255&t.Util.b2ColorToHex(i)}}exports.b2DebugDraw=r,r.e_shapeBit=1,r.e_jointBit=2,r.e_coreShapeBit=4,r.e_aabbBit=8,r.e_obbBit=16,r.e_pairBit=32,r.e_centerOfMassBit=64;
},{"@box2d/core":"kjbO","../../General/Util":"Zvyo"}],"tHDu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Draw=void 0;const e=require("pixi.js"),t=require("@box2d/core"),a=require("../General/Util"),i=require("../Main"),n=require("../Parts/Cannon"),o=require("../Parts/Circle"),r=require("../Parts/FixedJoint"),l=require("../Parts/JointPart"),s=require("../Parts/PrismaticJoint"),h=require("../Parts/Rectangle"),c=require("../Parts/RevoluteJoint"),w=require("../Parts/ShapePart"),d=require("../Parts/TextPart"),C=require("../Parts/Thrusters"),b=require("../Parts/Triangle"),_=require("./Globals/ControllerGameGlobals"),m=require("./Graphics/b2DebugDraw");class g extends m.b2DebugDraw{DrawWorld(_,m,G,S,M=!0,f=!0,u=!0,D=null){var y;if(this.m_world=G,D&&(S||D.showConditions)){for(y=0;y<D.winConditions.length;y++)0==D.winConditions[y].object?((K=new Array(4))[0]=new t.b2Vec2(D.winConditions[y].minX,D.winConditions[y].minY),K[1]=new t.b2Vec2(D.winConditions[y].minX,D.winConditions[y].maxY),K[2]=new t.b2Vec2(D.winConditions[y].maxX,D.winConditions[y].maxY),K[3]=new t.b2Vec2(D.winConditions[y].maxX,D.winConditions[y].minY),this.drawColours&&(this.m_fillAlpha=.2),this.DrawSolidPolygon(K,4,new t.b2Color(.5,.8,.5))):D.winConditions[y].object<5&&this.DrawSolidSegment(new t.b2Vec2(D.winConditions[y].minX,D.winConditions[y].minY),new t.b2Vec2(D.winConditions[y].maxX,D.winConditions[y].maxY),g.DarkenColour(new t.b2Color(.5,.8,.5)));for(y=0;y<D.lossConditions.length;y++)0==D.lossConditions[y].object?((K=new Array(4))[0]=new t.b2Vec2(D.lossConditions[y].minX,D.lossConditions[y].minY),K[1]=new t.b2Vec2(D.lossConditions[y].minX,D.lossConditions[y].maxY),K[2]=new t.b2Vec2(D.lossConditions[y].maxX,D.lossConditions[y].maxY),K[3]=new t.b2Vec2(D.lossConditions[y].maxX,D.lossConditions[y].minY),this.drawColours&&(this.m_fillAlpha=.2),this.DrawSolidPolygon(K,4,new t.b2Color(.8,.7,.7))):D.lossConditions[y].object<5&&this.DrawSolidSegment(new t.b2Vec2(D.lossConditions[y].minX,D.lossConditions[y].minY),new t.b2Vec2(D.lossConditions[y].maxX,D.lossConditions[y].maxY),g.DarkenColour(new t.b2Color(.7,.7,.8)))}if(S){if(this.drawColours&&u)for(y=0;y<_.length;y++)if((!_[y].isStatic||_[y].isEditable||M||_[y].drawAnyway)&&_[y]instanceof w.ShapePart&&_[y].terrain&&_[y].outline){var p=g.s_normalColor,V=!1;this.drawColours?(p=new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),(_[y]instanceof w.ShapePart&&_[y].highlightForJoint||a.Util.ObjectInArray(_[y],m))&&(V=!0)):(_[y].isEditable||(p=g.s_uneditableColor),_[y].isStatic&&_[y].isEditable&&(p=g.s_staticEditableColor),a.Util.ObjectInArray(_[y],m)&&(p=g.s_selectedColor),_[y].isStatic&&!_[y].isEditable&&(p=g.s_staticColor),_[y]instanceof w.ShapePart&&_[y].highlightForJoint&&(p=g.s_jointCreatingColor)),p=g.DarkenColour(p),V&&(p=g.DarkenColour(p));var I=Math.max(.1,this.m_lineThickness*Math.pow(this.m_drawScale,.5)/8);if(_[y]instanceof o.Circle){var A=_[y];this.m_fillAlpha=A.opacity/255,this.DrawSolidCircle(new t.b2Vec2(A.centerX,A.centerY),A.radius+.8*I,new t.b2Rot(A.angle),p,!1,!1)}else if(_[y]instanceof h.Rectangle){var T=_[y];this.m_fillAlpha=T.opacity/255,this.DrawSolidPolygon(T.GetVerticesForOutline(I),4,p,!1,!1)}else if(_[y]instanceof b.Triangle){var P=_[y];this.m_fillAlpha=P.opacity/255,this.DrawSolidPolygon(P.GetVerticesForOutline(I),3,p,!1,!1)}else if(_[y]instanceof n.Cannon){var N=_[y];this.m_fillAlpha=N.opacity/255,this.DrawSolidPolygon(N.GetVerticesForOutline(I),4,p,!1,!1)}}for(y=0;y<_.length;y++)if((!_[y].isStatic||_[y].isEditable||M||_[y].drawAnyway)&&(_[y]instanceof w.ShapePart||_[y]instanceof s.PrismaticJoint))if(p=g.s_normalColor,V=!1,this.drawColours?(p=new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),(_[y]instanceof w.ShapePart&&_[y].highlightForJoint||a.Util.ObjectInArray(_[y],m))&&(V=!0)):(_[y]instanceof l.JointPart&&(p=g.s_jointColor),_[y].isEditable||(p=g.s_uneditableColor),_[y].isStatic&&_[y].isEditable&&(p=g.s_staticEditableColor),a.Util.ObjectInArray(_[y],m)&&(p=g.s_selectedColor),_[y].isStatic&&!_[y].isEditable&&(p=g.s_staticColor),_[y]instanceof w.ShapePart&&_[y].highlightForJoint&&(p=g.s_jointCreatingColor)),_[y]instanceof o.Circle)A=_[y],this.drawColours&&(this.m_fillAlpha=A.opacity/255),this.DrawSolidCircle(new t.b2Vec2(A.centerX,A.centerY),A.radius,new t.b2Rot(A.angle),p,V,A.outline&&(!A.terrain||!this.drawColours)&&u);else if(_[y]instanceof h.Rectangle)T=_[y],this.drawColours&&(this.m_fillAlpha=T.opacity/255),this.DrawSolidPolygon(T.GetVertices(),4,p,V,T.outline&&(!T.terrain||!this.drawColours)&&u);else if(_[y]instanceof b.Triangle)P=_[y],this.drawColours&&(this.m_fillAlpha=P.opacity/255),this.DrawSolidPolygon(P.GetVertices(),3,p,V,P.outline&&(!P.terrain||!this.drawColours)&&u);else if(_[y]instanceof n.Cannon)N=_[y],this.drawColours&&(this.m_fillAlpha=N.opacity/255),this.DrawSolidCannon(N.GetVertices(),4,p,V,N.outline&&(!N.terrain||!this.drawColours)&&u);else if(_[y]instanceof s.PrismaticJoint){var L=_[y],x=L.anchorX-L.axis.x*L.initLength/2,E=L.anchorY-L.axis.y*L.initLength/2,v=L.anchorX+L.axis.x*L.initLength/2,X=L.anchorY+L.axis.y*L.initLength/2,R=Math.atan2(L.axis.y,L.axis.x);this.drawColours&&(this.m_fillAlpha=L.opacity/255),(F=new Array)[0]=new t.b2Vec2(x-.25,E-.05),F[1]=new t.b2Vec2(x+.25,E-.05),F[2]=new t.b2Vec2(x+.25,E+.05),F[3]=new t.b2Vec2(x-.25,E+.05);var U=Math.sqrt(.065);for(J=0;J<4;J++){var W=Math.atan2(F[J].y-E,F[J].x-x);W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=x+U*Math.cos(W),F[J].y=E+U*Math.sin(W)}this.DrawSolidPolygon(F,4,p,V,L.outline&&u);var O=x+(U=Math.sqrt(.2*.2+L.initLength*L.initLength/4))*Math.cos(Math.atan2(-L.initLength/2,-.2)+R+Math.PI/2),q=E+U*Math.sin(Math.atan2(-L.initLength/2,-.2)+R+Math.PI/2);for(F[0]=new t.b2Vec2(x-.05,E-L.initLength/2),F[1]=new t.b2Vec2(x+.05,E-L.initLength/2),F[2]=new t.b2Vec2(x+.05,E+L.initLength/2),F[3]=new t.b2Vec2(x-.05,E+L.initLength/2),U=Math.sqrt(.05*.05+L.initLength*L.initLength/4),J=0;J<4;J++)W=Math.atan2(F[J].y-E,F[J].x-x),W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=O+U*Math.cos(W),F[J].y=q+U*Math.sin(W);for(this.DrawSolidPolygon(F,4,p,V,L.outline&&u),O=x+(U=Math.sqrt(.2*.2+L.initLength*L.initLength/4))*Math.cos(Math.atan2(-L.initLength/2,.2)+R+Math.PI/2),q=E+U*Math.sin(Math.atan2(-L.initLength/2,.2)+R+Math.PI/2),F[0]=new t.b2Vec2(x-.05,E-L.initLength/2),F[1]=new t.b2Vec2(x+.05,E-L.initLength/2),F[2]=new t.b2Vec2(x+.05,E+L.initLength/2),F[3]=new t.b2Vec2(x-.05,E+L.initLength/2),U=Math.sqrt(.05*.05+L.initLength*L.initLength/4),J=0;J<4;J++)W=Math.atan2(F[J].y-E,F[J].x-x),W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=O+U*Math.cos(W),F[J].y=q+U*Math.sin(W);for(this.DrawSolidPolygon(F,4,p,V,L.outline&&u),O=x+(U=Math.sqrt(.0225+L.initLength*L.initLength))*Math.cos(Math.atan2(-L.initLength,-.15)+R+Math.PI/2),q=E+U*Math.sin(Math.atan2(-L.initLength,-.15)+R+Math.PI/2),F[0]=new t.b2Vec2(x-.1,E-.05),F[1]=new t.b2Vec2(x+.1,E-.05),F[2]=new t.b2Vec2(x+.1,E+.05),F[3]=new t.b2Vec2(x-.1,E+.05),U=Math.sqrt(.1*.1+.05*.05),J=0;J<4;J++)W=Math.atan2(F[J].y-E,F[J].x-x),W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=O+U*Math.cos(W),F[J].y=q+U*Math.sin(W);for(this.DrawSolidPolygon(F,4,p,V,L.outline&&u),O=x+(U=Math.sqrt(.0225+L.initLength*L.initLength))*Math.cos(Math.atan2(-L.initLength,.15)+R+Math.PI/2),q=E+U*Math.sin(Math.atan2(-L.initLength,.15)+R+Math.PI/2),F[0]=new t.b2Vec2(x-.1,E-.05),F[1]=new t.b2Vec2(x+.1,E-.05),F[2]=new t.b2Vec2(x+.1,E+.05),F[3]=new t.b2Vec2(x-.1,E+.05),U=Math.sqrt(.1*.1+.05*.05),J=0;J<4;J++)W=Math.atan2(F[J].y-E,F[J].x-x),W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=O+U*Math.cos(W),F[J].y=q+U*Math.sin(W);for(this.DrawSolidPolygon(F,4,p,V,L.outline&&u),O=v+(U=L.initLength/2-.1)*Math.cos(Math.atan2(L.initLength/2-.1,0)+R+Math.PI/2),q=X+U*Math.sin(Math.atan2(L.initLength/2-.1,0)+R+Math.PI/2),F[0]=new t.b2Vec2(v-.05,X-L.initLength/2),F[1]=new t.b2Vec2(v+.05,X-L.initLength/2),F[2]=new t.b2Vec2(v+.05,X+L.initLength/2),F[3]=new t.b2Vec2(v-.05,X+L.initLength/2),U=Math.sqrt(.05*.05+L.initLength*L.initLength/4),J=0;J<4;J++)W=Math.atan2(F[J].y-X,F[J].x-v),W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=O+U*Math.cos(W),F[J].y=q+U*Math.sin(W);for(this.DrawSolidPolygon(F,4,p,V,L.outline&&u),O=v+(U=L.initLength-.1)*Math.cos(Math.atan2(L.initLength-.1,0)+R+Math.PI/2),q=X+U*Math.sin(Math.atan2(L.initLength-.1,0)+R+Math.PI/2),F[0]=new t.b2Vec2(v-.15,X-.05),F[1]=new t.b2Vec2(v+.15,X-.05),F[2]=new t.b2Vec2(v+.15,X+.05),F[3]=new t.b2Vec2(v-.15,X+.05),U=Math.sqrt(.025),J=0;J<4;J++)W=Math.atan2(F[J].y-X,F[J].x-v),W=a.Util.NormalizeAngle(R+W+Math.PI/2),F[J].x=O+U*Math.cos(W),F[J].y=q+U*Math.sin(W);this.DrawSolidPolygon(F,4,p,V,L.outline&&u)}if(f)for(y=0;y<_.length;y++)if(_[y]instanceof l.JointPart||_[y]instanceof C.Thrusters)if(p=g.s_jointColor,_[y].isEditable||(p=g.s_uneditableColor),_[y].isStatic&&_[y].isEditable&&(p=g.s_staticEditableColor),a.Util.ObjectInArray(_[y],m)&&(p=g.s_selectedColor),_[y].isStatic&&!_[y].isEditable&&(p=g.s_staticColor),_[y]instanceof w.ShapePart&&_[y].highlightForJoint&&(p=g.s_jointCreatingColor),_[y]instanceof r.FixedJoint)for(var H=_[y],J=0;J<2;J++){var F=new Array;F[0]=new t.b2Vec2(H.anchorX-.075*(J+1)*30/this.m_drawScale,H.anchorY-.075*(J+1)*30/this.m_drawScale),F[1]=new t.b2Vec2(H.anchorX-.075*(J+1)*30/this.m_drawScale,H.anchorY+.075*(J+1)*30/this.m_drawScale),F[2]=new t.b2Vec2(H.anchorX+.075*(J+1)*30/this.m_drawScale,H.anchorY+.075*(J+1)*30/this.m_drawScale),F[3]=new t.b2Vec2(H.anchorX+.075*(J+1)*30/this.m_drawScale,H.anchorY-.075*(J+1)*30/this.m_drawScale),this.DrawPolygon(F,4,p)}else if(_[y]instanceof c.RevoluteJoint){var Y=_[y];this.DrawCircle(new t.b2Vec2(Y.anchorX,Y.anchorY),2.25/this.m_drawScale,p),this.DrawCircle(new t.b2Vec2(Y.anchorX,Y.anchorY),4.5/this.m_drawScale,p)}else if(_[y]instanceof C.Thrusters){var B=_[y];for(J=0;J<2;J++)(F=new Array)[0]=new t.b2Vec2(B.centerX+.2*Math.cos(B.angle)*(J+1)*30/this.m_drawScale,B.centerY+.2*Math.sin(B.angle)*(J+1)*30/this.m_drawScale),F[1]=new t.b2Vec2(B.centerX+.1*Math.cos(B.angle+2*Math.PI/3)*(J+1)*30/this.m_drawScale,B.centerY+.1*Math.sin(B.angle+2*Math.PI/3)*(J+1)*30/this.m_drawScale),F[2]=new t.b2Vec2(B.centerX+.1*Math.cos(B.angle+4*Math.PI/3)*(J+1)*30/this.m_drawScale,B.centerY+.1*Math.sin(B.angle+4*Math.PI/3)*(J+1)*30/this.m_drawScale),this.DrawPolygon(F,3,p)}}else{var j;this.GetFlags();if(this.drawColours&&u)for(y=0;y<_.length;y++)(!_[y].isStatic||_[y].isEditable||M||_[y].drawAnyway)&&_[y]instanceof w.ShapePart&&_[y].terrain&&_[y].outline&&(j=_[y].GetBody().GetTransform(),_[y]instanceof n.Cannon?this.DrawCannonForOutline(_[y].GetShape(),j,new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),_[y].opacity/255):this.DrawShapeForOutline(_[y].GetShape(),j,new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),_[y].opacity/255));for(y=0;y<_.length;y++){if(!_[y].isStatic||_[y].isEditable||M||_[y].drawAnyway)if(_[y]instanceof w.ShapePart)j=_[y].GetBody().GetTransform(),this.drawColours?_[y]instanceof n.Cannon?this.DrawCannon(_[y].GetShape(),j,new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),_[y].opacity/255,u):this.DrawShape(_[y].GetShape(),_[y].GetUserData(),j,new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),_[y].opacity/255,u):_[y].isStatic?_[y]instanceof n.Cannon?this.DrawCannon(_[y].GetShape(),j,g.s_staticColor,1,u):this.DrawShape(_[y].GetShape(),_[y].GetUserData(),j,g.s_staticColor,1,u):_[y]instanceof n.Cannon?this.DrawCannon(_[y].GetShape(),j,g.s_normalColor,1,u):this.DrawShape(_[y].GetShape(),_[y].GetUserData(),j,g.s_normalColor,1,u);else if(_[y]instanceof s.PrismaticJoint){const e=_[y];var k=e.GetShapes();for(J=0;J<k.length;J++)j=e.part2.GetBody().GetTransform(),this.drawColours?this.DrawShape(k[J],e.part2.GetUserData(),j,new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),_[y].opacity/255,u):_[y].isStatic?this.DrawShape(k[J],e.part2.GetUserData(),j,g.s_staticColor,1,u):this.DrawShape(k[J],e.part2.GetUserData(),j,g.s_normalColor,1,u)}if(_[y]instanceof n.Cannon)for(J=0;J<_[y].cannonballs.length;J++)j=_[y].cannonballs[J].GetTransform(),this.drawColours?this.DrawShape(_[y].cannonballs[J].GetShapeList(),_[y].GetUserData(),j,new t.b2Color(_[y].red/255,_[y].green/255,_[y].blue/255),_[y].opacity/255,u,!0):this.DrawShape(_[y].cannonballs[J].GetShapeList(),_[y].GetUserData(),j,g.s_normalColor,1,u,!0)}}for(y=0;y<_.length;y++)if(_[y]instanceof d.TextPart){_[y].m_textField.visible=S||_[y].alwaysVisible||_[y].displayKeyPressed,_[y].m_textField.x=_[y].x*this.m_drawScale-this.m_drawXOff,_[y].m_textField.y=_[y].y*this.m_drawScale-this.m_drawYOff,_[y].m_textField.width=_[y].w*this.m_drawScale,_[y].m_textField.height=_[y].h*this.m_drawScale;var z=new e.TextStyle;if(z.fontSize=_[y].scaleWithZoom?_[y].size*this.m_drawScale/30:_[y].size,z.fill=_[y].red<<16|_[y].green<<8|_[y].blue,z.fontFamily=i.Main.GLOBAL_FONT,_[y].m_textField.setTextStyle(z),_[y].m_textField.setSelection(0,0),S){var Z=a.Util.ObjectInArray(_[y],m)?new t.b2Color(1,1,1):new t.b2Color(.1,.1,.1),K=new Array;K[0]=new t.b2Vec2(_[y].x,_[y].y),K[1]=new t.b2Vec2(_[y].x+_[y].w,_[y].y),K[2]=new t.b2Vec2(_[y].x+_[y].w,_[y].y+_[y].h),K[3]=new t.b2Vec2(_[y].x,_[y].y+_[y].h),this.DrawPolygon(K,4,Z);var Q=new Array;for(J=0;J<4;J++)Q[0]=new t.b2Vec2(K[J].x-4/this.m_drawScale,K[J].y-4/this.m_drawScale),Q[1]=new t.b2Vec2(K[J].x-4/this.m_drawScale,K[J].y+4/this.m_drawScale),Q[2]=new t.b2Vec2(K[J].x+4/this.m_drawScale,K[J].y+4/this.m_drawScale),Q[3]=new t.b2Vec2(K[J].x+4/this.m_drawScale,K[J].y-4/this.m_drawScale),this.DrawPolygon(Q,4,Z)}}}DrawJoint(e){var i=e.GetBodyA(),n=e.GetBodyA(),o=i.GetTransform(),r=n.GetTransform(),l=o.position,s=r.position,h=e.GetAnchorA(),c=e.GetAnchorB(),w=g.s_jointColor;switch(e.GetType()){case t.b2JointType.e_revoluteJoint:this.DrawCircle(e.GetAnchorA(),1.5/this.m_drawScale,w),this.DrawCircle(e.GetAnchorB(),3/this.m_drawScale,w);break;case t.b2JointType.e_prismaticJoint:var d=e.GetBodyA().GetWorldPoint(e.GetUserData().localPoint1),C=e.GetBodyB().GetWorldPoint(e.GetUserData().localPoint2);this.DrawSegment(d,C,w);var b=a.Util.Midpoint(d,C);this.DrawCircle(b,1.5/this.m_drawScale,w),this.DrawCircle(b,3/this.m_drawScale,w);break;case t.b2JointType.e_mouseJoint:this.DrawSegment(h,c,w);break;default:i!=this.m_world.m_groundBody&&this.DrawSegment(l,h,w),this.DrawSegment(h,c,w),n!=this.m_world.m_groundBody&&this.DrawSegment(s,c,w)}}DrawShape(e,a,i,n,o,r=!0,l=!1){switch(e.GetType()){case t.b2ShapeType.e_circle:{var s=e;const w=new t.b2Vec2;t.b2Transform.MultiplyVec2(i,s.m_p,w);var h=s.m_radius,c=i.q;this.drawColours&&(this.m_fillAlpha=o),this.DrawSolidCircle(w,h,c,n,!1,a.outline&&(!this.drawColours||!a.terrain)&&r,l)}break;case t.b2ShapeType.e_polygon:var w,d=e,C=d.m_count,b=d.m_vertices,_=new Array(t.b2_maxPolygonVertices);for(w=0;w<C;++w){const e=new t.b2Vec2;t.b2Transform.MultiplyVec2(i,b[w],e),_[w]=e}this.drawColours&&(this.m_fillAlpha=o),this.DrawSolidPolygon(_,C,n,!1,a.outline&&(!this.drawColours||!a.terrain)&&r)}}DrawCannon(e,a,i,n,o=!0){for(var r=e,l=r.m_vertices,s=new Array,h=0;h<4;++h){const e=new t.b2Vec2;t.b2Transform.MultiplyVec2(a,l[h],e),s[h]=e}this.drawColours&&(this.m_fillAlpha=n),this.DrawSolidCannon(s,4,i,!1,r.GetUserData().outline&&(!this.drawColours||!r.GetUserData().terrain)&&o)}DrawShapeForOutline(e,a,i,n){i=g.DarkenColour(i);var o=Math.max(.1,this.m_lineThickness*Math.pow(this.m_drawScale,.5)/8);switch(e.GetType()){case t.b2ShapeType.e_circle:{var r=e;const o=new t.b2Vec2;t.b2Transform.MultiplyVec2(a,r.m_p,o);var l=r.m_radius,s=a.q;this.drawColours&&(this.m_fillAlpha=n),this.DrawSolidCircle(o,l,s,i,!1,!1)}break;case t.b2ShapeType.e_polygon:var h,c=e,d=c.m_count,C=c.m_vertices,b=new Array(t.b2_maxPolygonVertices);for(h=0;h<d;++h){const e=new t.b2Vec2;t.b2Transform.MultiplyVec2(a,C[h],e),b[h]=e}b=w.ShapePart.GetOutlineVertices(b,d,o),this.drawColours&&(this.m_fillAlpha=n),this.DrawSolidPolygon(b,d,i,!1,!1)}}DrawCannonForOutline(e,a,i,n){i=g.DarkenColour(i);for(var o=Math.max(.1,this.m_lineThickness*Math.pow(this.m_drawScale,.5)/8),r=e.m_vertices,l=new Array(t.b2_maxPolygonVertices),s=0;s<4;++s){const e=new t.b2Vec2;t.b2Transform.MultiplyVec2(a,r[s],e),l[s]=e}l=w.ShapePart.GetOutlineVertices(l,4,o),this.drawColours&&(this.m_fillAlpha=n),this.DrawSolidCannon(l,4,i,!1,!1)}DrawTempShape(e,i,r,l,s,c,w,d){var C;if(this.drawColours?this.m_fillAlpha=1:this.m_fillAlpha=.5,e==_.ControllerGameGlobals.NEW_CIRCLE&&1==i){var m=a.Util.GetDist(r,l,w,d);m<o.Circle.MIN_RADIUS&&(m=o.Circle.MIN_RADIUS),m>o.Circle.MAX_RADIUS&&(m=o.Circle.MAX_RADIUS),this.drawColours&&(this.m_fillAlpha=_.ControllerGameGlobals.defaultO/255);const e=new t.b2Rot;e.c=(w-r)/m,e.s=(d-l)/m,this.DrawSolidCircle(new t.b2Vec2(r,l),m,e,this.drawColours?new t.b2Color(_.ControllerGameGlobals.defaultR/255,_.ControllerGameGlobals.defaultG/255,_.ControllerGameGlobals.defaultB/255):g.s_selectedColor)}else if(e==_.ControllerGameGlobals.NEW_RECT&&1==i){var G=w-r,S=d-l;Math.abs(G)<h.Rectangle.MIN_WIDTH&&(G=G<0?-h.Rectangle.MIN_WIDTH:h.Rectangle.MIN_WIDTH),Math.abs(G)>h.Rectangle.MAX_WIDTH&&(G=G<0?-h.Rectangle.MAX_WIDTH:h.Rectangle.MAX_WIDTH),Math.abs(S)<h.Rectangle.MIN_WIDTH&&(S=S<0?-h.Rectangle.MIN_WIDTH:h.Rectangle.MIN_WIDTH),Math.abs(S)>h.Rectangle.MAX_WIDTH&&(S=S<0?-h.Rectangle.MAX_WIDTH:h.Rectangle.MAX_WIDTH),(C=new Array(4))[0]=new t.b2Vec2(r,l),C[1]=new t.b2Vec2(r+G,l),C[2]=new t.b2Vec2(r+G,l+S),C[3]=new t.b2Vec2(r,l+S),this.drawColours&&(this.m_fillAlpha=_.ControllerGameGlobals.defaultO/255),this.DrawSolidPolygon(C,4,this.drawColours?new t.b2Color(_.ControllerGameGlobals.defaultR/255,_.ControllerGameGlobals.defaultG/255,_.ControllerGameGlobals.defaultB/255):g.s_selectedColor)}else if(e==_.ControllerGameGlobals.NEW_CANNON&&1==i){G=w>=r||d>=l?Math.max(w-r,2*(d-l)):Math.min(w-r,2*(d-l)),Math.abs(G)<n.Cannon.MIN_WIDTH&&(G=G<0?-n.Cannon.MIN_WIDTH:n.Cannon.MIN_WIDTH),Math.abs(G)>n.Cannon.MAX_WIDTH&&(G=G<0?-n.Cannon.MAX_WIDTH:n.Cannon.MAX_WIDTH),(C=new Array(4))[0]=new t.b2Vec2(r,l),C[1]=new t.b2Vec2(r+G,l),C[2]=new t.b2Vec2(r+G,l+G/2),C[3]=new t.b2Vec2(r,l+G/2),this.drawColours&&(this.m_fillAlpha=_.ControllerGameGlobals.defaultO/255),this.DrawSolidCannon(C,4,this.drawColours?new t.b2Color(_.ControllerGameGlobals.defaultR/255,_.ControllerGameGlobals.defaultG/255,_.ControllerGameGlobals.defaultB/255):g.s_selectedColor)}else if(e==_.ControllerGameGlobals.NEW_TRIANGLE&&1==i){var M,f=w,u=d,D=a.Util.GetDist(r,l,w,d);D<b.Triangle.MIN_SIDE_LENGTH?(M=Math.atan2(l-d,w-r),f=r+b.Triangle.MIN_SIDE_LENGTH*Math.cos(M),u=l-b.Triangle.MIN_SIDE_LENGTH*Math.sin(M)):D>b.Triangle.MAX_SIDE_LENGTH&&(M=Math.atan2(l-d,w-r),f=r+b.Triangle.MAX_SIDE_LENGTH*Math.cos(M),u=l-b.Triangle.MAX_SIDE_LENGTH*Math.sin(M)),this.DrawSegment(new t.b2Vec2(r,l),new t.b2Vec2(f,u),this.drawColours?new t.b2Color(.0666,.0666,.0666):g.s_selectedColor)}else if(e==_.ControllerGameGlobals.NEW_TRIANGLE&&2==i){var y=a.Util.GetDist(r,l,w,d),p=a.Util.GetDist(s,c,w,d),V=a.Util.GetDist(r,l,s,c),I=a.Util.NormalizeAngle(Math.acos((V*V+y*y-p*p)/(2*V*y))),A=a.Util.NormalizeAngle(Math.acos((V*V+p*p-y*y)/(2*V*p))),T=a.Util.NormalizeAngle(Math.acos((y*y+p*p-V*V)/(2*y*p)));y<=b.Triangle.MAX_SIDE_LENGTH&&y>=b.Triangle.MIN_SIDE_LENGTH&&p<=b.Triangle.MAX_SIDE_LENGTH&&p>=b.Triangle.MIN_SIDE_LENGTH&&I>=b.Triangle.MIN_TRIANGLE_ANGLE&&A>=b.Triangle.MIN_TRIANGLE_ANGLE&&T>=b.Triangle.MIN_TRIANGLE_ANGLE?((C=new Array(3))[0]=new t.b2Vec2(r,l),C[1]=new t.b2Vec2(s,c),C[2]=new t.b2Vec2(w,d),this.drawColours&&(this.m_fillAlpha=_.ControllerGameGlobals.defaultO/255),this.DrawSolidPolygon(C,3,this.drawColours?new t.b2Color(_.ControllerGameGlobals.defaultR/255,_.ControllerGameGlobals.defaultG/255,_.ControllerGameGlobals.defaultB/255):g.s_selectedColor)):this.DrawSegment(new t.b2Vec2(r,l),new t.b2Vec2(s,c),this.drawColours?new t.b2Color(.0666,.0666,.0666):g.s_selectedColor)}else e==_.ControllerGameGlobals.NEW_FIXED_JOINT||e==_.ControllerGameGlobals.NEW_REVOLUTE_JOINT||e==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT||e==_.ControllerGameGlobals.FINALIZING_JOINT?(this.DrawCircle(new t.b2Vec2(w,d),2.25/this.m_drawScale,g.s_selectedColor),this.DrawCircle(new t.b2Vec2(w,d),4.5/this.m_drawScale,g.s_selectedColor),e==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT&&1==i&&(this.DrawCircle(new t.b2Vec2(r,l),2.25/this.m_drawScale,g.s_selectedColor),this.DrawCircle(new t.b2Vec2(r,l),4.5/this.m_drawScale,g.s_selectedColor),this.DrawSegment(new t.b2Vec2(r,l),new t.b2Vec2(w,d),g.s_selectedColor))):e==_.ControllerGameGlobals.BOX_SELECTING||e==_.ControllerGameGlobals.NEW_TEXT&&1==i||e==_.ControllerGameGlobals.DRAWING_BOX&&1==i||e==_.ControllerGameGlobals.DRAWING_BUILD_BOX&&1==i?((C=new Array(4))[0]=new t.b2Vec2(r,l),C[1]=new t.b2Vec2(r,d),C[2]=new t.b2Vec2(w,d),C[3]=new t.b2Vec2(w,l),this.drawColours&&(this.m_fillAlpha=.5),this.DrawSolidPolygon(C,4,new t.b2Color(.8,.5,.5))):e==_.ControllerGameGlobals.NEW_THRUSTERS?(this.DrawCircle(new t.b2Vec2(w,d),2.25/this.m_drawScale,g.s_selectedColor),this.DrawCircle(new t.b2Vec2(w,d),4.5/this.m_drawScale,g.s_selectedColor)):e==_.ControllerGameGlobals.DRAWING_HORIZONTAL_LINE&&1==i?this.DrawSegment(new t.b2Vec2(r,l),new t.b2Vec2(w,l),new t.b2Color(.0666,.0666,.0666)):e==_.ControllerGameGlobals.DRAWING_VERTICAL_LINE&&1==i&&this.DrawSegment(new t.b2Vec2(r,l),new t.b2Vec2(r,d),new t.b2Color(.0666,.0666,.0666))}}exports.Draw=g,g.s_jointColor=new t.b2Color(.8,.8,.4),g.s_selectedColor=new t.b2Color(.4,.4,.9),g.s_normalColor=new t.b2Color(.5,.5,.5),g.s_uneditableColor=new t.b2Color(.6,.6,.6),g.s_jointCreatingColor=new t.b2Color(.9,.4,.4),g.s_staticColor=new t.b2Color(.4,.9,.4),g.s_staticEditableColor=new t.b2Color(.6,.8,.6);
},{"pixi.js":"aQiP","@box2d/core":"kjbO","../General/Util":"Zvyo","../Main":"aM6Q","../Parts/Cannon":"vdN1","../Parts/Circle":"PfXD","../Parts/FixedJoint":"QW19","../Parts/JointPart":"avwv","../Parts/PrismaticJoint":"nZSh","../Parts/Rectangle":"jYSx","../Parts/RevoluteJoint":"AUAw","../Parts/ShapePart":"CDAe","../Parts/TextPart":"T0pq","../Parts/Thrusters":"Yw1p","../Parts/Triangle":"CRRv","./Globals/ControllerGameGlobals":"K8aL","./Graphics/b2DebugDraw":"H8Kw"}],"xLqP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Input=void 0;const i=require("../Main");class e{static Init(){e.m_stageMc=i.Main.theRoot,e.ascii=new Array(222),this.fillAscii(),e.keyState=new Array(222),e.keyArr=new Array;for(var s=0;s<222;s++)e.keyState[s]=0,null!=e.ascii[s]&&e.keyArr.push(s);e.bufferSize=5,e.keyBuffer=new Array(e.bufferSize);for(var a=0;a<e.bufferSize;a++)e.keyBuffer[a]=new Array(0,0);e.m_stageMc.on("mousedown",i=>this.mousePress(i)),e.m_stageMc.on("mouseup",i=>this.mouseRelease(i)),e.m_stageMc.on("mousemove",i=>this.mouseMove(i)),e.m_stageMc.on("mousewheel",i=>this.mouseWheel(i)),e.m_stageMc.on("mouseout",i=>this.mouseLeave(i))}static update(){for(var i=0;i<e.keyArr.length;i++)0!=e.keyState[e.keyArr[i]]&&e.keyState[e.keyArr[i]]++;for(var s=0;s<e.bufferSize;s++)e.keyBuffer[s][1]++;e.mouseReleased=!1,e.mousePressed=!1,e.mouseOver=!1}static mousePress(i){e.mousePressed=!0,e.mouseDown=!0,e.mouseDragX=0,e.mouseDragY=0,e.m_currController&&e.m_currController.mouseClick(!1)}static mouseWheel(i){e.mouseWheelVal+=i.delta}static mouseRelease(i){e.mouseDown=!1,e.mouseReleased=!0,e.m_currController&&e.m_currController.mouseClick(!0)}static mouseLeave(i){e.mouseReleased=e.mouseDown,e.mouseDown=!1}static mouseMove(i){e.mouseX=i.data.global.x-e.m_stageMc.x,e.mouseY=i.data.global.y-e.m_stageMc.y,e.mouseDown&&(e.mouseDragX+=e.mouseOffsetX,e.mouseDragY+=e.mouseOffsetY),e.m_currController&&e.m_currController.mouseMove(e.mouseX,e.mouseY)}static getKeyHold(i){return Math.max(0,e.keyState[i])}static isKeyDown(i){return e.keyState[i]>0}static isKeyPressed(i){return e.timeSinceLastKey=0,1==e.keyState[i]}static isKeyReleased(i){return-1==e.keyState[i]}static isKeyInBuffer(i,s,a){return e.keyBuffer[s][0]==i&&e.keyBuffer[s][1]<=a}static keyPress(i){e.keyState[i.keyCode]=Math.max(e.keyState[i.keyCode],1),e.lastKey=i.keyCode,e.m_currController&&e.m_currController.keyPress(e.lastKey,!1)}static keyRelease(i){e.keyState[i.keyCode]=-1;for(var s=e.bufferSize-1;s>0;s--)e.keyBuffer[s]=e.keyBuffer[s-1];e.keyBuffer[0]=[i.keyCode,0],e.m_currController&&e.m_currController.keyPress(i.keyCode,!0)}static getKeyString(i){return e.ascii[i]}static fillAscii(){e.ascii[65]="A",e.ascii[66]="B",e.ascii[67]="C",e.ascii[68]="D",e.ascii[69]="E",e.ascii[70]="F",e.ascii[71]="G",e.ascii[72]="H",e.ascii[73]="I",e.ascii[74]="J",e.ascii[75]="K",e.ascii[76]="L",e.ascii[77]="M",e.ascii[78]="N",e.ascii[79]="O",e.ascii[80]="P",e.ascii[81]="Q",e.ascii[82]="R",e.ascii[83]="S",e.ascii[84]="T",e.ascii[85]="U",e.ascii[86]="V",e.ascii[87]="W",e.ascii[88]="X",e.ascii[89]="Y",e.ascii[90]="Z",e.ascii[48]="0",e.ascii[49]="1",e.ascii[50]="2",e.ascii[51]="3",e.ascii[52]="4",e.ascii[53]="5",e.ascii[54]="6",e.ascii[55]="7",e.ascii[56]="8",e.ascii[57]="9",e.ascii[96]="NP 0",e.ascii[97]="NP 1",e.ascii[98]="NP 2",e.ascii[99]="NP 3",e.ascii[100]="NP 4",e.ascii[101]="NP 5",e.ascii[102]="NP 6",e.ascii[103]="NP 7",e.ascii[104]="NP 8",e.ascii[105]="NP 9",e.ascii[111]="NP /",e.ascii[106]="NP *",e.ascii[109]="NP -",e.ascii[107]="NP +",e.ascii[110]="NP .",e.ascii[112]="F1",e.ascii[113]="F2",e.ascii[114]="F3",e.ascii[115]="F4",e.ascii[116]="F5",e.ascii[117]="F6",e.ascii[118]="F7",e.ascii[119]="F8",e.ascii[120]="F9",e.ascii[122]="F11",e.ascii[123]="F12",e.ascii[124]="F13",e.ascii[125]="F14",e.ascii[126]="F15",e.ascii[32]="Space",e.ascii[17]="Ctrl",e.ascii[16]="Shift",e.ascii[20]="Caps",e.ascii[144]="NumLk",e.ascii[145]="ScrLk",e.ascii[192]="~",e.ascii[38]="Up",e.ascii[40]="Down",e.ascii[37]="Left",e.ascii[39]="Right",e.ascii[45]="Ins",e.ascii[46]="Del",e.ascii[33]="PgUp",e.ascii[34]="PgDn",e.ascii[35]="End",e.ascii[36]="Home",e.ascii[188]=",",e.ascii[190]=".",e.ascii[186]=";",e.ascii[222]="'",e.ascii[219]="[",e.ascii[221]="]",e.ascii[189]="-",e.ascii[187]="=",e.ascii[220]="\\",e.ascii[191]="/",e.ascii[9]="Tab",e.ascii[8]="Bksp",e.ascii[13]="Enter",e.ascii[19]="Break",e.ascii[27]="ESC"}}exports.Input=e,e.lastKey=0,e.timeSinceLastKey=0,e.mouseDown=!1,e.mouseReleased=!1,e.mousePressed=!1,e.mouseOver=!1,e.mouseWheelVal=0,e.mouseX=0,e.mouseY=0,e.mouseOffsetX=0,e.mouseOffsetY=0,e.mouseDragX=0,e.mouseDragY=0;
},{"../Main":"aM6Q"}],"xELh":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Action=void 0;const t=require("../Parts/Part");class o{constructor(t){this.partAffected=t}UndoAction(){throw new t.IllegalOperationError("abstract Action.UndoAction() called")}RedoAction(){throw new t.IllegalOperationError("abstract Action.RedoAction() called")}}exports.Action=o;
},{"../Parts/Part":"eAVa"}],"IBBZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiButton=void 0;const t=require("pixi.js"),e=require("../Game/Graphics/Resource"),u=require("../Main");class i extends t.Container{constructor(s,o,r,n,l,c,a,h=null,B=!1,d=!1){super(),this.sCheckbox=null,this.buttonOffset=!1,this.depressed=!1,this.label=null,this.background=null,this._disabled=!1,a==i.PURPLE?(this.upTexture=i.purpleButtonBase(),this.overTexture=i.purpleButtonRoll(),this.downTexture=i.purpleButtonClick()):a==i.RED?(this.upTexture=i.redButtonBase(),this.overTexture=i.redButtonRoll(),this.downTexture=i.redButtonClick()):a==i.BLUE?(this.upTexture=i.blueButtonBase(),this.overTexture=i.blueButtonRoll(),this.downTexture=i.blueButtonClick()):a==i.PINK?(this.upTexture=i.pinkButtonBase(),this.overTexture=i.pinkButtonRoll(),this.downTexture=i.pinkButtonClick()):a==i.ORANGE?(this.upTexture=i.orangeButtonBase(),this.overTexture=i.orangeButtonRoll(),this.downTexture=i.orangeButtonClick()):a==i.PLAY?(this.upTexture=i.playButtonBase(),this.overTexture=i.playButtonRoll(),this.downTexture=i.playButtonClick()):a==i.X&&(this.upTexture=i.xButtonBase(),this.overTexture=i.xButtonRoll(),this.downTexture=i.xButtonClick()),h||((h=new t.TextStyle).fontSize=11),h.fill="#573D40",h.fontFamily=u.Main.GLOBAL_FONT,h.align="center",this.width=n,this.height=l,this.position.set(o,r),this.buttonMode=!0,this.interactive=!0,this.background=new t.Sprite(this.upTexture),this.background.width=n,this.background.height=l,this.addChild(this.background),this.label=new t.Text(s),this.label.style=h,this.label.anchor.set(.5),this.label.x=n/2,this.label.y=l/2,this.addChild(this.label),this.on("click",t=>{this.disabled||c(t)}).on("tap",t=>{this.disabled||c(t)}).on("mousedown",this.bDown).on("mouseover",this.mouseOver).on("mouseout",this.bUp).on("click",this.bUp).on("click",this.mouseClick),B&&(this.sCheckbox=d?new t.Sprite(e.Resource.cLevelSelectLevelCheckBoxB):new t.Sprite(e.Resource.cLevelSelectLevelCheckBoxA),this.sCheckbox.x=110,this.sCheckbox.y=12,this.sCheckbox.smoothing=!0,this.addChild(this.sCheckbox))}set disabled(e){if(this._disabled=e,this._disabled){const e=new t.filters.ColorMatrixFilter;e.brightness(.5,!0),this.interactive=!1,this.alpha=.7,this.filters=[e]}else this.interactive=!0,this.alpha=1,this.filters=[]}get disabled(){return this._disabled}SetState(t){t?(this.buttonOffset||(this.x+=2,this.y+=2,this.buttonOffset=!0),this.depressed=!0,this.background.texture=this.downTexture):(this.buttonOffset&&(this.x-=2,this.y-=2,this.buttonOffset=!1),this.depressed=!1,this.background.texture=this.upTexture)}bDown(){this.disabled||(this.buttonOffset||(this.x+=2,this.y+=2,this.buttonOffset=!0),this.background.texture=this.downTexture)}bUp(){this.disabled||(this.buttonOffset&&(this.x-=2,this.y-=2,this.buttonOffset=!1),this.background.texture=this.upTexture)}mouseOver(){this.disabled||(u.Main.enableSound&&i.lastRolloverFrame!=Math.floor(Date.now()/150)&&(i.rolloverSound.stop(),i.rolloverSound.volume=.2,i.rolloverSound.play(),i.lastRolloverFrame=Math.floor(Date.now()/150)),this.background.texture=this.overTexture)}mouseClick(){this.disabled||u.Main.enableSound&&(i.clickSound.volume=.8,i.clickSound.play())}static redButtonBase(){return e.Resource.cGuiButtonRedBase}static redButtonRoll(){return e.Resource.cGuiButtonRedRoll}static redButtonClick(){return e.Resource.cGuiButtonRedClick}static blueButtonBase(){return e.Resource.cGuiButtonBlueBase}static blueButtonRoll(){return e.Resource.cGuiButtonBlueRoll}static blueButtonClick(){return e.Resource.cGuiButtonBlueClick}static purpleButtonBase(){return e.Resource.cGuiButtonPurpleBase}static purpleButtonRoll(){return e.Resource.cGuiButtonPurpleRoll}static purpleButtonClick(){return e.Resource.cGuiButtonPurpleClick}static pinkButtonBase(){return e.Resource.cGuiButtonPinkBase}static pinkButtonRoll(){return e.Resource.cGuiButtonPinkRoll}static pinkButtonClick(){return e.Resource.cGuiButtonPinkClick}static orangeButtonBase(){return e.Resource.cGuiButtonOrangeBase}static orangeButtonRoll(){return e.Resource.cGuiButtonOrangeRoll}static orangeButtonClick(){return e.Resource.cGuiButtonOrangeClick}static playButtonBase(){return e.Resource.cGuiButtonPlayBase}static playButtonRoll(){return e.Resource.cGuiButtonPlayRoll}static playButtonClick(){return e.Resource.cGuiButtonPlayClick}static xButtonBase(){return e.Resource.cGuiButtonXBase}static xButtonRoll(){return e.Resource.cGuiButtonXRoll}static xButtonClick(){return e.Resource.cGuiButtonXClick}}exports.GuiButton=i,i.PURPLE=0,i.RED=1,i.BLUE=2,i.PINK=3,i.ORANGE=4,i.PLAY=5,i.X=6,i.rolloverSound=e.Resource.cRoll,i.clickSound=e.Resource.cClick,i.lastRolloverFrame=0;
},{"pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q"}],"BOXT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiWindow=void 0;const e=require("pixi.js"),i=require("../Game/Graphics/Resource");class t extends e.Graphics{constructor(t,r,s,u,d=!0){var n;if(super(),this.x=t,this.y=r,this.interactive=!0,this.lineStyle(0,0,0),800==s)this.beginTextureFill({texture:i.Resource.cGuiWindowMid800}),this.drawRect(17,0,s-34,u),this.endFill(),this.beginTextureFill({texture:i.Resource.cGuiWindowRight800}),this.drawRect(s-17,0,17,u),this.endFill(),(n=new e.Matrix).translate(-1,0),this.beginTextureFill({texture:i.Resource.cGuiWindowLeft800,matrix:n}),this.drawRect(-1,0,18,u),this.endFill();else if(720==s)this.beginTextureFill({texture:i.Resource.cGuiWindowMid700}),this.drawRect(24,0,s-48,u),this.endFill(),this.beginTextureFill({texture:i.Resource.cGuiWindowRight700}),this.drawRect(s-24,0,24,u),this.endFill(),this.beginTextureFill({texture:i.Resource.cGuiWindowLeft700}),this.drawRect(0,0,24,u),this.endFill(),(n=new e.Matrix).translate(12,287),this.beginTextureFill({texture:i.Resource.cGuiWindowLine,matrix:n}),this.drawRect(12,287,684,6),this.endFill(),(n=new e.Matrix).translate(53,20),this.beginTextureFill({texture:i.Resource.cGuiWindowLinebox,matrix:n}),this.drawRect(53,20,602,80),this.endFill(),(n=new e.Matrix).translate(53,315),this.beginTextureFill({texture:i.Resource.cGuiWindowLinebox,matrix:n}),this.drawRect(53,313,602,80),this.endFill();else if(600==s||312==s)this.beginTextureFill({texture:i.Resource.cGuiWindowMid600}),this.drawRect(24,0,s-48,u),this.endFill(),this.beginTextureFill({texture:i.Resource.cGuiWindowRight600}),this.drawRect(s-24,0,24,u),this.endFill(),this.beginTextureFill({texture:i.Resource.cGuiWindowLeft600}),this.drawRect(0,0,24,u),this.endFill(),d&&312==s&&((n=new e.Matrix).translate(12,287),this.beginTextureFill({texture:i.Resource.cGuiWindowLine,matrix:n}),this.drawRect(12,275,274,6),this.endFill());else{var o,l,h;120==s?(o=i.Resource.cGuiWindowTop120,l=i.Resource.cGuiWindowMid120,h=i.Resource.cGuiWindowBottom120):154==s?(o=i.Resource.cGuiWindowTop154,l=i.Resource.cGuiWindowMid154,h=i.Resource.cGuiWindowBottom154):200==s?(o=i.Resource.cGuiWindowTop200,l=i.Resource.cGuiWindowMid200,h=i.Resource.cGuiWindowBottom200):248==s?(o=i.Resource.cGuiWindowTop248,l=i.Resource.cGuiWindowMid248,h=i.Resource.cGuiWindowBottom248):(o=i.Resource.cGuiWindowTop547,l=i.Resource.cGuiWindowMid547,h=i.Resource.cGuiWindowBottom547),this.beginTextureFill({texture:l}),this.drawRect(-1,15,s+10,u-30),this.endFill(),this.beginTextureFill({texture:o}),this.drawRect(-1,0,s+10,15),this.endFill(),(n=new e.Matrix).translate(0,u-15),this.beginTextureFill({texture:h,matrix:n}),this.drawRect(-1,u-15,s+10,24),this.endFill()}this.fader=new e.Graphics,this.fader.beginFill(0,1),this.fader.lineStyle(0,0,1),this.fader.moveTo(0,0),this.fader.lineTo(s-1,0),this.fader.lineTo(s-1,u-1),this.fader.lineTo(0,u-1),this.fader.lineTo(0,0),this.fader.endFill(),this.fader.visible=!1,this.fader.interactive=!0,this.fader.buttonMode=!0,this.addChild(this.fader)}MouseOver(e,i){return this.visible&&e>=this.x&&e<this.x+this.width&&i>=this.y&&i<this.y+this.height}ShowFader(){this.fader.visible=!0}HideFader(){this.fader.visible=!1}}exports.GuiWindow=t;
},{"pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR"}],"YujO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MainEditPanel=void 0;const t=require("pixi.js"),e=require("../Game/Globals/ControllerGameGlobals"),i=require("../Game/Graphics/Resource"),o=require("../General/Util"),n=require("../Main"),l=require("./GuiButton"),s=require("./GuiWindow");class u extends s.GuiWindow{constructor(i){super(0,5,800,95),this.cont=i,this.m_editPanel=new t.Container,this.addChild(this.m_editPanel),this.m_gamePanel=new t.Container,this.m_gamePanel.visible=!1,this.addChild(this.m_gamePanel),this.m_pausePanel=new t.Container,this.m_pausePanel.visible=!1,this.addChild(this.m_pausePanel);var o=new t.TextStyle;o.fontFamily=n.Main.GLOBAL_FONT,n.Main.inIFrame||(this.m_circleButton=new l.GuiButton("Circle",10,15,105,35,()=>this.cont.circleButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_circleButton),this.m_rectButton=new l.GuiButton("Rectangle",110,15,105,35,()=>this.cont.rectButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_rectButton),this.m_triangleButton=new l.GuiButton("Triangle",210,15,105,35,()=>this.cont.triangleButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_triangleButton),this.m_fixedJointButton=new l.GuiButton("Fixed Joint",10,45,105,35,()=>this.cont.fjButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_fixedJointButton),this.m_revoluteJointButton=new l.GuiButton("Rotating Joint",110,45,105,35,()=>this.cont.rjButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_revoluteJointButton),this.m_prismaticJointButton=new l.GuiButton("Sliding Joint",210,45,105,35,()=>this.cont.pjButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_prismaticJointButton),this.m_textButton=new l.GuiButton("Text",310,45,60,35,()=>this.cont.textButton(),l.GuiButton.BLUE),this.m_editPanel.addChild(this.m_textButton),this.m_pasteButton=new l.GuiButton("Paste",370,45,60,35,()=>this.cont.pasteButton(),l.GuiButton.ORANGE),this.m_editPanel.addChild(this.m_pasteButton),this.m_undoButton=new l.GuiButton("Undo",310,15,60,35,()=>this.cont.undoButton(),l.GuiButton.ORANGE),this.m_editPanel.addChild(this.m_undoButton),this.m_redoButton=new l.GuiButton("Redo",370,15,60,35,()=>this.cont.redoButton(),l.GuiButton.ORANGE),this.m_editPanel.addChild(this.m_redoButton)),this.m_zoomInButton=new l.GuiButton("Zoom In",430,15,80,35,()=>this.cont.zoomInButton(),l.GuiButton.PINK),this.m_editPanel.addChild(this.m_zoomInButton),this.m_zoomInButton=new l.GuiButton("Zoom In",430,15,80,35,()=>this.cont.zoomInButton(),l.GuiButton.PINK),this.m_gamePanel.addChild(this.m_zoomInButton),this.m_zoomInButton=new l.GuiButton("Zoom In",430,15,80,35,()=>this.cont.zoomInButton(),l.GuiButton.PINK),this.m_pausePanel.addChild(this.m_zoomInButton),this.m_zoomOutButton=new l.GuiButton("Zoom Out",430,45,80,35,()=>this.cont.zoomOutButton(),l.GuiButton.PINK),this.m_editPanel.addChild(this.m_zoomOutButton),this.m_zoomOutButton=new l.GuiButton("Zoom Out",430,45,80,35,()=>this.cont.zoomOutButton(),l.GuiButton.PINK),this.m_gamePanel.addChild(this.m_zoomOutButton),this.m_zoomOutButton=new l.GuiButton("Zoom Out",430,45,80,35,()=>this.cont.zoomOutButton(),l.GuiButton.PINK),this.m_pausePanel.addChild(this.m_zoomOutButton),this.m_conditionsButton=new l.GuiButton("Set Conditions",520,45,95,35,()=>this.cont.conditionsButton(),l.GuiButton.BLUE),this.m_buildBoxButton=new l.GuiButton("Build Box",610,45,85,35,()=>this.cont.buildBoxButton(),l.GuiButton.BLUE),this.m_restrictionsButton=new l.GuiButton("Restrictions",695,15,95,30,()=>this.cont.restrictionsButton(),l.GuiButton.BLUE),this.m_conditionsButton.visible=!1,this.m_restrictionsButton.visible=!1,this.m_buildBoxButton.visible=!1,this.m_loadButton=new l.GuiButton("Load...",520,45,95,35,()=>this.cont.loadButton(),l.GuiButton.PURPLE),this.m_loginButton=new l.GuiButton("Login",610,45,85,35,()=>this.cont.loginButton(),l.GuiButton.PURPLE),this.m_loginButton.visible="_Public"==e.ControllerGameGlobals.userName,this.m_logoutButton=new l.GuiButton("Logout",610,45,85,35,()=>this.cont.logoutButton(),l.GuiButton.PURPLE),this.m_logoutButton.visible="_Public"!=e.ControllerGameGlobals.userName,this.m_editPanel.addChild(this.m_loadButton),this.m_editPanel.addChild(this.m_loginButton),this.m_editPanel.addChild(this.m_logoutButton),this.m_editPanel.addChild(this.m_conditionsButton),this.m_editPanel.addChild(this.m_buildBoxButton),this.m_editPanel.addChild(this.m_restrictionsButton),this.m_saveButton=new l.GuiButton("Save...",520,15,95,35,()=>this.cont.saveButton(),l.GuiButton.PURPLE),this.m_editPanel.addChild(this.m_saveButton),this.m_newButton=new l.GuiButton("Main Menu",610,15,85,35,()=>this.cont.newButton(),l.GuiButton.PURPLE),this.m_editPanel.addChild(this.m_newButton),(o=new t.TextStyle).fontFamily=n.Main.GLOBAL_FONT,o.fontSize=15,this.m_playButton=new l.GuiButton("Resume",610,45,75,35,()=>this.cont.playButton(),l.GuiButton.RED),this.m_pausePanel.addChild(this.m_playButton),this.m_playButton=new l.GuiButton("Play!",700,35,85,45,()=>this.cont.playButton(),l.GuiButton.PLAY,o),this.m_editPanel.addChild(this.m_playButton),this.m_testButton=new l.GuiButton("    Test\nChallenge",700,35,85,45,()=>this.cont.playButton(),l.GuiButton.PLAY),this.m_testButton.visible=!1,this.m_editPanel.addChild(this.m_testButton),this.m_editButton=new l.GuiButton("Edit Challenge",695,15,95,30,()=>this.cont.editButton(),l.GuiButton.RED),this.m_editButton.visible=!1,this.m_editPanel.addChild(this.m_editButton),this.m_pauseButton=new l.GuiButton("Pause",610,45,75,35,()=>this.cont.pauseButton(),l.GuiButton.RED),this.m_gamePanel.addChild(this.m_pauseButton),this.m_resetButton=new l.GuiButton("Stop",700,35,85,45,()=>e.ControllerGameGlobals.playingReplay?this.cont.rewindButton():this.cont.resetButton(),l.GuiButton.PLAY,o),this.m_gamePanel.addChild(this.m_resetButton),this.m_resetButton2=new l.GuiButton("Stop",700,35,85,45,()=>e.ControllerGameGlobals.playingReplay?this.cont.rewindButton():this.cont.resetButton(),l.GuiButton.PLAY,o),this.m_pausePanel.addChild(this.m_resetButton2),this.m_rewindButton=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Rewind":"Restart",535,45,75,35,()=>e.ControllerGameGlobals.playingReplay?this.cont.resetButton():this.cont.rewindButton(),l.GuiButton.RED),this.m_gamePanel.addChild(this.m_rewindButton),this.m_rewindButton2=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Rewind":"Restart",535,45,75,35,()=>e.ControllerGameGlobals.playingReplay?this.cont.resetButton():this.cont.rewindButton(),l.GuiButton.RED),this.m_pausePanel.addChild(this.m_rewindButton2),e.ControllerGameGlobals.playingReplay||(this.m_saveReplayButton=new l.GuiButton("Save Replay",550,15,120,35,()=>this.cont.saveReplayButton(),l.GuiButton.PURPLE),this.m_gamePanel.addChild(this.m_saveReplayButton),this.m_saveReplayButton2=new l.GuiButton("Save Replay",550,15,120,35,()=>this.cont.saveReplayButton(),l.GuiButton.PURPLE),this.m_pausePanel.addChild(this.m_saveReplayButton2)),(o=new t.TextStyle).fontFamily=n.Main.GLOBAL_FONT,o.fontSize=12,o.fill="#242930",this.m_header=new t.Text(e.ControllerGameGlobals.playingReplay?"    Replay in Progress":"Simulation in Progress"),this.m_header.x=300,this.m_header.y=25,this.m_header.style=o,this.m_gamePanel.addChild(this.m_header),this.m_header=new t.Text(e.ControllerGameGlobals.playingReplay?"    Replay Paused":"Simulation Paused"),this.m_header.x=310,this.m_header.y=25,this.m_header.style=o,this.m_pausePanel.addChild(this.m_header),this.m_featureButton=new l.GuiButton("Feature!",85,15,90,35,()=>this.cont.featureButton(),l.GuiButton.PURPLE),this.m_featureButton.visible=!1,this.m_gamePanel.addChild(this.m_featureButton),this.m_featureButton2=new l.GuiButton("Feature!",85,15,90,35,()=>this.cont.featureButton(),l.GuiButton.PURPLE),this.m_featureButton2.visible=!1,this.m_pausePanel.addChild(this.m_featureButton2),this.ShowFeatureButton(),this.m_rateButton=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Rate this Replay!":"Rate this Robot!",165,15,140,35,()=>this.rateButton(),l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_rateButton),this.m_rateButton2=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Rate this Replay!":"Rate this Robot!",165,15,140,35,()=>this.rateButton(),l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_rateButton2),this.m_rateButton3=new l.GuiButton("Rate this Challenge!",165,15,140,35,()=>this.rateButton(),l.GuiButton.ORANGE),this.m_rateButton3.visible=!1,this.m_gamePanel.addChild(this.m_rateButton3),this.m_rateButton4=new l.GuiButton("Rate this Challenge!",165,15,140,35,()=>this.rateButton(),l.GuiButton.ORANGE),this.m_rateButton4.visible=!1,this.m_pausePanel.addChild(this.m_rateButton4),this.m_commentButton=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Comment on this Replay":"Comment on this Robot",15,45,160,35,()=>this.commentButton(),l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_commentButton),this.m_commentButton2=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Comment on this Replay":"Comment on this Robot",15,45,160,35,()=>this.commentButton(),l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_commentButton2),this.m_commentButton3=new l.GuiButton("Comment on this Challenge",15,45,160,35,()=>this.commentButton(),l.GuiButton.ORANGE),this.m_commentButton3.visible=!1,this.m_gamePanel.addChild(this.m_commentButton3),this.m_commentButton4=new l.GuiButton("Comment on this Challenge",15,45,160,35,()=>this.commentButton(),l.GuiButton.ORANGE),this.m_commentButton4.visible=!1,this.m_pausePanel.addChild(this.m_commentButton4),this.m_linkButton=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Link to this Replay":"Link to this Robot",165,45,140,35,()=>this.linkButton(),l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_linkButton),this.m_linkButton2=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Link to this Replay":"Link to this Robot",165,45,140,35,()=>this.linkButton(),l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_linkButton2),this.m_linkButton3=new l.GuiButton("Link to this Challenge",165,45,140,35,()=>this.linkButton(),l.GuiButton.ORANGE),this.m_linkButton3.visible=!1,this.m_gamePanel.addChild(this.m_linkButton3),this.m_linkButton4=new l.GuiButton("Link to this Challenge",165,45,140,35,()=>this.linkButton(),l.GuiButton.ORANGE),this.m_linkButton4.visible=!1,this.m_pausePanel.addChild(this.m_linkButton4),this.m_embedButton=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Embed this Replay":"Embed this Robot",295,45,140,35,()=>this.embedButton(),l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_embedButton),this.m_embedButton2=new l.GuiButton(e.ControllerGameGlobals.playingReplay?"Embed this Replay":"Embed this Robot",295,45,140,35,()=>this.embedButton(),l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_embedButton2),this.m_embedButton3=new l.GuiButton("Embed this Challenge",295,45,140,35,()=>this.embedButton(),l.GuiButton.ORANGE),this.m_embedButton3.visible=!1,this.m_gamePanel.addChild(this.m_embedButton3),this.m_embedButton4=new l.GuiButton("Embed this Challenge",295,45,140,35,()=>this.embedButton(),l.GuiButton.ORANGE),this.m_embedButton4.visible=!1,this.m_pausePanel.addChild(this.m_embedButton4);const s=this.cont.constructor.name;["ControllerTutorial","ControllerHomeMovies","ControllerRubeGoldberg","ControllerNewFeatures","ControllerChallengeEditor"].includes(s)&&(this.m_tutorialButton=new l.GuiButton("View Previous Tip",660,90,140,40,()=>this.cont.tutorialButton(),l.GuiButton.PURPLE),this.m_editPanel.addChild(this.m_tutorialButton)),(o=new t.TextStyle).fontFamily=n.Main.GLOBAL_FONT,o.fontSize=24,o.fill="#242930",this.m_timer1=new t.Text(""),this.m_timer1.text="0:00",this.m_timer1.x=30,this.m_timer1.y=22,this.m_timer1.style=o,this.m_gamePanel.addChild(this.m_timer1),this.m_timer2=new t.Text(""),this.m_timer2.text="0:00",this.m_timer2.x=30,this.m_timer2.y=22,this.m_timer2.style=o,this.m_pausePanel.addChild(this.m_timer2)}Update(t){n.Main.inIFrame||(t==e.ControllerGameGlobals.NEW_CIRCLE?this.m_circleButton.SetState(!0):this.m_circleButton.depressed&&this.m_circleButton.SetState(!1),t==e.ControllerGameGlobals.NEW_RECT?this.m_rectButton.SetState(!0):this.m_rectButton.depressed&&this.m_rectButton.SetState(!1),t==e.ControllerGameGlobals.NEW_TRIANGLE?this.m_triangleButton.SetState(!0):this.m_triangleButton.depressed&&this.m_triangleButton.SetState(!1),t==e.ControllerGameGlobals.NEW_FIXED_JOINT?this.m_fixedJointButton.SetState(!0):this.m_fixedJointButton.depressed&&this.m_fixedJointButton.SetState(!1),t==e.ControllerGameGlobals.NEW_REVOLUTE_JOINT?this.m_revoluteJointButton.SetState(!0):this.m_revoluteJointButton.depressed&&this.m_revoluteJointButton.SetState(!1),t==e.ControllerGameGlobals.NEW_PRISMATIC_JOINT?this.m_prismaticJointButton.SetState(!0):this.m_prismaticJointButton.depressed&&this.m_prismaticJointButton.SetState(!1),t==e.ControllerGameGlobals.NEW_TEXT?this.m_textButton.SetState(!0):this.m_textButton.depressed&&this.m_textButton.SetState(!1)),e.ControllerGameGlobals.playingReplay?(this.m_featureButton.label=e.ControllerGameGlobals.curReplayFeatured?"Un-feature!":"Feature!",this.m_featureButton2.label=e.ControllerGameGlobals.curReplayFeatured?"Un-feature!":"Feature!"):""!=e.ControllerGameGlobals.curChallengeID?(this.m_featureButton.label=e.ControllerGameGlobals.curChallengeFeatured?"Un-feature!":"Feature!",this.m_featureButton2.label=e.ControllerGameGlobals.curChallengeFeatured?"Un-feature!":"Feature!"):(this.m_featureButton.label=e.ControllerGameGlobals.curRobotFeatured?"Un-feature!":"Feature!",this.m_featureButton2.label=e.ControllerGameGlobals.curRobotFeatured?"Un-feature!":"Feature!")}rateButton(){e.ControllerGameGlobals.playingReplay&&""!=e.ControllerGameGlobals.curReplayID&&e.ControllerGameGlobals.curReplayPublic?this.cont.rateReplayButton():""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?this.cont.rateChallengeButton():this.cont.rateButton()}commentButton(){e.ControllerGameGlobals.playingReplay&&""!=e.ControllerGameGlobals.curReplayID&&e.ControllerGameGlobals.curReplayPublic?this.cont.commentReplayButton():""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?this.cont.commentChallengeButton():this.cont.commentButton()}linkButton(){e.ControllerGameGlobals.playingReplay&&""!=e.ControllerGameGlobals.curReplayID&&e.ControllerGameGlobals.curReplayPublic?this.cont.linkReplayButton():""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?this.cont.linkChallengeButton():this.cont.linkButton()}embedButton(){e.ControllerGameGlobals.playingReplay&&""!=e.ControllerGameGlobals.curReplayID&&e.ControllerGameGlobals.curReplayPublic?this.cont.embedReplayButton():""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?this.cont.embedChallengeButton():this.cont.embedButton()}ShowLogin(){this.m_loginButton.visible=!0,this.m_logoutButton.visible=!1}ShowLogout(){this.m_loginButton.visible=!1,this.m_logoutButton.visible=!0}ShowEditButton(){this.m_playButton.visible=!0,this.m_testButton.visible=!1,this.m_loadButton.visible=!0,this.m_loginButton.visible="_Public"==e.ControllerGameGlobals.userName,this.m_logoutButton.visible="_Public"!=e.ControllerGameGlobals.userName,this.m_conditionsButton.visible=!1,this.m_buildBoxButton.visible=!1,this.m_restrictionsButton.visible=!1,this.m_editButton.visible=!ControllerChallenge.playOnlyMode}HideEditButton(){this.m_playButton.visible=!1,this.m_testButton.visible=!0,this.m_loadButton.visible=!1,this.m_loginButton.visible=!1,this.m_logoutButton.visible=!1,this.m_conditionsButton.visible=!0,this.m_buildBoxButton.visible=!0,this.m_restrictionsButton.visible=!0,this.m_editButton.visible=!1}SetTimer(e){if(e>=108e3)this.m_timer1.text="59:59",this.m_timer2.text="59:59";else{var i=Math.floor(e/1800);e%=1800;var o=Math.floor(e/30);o<10?(this.m_timer1.text=i+":0"+o,this.m_timer2.text=i+":0"+o):(this.m_timer1.text=i+":"+o,this.m_timer2.text=i+":"+o)}var l=new t.TextStyle;l.fontFamily=n.Main.GLOBAL_FONT,l.fontSize=24,this.m_timer1.style=l,this.m_timer2.style=l}ShowEditPanel(e=!1){if(this.m_editPanel.visible=!0,this.m_gamePanel.visible=!1,this.m_pausePanel.visible=!1,e){this.m_gamePanel.removeChild(this.m_resetButton),this.m_pausePanel.removeChild(this.m_resetButton2),this.m_gamePanel.removeChild(this.m_rewindButton),this.m_pausePanel.removeChild(this.m_rewindButton2),this.m_gamePanel.removeChild(this.m_commentButton),this.m_pausePanel.removeChild(this.m_commentButton2),this.m_gamePanel.removeChild(this.m_linkButton),this.m_pausePanel.removeChild(this.m_linkButton2),this.m_gamePanel.removeChild(this.m_embedButton),this.m_pausePanel.removeChild(this.m_embedButton2);var i=new t.TextStyle;i.fontFamily=n.Main.GLOBAL_FONT,i.fontSize=15,this.m_resetButton=new l.GuiButton("Stop",700,35,85,45,this.cont.resetButton,l.GuiButton.PLAY,i),this.m_gamePanel.addChild(this.m_resetButton),this.m_resetButton2=new l.GuiButton("Stop",700,35,85,45,this.cont.resetButton,l.GuiButton.PLAY,i),this.m_pausePanel.addChild(this.m_resetButton2),this.m_rewindButton=new l.GuiButton("Restart",535,45,75,35,this.cont.rewindButton,l.GuiButton.RED),this.m_gamePanel.addChild(this.m_rewindButton),this.m_rewindButton2=new l.GuiButton("Restart",535,45,75,35,this.cont.rewindButton,l.GuiButton.RED),this.m_pausePanel.addChild(this.m_rewindButton2),this.m_saveReplayButton=new l.GuiButton("Save Replay",558,15,120,35,this.cont.saveReplayButton,l.GuiButton.PURPLE),this.m_gamePanel.addChild(this.m_saveReplayButton),this.m_saveReplayButton2=new l.GuiButton("Save Replay",558,15,120,35,this.cont.saveReplayButton,l.GuiButton.PURPLE),this.m_pausePanel.addChild(this.m_saveReplayButton2),this.m_commentButton=new l.GuiButton("Comment on this Robot",15,45,160,35,this.commentButton,l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_commentButton),this.m_commentButton2=new l.GuiButton("Comment on this Robot",15,45,160,35,this.commentButton,l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_commentButton2),this.m_linkButton=new l.GuiButton("Link to this Robot",165,45,140,35,this.linkButton,l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_linkButton),this.m_linkButton2=new l.GuiButton("Link to this Robot",165,45,140,35,this.linkButton,l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_linkButton2),this.m_embedButton=new l.GuiButton("Embed this Robot",295,45,140,35,this.embedButton,l.GuiButton.ORANGE),this.m_gamePanel.addChild(this.m_embedButton),this.m_embedButton2=new l.GuiButton("Embed this Robot",295,45,140,35,this.embedButton,l.GuiButton.ORANGE),this.m_pausePanel.addChild(this.m_embedButton2)}}ShowGamePanel(){this.m_editPanel.visible=!1,this.m_gamePanel.visible=!0,this.m_pausePanel.visible=!1,this.ShowFeatureButton(),e.ControllerGameGlobals.playingReplay&&""!=e.ControllerGameGlobals.curReplayID&&e.ControllerGameGlobals.curReplayPublic?(this.m_rateButton.visible=!0,this.m_rateButton3.visible=!1,this.m_commentButton.visible=!0,this.m_commentButton3.visible=!1,this.m_linkButton.visible=!0,this.m_linkButton3.visible=!1,this.m_embedButton.visible=!0,this.m_embedButton3.visible=!1):""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?(this.m_rateButton.visible=!1,this.m_rateButton3.visible=!0,this.m_commentButton.visible=!1,this.m_commentButton3.visible=!0,this.m_linkButton.visible=!1,this.m_linkButton3.visible=!0,this.m_embedButton.visible=!1,this.m_embedButton3.visible=!0):(this.m_rateButton.visible=!0,this.m_rateButton3.visible=!1,this.m_commentButton.visible=!0,this.m_commentButton3.visible=!1,this.m_linkButton.visible=!0,this.m_linkButton3.visible=!1,this.m_embedButton.visible=!0,this.m_embedButton3.visible=!1)}ShowPausePanel(t){this.m_editPanel.visible=!1,this.m_gamePanel.visible=!1,this.m_pausePanel.visible=!0,this.ShowFeatureButton(),this.m_saveReplayButton&&(this.m_saveReplayButton.visible=t),e.ControllerGameGlobals.playingReplay&&""!=e.ControllerGameGlobals.curReplayID&&e.ControllerGameGlobals.curReplayPublic?(this.m_rateButton2.visible=!0,this.m_rateButton4.visible=!1,this.m_commentButton2.visible=!0,this.m_commentButton4.visible=!1,this.m_linkButton2.visible=!0,this.m_linkButton4.visible=!1,this.m_embedButton2.visible=!0,this.m_embedButton4.visible=!1):""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?(this.m_rateButton2.visible=!1,this.m_rateButton4.visible=!0,this.m_commentButton2.visible=!1,this.m_commentButton4.visible=!0,this.m_linkButton2.visible=!1,this.m_linkButton4.visible=!0,this.m_embedButton2.visible=!1,this.m_embedButton4.visible=!0):(this.m_rateButton2.visible=!0,this.m_rateButton4.visible=!1,this.m_commentButton2.visible=!0,this.m_commentButton4.visible=!1,this.m_linkButton2.visible=!0,this.m_linkButton4.visible=!1,this.m_embedButton2.visible=!0,this.m_embedButton4.visible=!1)}ShowFeatureButton(){this.m_featureButton.visible=o.Util.ObjectInArray(e.ControllerGameGlobals.userName,e.ControllerGameGlobals.ADMIN_USERS),this.m_featureButton2.visible=o.Util.ObjectInArray(e.ControllerGameGlobals.userName,e.ControllerGameGlobals.ADMIN_USERS)}static scrollbarField(){var t=new i.Resource.cGuiScrollbarField;return t.smoothing=!0,t}static scrollbarBase(){var t=new i.Resource.cGuiScrollbarBase;return t.smoothing=!0,t}static scrollbarRoll(){var t=new i.Resource.cGuiScrollbarRoll;return t.smoothing=!0,t}static scrollbarClick(){var t=new i.Resource.cGuiScrollbarClick;return t.smoothing=!0,t}static scrollbarTallBase(){var t=new i.Resource.cGuiScrollbarTallBase;return t.smoothing=!0,t}static scrollbarTallRoll(){var t=new i.Resource.cGuiScrollbarTallRoll;return t.smoothing=!0,t}static scrollbarTallClick(){var t=new i.Resource.cGuiScrollbarTallClick;return t.smoothing=!0,t}static scrollbarButtonUpBase(){var t=new i.Resource.cGuiScrollbarButtonUpBase;return t.smoothing=!0,t}static scrollbarButtonUpRoll(){var t=new i.Resource.cGuiScrollbarButtonUpRoll;return t.smoothing=!0,t}static scrollbarButtonUpClick(){var t=new i.Resource.cGuiScrollbarButtonUpClick;return t.smoothing=!0,t}static scrollbarButtonDownBase(){var t=new i.Resource.cGuiScrollbarButtonDownBase;return t.smoothing=!0,t}static scrollbarButtonDownRoll(){var t=new i.Resource.cGuiScrollbarButtonDownRoll;return t.smoothing=!0,t}static scrollbarButtonDownClick(){var t=new i.Resource.cGuiScrollbarButtonDownClick;return t.smoothing=!0,t}}exports.MainEditPanel=u;
},{"pixi.js":"aQiP","../Game/Globals/ControllerGameGlobals":"K8aL","../Game/Graphics/Resource":"VWUR","../General/Util":"Zvyo","../Main":"aM6Q","./GuiButton":"IBBZ","./GuiWindow":"BOXT"}],"d4c4":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DropDownMenuItem=void 0;const e=require("pixi.js"),i=require("../Game/Graphics/Resource"),h=require("../General/Input"),s=require("../Main");class t extends e.Graphics{constructor(h,t,c,o,l=!1,x=!1){super(),this.m_checkBoxBase=new e.Sprite,this.m_checkBoxRoll=new e.Sprite,this.m_checkBoxClick=new e.Sprite;var B=new e.TextStyle;B.fontFamily=s.Main.GLOBAL_FONT,B.fontSize=12,B.fill="#242930",this.interactive=!0,this.m_width=c,this.m_Text=new e.Text((l?"  ":"")+t),this.m_Text.x=10,this.m_Text.y=3,this.m_Text.style=B,this.addChild(this.m_Text),this.on("mouseup",()=>o()),this.on("mouseup",()=>h.HideAll()),this.on("mouseover",()=>this.highlight()),this.on("mouseout",()=>this.deHighlight()),l&&(x?(this.m_checkBoxBase.texture=i.Resource.cGuiMenuCheckBoxBBase,this.addChild(this.m_checkBoxBase),this.m_checkBoxRoll.texture=i.Resource.cGuiMenuCheckBoxBRoll,this.m_checkBoxRoll.visible=!1,this.addChild(this.m_checkBoxRoll),this.m_checkBoxClick.texture=i.Resource.cGuiMenuCheckBoxBClick,this.m_checkBoxClick.visible=!1,this.addChild(this.m_checkBoxClick)):(this.m_checkBoxBase.texture=i.Resource.cGuiMenuCheckBoxABase,this.addChild(this.m_checkBoxBase),this.m_checkBoxRoll.texture=i.Resource.cGuiMenuCheckBoxARoll,this.m_checkBoxRoll.visible=!1,this.addChild(this.m_checkBoxRoll),this.m_checkBoxClick.texture=i.Resource.cGuiMenuCheckBoxAClick,this.m_checkBoxClick.visible=!1,this.addChild(this.m_checkBoxClick)),this.m_checkBoxBase.x=3,this.m_checkBoxRoll.x=3,this.m_checkBoxClick.x=3,this.on("mousedown",()=>this.click()))}highlight(){this.beginFill(16692612,1),this.lineStyle(0,16692612),this.drawRect(1,1,this.m_width-2,18),this.m_checkBoxBase&&(this.m_checkBoxBase.visible=!1,this.m_checkBoxRoll.visible=!h.Input.mouseDown,this.m_checkBoxClick.visible=h.Input.mouseDown)}deHighlight(){this.beginFill(16644586,1),this.lineStyle(0,16644586),this.drawRect(1,1,this.m_width-2,18),this.m_checkBoxBase&&(this.m_checkBoxBase.visible=!0,this.m_checkBoxRoll.visible=!1,this.m_checkBoxClick.visible=!1)}click(){this.m_checkBoxBase.visible=!1,this.m_checkBoxRoll.visible=!1,this.m_checkBoxClick.visible=!0}}exports.DropDownMenuItem=t;
},{"pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../General/Input":"xLqP","../Main":"aM6Q"}],"qU8f":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DropDownMenu=void 0;const t=require("pixi.js"),e=require("../Game/Globals/ControllerGameGlobals"),n=require("../Game/Graphics/Resource"),i=require("../Main"),s=require("./DropDownMenuItem");class u extends t.Graphics{constructor(e,n,i){super();const s=i;this.interactive=!0,this.text=new t.Text(e),this.text.anchor.set(.5),this.text.x=n+s/2,this.text.y=10.5,this.addChild(this.text),this.beginFill(16777215,.01),this.drawRect(n,0,s,21),this.endFill()}set style(t){this.text.style=t}get style(){return this.text.style}}class h extends t.Graphics{constructor(e){super(),this.mouseDown=!1,this.cont=e,this.m_currentMenu=null,this.interactive=!0,this.menuBitmap=n.Resource.cGuiMenuBar,this.menuBitmapRoll=n.Resource.cGuiMenuBarRoll,this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(0,0,800,21);const s=new t.TextStyle;s.fontFamily=i.Main.GLOBAL_FONT,s.align="center",s.fill="#E1E1EA",s.fontSize=12,s.dropShadow=!0,s.dropShadowColor="#343550",s.dropShadowDistance=1,this.fileText=new u("File",0,40),this.fileText.interactive=!0,this.fileText.style=s,this.fileText.on("mousedown",t=>this.file(t)),this.fileText.on("mouseover",t=>this.maybeFile(t)),this.fileText.on("mouseout",t=>this.noFile(t)),this.addChild(this.fileText),this.editText=new u("Edit",40,40),this.editText.interactive=!0,this.editText.style=s,this.editText.on("mousedown",t=>this.edit(t)),this.editText.on("mouseover",t=>this.maybeEdit(t)),this.editText.on("mouseout",t=>this.noEdit(t)),this.addChild(this.editText),this.viewText=new u("View",80,40),this.viewText.interactive=!0,this.viewText.style=s,this.viewText.on("mousedown",t=>this.view(t)),this.viewText.on("mouseover",t=>this.maybeView(t)),this.viewText.on("mouseout",t=>this.noView(t)),this.addChild(this.viewText),this.commentText=new u("Share!",120,60),this.commentText.interactive=!0,this.commentText.style=s,this.commentText.on("mousedown",t=>this.comment(t)),this.commentText.on("mouseover",t=>this.maybeComment(t)),this.commentText.on("mouseout",t=>this.noComment(t)),this.addChild(this.commentText),this.helpText=new u("Help",180,45),this.helpText.interactive=!0,this.helpText.style=s,this.helpText.on("mousedown",t=>this.help(t)),this.helpText.on("mouseover",t=>this.maybeHelp(t)),this.helpText.on("mouseout",t=>this.noHelp(t)),this.addChild(this.helpText),this.aboutText=new u("About",750,50),this.aboutText.interactive=!0,this.aboutText.style=s,this.aboutText.on("mousedown",t=>this.about(t)),this.aboutText.on("mouseover",t=>this.maybeAbout(t)),this.aboutText.on("mouseout",t=>this.noAbout(t)),this.addChild(this.aboutText),this.extrasText=new u("Extras",225,50),this.extrasText.interactive=!0,this.extrasText.style=s,this.extrasText.on("mousedown",t=>this.extras(t)),this.extrasText.on("mouseover",t=>this.maybeExtras(t)),this.extrasText.on("mouseout",t=>this.noExtras(t)),this.addChild(this.extrasText)}Update(){}MouseClick(t,e,n){!(n>20)||this.m_currentMenu&&this.MouseOverMenu(e,n)||this.HideAll()}BuildFileMenu(){this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=0,this.m_currentMenu.y=20,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,155,200);var e=new s.DropDownMenuItem(this,"Main Menu",155,()=>this.cont.newButton());e.y=0,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Save...",155,()=>this.cont.saveButton())).y=20,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Load Robot",155,()=>this.cont.loadRobotButton())).y=40,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Load And Insert",155,()=>this.cont.loadAndInsertButton())).y=60,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Load Replay",155,()=>this.cont.loadReplayButton())).y=80,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Load Challenge",155,()=>this.cont.loadChallengeButton())).y=100,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Log In",155,()=>this.cont.loginButton())).y=120,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"View High Scores",155,()=>this.cont.highScoresButton())).y=140,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Report As Inappropriate",155,()=>this.cont.reportButton())).y=160,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,i.Main.enableSound?"Disable Sound":"Enable Sound",155,()=>this.soundButton())).y=180,this.m_currentMenu.addChild(e),this.addChild(this.m_currentMenu)}BuildEditMenu(){this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=40,this.m_currentMenu.y=20,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,120,200);var e=new s.DropDownMenuItem(this,"Change Settings",120,()=>this.cont.sandboxSettingsButton());e.y=0,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Clear All",120,()=>this.cont.clearButton())).y=20,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Undo",120,()=>this.cont.undoButton())).y=40,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Redo",120,()=>this.cont.redoButton())).y=60,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Cut",120,()=>this.cont.cutButton())).y=80,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Copy",120,()=>this.cont.copyButton())).y=100,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Paste",120,()=>this.pasteButton())).y=120,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Delete",120,()=>this.cont.deleteButton())).y=140,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Move to Front",120,()=>this.cont.frontButton())).y=160,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Move to Back",120,()=>this.cont.backButton())).y=180,this.m_currentMenu.addChild(e),this.addChild(this.m_currentMenu)}BuildViewMenu(){this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=80,this.m_currentMenu.y=21,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,140,140);var n=new s.DropDownMenuItem(this,"Zoom In",140,()=>this.cont.zoomInButton());n.y=0,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Zoom Out",140,()=>this.cont.zoomOutButton())).y=20,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Snap to Center",140,()=>this.cont.centerBox(),!0,e.ControllerGameGlobals.snapToCenter)).y=40,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Show Joints",140,()=>this.cont.jointBox(),!0,e.ControllerGameGlobals.showJoints)).y=60,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Show Colors",140,()=>this.cont.colourBox(),!0,e.ControllerGameGlobals.showColours)).y=80,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Show Outlines",140,()=>this.cont.globalOutlineBox(),!0,e.ControllerGameGlobals.showOutlines)).y=100,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Center on Selection",140,()=>this.cont.centerOnSelectedBox(),!0,e.ControllerGameGlobals.centerOnSelected)).y=120,this.m_currentMenu.addChild(n),this.addChild(this.m_currentMenu)}BuildCommentMenu(){if(this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=120,this.m_currentMenu.y=21,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,180,60),e.ControllerGameGlobals.playingReplay){var n=new s.DropDownMenuItem(this,"Comment on this Replay",180,()=>this.cont.commentReplayButton());n.y=0,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Link to this Replay",180,()=>this.cont.linkReplayButton())).y=20,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Embed this Replay",180,()=>this.cont.embedReplayButton())).y=40,this.m_currentMenu.addChild(n)}else"ControllerChallenge"===this.cont.constructor.name&&""!=e.ControllerGameGlobals.curChallengeID&&e.ControllerGameGlobals.curChallengePublic?((n=new s.DropDownMenuItem(this,"Comment on this Challenge",180,()=>this.cont.commentChallengeButton())).y=0,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Link to this Challenge",180,()=>this.cont.linkChallengeButton())).y=20,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Embed this Challenge",180,()=>this.cont.embedChallengeButton())).y=40,this.m_currentMenu.addChild(n)):((n=new s.DropDownMenuItem(this,"Comment on this Robot",180,()=>this.cont.commentButton())).y=0,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Link to this Robot",180,()=>this.cont.linkButton())).y=20,this.m_currentMenu.addChild(n),(n=new s.DropDownMenuItem(this,"Embed this Robot",180,()=>this.cont.embedButton())).y=40,this.m_currentMenu.addChild(n));this.addChild(this.m_currentMenu)}BuildHelpMenu(){this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=180,this.m_currentMenu.y=21,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,115,40);var e=new s.DropDownMenuItem(this,"Incredibots Help",115,()=>this.helpButton());e.y=0,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Forums",115,()=>this.forumsButton())).y=20,this.m_currentMenu.addChild(e),this.addChild(this.m_currentMenu)}BuildAboutMenu(){this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=670,this.m_currentMenu.y=21,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,130,40);var e=new s.DropDownMenuItem(this,"Credits",130,()=>this.credits());e.y=0,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"GrubbyGames.com",130,()=>this.grubby())).y=20,this.m_currentMenu.addChild(e),this.addChild(this.m_currentMenu)}BuildExtrasMenu(){this.m_currentMenu&&this.removeChild(this.m_currentMenu),this.m_currentMenu=new t.Graphics,this.m_currentMenu.interactive=!0,this.m_currentMenu.x=225,this.m_currentMenu.y=21,this.m_currentMenu.beginFill(16644586,1),this.m_currentMenu.lineStyle(1,4404847),this.m_currentMenu.moveTo(0,0),this.m_currentMenu.drawRect(0,0,115,"ControllerSandbox"===this.cont.constructor.name?100:60);var e=new s.DropDownMenuItem(this,"Mirror Horizontal",115,()=>this.mirrorHorizontalButton());e.y=0,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Mirror Vertical",115,()=>this.mirrorVerticalButton())).y=20,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Scale",115,()=>this.cont.scaleButton())).y=40,this.m_currentMenu.addChild(e),"ControllerSandbox"===this.cont.constructor.name&&((e=new s.DropDownMenuItem(this,"Thrusters",115,()=>this.cont.thrustersButton())).y=60,this.m_currentMenu.addChild(e),(e=new s.DropDownMenuItem(this,"Cannon",115,()=>this.cont.cannonButton())).y=80,this.m_currentMenu.addChild(e)),this.addChild(this.m_currentMenu)}MouseOverMenu(t,e){return!!this.m_currentMenu&&(this.m_currentMenu&&t>=this.m_currentMenu.x&&t<this.m_currentMenu.x+this.m_currentMenu.width&&e>=this.m_currentMenu.y&&e<this.m_currentMenu.y+this.m_currentMenu.height)}file(t,e=!0){this.mouseDown&&e?(this.noFile(t),this.mouseDown=!1):(this.noEdit(t),this.MakeDummyMenu(),this.noView(t),this.MakeDummyMenu(),this.noComment(t),this.MakeDummyMenu(),this.noHelp(t),this.MakeDummyMenu(),this.noAbout(t),this.MakeDummyMenu(),this.noExtras(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(0,0,40,21),this.BuildFileMenu(),this.mouseDown=!0)}maybeFile(t){this.mouseDown&&this.file(t,!1)}noFile(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.data.global.x,t.data.global.y)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(0,0,40,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}edit(t,e=!0){this.mouseDown&&e?(this.noEdit(t),this.mouseDown=!1):(this.noFile(t),this.MakeDummyMenu(),this.noView(t),this.MakeDummyMenu(),this.noComment(t),this.MakeDummyMenu(),this.noHelp(t),this.MakeDummyMenu(),this.noAbout(t),this.MakeDummyMenu(),this.noExtras(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(40,0,40,21),this.mouseDown=!0,this.BuildEditMenu())}maybeEdit(t){this.mouseDown&&this.edit(t,!1)}noEdit(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.stageX,t.stageY)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(40,0,40,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}view(t,e=!0){this.mouseDown&&e?(this.noView(t),this.mouseDown=!1):(this.noFile(t),this.MakeDummyMenu(),this.noEdit(t),this.MakeDummyMenu(),this.noComment(t),this.MakeDummyMenu(),this.noHelp(t),this.MakeDummyMenu(),this.noAbout(t),this.MakeDummyMenu(),this.noExtras(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(80,0,40,21),this.mouseDown=!0,this.BuildViewMenu())}maybeView(t){this.mouseDown&&this.view(t,!1)}noView(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.stageX,t.stageY)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(80,0,40,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}comment(t,e=!0){this.mouseDown&&e?(this.noComment(t),this.mouseDown=!1):(this.noFile(t),this.MakeDummyMenu(),this.noEdit(t),this.MakeDummyMenu(),this.noView(t),this.MakeDummyMenu(),this.noHelp(t),this.MakeDummyMenu(),this.noAbout(t),this.MakeDummyMenu(),this.noExtras(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(120,0,60,21),this.mouseDown=!0,this.BuildCommentMenu())}maybeComment(t){this.mouseDown&&this.comment(t,!1)}noComment(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.stageX,t.stageY)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(120,0,60,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}help(t,e=!0){this.mouseDown&&e?(this.noHelp(t),this.mouseDown=!1):(this.noFile(t),this.MakeDummyMenu(),this.noEdit(t),this.MakeDummyMenu(),this.noView(t),this.MakeDummyMenu(),this.noComment(t),this.MakeDummyMenu(),this.noAbout(t),this.MakeDummyMenu(),this.noExtras(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(180,0,40,21),this.mouseDown=!0,this.BuildHelpMenu())}maybeHelp(t){this.mouseDown&&this.help(t,!1)}noHelp(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.stageX,t.stageY)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(180,0,40,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}about(t,e=!0){this.mouseDown&&e?(this.noAbout(t),this.mouseDown=!1):(this.noFile(t),this.MakeDummyMenu(),this.noEdit(t),this.MakeDummyMenu(),this.noView(t),this.MakeDummyMenu(),this.noComment(t),this.MakeDummyMenu(),this.noHelp(t),this.MakeDummyMenu(),this.noExtras(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(750,0,50,21),this.mouseDown=!0,this.BuildAboutMenu())}maybeAbout(t){this.mouseDown&&this.about(t,!1)}noAbout(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.stageX,t.stageY)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(750,0,50,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}extras(t,e=!0){this.mouseDown&&e?(this.noExtras(t),this.mouseDown=!1):(this.noFile(t),this.MakeDummyMenu(),this.noEdit(t),this.MakeDummyMenu(),this.noView(t),this.MakeDummyMenu(),this.noComment(t),this.MakeDummyMenu(),this.noHelp(t),this.MakeDummyMenu(),this.noAbout(t),this.beginTextureFill({texture:this.menuBitmapRoll}),this.drawRect(225,0,50,21),this.mouseDown=!0,this.BuildExtrasMenu())}maybeExtras(t){this.mouseDown&&this.extras(t,!1)}noExtras(t){t.target!==this&&t.target!==this.m_currentMenu&&this.m_currentMenu&&!this.MouseOverMenu(t.stageX,t.stageY)&&(this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(225,0,50,21),this.removeChild(this.m_currentMenu),this.m_currentMenu=null)}HideAll(){this.m_currentMenu&&(this.removeChild(this.m_currentMenu),this.m_currentMenu=null,this.beginTextureFill({texture:this.menuBitmap}),this.drawRect(0,0,800,21)),this.mouseDown=!1}MakeDummyMenu(){this.m_currentMenu=new t.Graphics,this.addChild(this.m_currentMenu)}pasteButton(){this.cont.ignoreAClick=!0,this.cont.pasteButton()}mirrorHorizontalButton(){this.cont.ignoreAClick=!0,this.cont.mirrorHorizontal()}mirrorVerticalButton(){this.cont.ignoreAClick=!0,this.cont.mirrorVertical()}soundButton(){i.Main.enableSound=!i.Main.enableSound}credits(){i.Main.BrowserRedirect("http://www.incredifriends.com/",!0)}grubby(){i.Main.BrowserRedirect("http://www.grubbygames.com",!0)}helpButton(){i.Main.BrowserRedirect("http://www.incredifriends.com/",!0)}forumsButton(){i.Main.BrowserRedirect("http://www.incredifriends.com/",!0)}}exports.DropDownMenu=h;
},{"pixi.js":"aQiP","../Game/Globals/ControllerGameGlobals":"K8aL","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q","./DropDownMenuItem":"d4c4"}],"nOXD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiCheckBox=void 0;const e=require("pixi.js"),s=require("../Game/Graphics/Resource"),t=require("../Main");class i extends e.Graphics{constructor(t,i,l){super(),this.enabled=!0,this.focusEnabled=!0,this._selected=!1,this._disabled=!1,this._mouseOver=!1,this._mouseDown=!1,this._style=new e.TextStyle,this._disabledStyle=new e.TextStyle;this.buttonMode=!0,this.interactive=!0,this.x=t,this.y=i,this._icon=new e.Sprite,this._icon.x=5,this._icon.y=0,this._label=new e.Text(""),this._label.anchor.set(0,.5),this._label.x=32,this._label.y=12,this.textures={upIcon:s.Resource.cGuiCheckboxABase,overIcon:s.Resource.cGuiCheckboxARoll,downIcon:s.Resource.cGuiCheckboxAClick,disabledIcon:s.Resource.cGuiCheckboxADisabled,selectedUpIcon:s.Resource.cGuiCheckboxBBase,selectedOverIcon:s.Resource.cGuiCheckboxBRoll,selectedDownIcon:s.Resource.cGuiCheckboxBClick,selectedDisabledIcon:s.Resource.cGuiCheckboxBDisabled},this._icon.texture=this.selected?this.textures.selectedUpIcon:this.textures.upIcon,this.beginFill(16777215,.01),this.drawRect(0,0,l,22),this.endFill(),this.addChild(this._icon),this.addChild(this._label),this.on("click",e=>this.mouseClick(e)),this.on("mouseover",()=>{this._mouseOver=!0,this.updateIcon()}),this.on("mouseout",()=>{this._mouseOver=!1,this.updateIcon()}),this.on("mousedown",()=>{this._mouseDown=!0,this.updateIcon()}),this.on("mouseup",()=>{this._mouseDown=!1,this.updateIcon()})}set label(e){this._label.text=e}get label(){return this._label.text}set style(e){this._style=e,this.disabled||(this._label.style=e)}get style(){return this._style}set disabledStyle(e){this._disabledStyle=e,this.disabled&&(this._label.style=e)}get disabledStyle(){return this._disabledStyle}set selected(e){this._selected=e,this.updateIcon()}get selected(){return this._selected}set disabled(e){this._disabled=e,this._label.style=this._disabled?this._disabledStyle:this._style,this.updateIcon()}get disabled(){return this._disabled}async load(){}mouseClick(e){this.disabled||(this.toggle(),t.Main.enableSound&&i.clickSound.play(),this.emit("change",this.selected))}toggle(){this.selected=!this.selected,this.updateIcon()}updateIcon(){let e="Up";this._mouseOver&&(e="Over"),this._mouseDown&&(e="Down"),this._disabled&&(e="Disabled"),this._icon.texture=this.selected?this.textures[`selected${e}Icon`]:this.textures[`${e.toLowerCase()}Icon`]}}exports.GuiCheckBox=i,i.clickSound=s.Resource.cClick;
},{"pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q"}],"vG6C":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiComboboxItem=void 0;const e=require("pixi.js"),t=require("../Game/Graphics/Resource"),i=require("../Main");class s extends e.Container{constructor(o,r,u,l,h){super(),this.label=new e.Text(""),this.background=new e.Sprite,this._selected=!1,this._text="",this.width=l,this.height=h,this.x=r,this.y=u,this.buttonMode=!0,this.interactive=!0,this.text=o,this.upTexture=t.Resource.cGuiListboxBase,this.overTexture=t.Resource.cGuiListboxRoll,this.downTexture=t.Resource.cGuiListboxClick;const n=new e.TextStyle;n.fontSize=11,n.fill="#573D40",n.fontFamily=i.Main.GLOBAL_FONT,n.align="left",this.background.texture=this.upTexture,this.background.width=l,this.background.height=h,this.addChild(this.background),this.label.style=n,this.label.anchor.set(0,.5),this.label.x=10,this.label.y=h/2,this.addChild(this.label),this.on("click",e=>{i.Main.enableSound&&(s.clickSound.stop(),s.clickSound.volume=.2,s.clickSound.play()),e.stopPropagation(),this.emit("select",e)}).on("mousedown",e=>{this.background.texture=this.downTexture}).on("mouseover",e=>{this.background.texture=this.selected?this.downTexture:this.overTexture,i.Main.enableSound&&(s.rolloverSound.stop(),s.rolloverSound.volume=.2,s.rolloverSound.play())}).on("mouseout",e=>{this.background.texture=this.selected?this.downTexture:this.upTexture})}set selected(e){this._selected=e,this._selected?this.background.texture=this.downTexture:this.background.texture=this.upTexture}get selected(){return this._selected}set text(e){this._text=e,this.label.text=this._text}get text(){return this._text}}exports.GuiComboboxItem=s,s.rolloverSound=t.Resource.cRoll,s.clickSound=t.Resource.cClick;
},{"pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q"}],"a9Q3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiCombobox=void 0;const e=require("pixi.js"),t=require("../Game/Graphics/Resource"),i=require("../Main"),s=require("./GuiComboboxItem"),n=[];class h extends e.Container{constructor(s,o,r,u){super(),this.buttonOffset=!1,this.label=new e.Text(""),this.background=new e.Sprite,this.itemsTextStyle=null,this._selectedIndex=0,this._menuOpen=!1,this.items=[],this.itemsWidgets=[],this.width=r,this.height=u,this.x=s,this.y=o,n.push(this),this.upTexture=t.Resource.cGuiComboboxBase,this.overTexture=t.Resource.cGuiComboboxRoll,this.downTexture=t.Resource.cGuiComboboxClick,this.itemsTextStyle=new e.TextStyle,this.itemsTextStyle.fontSize=11,this.itemsTextStyle.fill="#573D40",this.itemsTextStyle.fontFamily=i.Main.GLOBAL_FONT,this.itemsTextStyle.align="left",this.width=r,this.height=u,this.position.set(s,o),this.buttonMode=!0,this.interactive=!0,this.background.texture=this.upTexture,this.background.width=r,this.background.height=u,this.addChild(this.background),this.label.text="",this.label.style=this.itemsTextStyle,this.label.anchor.set(0,.5),this.label.x=10,this.label.y=u/2,this.addChild(this.label),this.itemsContainer=new e.Container,this.itemsContainer.x=5,this.itemsContainer.width=r-10,this.itemsContainer.height=u,this.itemsContainer.y=u,this.itemsContainer.visible=this._menuOpen,this.addChild(this.itemsContainer),this.itemsContainerBackground=new e.Graphics,this.itemsContainerBackground.height=u,this.itemsContainerBackground.beginFill(255),this.itemsContainerBackground.drawRect(0,0,r-10,u),this.itemsContainerBackground.endFill(),this.itemsContainer.addChild(this.itemsContainerBackground),this.on("click",e=>{e.target===this&&(this.openMenu(),i.Main.enableSound&&(h.clickSound.volume=.8,h.clickSound.play()))}).on("mousedown",e=>{this.background.texture=this.downTexture,this.buttonOffset||(this.x+=2,this.y+=2,this.buttonOffset=!0)}).on("mouseover",e=>{this.background.texture=this.overTexture,i.Main.enableSound&&(h.rolloverSound.stop(),h.rolloverSound.volume=.2,h.rolloverSound.play())}).on("mouseout",e=>{this.menuOpen||(this.background.texture=this.upTexture,this.buttonOffset&&(this.x-=2,this.y-=2,this.buttonOffset=!1))}),this.zIndex=0}set selectedIndex(e){this._selectedIndex=e,this.itemsWidgets.forEach((e,t)=>{t===this._selectedIndex?(e.selected=!0,this.label.text=e.text):e.selected=!1}),this.menuOpen=!1,this.emit("change",this._selectedIndex)}get selectedIndex(){return this._selectedIndex}set menuOpen(e){this._menuOpen=e,this.zIndex=this._menuOpen?1e3:0,this.itemsContainer.visible=this._menuOpen}get menuOpen(){return this._menuOpen}addItem(e){this.items.push(e),this.label.text=this.items[this.selectedIndex].label,this.itemsContainer.removeChild(...this.itemsWidgets),this.itemsContainerBackground.height=20*this.items.length,this.itemsWidgets=[],this.items.forEach((e,t)=>{const i=new s.GuiComboboxItem(e.label,0,20*t,this.itemsContainer.width,20);i.on("select",()=>{this.selectedIndex=t}),this.itemsContainer.addChild(i),this.itemsWidgets.push(i)})}openMenu(){n.forEach(e=>{e!==this&&(e.menuOpen=!1)}),this.menuOpen=!this.menuOpen}}exports.GuiCombobox=h,h.rolloverSound=t.Resource.cRoll,h.clickSound=t.Resource.cClick;
},{"pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q","./GuiComboboxItem":"vG6C"}],"GxIj":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KawaseBlurFilter=void 0;var e=require("@pixi/core"),t=require("@pixi/math"),r="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",i="\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}",o="\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\n\nuniform vec2 uOffset;\nuniform vec4 filterClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample top right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    gl_FragColor = color;\n}\n",n=function(e){function n(n,l,u){void 0===n&&(n=4),void 0===l&&(l=3),void 0===u&&(u=!1),e.call(this,r,u?o:i),this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new t.Point,this.pixelSize=1,this._clamp=u,this._kernels=null,Array.isArray(n)?this.kernels=n:(this._blur=n,this.quality=l)}e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n;var l={kernels:{configurable:!0},clamp:{configurable:!0},pixelSize:{configurable:!0},quality:{configurable:!0},blur:{configurable:!0}};return n.prototype.apply=function(e,t,r,i){var o,n=this._pixelSize.x/t._frame.width,l=this._pixelSize.y/t._frame.height;if(1===this._quality||0===this._blur)o=this._kernels[0]+.5,this.uniforms.uOffset[0]=o*n,this.uniforms.uOffset[1]=o*l,e.applyFilter(this,t,r,i);else{for(var u,s=e.getFilterTexture(),a=t,f=s,p=this._quality-1,x=0;x<p;x++)o=this._kernels[x]+.5,this.uniforms.uOffset[0]=o*n,this.uniforms.uOffset[1]=o*l,e.applyFilter(this,a,f,1),u=a,a=f,f=u;o=this._kernels[p]+.5,this.uniforms.uOffset[0]=o*n,this.uniforms.uOffset[1]=o*l,e.applyFilter(this,a,r,i),e.returnFilterTexture(s)}},n.prototype._updatePadding=function(){this.padding=Math.ceil(this._kernels.reduce(function(e,t){return e+t+.5},0))},n.prototype._generateKernels=function(){var e=this._blur,t=this._quality,r=[e];if(e>0)for(var i=e,o=e/t,n=1;n<t;n++)i-=o,r.push(i);this._kernels=r,this._updatePadding()},l.kernels.get=function(){return this._kernels},l.kernels.set=function(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max.apply(Math,e)):(this._kernels=[0],this._quality=1)},l.clamp.get=function(){return this._clamp},l.pixelSize.set=function(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof t.Point?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)},l.pixelSize.get=function(){return this._pixelSize},l.quality.get=function(){return this._quality},l.quality.set=function(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()},l.blur.get=function(){return this._blur},l.blur.set=function(e){this._blur=e,this._generateKernels()},Object.defineProperties(n.prototype,l),n}(e.Filter);exports.KawaseBlurFilter=n;
},{"@pixi/core":"lj2a","@pixi/math":"w9h1"}],"wgG9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DropShadowFilter=void 0;var t=require("@pixi/filter-kawase-blur"),i=require("@pixi/core"),e=require("@pixi/settings"),r=require("@pixi/math"),n=require("@pixi/utils"),o="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n}",l="varying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform vec3 color;\n\nuniform vec2 shift;\nuniform vec4 inputSize;\n\nvoid main(void){\n    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = color.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= alpha;\n\n    gl_FragColor = sample;\n}",s=function(i){function s(n){n&&n.constructor!==Object&&(console.warn("DropShadowFilter now uses options instead of (rotation, distance, blur, color, alpha)"),n={rotation:n},void 0!==arguments[1]&&(n.distance=arguments[1]),void 0!==arguments[2]&&(n.blur=arguments[2]),void 0!==arguments[3]&&(n.color=arguments[3]),void 0!==arguments[4]&&(n.alpha=arguments[4])),n=Object.assign({rotation:45,distance:5,color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:e.settings.FILTER_RESOLUTION},n),i.call(this);var s=n.kernels,a=n.blur,u=n.quality,h=n.pixelSize,c=n.resolution;this._tintFilter=new i(o,l),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=new r.Point,this._tintFilter.resolution=c,this._blurFilter=s?new t.KawaseBlurFilter(s):new t.KawaseBlurFilter(a,u),this.pixelSize=h,this.resolution=c;var p=n.shadowOnly,f=n.rotation,d=n.distance,_=n.alpha,b=n.color;this.shadowOnly=p,this.rotation=f,this.distance=d,this.alpha=_,this.color=b,this._updatePadding()}i&&(s.__proto__=i),s.prototype=Object.create(i&&i.prototype),s.prototype.constructor=s;var a={resolution:{configurable:!0},distance:{configurable:!0},rotation:{configurable:!0},alpha:{configurable:!0},color:{configurable:!0},kernels:{configurable:!0},blur:{configurable:!0},quality:{configurable:!0},pixelSize:{configurable:!0}};return s.prototype.apply=function(t,i,e,r){var n=t.getFilterTexture();this._tintFilter.apply(t,i,n,1),this._blurFilter.apply(t,n,e,r),!0!==this.shadowOnly&&t.applyFilter(this,i,e,0),t.returnFilterTexture(n)},s.prototype._updatePadding=function(){this.padding=this.distance+2*this.blur},s.prototype._updateShift=function(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))},a.resolution.get=function(){return this._resolution},a.resolution.set=function(t){this._resolution=t,this._tintFilter&&(this._tintFilter.resolution=t),this._blurFilter&&(this._blurFilter.resolution=t)},a.distance.get=function(){return this._distance},a.distance.set=function(t){this._distance=t,this._updatePadding(),this._updateShift()},a.rotation.get=function(){return this.angle/r.DEG_TO_RAD},a.rotation.set=function(t){this.angle=t*r.DEG_TO_RAD,this._updateShift()},a.alpha.get=function(){return this._tintFilter.uniforms.alpha},a.alpha.set=function(t){this._tintFilter.uniforms.alpha=t},a.color.get=function(){return(0,n.rgb2hex)(this._tintFilter.uniforms.color)},a.color.set=function(t){(0,n.hex2rgb)(t,this._tintFilter.uniforms.color)},a.kernels.get=function(){return this._blurFilter.kernels},a.kernels.set=function(t){this._blurFilter.kernels=t},a.blur.get=function(){return this._blurFilter.blur},a.blur.set=function(t){this._blurFilter.blur=t,this._updatePadding()},a.quality.get=function(){return this._blurFilter.quality},a.quality.set=function(t){this._blurFilter.quality=t},a.pixelSize.get=function(){return this._blurFilter.pixelSize},a.pixelSize.set=function(t){this._blurFilter.pixelSize=t},Object.defineProperties(s.prototype,a),s}(i.Filter);exports.DropShadowFilter=s;
},{"@pixi/filter-kawase-blur":"GxIj","@pixi/core":"lj2a","@pixi/settings":"Xe2x","@pixi/math":"w9h1","@pixi/utils":"X4iF"}],"u6bk":[function(require,module,exports) {
var global = arguments[3];

var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.create=L,exports.wrapEase=N,exports.WidgetGroup=exports.Widget=exports.TilingSprite=exports.Ticker=exports.TextWidget=exports.TextInput=exports.TEXT_STYLE_PROPERTIES=exports.StyleSheet=exports.Style=exports.Stage=exports.Sprite=exports.SortableList=exports.Slider=exports.SliceSprite=exports.ScrollWidget=exports.ScrollManager=exports.ScrollBar=exports.MeasureMode=exports.LinearLayout=exports.LayoutOptions=exports.InteractiveGroup=exports.Insets=exports.ImageWidget=exports.ImageButton=exports.Helpers=exports.FastLayoutOptions=exports.FastLayout=exports.EventManager=exports.EventBroker=exports.Ease=exports.ClickManager=exports.CheckBox=exports.Button=exports.BorderLayoutOptions=exports.BorderLayout=exports.AnchorLayoutOptions=exports.AnchorLayout=exports.ALIGN=void 0;var e=require("pixi.js"),i=require("@pixi/filter-drop-shadow");const r=[],s={add:(t,e)=>(t._dragDropEventId=e.data.identifier,-1===r.indexOf(t)&&(r.push(t),!0)),getItem(t){let e,i=null;for(let s=0;s<r.length;s++)if(r[s]===t){i=r[s],e=s;break}return null!==i&&(r.splice(e,1),i)},getEventItem(t,e){let i,s=null;const n=t.data.identifier;for(let o=0;o<r.length;o++)if(r[o]._dragDropEventId===n){if(e!==r[o].dragGroup)return!1;s=r[o],i=o;break}return null!==s&&(r.splice(i,1),s)}};class n{constructor(){this.reset(),this.dirtyId=0}reset(){this.left=-1,this.top=-1,this.right=-1,this.bottom=-1}}var o;exports.Insets=n,exports.MeasureMode=o,function(t){t[t.UNBOUNDED=0]="UNBOUNDED",t[t.EXACTLY=1]="EXACTLY",t[t.AT_MOST=2]="AT_MOST"}(o||(exports.MeasureMode=o={}));class h{constructor(t){this.target=t,this.isEnabled=!1}getTarget(){return this.target}}exports.EventManager=h;class a extends h{constructor(t,i,r,s){super(t),this.startEvent=((t=this._includeHover,e=this._rightMouseButton,i=this._doubleClick)=>{if(this.isEnabled)return;this._includeHover=t,this.rightMouseButton=e,this._doubleClick=i;const{target:r}=this;r.insetContainer.on(this.evMouseDown,this.onMouseDownImpl),this._rightMouseButton||r.insetContainer.on("touchstart",this.onMouseDownImpl),this._includeHover&&(r.insetContainer.on("mouseover",this.onMouseOverImpl),r.insetContainer.on("mouseout",this.onMouseOutImpl)),this.isEnabled=!0}),this.stopEvent=(()=>{if(!this.isEnabled)return;const{target:t}=this;this.bound&&(t.insetContainer.removeListener(this.evMouseUp,this.onMouseUpImpl),t.insetContainer.removeListener(this.evMouseUpOutside,this.onMouseUpOutsideImpl),this._rightMouseButton||(t.insetContainer.removeListener("touchend",this.onMouseUpImpl),t.insetContainer.removeListener("touchendoutside",this.onMouseUpOutsideImpl)),this.bound=!1),t.insetContainer.removeListener(this.evMouseDown,this.onMouseDownImpl),this._rightMouseButton||t.insetContainer.removeListener("touchstart",this.onMouseDownImpl),this._includeHover&&(t.insetContainer.removeListener("mouseover",this.onMouseOverImpl),t.insetContainer.removeListener("mouseout",this.onMouseOutImpl),t.insetContainer.removeListener("mousemove",this.onMouseMoveImpl),t.insetContainer.removeListener("touchmove",this.onMouseMoveImpl)),this.isEnabled=!1}),this.onMouseDownImpl=(t=>{const{target:e,evMouseUp:i,onMouseUpImpl:r,evMouseUpOutside:s,onMouseUpOutsideImpl:n,_rightMouseButton:o}=this;if(this.mouse.copyFrom(t.data.global),this.id=t.data.identifier,this.onPress.call(this.target,t,!0),this.bound||(e.insetContainer.on(i,r),e.insetContainer.on(s,n),o||(e.insetContainer.on("touchend",r),e.insetContainer.on("touchendoutside",n)),this.bound=!0),this._doubleClick){const i=performance.now();i-this.time<210?this.onClick.call(e,t):this.time=i}t.data.originalEvent.preventDefault()}),this.onMouseUpCommonImpl=(t=>{const{target:e,evMouseUp:i,onMouseUpImpl:r,evMouseUpOutside:s,onMouseUpOutsideImpl:n}=this;t.data.identifier===this.id&&(this.offset.set(t.data.global.x-this.mouse.x,t.data.global.y-this.mouse.y),this.bound&&(e.insetContainer.removeListener(i,r),e.insetContainer.removeListener(s,n),this._rightMouseButton||(e.insetContainer.removeListener("touchend",r),e.insetContainer.removeListener("touchendoutside",n)),this.bound=!1),this.onPress.call(e,t,!1))}),this.onMouseUpImpl=(t=>{t.data.identifier===this.id&&(this.onMouseUpCommonImpl(t),this.target.dragThreshold&&(this.movementX=Math.abs(this.offset.x),this.movementY=Math.abs(this.offset.y),Math.max(this.movementX,this.movementY)>this.target.dragThreshold)||this._doubleClick||this.onClick.call(this.target,t))}),this.onMouseUpOutsideImpl=(t=>{t.data.identifier===this.id&&this.onMouseUpCommonImpl(t)}),this.onMouseOverImpl=(t=>{this.ishover||(this.ishover=!0,this.target.insetContainer.on("mousemove",this.onMouseMoveImpl),this.target.insetContainer.on("touchmove",this.onMouseMoveImpl),this.onHover.call(this.target,t,!0))}),this.onMouseOutImpl=(t=>{this.ishover&&(this.ishover=!1,this.target.insetContainer.removeListener("mousemove",this.onMouseMoveImpl),this.target.insetContainer.removeListener("touchmove",this.onMouseMoveImpl),this.onHover.call(this.target,t,!1))}),this.onMouseMoveImpl=(t=>{this.onMove.call(this.target,t)}),this.bound=!1,this.id=0,this.ishover=!1,this.mouse=new e.Point,this.offset=new e.Point,this.movementX=0,this.movementY=0,this._includeHover=void 0===i||i,this.rightMouseButton=void 0!==r&&r,this._doubleClick=void 0!==s&&s,t.interactive=!0,this.time=0,this.startEvent(),this.onHover=(()=>null),this.onPress=(()=>null),this.onClick=(()=>null),this.onMove=(()=>null)}get rightMouseButton(){return this._rightMouseButton}set rightMouseButton(t){this._rightMouseButton=t,this.evMouseDown=this._rightMouseButton?"rightdown":"mousedown",this.evMouseUp=this._rightMouseButton?"rightup":"mouseup",this.evMouseUpOutside=this._rightMouseButton?"rightupoutside":"mouseupoutside"}}exports.ClickManager=a;class u extends h{constructor(t){super(t),this.onDragStartImpl=(t=>{const{target:e}=this;this.id=t.data.identifier,this.onPress(t,!0),this.isBound||(this.dragStart.copyFrom(t.data.global),e.stage.on("mousemove",this.onDragMoveImpl),e.stage.on("touchmove",this.onDragMoveImpl),e.stage.on("mouseup",this.onDragEndImpl),e.stage.on("mouseupoutside",this.onDragEndImpl),e.stage.on("touchend",this.onDragEndImpl),e.stage.on("touchendoutside",this.onDragEndImpl),e.stage.on("touchcancel",this.onDragEndImpl),this.isBound=!0),t.data.originalEvent.preventDefault()}),this.onDragMoveImpl=(t=>{if(t.data.identifier!==this.id)return;const{lastCursor:e,dragOffset:i,dragStart:r,target:s}=this;if(this.lastCursor.copyFrom(t.data.global),this.dragOffset.set(e.x-r.x,e.y-r.y),!this.isDragging){if(this.movementX=Math.abs(i.x),this.movementY=Math.abs(i.y),0===this.movementX&&0===this.movementY||Math.max(this.movementX,this.movementY)<s.dragThreshold)return;if(null!==s.dragRestrictAxis&&(this.cancel=!1,"x"===s.dragRestrictAxis&&this.movementY>this.movementX?this.cancel=!0:"y"===s.dragRestrictAxis&&this.movementY<=this.movementX&&(this.cancel=!0),this.cancel))return void this.onDragEndImpl(t);this.onDragStart(t),this.isDragging=!0}this.onDragMove(t,i)}),this.onDragEndImpl=(t=>{if(t.data.identifier!==this.id)return;const{target:e}=this;this.isBound&&(e.stage.removeListener("mousemove",this.onDragMoveImpl),e.stage.removeListener("touchmove",this.onDragMoveImpl),e.stage.removeListener("mouseup",this.onDragEndImpl),e.stage.removeListener("mouseupoutside",this.onDragEndImpl),e.stage.removeListener("touchend",this.onDragEndImpl),e.stage.removeListener("touchendoutside",this.onDragEndImpl),e.stage.removeListener("touchcancel",this.onDragEndImpl),this.isDragging=!1,this.isBound=!1,this.onDragEnd(t),this.onPress(t,!1))}),this.isBound=!1,this.isDragging=!1,this.id=0,this.dragStart=new e.Point,this.dragOffset=new e.Point,this.lastCursor=new e.Point,this.movementX=0,this.movementY=0,this.cancel=!1,this.target.interactive=!0,this.onPress=(()=>null),this.onDragStart=(()=>null),this.onDragMove=(()=>null),this.onDragEnd=(()=>null),this.startEvent()}startEvent(){if(this.isEnabled)return;const{target:t}=this;t.insetContainer.on("mousedown",this.onDragStartImpl),t.insetContainer.on("touchstart",this.onDragStartImpl),this.isEnabled=!0}stopEvent(){if(!this.isEnabled)return;const{target:t}=this;this.isBound&&(t.stage.removeListener("mousemove",this.onDragMoveImpl),t.stage.removeListener("touchmove",this.onDragMoveImpl),t.stage.removeListener("mouseup",this.onDragEndImpl),t.stage.removeListener("mouseupoutside",this.onDragEndImpl),t.stage.removeListener("touchend",this.onDragEndImpl),t.stage.removeListener("touchendoutside",this.onDragEndImpl),this.isBound=!1),t.insetContainer.removeListener("mousedown",this.onDragStartImpl),t.insetContainer.removeListener("touchstart",this.onDragStartImpl),this.isEnabled=!1}}class l{constructor(t){this.target=t;for(const e of Object.keys(l.MANAGER_MAP))Object.defineProperty(this,e,{get(){return this[`_${e}`]||(this[`_${e}`]=new l.MANAGER_MAP[e](this.target)),this[`_${e}`]}})}}exports.EventBroker=l,l.MANAGER_MAP={click:a,dnd:u};class d extends h{constructor(t,i=!0){super(t),this.onMouseScrollImpl=(t=>{const{target:e,preventDefault:i,delta:r}=this;i&&event.preventDefault(),void 0!==t.deltaX?r.set(t.deltaX,t.deltaY):r.set(1===t.axis?60*t.detail:0,2===t.axis?60*t.detail:0),this.onMouseScroll.call(e,event,r)}),this.onHoverImpl=(t=>{const{onMouseScrollImpl:e}=this;this.bound||(document.addEventListener("mousewheel",e,!1),document.addEventListener("DOMMouseScroll",e,!1),this.bound=!0)}),this.onMouseOutImpl=(t=>{const{onMouseScrollImpl:e}=this;this.bound&&(document.removeEventListener("mousewheel",e),document.removeEventListener("DOMMouseScroll",e),this.bound=!1)}),this.onMouseScroll=function(t,e){},this.bound=!1,this.delta=new e.Point,this.preventDefault=i,this.startEvent()}startEvent(){const{target:t,onHoverImpl:e,onMouseOutImpl:i}=this;t.contentContainer.on("mouseover",e),t.contentContainer.on("mouseout",i)}stopEvent(){const{target:t,onMouseScrollImpl:e,onHoverImpl:i,onMouseOutImpl:r}=this;this.bound&&(document.removeEventListener("mousewheel",e),document.removeEventListener("DOMMouseScroll",e),this.bound=!1),t.contentContainer.removeListener("mouseover",i),t.contentContainer.removeListener("mouseout",r)}}exports.ScrollManager=d;const c=["paddingLeft","paddingTop","paddingRight","paddingBottom"],p=["paddingHorizontal","paddingVertical"],f=["fontFamily","fontSize","fontWeight","letterSpacing"];exports.TEXT_STYLE_PROPERTIES=f;class g extends e.utils.EventEmitter{constructor(){super(),this.insetContainer=new e.Container,this.contentContainer=this.insetContainer.addChild(new e.Container),this.widgetChildren=[],this.stage=null,this.layoutMeasure=new n,this.initialized=!1,this.dragInitialized=!1,this.dropInitialized=!1,this.dirty=!0,this._oldWidth=-1,this._oldHeight=-1,this.pixelPerfect=!0,this._paddingLeft=0,this._paddingTop=0,this._paddingRight=0,this._paddingBottom=0,this._elevation=0,this.tint=0,this.blendMode=e.BLEND_MODES.NORMAL,this.draggable=!1,this.droppable=!1,this.singleClickTimeout=null,this.style=null,this.styleID=-1,this.insetContainer.on("pointerdown",t=>{this.onPointerPress(t)}),this.insetContainer.on("pointermove",t=>{this.onPointerMove(t)}),this.insetContainer.on("pointerup",t=>{this.onPointerRelease(t)}),this.insetContainer.on("pointerover",t=>{this.onPointerEnter(t)}),this.insetContainer.on("pointerout",t=>{this.onPointerExit(t)}),this.insetContainer.on("rightclick",t=>{this.onRightClick(t)})}update(){this._layoutDirty&&(console.log("here"),setTimeout(()=>{this._layoutDirty&&this.stage.measureAndLayout()},0)),this.style&&this.styleID!==this.style.dirtyID&&(this.onStyleChange(this.style),this.styleID=this.style.dirtyID)}get measuredWidth(){return this._measuredWidth}get measuredHeight(){return this._measuredHeight}getMeasuredWidth(){return this._measuredWidth}getMeasuredHeight(){return this._measuredHeight}onMeasure(t,e,i,r){const s=this.contentContainer.width+this.paddingHorizontal,n=this.contentContainer.height+this.paddingVertical;switch(i){case o.EXACTLY:this._measuredWidth=t;break;case o.UNBOUNDED:this._measuredWidth=s;break;case o.AT_MOST:this._measuredWidth=Math.min(t,s)}switch(r){case o.EXACTLY:this._measuredHeight=e;break;case o.UNBOUNDED:this._measuredHeight=n;break;case o.AT_MOST:this._measuredHeight=Math.min(e,n)}}measure(t,e,i,r){this.onMeasure(t,e,i,r)}onLayout(t,e=t,i=t,r=e,s=!0){this.layoutMeasure.left=t,this.layoutMeasure.top=e,this.layoutMeasure.right=i,this.layoutMeasure.bottom=r,this._width=i-t,this._height=r-e,this.background&&(this.background.x=0,this.background.y=0,this.background.width=i-t,this.background.height=r-e),this.insetContainer.x=t,this.insetContainer.y=e,this.contentContainer.x=this._paddingLeft,this.contentContainer.y=this._paddingTop,this._layoutDirty=!1}layout(t,e=t,i=t,r=e,s=!0){this.onLayout(t,e,i,r,s)}setLayoutOptions(t){return this.layoutOptions=t,this}onStyleChange(t){const e=t.getProperties("backgroundColor","background","elevation","padding","paddingHorizontal","paddingVertical","paddingLeft","paddingTop","paddingRight","paddingBottom");e.background?this.setBackground(e.background):void 0!==e.backgroundColor&&this.setBackground(e.backgroundColor),void 0!==e.elevation&&this.setElevation(e.elevation),c.forEach((t,i)=>{"number"==typeof e[t]?this[`_${t}`]=e[t]:"number"==typeof e[p[i%2]]?this[`_${t}`]=e[p[i%2]]:"number"==typeof e.padding&&(this[`_${t}`]=e.padding)}),this.dirty=!0}onPointerEnter(t){this.onHoverChange(t,!0)}onPointerExit(t){this.onHoverChange(t,!1)}onPointerPress(t){}onPointerMove(t){}onPointerRelease(t){this.singleClickTimeout?(clearTimeout(this.singleClickTimeout),this.singleClickTimeout=null,setTimeout(()=>{this.onDoubleClick(t)},0)):(this.singleClickTimeout=setTimeout(()=>{this.singleClickTimeout=null},g.CLICK_DELAY),this.onClick(t))}onHoverChange(t,e){}onClick(t){}onDoubleClick(t){}onRightClick(t){if(console.log("RIGHT_CLICK"),t.data.originalEvent.preventDefault(),this.contextMenu){this.contextPopup;t.data.getLocalPosition(this.stage)}}get eventBroker(){return this._eventBroker||(this._eventBroker=new l(this)),this._eventBroker}get paddingLeft(){return this._paddingLeft}set paddingLeft(t){this._paddingLeft=t,this.dirty=!0}get paddingTop(){return this._paddingTop}set paddingTop(t){this._paddingTop=t,this.dirty=!0}get paddingRight(){return this._paddingRight}set paddingRight(t){this._paddingRight=t,this.dirty=!0}get paddingBottom(){return this._paddingBottom}set paddingBottom(t){this._paddingBottom=t,this.dirty=!0}get paddingHorizontal(){return this._paddingLeft+this._paddingRight}get paddingVertical(){return this._paddingTop+this._paddingBottom}get interactive(){return this.insetContainer.interactive}set interactive(t){this.insetContainer.interactive=!0,this.contentContainer.interactive=!0}get width(){return this._width}get height(){return this._height}get contentWidth(){return this._width-this.paddingHorizontal}get contentHeight(){return this._height-this.paddingVertical}get alpha(){return this.insetContainer.alpha}set alpha(t){this.insetContainer.alpha=t}setPadding(t,e=t,i=t,r=e){return this._paddingLeft=t,this._paddingTop=e,this._paddingRight=i,this._paddingBottom=r,this.dirty=!0,this}getBackground(){return this.background}setBackground(t){return this.background&&this.insetContainer.removeChild(this.background),"string"==typeof t&&(t=e.utils.string2hex(t)),"number"==typeof t&&(t=(new e.Graphics).beginFill(t).drawRect(0,0,1,1).endFill()),this.background=t,t&&(t.width=this.width,t.height=this.height,this.insetContainer.addChildAt(t,0)),t&&this._elevation&&this._dropShadow&&(this.background.filters||(this.background.filters=[]),this.background.filters.push(this._dropShadow)),this}getBackgroundAlpha(){return this.background?this.background.alpha:1}setBackgroundAlpha(t){return this.background||this.setBackground(16777215),this.background.alpha=t,this}setContextMenu(t){this.contextMenu=t}getElevation(){return this._elevation}setElevation(t){if(this._elevation=t,0===t&&this._dropShadow){if(!this.background)return this;const t=this.background.filters.indexOf(this._dropShadow);t>0&&this.background.filters.splice(t,1)}else t>0&&(this._dropShadow||(this.background&&!this.background.filters&&(this.background.filters=[]),this._dropShadow=new i.DropShadowFilter({distance:t}),this.background&&this.background.filters.push(this._dropShadow)),this._dropShadow.distance=t);return this}setStyle(t){return this.style=t,this.styleID=-1,this}requestLayout(){this._layoutDirty=!0}addChild(...t){for(let e=0;e<t.length;e++){const i=t[e];i.parent&&i.parent.removeChild(i),i.parent=this,this.contentContainer.addChild(i.insetContainer),this.widgetChildren.push(i)}return this}removeChild(...t){for(let e=0;e<t.length;e++){const i=t[e],r=this.widgetChildren.indexOf(i);-1!==r&&(i.insetContainer.parent.removeChild(i.insetContainer),this.widgetChildren.splice(r,1),i.parent=null)}return this}openPopupMenu(t,e){this.stage;const i=this.contextPopup.layoutOptions;i.x=t,i.y=e,this.stage.addChild(this.contextPopup)}closePopupMenu(){this.stage.removeChild(this.contextPopup)}makeDraggable(){return this.draggable=!0,this.initialized&&this.initDraggable(),this}clearDraggable(){this.dragInitialized&&(this.dragInitialized=!1,this.eventBroker.dnd.stopEvent())}initialize(){this.initialized||(this.draggable&&this.initDraggable(),this.droppable&&this.initDroppable(),this.initialized=!0)}initDraggable(){if(this.dragInitialized)return;this.dragInitialized=!0;const t=new e.Point,i=new e.Point,r=this.eventBroker.dnd,{insetContainer:n}=this;r.onDragStart=(e=>{const i=s.add(this,e);!this.isDragging&&i&&(this.isDragging=!0,n.interactive=!1,t.copyFrom(n.position),this.emit("draggablestart",e))}),r.onDragMove=((e,r)=>{this.isDragging&&(i.set(t.x+r.x,t.y+r.y),n.x=i.x,n.y=i.y,this.emit("draggablemove",e))}),r.onDragEnd=(e=>{this.isDragging&&(this.isDragging=!1,s.getItem(this),setTimeout(()=>{this.insetContainer.interactive=!0,this.insetContainer.position.copyFrom(t),this.emit("draggableend",e)},0))})}makeDroppable(){return this.droppable=!0,this.initialized&&this.initDroppable(),this}clearDroppable(){this.dropInitialized&&(this.dropInitialized=!1,this.contentContainer.removeListener("mouseup",this.onDrop),this.contentContainer.removeListener("touchend",this.onDrop))}initDroppable(){if(!this.dropInitialized){this.dropInitialized=!0;const t=this.contentContainer;this.contentContainer.interactive=!0,this.onDrop=(t=>{const e=s.getEventItem(t,this.dropGroup);if(e&&e.isDragging){e.isDragging=!1,e.insetContainer.interactive=!0;const t=null!==this.droppableReparent?this.droppableReparent:self;t.container.toLocal(e.container.position,e.container.parent,e),t.container!=e.container.parent&&t.addChild(e)}}),t.on("mouseup",this.onDrop),t.on("touchend",this.onDrop)}}static fromContent(t){if(t instanceof g)return t;const e=new g;return e.contentContainer.addChild(t),e}static resolveMeasuredDimen(t,e,i){return i===o.EXACTLY?e:i===o.AT_MOST?Math.min(e,t):t}}var m;exports.Widget=g,g.CLICK_DELAY=300,exports.ALIGN=m,function(t){t[t.LEFT=0]="LEFT",t[t.TOP=0]="TOP",t[t.MIDDLE=4081]="MIDDLE",t[t.CENTER=4081]="CENTER",t[t.RIGHT=1048561]="RIGHT",t[t.BOTTOM=1048561]="BOTTOM",t[t.NONE=4294967295]="NONE"}(m||(exports.ALIGN=m={}));class v{constructor(t=v.WRAP_CONTENT,e=v.WRAP_CONTENT){this.setWidth(t),this.setHeight(e),this.cache={}}setWidth(t){this.width=v.parseDimen(t)}setHeight(t){this.height=v.parseDimen(t)}get isWidthPredefined(){return this.width>1&&this.width<=v.MAX_DIMEN}get isHeightPredefined(){return this.height>1&&this.height<=v.MAX_DIMEN}get marginLeft(){return this._marginLeft||0}set marginLeft(t){this._marginLeft=t}get marginTop(){return this._marginTop||0}set marginTop(t){this._marginTop=t}get marginRight(){return this._marginRight||0}set marginRight(t){this._marginRight=t}get marginBottom(){return this._marginBottom||0}set marginBottom(t){this._marginBottom=t}setMargin(t,e,i,r){this._marginLeft=t,this._marginTop=e,this._marginRight=i,this._marginBottom=r}static parseDimen(t){if("string"==typeof t&&(t.endsWith("%")?t=parseFloat(t.replace("%",""))/100:t.endsWith("px")&&(t=parseFloat(t.replace("px",""))),"string"==typeof t||isNaN(t)))throw new Error("Width could not be parsed!");return t}}exports.LayoutOptions=v,v.FILL_PARENT=4294967281,v.WRAP_CONTENT=4294967282,v.MAX_DIMEN=4294967280,v.DEFAULT=new v;class y extends v{constructor(t){super(t.width,t.height),this.anchorLeft=t.anchorLeft||0,this.anchorTop=t.anchorTop||0,this.anchorBottom=t.anchorBottom||0,this.anchorRight=t.anchorRight||0,this.horizontalAlign=t.horizontalAlign||m.LEFT,this.verticalAlign=t.verticalAlign||m.CENTER}}exports.AnchorLayoutOptions=y;class _ extends v{constructor(t){super(t.width,t.height),this.x=t.x||0,this.y=t.y||0,this.anchor=t.anchor||_.DEFAULT_ANCHOR.clone()}}exports.FastLayoutOptions=_,_.DEFAULT_ANCHOR=new e.Point(0,0),_.CENTER_ANCHOR=new e.Point(.5,.5);class x extends v{constructor(t){super(t.width,t.height),this.region=t.region||x.REGION_CENTER,this.horizontalAlign=t.horizontalAlign||m.LEFT,this.verticalAlign=t.verticalAlign||m.TOP}}exports.BorderLayoutOptions=x,x.REGION_LEFT=61425,x.REGION_TOP=61426,x.REGION_RIGHT=61427,x.REGION_BOTTOM=61428,x.REGION_CENTER=61429;class T{onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){const t=this.host,{contentWidth:e,contentHeight:i,widgetChildren:r}=t;for(let s=0,n=r.length;s<n;s++){const t=r[s],n=t.layoutOptions||v.DEFAULT;let o=n.x?n.x:0,h=n.y?n.y:0;Math.abs(o)<1&&(o*=e),Math.abs(h)<1&&(h*=i);const a=n.anchor||_.DEFAULT_ANCHOR,u=o-a.x*t.getMeasuredWidth(),l=h-a.y*t.getMeasuredHeight();t.layout(u,l,u+t.getMeasuredWidth(),l+t.getMeasuredHeight())}}onMeasure(t,e,i,r){this._measuredWidth=t,this._measuredHeight=e;const s=this.host.widgetChildren;for(let n=0,o=s.length;n<o;n++){const o=s[n],h=o.layoutOptions||v.DEFAULT,a=Math.abs(h.width)<1?h.width*t:h.width,u=Math.abs(h.height)<1?h.height*e:h.height,l=this.getChildMeasureMode(h.width,i),d=this.getChildMeasureMode(h.height,r);o.measure(a,u,l,d)}this._measuredWidth=this.measureWidthReach(t,i),this._measuredHeight=this.measureHeightReach(e,r),this.measureChildFillers()}getChildMeasureMode(t,e){return t===v.WRAP_CONTENT?e===o.UNBOUNDED?o.UNBOUNDED:o.AT_MOST:e}measureWidthReach(t,e){if(e===o.EXACTLY)return t;const i=this.host.widgetChildren;let r=0;for(let s=0,n=i.length;s<n;s++){const t=i[s],e=t.getMeasuredWidth(),n=t.layoutOptions||v.DEFAULT,o=n.x?n.x:0,h=n.anchor?n.anchor:_.DEFAULT_ANCHOR,a=Math.abs(o)<1?(1-h.x)*e/(1-o):o+e;r=Math.max(r,a)}return e===o.AT_MOST&&(r=Math.min(t,r)),r}measureHeightReach(t,e){if(e===o.EXACTLY)return t;const i=this.host.widgetChildren;let r=0;for(let s=0,n=i.length;s<n;s++){const t=i[s],e=t.getMeasuredHeight(),n=t.layoutOptions||v.DEFAULT,o=n.y?n.y:0,h=n.anchor?n.anchor:_.DEFAULT_ANCHOR,a=Math.abs(o)<1?(1-h.y)*e/(1-o):o+e;r=Math.max(r,a)}return e===o.AT_MOST&&(r=Math.min(t,r)),r}measureChildFillers(){const t=this.host.widgetChildren;for(let e=0,i=t.length;e<i;e++){const i=t[e],r=i.layoutOptions||v.DEFAULT;let s=Math.abs(r.width)<1?r.width*this._measuredWidth:r.width,n=Math.abs(r.height)<1?r.height*this._measuredHeight:r.height;s===v.WRAP_CONTENT&&(s=i.getMeasuredWidth()),n===v.WRAP_CONTENT&&(n=i.getMeasuredHeight()),r.width!==v.FILL_PARENT&&r.height!==v.FILL_PARENT||i.measure(r.width===v.FILL_PARENT?this._measuredWidth:s,r.height===v.FILL_PARENT?this._measuredHeight:n,o.EXACTLY,o.EXACTLY)}}getMeasuredWidth(){return this._measuredWidth}getMeasuredHeight(){return this._measuredHeight}}exports.FastLayout=T;class b extends g{useLayout(t){return this.layoutMgr&&this.layoutMgr.onDetach(),this.layoutMgr=t,t&&this.layoutMgr.onAttach(this),this}useDefaultLayout(){this.useLayout(new T)}onMeasure(t,e,i,r){super.onMeasure(t,e,i,r),0!==this.widgetChildren.length&&(this.layoutMgr||this.useDefaultLayout(),this.layoutMgr.onMeasure(t-this.paddingHorizontal,e-this.paddingVertical,i,r),this._measuredWidth=Math.max(this.measuredWidth,this.layoutMgr.getMeasuredWidth()),this._measuredHeight=Math.max(this.measuredHeight,this.layoutMgr.getMeasuredHeight()))}onLayout(t,e,i,r,s=!0){super.onLayout(t,e,i,r,s),0!==this.widgetChildren.length&&(this.layoutMgr||this.useDefaultLayout(),this.layoutMgr.onLayout())}}exports.WidgetGroup=b;class E extends b{constructor(){super(),this.hitArea=new e.Rectangle,this.insetContainer.hitArea=this.hitArea}update(){super.update()}layout(t,e,i,r,s){super.layout(t,e,i,r,s),this.hitArea.width=this.width,this.hitArea.height=this.height}}exports.InteractiveGroup=E;class w extends E{constructor(t={}){super(),this.bindEvents=(()=>{this.stage.on("pointerdown",this.onDocumentPointerDownImpl),document.addEventListener("keydown",this.onKeyDownImpl)}),this.clearEvents=(()=>{this.stage.off("pointerdown",this.onDocumentPointerDownImpl),document.removeEventListener("keydown",this.onKeyDownImpl)}),this.onKeyDownImpl=(t=>{const e=this.stage.focusController;9===t.which&&e.useTab?(e.onTab(),t.preventDefault()):38===t.which&&e.useBack?(e.onBack(),t.preventDefault()):40===t.which&&e.useForward&&(e.onForward(),t.preventDefault()),this.emit("keydown")}),this.onDocumentPointerDownImpl=(()=>{this._isMousePressed||this.blur()}),t.background&&super.setBackground(t.background),this._isFocused=!1,this._isMousePressed=!1,this.interactive=!0,this.tabIndex=t.tabIndex,this.tabGroup=t.tabGroup,this.insetContainer.on("pointerdown",()=>{this.focus(),this._isMousePressed=!0}),this.insetContainer.on("pointerup",()=>{this._isMousePressed=!1}),this.insetContainer.on("pointerupoutside",()=>{this._isMousePressed=!1})}focus(){this.isFocused||(this.stage.focusController.notifyFocus(this),this._isFocused=!0,this.bindEvents(),this.emit("focusChanged",!0),this.emit("focus"))}blur(){this._isFocused&&(this.stage.focusController.notifyBlur(),this._isFocused=!1,this.clearEvents(),this.emit("focusChanged",!1),this.emit("blur"))}get isFocused(){return this._isFocused}initialize(){super.initialize(),this.stage.focusController.in(this,this.tabIndex,this.tabGroup)}}class C extends g{constructor(t,i){super(),this.textDisplay=new e.Text(t,i),this.contentContainer.addChild(this.textDisplay)}update(){super.update(),null!==this.tint&&(this.textDisplay.tint=this.tint),null!==this.blendMode&&(this.textDisplay.blendMode=this.blendMode)}get value(){return this.textDisplay.text}set value(t){this.textDisplay.text=t}get text(){return this.value}set text(t){this.value=t}getTextStyle(){return this.textDisplay.style}setTextStyle(t){return this.textDisplay.style=t,this}onStyleChange(t){super.onStyleChange(t);const e=t.getProperties(...f),i=this.textDisplay.style;f.forEach(t=>{void 0!==e[t]&&(i[t]=e[t])})}}exports.TextWidget=C;class A extends w{constructor(t){super(t),this.isHover=!1,"string"==typeof t.text&&(t.text=new C(t.text,new e.TextStyle)),this.textWidget=t.text.setLayoutOptions(new _({width:v.WRAP_CONTENT,height:v.WRAP_CONTENT,x:.5,y:.5,anchor:_.CENTER_ANCHOR})),this.textWidget&&this.addChild(this.textWidget),this.contentContainer.buttonMode=!0}onClick(t){super.onClick(t),this.emit("click",t)}onDoubleClick(t){super.onDoubleClick(t),this.emit("doubleclick",t)}update(){super.update()}initialize(){super.initialize(),this.insetContainer.interactiveChildren=!1}get value(){return this.textWidget?this.textWidget.text:""}set value(t){this.textWidget&&(this.textWidget.text=t)}get text(){return this.textWidget}set text(t){this.value=t}onStyleChange(t){this.textWidget.onStyleChange(t)}}exports.Button=A;class I extends w{constructor(t){super(t),this.change=(t=>{this.checkmark&&(this.checkmark.alpha=t?1:0)}),this.click=(()=>{this.emit("click"),null!==this.checkGroup&&this.checked||(this.checked=!this.checked,this.emit("changed",this.checked))}),this._checked=void 0!==t.checked&&t.checked,this._value=t.value||"",this.checkGroup=t.checkGroup||null,this.checkmark=new E,this.checkmark.contentContainer.addChild(t.checkmark),this.checkmark.setLayoutOptions(new _({width:v.WRAP_CONTENT,height:v.WRAP_CONTENT,x:.5,y:.5,anchor:_.CENTER_ANCHOR})),this.checkmark.alpha=this._checked?1:0,this.addChild(this.checkmark),this.contentContainer.buttonMode=!0}update(){}get checked(){return this._checked}set checked(t){t!==this._checked&&(null!==this.checkGroup&&t&&this.stage.checkBoxGroupController.notifyCheck(this),this._checked=t,this.change(t))}get value(){return this._value}set value(t){this._value=t,this.checked&&this.stage.checkBoxGroupController.notifyCheck(this)}get selectedValue(){var t;return null===(t=this.stage)||void 0===t?void 0:t.checkBoxGroupController.getSelected(this.checkGroup).value}initialize(){super.initialize();const t=this.eventBroker.click;t.onHover=((t,e)=>{this.emit("hover",e)}),t.onPress=((t,e)=>{e&&(this.focus(),t.data.originalEvent.preventDefault()),this.emit("press",e)}),t.onClick=(()=>{this.click()}),null!==this.checkGroup&&this.stage.checkBoxGroupController.in(this,this.checkGroup)}}exports.CheckBox=I;class M{getPosition(t){return t}}function S(t,e,i){const r=t,s=e&&i?3:i?1:2;this.getPosition=function(t){let e=1===s?1-t:2===s?t:t<.5?2*t:2*(1-t);return 1===r?e*=e:2===r?e*=e*e:3===r?e*=e*e*e:4===r&&(e*=e*e*e*e),1===s?1-e:2===s?e:t<.5?e/2:1-e/2}}S.prototype=Object.create(M.prototype),S.prototype.constructor=S;const O={};exports.Ease=O;const R=.5*Math.PI;function L(t){const e=Object.create(M.prototype);return e.getPosition=t,e}const P=new M;function N(t,e,i){return{easeIn:t,easeOut:e,easeInOut:i}}O.Linear=P,O.Power0={easeNone:P},O.Power1=O.Quad=N(new S(1,1,0),new S(1,0,1),new S(1,1,1)),O.Power2=O.Cubic=N(new S(2,1,0),new S(2,0,1),new S(2,1,1)),O.Power3=O.Quart=N(new S(3,1,0),new S(3,0,1),new S(3,1,1)),O.Power4=O.Quint=N(new S(4,1,0),new S(4,0,1),new S(4,1,1)),O.Bounce={BounceIn:L(function(t){return(t=1-t)<1/2.75?1-7.5625*t*t:t<2/2.75?1-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(7.5625*(t-=2.25/2.75)*t+.9375):1-(7.5625*(t-=2.625/2.75)*t+.984375)}),BounceOut:L(function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}),BounceInOut:L(function(t){const e=t<.5;return(t=e?1-2*t:2*t-1)<1/2.75?t*=7.5625*t:t=t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5})},O.Circ={CircIn:L(function(t){return-(Math.sqrt(1-t*t)-1)}),CircOut:L(function(t){return Math.sqrt(1-(t-=1)*t)}),CircInOut:L(function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)})},O.Expo={ExpoIn:L(function(t){return Math.pow(2,10*(t-1))-.001}),ExpoOut:L(function(t){return 1-Math.pow(2,-10*t)}),ExpoInOut:L(function(t){return(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))})},O.Sine={SineIn:L(function(t){return 1-Math.cos(t*R)}),SineOut:L(function(t){return Math.sin(t*R)}),SineInOut:L(function(t){return-.5*(Math.cos(Math.PI*t)-1)})};const D={Lerp:(t,e,i)=>(i>1?i=1:i<0&&(i=0),t+(e-t)*i),Round(t,e){const i=Math.pow(10,e);return Math.round(t*i)/i},componentToHex(t){const e=t.toString(16);return 1==e.length?`0${e}`:e},rgbToHex(t,e,i){return`#${this.componentToHex(t)}${this.componentToHex(e)}${this.componentToHex(i)}`},rgbToNumber:(t,e,i)=>65536*t+256*e+i,numberToRgb:t=>({r:Math.floor(t/65536),g:Math.floor(t/256)%256,b:t%256}),hexToRgb(t){if(null===t&&(t=16777215),!isNaN(t))return this.numberToRgb(t);t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,r){return e+e+i+i+r+r});const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}};exports.Helpers=D;class F extends g{constructor(t){super(),this.spriteDisplay=new e.Sprite(t),this.contentContainer.addChild(this.spriteDisplay)}update(){null!==this.tint&&(this.spriteDisplay.tint=this.tint),null!==this.blendMode&&(this.spriteDisplay.blendMode=this.blendMode)}static fromImage(t){return new F(new e.Texture(new e.BaseTexture(t)))}}exports.Sprite=F;const k=F;exports.ImageWidget=k;var U=/iPhone/i,B=/iPod/i,H=/iPad/i,G=/\biOS-universal(?:.+)Mac\b/i,W=/\bAndroid(?:.+)Mobile\b/i,V=/Android/i,X=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,j=/Silk/i,z=/Windows Phone/i,Y=/\bWindows(?:.+)ARM\b/i,K=/BlackBerry/i,q=/BB10/i,Z=/Opera Mini/i,$=/\b(CriOS|Chrome)(?:.+)Mobile/i,J=/Mobile(?:.+)Firefox\b/i,Q=function(t){return void 0!==t&&"MacIntel"===t.platform&&"number"==typeof t.maxTouchPoints&&t.maxTouchPoints>1&&"undefined"==typeof MSStream};function tt(t){return function(e){return e.test(t)}}function et(t){var e={userAgent:"",platform:"",maxTouchPoints:0};t||"undefined"==typeof navigator?"string"==typeof t?e.userAgent=t:t&&t.userAgent&&(e={userAgent:t.userAgent,platform:t.platform,maxTouchPoints:t.maxTouchPoints||0}):e={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var i=e.userAgent,r=i.split("[FBAN");void 0!==r[1]&&(i=r[0]),void 0!==(r=i.split("Twitter"))[1]&&(i=r[0]);var s=tt(i),n={apple:{phone:s(U)&&!s(z),ipod:s(B),tablet:!s(U)&&(s(H)||Q(e))&&!s(z),universal:s(G),device:(s(U)||s(B)||s(H)||s(G)||Q(e))&&!s(z)},amazon:{phone:s(X),tablet:!s(X)&&s(j),device:s(X)||s(j)},android:{phone:!s(z)&&s(X)||!s(z)&&s(W),tablet:!s(z)&&!s(X)&&!s(W)&&(s(j)||s(V)),device:!s(z)&&(s(X)||s(j)||s(W)||s(V))||s(/\bokhttp\b/i)},windows:{phone:s(z),tablet:s(Y),device:s(z)||s(Y)},other:{blackberry:s(K),blackberry10:s(q),opera:s(Z),firefox:s(J),chrome:s($),device:s(K)||s(q)||s(Z)||s(J)||s($)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}var it=et(window.navigator);function rt(t){var e=!0;if(it.tablet||it.phone){var i;if(it.apple.device)if(i=navigator.userAgent.match(/OS (\d+)_(\d+)?/))parseInt(i[1],10)<11&&(e=!1);if(it.android.device)if(i=navigator.userAgent.match(/Android\s([0-9.]*)/))parseInt(i[1],10)<7&&(e=!1)}return e?t:4}function nt(){return!it.apple.device}var ot,ht,at,ut,lt,dt,ct,pt,ft,gt,mt,vt,yt,_t,xt,Tt,bt,Et={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:rt(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:it.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:nt(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};!function(t){t[t.WEBGL_LEGACY=0]="WEBGL_LEGACY",t[t.WEBGL=1]="WEBGL",t[t.WEBGL2=2]="WEBGL2"}(ot||(ot={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WEBGL=1]="WEBGL",t[t.CANVAS=2]="CANVAS"}(ht||(ht={})),function(t){t[t.COLOR=16384]="COLOR",t[t.DEPTH=256]="DEPTH",t[t.STENCIL=1024]="STENCIL"}(at||(at={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ADD=1]="ADD",t[t.MULTIPLY=2]="MULTIPLY",t[t.SCREEN=3]="SCREEN",t[t.OVERLAY=4]="OVERLAY",t[t.DARKEN=5]="DARKEN",t[t.LIGHTEN=6]="LIGHTEN",t[t.COLOR_DODGE=7]="COLOR_DODGE",t[t.COLOR_BURN=8]="COLOR_BURN",t[t.HARD_LIGHT=9]="HARD_LIGHT",t[t.SOFT_LIGHT=10]="SOFT_LIGHT",t[t.DIFFERENCE=11]="DIFFERENCE",t[t.EXCLUSION=12]="EXCLUSION",t[t.HUE=13]="HUE",t[t.SATURATION=14]="SATURATION",t[t.COLOR=15]="COLOR",t[t.LUMINOSITY=16]="LUMINOSITY",t[t.NORMAL_NPM=17]="NORMAL_NPM",t[t.ADD_NPM=18]="ADD_NPM",t[t.SCREEN_NPM=19]="SCREEN_NPM",t[t.NONE=20]="NONE",t[t.SRC_OVER=0]="SRC_OVER",t[t.SRC_IN=21]="SRC_IN",t[t.SRC_OUT=22]="SRC_OUT",t[t.SRC_ATOP=23]="SRC_ATOP",t[t.DST_OVER=24]="DST_OVER",t[t.DST_IN=25]="DST_IN",t[t.DST_OUT=26]="DST_OUT",t[t.DST_ATOP=27]="DST_ATOP",t[t.ERASE=26]="ERASE",t[t.SUBTRACT=28]="SUBTRACT",t[t.XOR=29]="XOR"}(ut||(ut={})),function(t){t[t.POINTS=0]="POINTS",t[t.LINES=1]="LINES",t[t.LINE_LOOP=2]="LINE_LOOP",t[t.LINE_STRIP=3]="LINE_STRIP",t[t.TRIANGLES=4]="TRIANGLES",t[t.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",t[t.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(lt||(lt={})),function(t){t[t.RGBA=6408]="RGBA",t[t.RGB=6407]="RGB",t[t.ALPHA=6406]="ALPHA",t[t.LUMINANCE=6409]="LUMINANCE",t[t.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",t[t.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=34041]="DEPTH_STENCIL"}(dt||(dt={})),function(t){t[t.TEXTURE_2D=3553]="TEXTURE_2D",t[t.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",t[t.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",t[t.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",t[t.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",t[t.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",t[t.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",t[t.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"}(ct||(ct={})),function(t){t[t.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",t[t.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",t[t.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",t[t.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",t[t.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",t[t.FLOAT=5126]="FLOAT",t[t.HALF_FLOAT=36193]="HALF_FLOAT"}(pt||(pt={})),function(t){t[t.NEAREST=0]="NEAREST",t[t.LINEAR=1]="LINEAR"}(ft||(ft={})),function(t){t[t.CLAMP=33071]="CLAMP",t[t.REPEAT=10497]="REPEAT",t[t.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(gt||(gt={})),function(t){t[t.OFF=0]="OFF",t[t.POW2=1]="POW2",t[t.ON=2]="ON"}(mt||(mt={})),function(t){t[t.NPM=0]="NPM",t[t.UNPACK=1]="UNPACK",t[t.PMA=2]="PMA",t[t.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",t[t.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",t[t.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA"}(vt||(vt={})),function(t){t[t.NO=0]="NO",t[t.YES=1]="YES",t[t.AUTO=2]="AUTO",t[t.BLEND=0]="BLEND",t[t.CLEAR=1]="CLEAR",t[t.BLIT=2]="BLIT"}(yt||(yt={})),function(t){t[t.AUTO=0]="AUTO",t[t.MANUAL=1]="MANUAL"}(_t||(_t={})),function(t){t.LOW="lowp",t.MEDIUM="mediump",t.HIGH="highp"}(xt||(xt={})),function(t){t[t.NONE=0]="NONE",t[t.SCISSOR=1]="SCISSOR",t[t.STENCIL=2]="STENCIL",t[t.SPRITE=3]="SPRITE"}(Tt||(Tt={})),function(t){t[t.NONE=0]="NONE",t[t.LOW=2]="LOW",t[t.MEDIUM=4]="MEDIUM",t[t.HIGH=8]="HIGH"}(bt||(bt={}));var wt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function Ct(t,e){return t(e={exports:{}},e.exports),e.exports}var At=Ct(function(t){var e=Object.prototype.hasOwnProperty,i="~";function r(){}function s(t,e,i){this.fn=t,this.context=e,this.once=i||!1}function n(t,e,r,n,o){if("function"!=typeof r)throw new TypeError("The listener must be a function");var h=new s(r,n||t,o),a=i?i+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],h]:t._events[a].push(h):(t._events[a]=h,t._eventsCount++),t}function o(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function h(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(i=!1)),h.prototype.eventNames=function(){var t,r,s=[];if(0===this._eventsCount)return s;for(r in t=this._events)e.call(t,r)&&s.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(t)):s},h.prototype.listeners=function(t){var e=i?i+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var s=0,n=r.length,o=new Array(n);s<n;s++)o[s]=r[s].fn;return o},h.prototype.listenerCount=function(t){var e=i?i+t:t,r=this._events[e];return r?r.fn?1:r.length:0},h.prototype.emit=function(t,e,r,s,n,o){var h=i?i+t:t;if(!this._events[h])return!1;var a,u,l=this._events[h],d=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),d){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,s),!0;case 5:return l.fn.call(l.context,e,r,s,n),!0;case 6:return l.fn.call(l.context,e,r,s,n,o),!0}for(u=1,a=new Array(d-1);u<d;u++)a[u-1]=arguments[u];l.fn.apply(l.context,a)}else{var c,p=l.length;for(u=0;u<p;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),d){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,r);break;case 4:l[u].fn.call(l[u].context,e,r,s);break;default:if(!a)for(c=1,a=new Array(d-1);c<d;c++)a[c-1]=arguments[c];l[u].fn.apply(l[u].context,a)}}return!0},h.prototype.on=function(t,e,i){return n(this,t,e,i,!1)},h.prototype.once=function(t,e,i){return n(this,t,e,i,!0)},h.prototype.removeListener=function(t,e,r,s){var n=i?i+t:t;if(!this._events[n])return this;if(!e)return o(this,n),this;var h=this._events[n];if(h.fn)h.fn!==e||s&&!h.once||r&&h.context!==r||o(this,n);else{for(var a=0,u=[],l=h.length;a<l;a++)(h[a].fn!==e||s&&!h[a].once||r&&h[a].context!==r)&&u.push(h[a]);u.length?this._events[n]=1===u.length?u[0]:u:o(this,n)}return this},h.prototype.removeAllListeners=function(t){var e;return t?(e=i?i+t:t,this._events[e]&&o(this,e)):(this._events=new r,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=i,h.EventEmitter=h,t.exports=h}),It=Ct(function(t,e){!function(i){var r=e&&!e.nodeType&&e,s=t&&!t.nodeType&&t,n="object"==typeof wt&&wt;n.global!==n&&n.window!==n&&n.self!==n||(i=n);var o,h,a=2147483647,u=36,l=1,d=26,c=38,p=700,f=72,g=128,m="-",v=/^xn--/,y=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,x={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},T=u-l,b=Math.floor,E=String.fromCharCode;function w(t){throw RangeError(x[t])}function C(t,e){for(var i=t.length,r=[];i--;)r[i]=e(t[i]);return r}function A(t,e){var i=t.split("@"),r="";return i.length>1&&(r=i[0]+"@",t=i[1]),r+C((t=t.replace(_,".")).split("."),e).join(".")}function I(t){for(var e,i,r=[],s=0,n=t.length;s<n;)(e=t.charCodeAt(s++))>=55296&&e<=56319&&s<n?56320==(64512&(i=t.charCodeAt(s++)))?r.push(((1023&e)<<10)+(1023&i)+65536):(r.push(e),s--):r.push(e);return r}function M(t){return C(t,function(t){var e="";return t>65535&&(e+=E((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+=E(t)}).join("")}function S(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function O(t,e,i){var r=0;for(t=i?b(t/p):t>>1,t+=b(t/e);t>T*d>>1;r+=u)t=b(t/T);return b(r+(T+1)*t/(t+c))}function R(t){var e,i,r,s,n,o,h,c,p,v,y,_=[],x=t.length,T=0,E=g,C=f;for((i=t.lastIndexOf(m))<0&&(i=0),r=0;r<i;++r)t.charCodeAt(r)>=128&&w("not-basic"),_.push(t.charCodeAt(r));for(s=i>0?i+1:0;s<x;){for(n=T,o=1,h=u;s>=x&&w("invalid-input"),((c=(y=t.charCodeAt(s++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:u)>=u||c>b((a-T)/o))&&w("overflow"),T+=c*o,!(c<(p=h<=C?l:h>=C+d?d:h-C));h+=u)o>b(a/(v=u-p))&&w("overflow"),o*=v;C=O(T-n,e=_.length+1,0==n),b(T/e)>a-E&&w("overflow"),E+=b(T/e),T%=e,_.splice(T++,0,E)}return M(_)}function L(t){var e,i,r,s,n,o,h,c,p,v,y,_,x,T,C,A=[];for(_=(t=I(t)).length,e=g,i=0,n=f,o=0;o<_;++o)(y=t[o])<128&&A.push(E(y));for(r=s=A.length,s&&A.push(m);r<_;){for(h=a,o=0;o<_;++o)(y=t[o])>=e&&y<h&&(h=y);for(h-e>b((a-i)/(x=r+1))&&w("overflow"),i+=(h-e)*x,e=h,o=0;o<_;++o)if((y=t[o])<e&&++i>a&&w("overflow"),y==e){for(c=i,p=u;!(c<(v=p<=n?l:p>=n+d?d:p-n));p+=u)C=c-v,T=u-v,A.push(E(S(v+C%T,0))),c=b(C/T);A.push(E(S(c,0))),n=O(i,x,r==s),i=0,++r}++i,++e}return A.join("")}if(o={version:"1.3.2",ucs2:{decode:I,encode:M},decode:R,encode:L,toASCII:function(t){return A(t,function(t){return y.test(t)?"xn--"+L(t):t})},toUnicode:function(t){return A(t,function(t){return v.test(t)?R(t.slice(4).toLowerCase()):t})}},r&&s)if(t.exports==r)s.exports=o;else for(h in o)o.hasOwnProperty(h)&&(r[h]=o[h]);else i.punycode=o}(wt)}),Mt={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}};function St(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Ot=function(t,e,i,r){e=e||"&",i=i||"=";var s={};if("string"!=typeof t||0===t.length)return s;var n=/\+/g;t=t.split(e);var o=1e3;r&&"number"==typeof r.maxKeys&&(o=r.maxKeys);var h=t.length;o>0&&h>o&&(h=o);for(var a=0;a<h;++a){var u,l,d,c,p=t[a].replace(n,"%20"),f=p.indexOf(i);f>=0?(u=p.substr(0,f),l=p.substr(f+1)):(u=p,l=""),d=decodeURIComponent(u),c=decodeURIComponent(l),St(s,d)?Array.isArray(s[d])?s[d].push(c):s[d]=[s[d],c]:s[d]=c}return s},Rt=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},Lt=function(t,e,i,r){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(r){var s=encodeURIComponent(Rt(r))+i;return Array.isArray(t[r])?t[r].map(function(t){return s+encodeURIComponent(Rt(t))}).join(e):s+encodeURIComponent(Rt(t[r]))}).join(e):r?encodeURIComponent(Rt(r))+i+encodeURIComponent(Rt(t)):""},Pt=Ct(function(t,e){e.decode=e.parse=Ot,e.encode=e.stringify=Lt}),Nt=Pt.decode,Dt=Pt.parse,Ft=Pt.encode,kt=Pt.stringify,Ut=te;function Bt(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Ht=/^([a-z0-9.+-]+:)/i,Gt=/:[0-9]*$/,Wt=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Vt=["<",">",'"',"`"," ","\r","\n","\t"],Xt=["{","}","|","\\","^","`"].concat(Vt),jt=["'"].concat(Xt),zt=["%","/","?",";","#"].concat(jt),Yt=["/","?","#"],Kt=255,qt=/^[+a-z0-9A-Z_-]{0,63}$/,Zt=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,$t={javascript:!0,"javascript:":!0},Jt={javascript:!0,"javascript:":!0},Qt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function te(t,e,i){if(t&&Mt.isObject(t)&&t instanceof Bt)return t;var r=new Bt;return r.parse(t,e,i),r}Bt.prototype.parse=function(t,e,i){if(!Mt.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),s=-1!==r&&r<t.indexOf("#")?"?":"#",n=t.split(s);n[0]=n[0].replace(/\\/g,"/");var o=t=n.join(s);if(o=o.trim(),!i&&1===t.split("#").length){var h=Wt.exec(o);if(h)return this.path=o,this.href=o,this.pathname=h[1],h[2]?(this.search=h[2],this.query=e?Pt.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var a=Ht.exec(o);if(a){var u=(a=a[0]).toLowerCase();this.protocol=u,o=o.substr(a.length)}if(i||a||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===o.substr(0,2);!l||a&&Jt[a]||(o=o.substr(2),this.slashes=!0)}if(!Jt[a]&&(l||a&&!Qt[a])){for(var d,c,p=-1,f=0;f<Yt.length;f++){-1!==(g=o.indexOf(Yt[f]))&&(-1===p||g<p)&&(p=g)}-1!==(c=-1===p?o.lastIndexOf("@"):o.lastIndexOf("@",p))&&(d=o.slice(0,c),o=o.slice(c+1),this.auth=decodeURIComponent(d)),p=-1;for(f=0;f<zt.length;f++){var g;-1!==(g=o.indexOf(zt[f]))&&(-1===p||g<p)&&(p=g)}-1===p&&(p=o.length),this.host=o.slice(0,p),o=o.slice(p),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var v=this.hostname.split(/\./),y=(f=0,v.length);f<y;f++){var _=v[f];if(_&&!_.match(qt)){for(var x="",T=0,b=_.length;T<b;T++)_.charCodeAt(T)>127?x+="x":x+=_[T];if(!x.match(qt)){var E=v.slice(0,f),w=v.slice(f+1),C=_.match(Zt);C&&(E.push(C[1]),w.unshift(C[2])),w.length&&(o="/"+w.join(".")+o),this.hostname=E.join(".");break}}}this.hostname.length>Kt?this.hostname="":this.hostname=this.hostname.toLowerCase(),m||(this.hostname=It.toASCII(this.hostname));var A=this.port?":"+this.port:"",I=this.hostname||"";this.host=I+A,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==o[0]&&(o="/"+o))}if(!$t[u])for(f=0,y=jt.length;f<y;f++){var M=jt[f];if(-1!==o.indexOf(M)){var S=encodeURIComponent(M);S===M&&(S=escape(M)),o=o.split(M).join(S)}}var O=o.indexOf("#");-1!==O&&(this.hash=o.substr(O),o=o.slice(0,O));var R=o.indexOf("?");if(-1!==R?(this.search=o.substr(R),this.query=o.substr(R+1),e&&(this.query=Pt.parse(this.query)),o=o.slice(0,R)):e&&(this.search="",this.query={}),o&&(this.pathname=o),Qt[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){A=this.pathname||"";var L=this.search||"";this.path=A+L}return this.href=this.format(),this},Bt.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",r=this.hash||"",s=!1,n="";this.host?s=t+this.host:this.hostname&&(s=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&Mt.isObject(this.query)&&Object.keys(this.query).length&&(n=Pt.stringify(this.query));var o=this.search||n&&"?"+n||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||Qt[e])&&!1!==s?(s="//"+(s||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):s||(s=""),r&&"#"!==r.charAt(0)&&(r="#"+r),o&&"?"!==o.charAt(0)&&(o="?"+o),e+s+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(o=o.replace("#","%23"))+r},Bt.prototype.resolve=function(t){return this.resolveObject(te(t,!1,!0)).format()},Bt.prototype.resolveObject=function(t){if(Mt.isString(t)){var e=new Bt;e.parse(t,!1,!0),t=e}for(var i=new Bt,r=Object.keys(this),s=0;s<r.length;s++){var n=r[s];i[n]=this[n]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),h=0;h<o.length;h++){var a=o[h];"protocol"!==a&&(i[a]=t[a])}return Qt[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!Qt[t.protocol]){for(var u=Object.keys(t),l=0;l<u.length;l++){var d=u[l];i[d]=t[d]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||Jt[t.protocol])i.pathname=t.pathname;else{for(var c=(t.pathname||"").split("/");c.length&&!(t.host=c.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==c[0]&&c.unshift(""),c.length<2&&c.unshift(""),i.pathname=c.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var p=i.pathname||"",f=i.search||"";i.path=p+f}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var g=i.pathname&&"/"===i.pathname.charAt(0),m=t.host||t.pathname&&"/"===t.pathname.charAt(0),v=m||g||i.host&&t.pathname,y=v,_=i.pathname&&i.pathname.split("/")||[],x=(c=t.pathname&&t.pathname.split("/")||[],i.protocol&&!Qt[i.protocol]);if(x&&(i.hostname="",i.port=null,i.host&&(""===_[0]?_[0]=i.host:_.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===c[0]?c[0]=t.host:c.unshift(t.host)),t.host=null),v=v&&(""===c[0]||""===_[0])),m)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,_=c;else if(c.length)_||(_=[]),_.pop(),_=_.concat(c),i.search=t.search,i.query=t.query;else if(!Mt.isNullOrUndefined(t.search)){if(x)i.hostname=i.host=_.shift(),(C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=C.shift(),i.host=i.hostname=C.shift());return i.search=t.search,i.query=t.query,Mt.isNull(i.pathname)&&Mt.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!_.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var T=_.slice(-1)[0],b=(i.host||t.host||_.length>1)&&("."===T||".."===T)||""===T,E=0,w=_.length;w>=0;w--)"."===(T=_[w])?_.splice(w,1):".."===T?(_.splice(w,1),E++):E&&(_.splice(w,1),E--);if(!v&&!y)for(;E--;E)_.unshift("..");!v||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),b&&"/"!==_.join("/").substr(-1)&&_.push("");var C,A=""===_[0]||_[0]&&"/"===_[0].charAt(0);x&&(i.hostname=i.host=A?"":_.length?_.shift():"",(C=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=C.shift(),i.host=i.hostname=C.shift()));return(v=v||i.host&&_.length)&&!A&&_.unshift(""),_.length?i.pathname=_.join("/"):(i.pathname=null,i.path=null),Mt.isNull(i.pathname)&&Mt.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},Bt.prototype.parseHost=function(){var t=this.host,e=Gt.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)},Et.RETINA_PREFIX=/@([0-9\.]+)x/,Et.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var ee,ie=!1,re="5.3.1";function se(t){var e;if(!ie){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var i=["\n %c %c %c PixiJS "+re+" - ✰ "+t+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(e=window.console).log.apply(e,i)}else window.console&&window.console.log("PixiJS "+re+" - "+t+" - http://www.pixijs.com/");ie=!0}}function ne(){return void 0===ee&&(ee=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:Et.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),r=!(!i||!i.getContextAttributes().stencil);if(i){var s=i.getExtension("WEBGL_lose_context");s&&s.loseContext()}return i=null,r}catch(n){return!1}}()),ee}function oe(t,e){return void 0===e&&(e=[]),e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(255&t)/255,e}function he(t){var e=t.toString(16);return"#"+(e="000000".substr(0,6-e.length)+e)}function ae(){for(var t=[],e=[],i=0;i<32;i++)t[i]=i,e[i]=i;t[ut.NORMAL_NPM]=ut.NORMAL,t[ut.ADD_NPM]=ut.ADD,t[ut.SCREEN_NPM]=ut.SCREEN,e[ut.NORMAL]=ut.NORMAL_NPM,e[ut.ADD]=ut.ADD_NPM,e[ut.SCREEN]=ut.SCREEN_NPM;var r=[];return r.push(e),r.push(t),r}var ue=ae();function le(t,e){if(1===e)return(255*e<<24)+t;if(0===e)return 0;var i=t>>16&255,r=t>>8&255,s=255&t;return(255*e<<24)+((i=i*e+.5|0)<<16)+((r=r*e+.5|0)<<8)+(s=s*e+.5|0)}function de(t){return t+=0===t?1:0,--t,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,(t|=t>>>16)+1}function ce(t){return!(t&t-1||!t)}function pe(t){var e=(t>65535?1:0)<<4,i=((t>>>=e)>255?1:0)<<3;return e|=i,e|=i=((t>>>=i)>15?1:0)<<2,(e|=i=((t>>>=i)>3?1:0)<<1)|(t>>>=i)>>1}function fe(t,e,i){var r,s=t.length;if(!(e>=s||0===i)){var n=s-(i=e+i>s?s-e:i);for(r=e;r<n;++r)t[r]=t[r+i];t.length=n}}var ge=0;function me(){return++ge}var ve={};function ye(t,e,i){if(void 0===i&&(i=3),!ve[e]){var r=(new Error).stack;void 0===r?console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t):(r=r.split("\n").splice(i).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",e+"\nDeprecated since v"+t),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",e+"\nDeprecated since v"+t),console.warn(r))),ve[e]=!0}}var _e,xe={},Te=Object.create(null),be=Object.create(null),Ee=function(){function t(t,e,i){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=i||Et.RESOLUTION,this.resize(t,e)}return t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},t.prototype.resize=function(t,e){this.canvas.width=t*this.resolution,this.canvas.height=e*this.resolution},t.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=t},enumerable:!1,configurable:!0}),t}();function we(t,e){if(void 0===e&&(e=window.location),0===t.indexOf("data:"))return"";e=e||window.location,_e||(_e=document.createElement("a")),_e.href=t;var i=Ut(_e.href),r=!i.port&&""===e.port||i.port===e.port;return i.hostname===e.hostname&&r&&i.protocol===e.protocol?"":"anonymous"}function Ce(t,e){var i=Et.RETINA_PREFIX.exec(t);return i?parseFloat(i[1]):void 0!==e?e:1}var Ae,Ie=function(){function t(t){this.items=[],this._name=t,this._aliasCount=0}return t.prototype.emit=function(t,e,i,r,s,n,o,h){if(arguments.length>8)throw new Error("max arguments reached");var a=this.name,u=this.items;this._aliasCount++;for(var l=0,d=u.length;l<d;l++)u[l][a](t,e,i,r,s,n,o,h);return u===this.items&&this._aliasCount--,this},t.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},t.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},t.prototype.remove=function(t){var e=this.items.indexOf(t);return-1!==e&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},t.prototype.contains=function(t){return-1!==this.items.indexOf(t)},t.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},t.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t}();Object.defineProperties(Ie.prototype,{dispatch:{value:Ie.prototype.emit},run:{value:Ie.prototype.emit}}),Et.TARGET_FPMS=.06,function(t){t[t.INTERACTION=50]="INTERACTION",t[t.HIGH=25]="HIGH",t[t.NORMAL=0]="NORMAL",t[t.LOW=-25]="LOW",t[t.UTILITY=-50]="UTILITY"}(Ae||(Ae={}));var Me,Se=function(){function t(t,e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=!1),this.fn=t,this.context=e,this.priority=i,this.once=r,this.next=null,this.previous=null,this._destroyed=!1}return t.prototype.match=function(t,e){return void 0===e&&(e=null),this.fn===t&&this.context===e},t.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},t.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},t.prototype.destroy=function(t){void 0===t&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},t}(),Oe=function(){function t(){var t=this;this._head=new Se(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Et.TARGET_FPMS,this.elapsedMS=1/Et.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&null===t._requestId&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return t.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},t.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},t.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},t.prototype.add=function(t,e,i){return void 0===i&&(i=Ae.NORMAL),this._addListener(new Se(t,e,i))},t.prototype.addOnce=function(t,e,i){return void 0===i&&(i=Ae.NORMAL),this._addListener(new Se(t,e,i,!0))},t.prototype._addListener=function(t){var e=this._head.next,i=this._head;if(e){for(;e;){if(t.priority>e.priority){t.connect(i);break}i=e,e=e.next}t.previous||t.connect(i)}else t.connect(i);return this._startIfPossible(),this},t.prototype.remove=function(t,e){for(var i=this._head.next;i;)i=i.match(t,e)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(t.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},t.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},t.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},t.prototype.update=function(t){var e;if(void 0===t&&(t=performance.now()),t>this.lastTime){if((e=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var i=t-this._lastFrame|0;if(i<this._minElapsedMS)return;this._lastFrame=t-i%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Et.TARGET_FPMS;for(var r=this._head,s=r.next;s;)s=s.emit(this.deltaTime);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(t.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),i=Math.min(Math.max(0,e)/1e3,Et.TARGET_FPMS);this._maxElapsedMS=1/i},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(0===t)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(t,"shared",{get:function(){if(!t._shared){var e=t._shared=new t;e.autoStart=!0,e._protected=!0}return t._shared},enumerable:!1,configurable:!0}),Object.defineProperty(t,"system",{get:function(){if(!t._system){var e=t._system=new t;e.autoStart=!0,e._protected=!0}return t._system},enumerable:!1,configurable:!0}),t}(),Re=2*Math.PI;!function(t){t[t.POLY=0]="POLY",t[t.RECT=1]="RECT",t[t.CIRC=2]="CIRC",t[t.ELIP=3]="ELIP",t[t.RREC=4]="RREC"}(Me||(Me={}));var Le=function(){function t(t,e,i,r){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=0),this.x=Number(t),this.y=Number(e),this.width=Number(i),this.height=Number(r),this.type=Me.RECT}return Object.defineProperty(t.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(t,"EMPTY",{get:function(){return new t(0,0,0,0)},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},t.prototype.contains=function(t,e){return!(this.width<=0||this.height<=0)&&(t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height)},t.prototype.pad=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x-=t,this.y-=e,this.width+=2*t,this.height+=2*e,this},t.prototype.fit=function(t){var e=Math.max(this.x,t.x),i=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),s=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(i-e,0),this.y=r,this.height=Math.max(s-r,0),this},t.prototype.ceil=function(t,e){void 0===t&&(t=1),void 0===e&&(e=.001);var i=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=i-this.x,this.height=r-this.y,this},t.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),s=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=i-e,this.y=r,this.height=s-r,this},t}(),Pe=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},t.prototype.copyTo=function(t){return t.set(this.x,this.y),t},t.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this.x=t,this.y=e,this},t}(),Ne=function(){function t(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0),this._x=i,this._y=r,this.cb=t,this.scope=e}return t.prototype.clone=function(e,i){return void 0===e&&(e=this.cb),void 0===i&&(i=this.scope),new t(e,i,this._x,this._y)},t.prototype.set=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=t),this._x===t&&this._y===e||(this._x=t,this._y=e,this.cb.call(this.scope)),this},t.prototype.copyFrom=function(t){return this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.set(this._x,this._y),t},t.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),t}(),De=function(){function t(t,e,i,r,s,n){void 0===t&&(t=1),void 0===e&&(e=0),void 0===i&&(i=0),void 0===r&&(r=1),void 0===s&&(s=0),void 0===n&&(n=0),this.array=null,this.a=t,this.b=e,this.c=i,this.d=r,this.tx=s,this.ty=n}return t.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},t.prototype.set=function(t,e,i,r,s,n){return this.a=t,this.b=e,this.c=i,this.d=r,this.tx=s,this.ty=n,this},t.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i},t.prototype.apply=function(t,e){e=e||new Pe;var i=t.x,r=t.y;return e.x=this.a*i+this.c*r+this.tx,e.y=this.b*i+this.d*r+this.ty,e},t.prototype.applyInverse=function(t,e){e=e||new Pe;var i=1/(this.a*this.d+this.c*-this.b),r=t.x,s=t.y;return e.x=this.d*i*r+-this.c*i*s+(this.ty*this.c-this.tx*this.d)*i,e.y=this.a*i*s+-this.b*i*r+(-this.ty*this.a+this.tx*this.b)*i,e},t.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},t.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},t.prototype.rotate=function(t){var e=Math.cos(t),i=Math.sin(t),r=this.a,s=this.c,n=this.tx;return this.a=r*e-this.b*i,this.b=r*i+this.b*e,this.c=s*e-this.d*i,this.d=s*i+this.d*e,this.tx=n*e-this.ty*i,this.ty=n*i+this.ty*e,this},t.prototype.append=function(t){var e=this.a,i=this.b,r=this.c,s=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*i+t.b*s,this.c=t.c*e+t.d*r,this.d=t.c*i+t.d*s,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*i+t.ty*s+this.ty,this},t.prototype.setTransform=function(t,e,i,r,s,n,o,h,a){return this.a=Math.cos(o+a)*s,this.b=Math.sin(o+a)*s,this.c=-Math.sin(o-h)*n,this.d=Math.cos(o-h)*n,this.tx=t-(i*this.a+r*this.c),this.ty=e-(i*this.b+r*this.d),this},t.prototype.prepend=function(t){var e=this.tx;if(1!==t.a||0!==t.b||0!==t.c||1!==t.d){var i=this.a,r=this.c;this.a=i*t.a+this.b*t.c,this.b=i*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},t.prototype.decompose=function(t){var e=this.a,i=this.b,r=this.c,s=this.d,n=-Math.atan2(-r,s),o=Math.atan2(i,e),h=Math.abs(n+o);return h<1e-5||Math.abs(Re-h)<1e-5?(t.rotation=o,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=n,t.skew.y=o),t.scale.x=Math.sqrt(e*e+i*i),t.scale.y=Math.sqrt(r*r+s*s),t.position.x=this.tx,t.position.y=this.ty,t},t.prototype.invert=function(){var t=this.a,e=this.b,i=this.c,r=this.d,s=this.tx,n=t*r-e*i;return this.a=r/n,this.b=-e/n,this.c=-i/n,this.d=t/n,this.tx=(i*this.ty-r*s)/n,this.ty=-(t*this.ty-e*s)/n,this},t.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},t.prototype.clone=function(){var e=new t;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},t.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},t.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},Object.defineProperty(t,"IDENTITY",{get:function(){return new t},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEMP_MATRIX",{get:function(){return new t},enumerable:!1,configurable:!0}),t}(),Fe=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],ke=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],Ue=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Be=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],He=[],Ge=[],We=Math.sign;function Ve(){for(var t=0;t<16;t++){var e=[];He.push(e);for(var i=0;i<16;i++)for(var r=We(Fe[t]*Fe[i]+Ue[t]*ke[i]),s=We(ke[t]*Fe[i]+Be[t]*ke[i]),n=We(Fe[t]*Ue[i]+Ue[t]*Be[i]),o=We(ke[t]*Ue[i]+Be[t]*Be[i]),h=0;h<16;h++)if(Fe[h]===r&&ke[h]===s&&Ue[h]===n&&Be[h]===o){e.push(h);break}}for(t=0;t<16;t++){var a=new De;a.set(Fe[t],ke[t],Ue[t],Be[t],0,0),Ge.push(a)}}Ve();var Xe={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(t){return Fe[t]},uY:function(t){return ke[t]},vX:function(t){return Ue[t]},vY:function(t){return Be[t]},inv:function(t){return 8&t?15&t:7&-t},add:function(t,e){return He[t][e]},sub:function(t,e){return He[t][Xe.inv(e)]},rotate180:function(t){return 4^t},isVertical:function(t){return 2==(3&t)},byDirection:function(t,e){return 2*Math.abs(t)<=Math.abs(e)?e>=0?Xe.S:Xe.N:2*Math.abs(e)<=Math.abs(t)?t>0?Xe.E:Xe.W:e>0?t>0?Xe.SE:Xe.SW:t>0?Xe.NE:Xe.NW},matrixAppendRotationInv:function(t,e,i,r){void 0===i&&(i=0),void 0===r&&(r=0);var s=Ge[Xe.inv(e)];s.tx=i,s.ty=r,t.append(s)}},je=function(){function t(){this.worldTransform=new De,this.localTransform=new De,this.position=new Ne(this.onChange,this,0,0),this.scale=new Ne(this.onChange,this,1,1),this.pivot=new Ne(this.onChange,this,0,0),this.skew=new Ne(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return t.prototype.onChange=function(){this._localID++},t.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},t.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},t.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var i=t.worldTransform,r=this.worldTransform;r.a=e.a*i.a+e.b*i.c,r.b=e.a*i.b+e.b*i.d,r.c=e.c*i.a+e.d*i.c,r.d=e.c*i.b+e.d*i.d,r.tx=e.tx*i.a+e.ty*i.c+i.tx,r.ty=e.tx*i.b+e.ty*i.d+i.ty,this._parentID=t._worldID,this._worldID++}},t.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(t.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),t.IDENTITY=new t,t}();Et.PREFER_ENV=it.any?ot.WEBGL:ot.WEBGL2,Et.STRICT_TEXTURE_CACHE=!1;var ze=[];function Ye(t,e){if(!t)return null;var i="";if("string"==typeof t){var r=/\.(\w{3,4})(?:$|\?|#)/i.exec(t);r&&(i=r[1].toLowerCase())}for(var s=ze.length-1;s>=0;--s){var n=ze[s];if(n.test&&n.test(t,i))return new n(t,e)}throw new Error("Unrecognized source type to auto-detect Resource")}var Ke=function(t,e){return(Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function qe(t,e){function i(){this.constructor=t}Ke(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var Ze=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new Ie("setRealSize"),this.onUpdate=new Ie("update"),this.onError=new Ie("onError")}return t.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},t.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},t.prototype.resize=function(t,e){t===this._width&&e===this._height||(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(t.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.destroyed||this.onUpdate.emit()},t.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),t.prototype.style=function(t,e,i){return!1},t.prototype.dispose=function(){},t.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},t.test=function(t,e){return!1},t}(),$e=function(t){function e(e,i){var r=this,s=i||{},n=s.width,o=s.height;if(!n||!o)throw new Error("BufferResource width or height invalid");return(r=t.call(this,n,o)||this).data=e,r}return qe(e,t),e.prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===vt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,i.internalFormat,e.width,e.height,0,e.format,i.type,this.data)),!0},e.prototype.dispose=function(){this.data=null},e.test=function(t){return t instanceof Float32Array||t instanceof Uint8Array||t instanceof Uint32Array},e}(Ze),Je={scaleMode:ft.NEAREST,format:dt.RGBA,alphaMode:vt.NPM},Qe=function(t){function e(e,i){void 0===e&&(e=null),void 0===i&&(i=null);var r=t.call(this)||this,s=(i=i||{}).alphaMode,n=i.mipmap,o=i.anisotropicLevel,h=i.scaleMode,a=i.width,u=i.height,l=i.wrapMode,d=i.format,c=i.type,p=i.target,f=i.resolution,g=i.resourceOptions;return!e||e instanceof Ze||((e=Ye(e,g)).internal=!0),r.width=a||0,r.height=u||0,r.resolution=f||Et.RESOLUTION,r.mipmap=void 0!==n?n:Et.MIPMAP_TEXTURES,r.anisotropicLevel=void 0!==o?o:Et.ANISOTROPIC_LEVEL,r.wrapMode=l||Et.WRAP_MODE,r.scaleMode=void 0!==h?h:Et.SCALE_MODE,r.format=d||dt.RGBA,r.type=c||pt.UNSIGNED_BYTE,r.target=p||ct.TEXTURE_2D,r.alphaMode=void 0!==s?s:vt.UNPACK,void 0!==i.premultiplyAlpha&&(r.premultiplyAlpha=i.premultiplyAlpha),r.uid=me(),r.touched=0,r.isPowerOfTwo=!1,r._refreshPOT(),r._glTextures={},r.dirtyId=0,r.dirtyStyleId=0,r.cacheId=null,r.valid=a>0&&u>0,r.textureCacheIds=[],r.destroyed=!1,r.resource=null,r._batchEnabled=0,r._batchLocation=0,r.parentTextureArray=null,r.setResource(e),r}return qe(e,t),Object.defineProperty(e.prototype,"realWidth",{get:function(){return Math.ceil(this.width*this.resolution-1e-4)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"realHeight",{get:function(){return Math.ceil(this.height*this.resolution-1e-4)},enumerable:!1,configurable:!0}),e.prototype.setStyle=function(t,e){var i;return void 0!==t&&t!==this.scaleMode&&(this.scaleMode=t,i=!0),void 0!==e&&e!==this.mipmap&&(this.mipmap=e,i=!0),i&&this.dirtyStyleId++,this},e.prototype.setSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t,this.height=e,this._refreshPOT(),this.update(),this},e.prototype.setRealSize=function(t,e,i){return this.resolution=i||this.resolution,this.width=t/this.resolution,this.height=e/this.resolution,this._refreshPOT(),this.update(),this},e.prototype._refreshPOT=function(){this.isPowerOfTwo=ce(this.realWidth)&&ce(this.realHeight)},e.prototype.setResolution=function(t){var e=this.resolution;return e===t?this:(this.resolution=t,this.valid&&(this.width=this.width*e/t,this.height=this.height*e/t,this.emit("update",this)),this._refreshPOT(),this)},e.prototype.setResource=function(t){if(this.resource===t)return this;if(this.resource)throw new Error("Resource can be set only once");return t.bind(this),this.resource=t,this},e.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},e.prototype.onError=function(t){this.emit("error",this,t)},e.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete be[this.cacheId],delete Te[this.cacheId],this.cacheId=null),this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},e.prototype.dispose=function(){this.emit("dispose",this)},e.prototype.castToBaseTexture=function(){return this},e.from=function(t,i,r){void 0===r&&(r=Et.STRICT_TEXTURE_CACHE);var s="string"==typeof t,n=null;s?n=t:(t._pixiId||(t._pixiId="pixiid_"+me()),n=t._pixiId);var o=be[n];if(s&&r&&!o)throw new Error('The cacheId "'+n+'" does not exist in BaseTextureCache.');return o||((o=new e(t,i)).cacheId=n,e.addToCache(o,n)),o},e.fromBuffer=function(t,i,r,s){t=t||new Float32Array(i*r*4);var n=new $e(t,{width:i,height:r}),o=t instanceof Float32Array?pt.FLOAT:pt.UNSIGNED_BYTE;return new e(n,Object.assign(Je,s||{width:i,height:r,type:o}))},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),be[e]&&console.warn("BaseTexture added to the cache with an id ["+e+"] that already had an entry"),be[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=be[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete be[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)delete be[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},e._globalBatch=0,e}(At),ti=function(t){function e(e,i){var r=this,s=i||{},n=s.width,o=s.height;(r=t.call(this,n,o)||this).items=[],r.itemDirtyIds=[];for(var h=0;h<e;h++){var a=new Qe;r.items.push(a),r.itemDirtyIds.push(-2)}return r.length=e,r._load=null,r.baseTexture=null,r}return qe(e,t),e.prototype.initFromArray=function(t,e){for(var i=0;i<this.length;i++)t[i]&&(t[i].castToBaseTexture?this.addBaseTextureAt(t[i].castToBaseTexture(),i):t[i]instanceof Ze?this.addResourceAt(t[i],i):this.addResourceAt(Ye(t[i],e),i))},e.prototype.dispose=function(){for(var t=0,e=this.length;t<e;t++)this.items[t].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},e.prototype.addResourceAt=function(t,e){if(!this.items[e])throw new Error("Index "+e+" is out of bounds");return t.valid&&!this.valid&&this.resize(t.width,t.height),this.items[e].setResource(t),this},e.prototype.bind=function(e){if(null!==this.baseTexture)throw new Error("Only one base texture per TextureArray is allowed");t.prototype.bind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=e,this.items[i].on("update",e.update,e)},e.prototype.unbind=function(e){t.prototype.unbind.call(this,e);for(var i=0;i<this.length;i++)this.items[i].parentTextureArray=null,this.items[i].off("update",e.update,e)},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.items.map(function(t){return t.resource}).filter(function(t){return t}).map(function(t){return t.load()});return this._load=Promise.all(e).then(function(){var e=t.items[0],i=e.realWidth,r=e.realHeight;return t.resize(i,r),Promise.resolve(t)}),this._load},e}(Ze),ii=function(t){function e(e,i){var r,s,n=this,o=i||{},h=o.width,a=o.height;return Array.isArray(e)?(r=e,s=e.length):s=e,n=t.call(this,s,{width:h,height:a})||this,r&&n.initFromArray(r,i),n}return qe(e,t),e.prototype.addBaseTextureAt=function(t,e){if(!t.resource)throw new Error("ArrayResource does not support RenderTexture");return this.addResourceAt(t.resource,e),this},e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=ct.TEXTURE_2D_ARRAY},e.prototype.upload=function(t,e,i){var r=this.length,s=this.itemDirtyIds,n=this.items,o=t.gl;i.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,e.format,this._width,this._height,r,0,e.format,e.type,null);for(var h=0;h<r;h++){var a=n[h];s[h]<a.dirtyId&&(s[h]=a.dirtyId,a.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,h,a.resource.width,a.resource.height,1,e.format,e.type,a.resource.source))}return!0},e}(ti),ri=function(t){function e(e){var i=this,r=e,s=r.naturalWidth||r.videoWidth||r.width,n=r.naturalHeight||r.videoHeight||r.height;return(i=t.call(this,s,n)||this).source=e,i.noSubImage=!1,i}return qe(e,t),e.crossOrigin=function(t,e,i){void 0===i&&0!==e.indexOf("data:")?t.crossOrigin=we(e):!1!==i&&(t.crossOrigin="string"==typeof i?i:"anonymous")},e.prototype.upload=function(t,e,i,r){var s=t.gl,n=e.realWidth,o=e.realHeight;return r=r||this.source,s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===vt.UNPACK),this.noSubImage||e.target!==s.TEXTURE_2D||i.width!==n||i.height!==o?(i.width=n,i.height=o,s.texImage2D(e.target,0,e.format,e.format,e.type,r)):s.texSubImage2D(s.TEXTURE_2D,0,0,0,e.format,e.type,r),!0},e.prototype.update=function(){if(!this.destroyed){var e=this.source,i=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(i,r),t.prototype.update.call(this)}},e.prototype.dispose=function(){this.source=null},e}(Ze),si=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qe(e,t),e.test=function(t){var e=window.OffscreenCanvas;return!!(e&&t instanceof e)||t instanceof HTMLCanvasElement},e}(ri),ni=function(t){function e(i,r){var s=this,n=r||{},o=n.width,h=n.height,a=n.autoLoad,u=n.linkBaseTexture;if(i&&i.length!==e.SIDES)throw new Error("Invalid length. Got "+i.length+", expected 6");s=t.call(this,6,{width:o,height:h})||this;for(var l=0;l<e.SIDES;l++)s.items[l].target=ct.TEXTURE_CUBE_MAP_POSITIVE_X+l;return s.linkBaseTexture=!1!==u,i&&s.initFromArray(i,r),!1!==a&&s.load(),s}return qe(e,t),e.prototype.bind=function(e){t.prototype.bind.call(this,e),e.target=ct.TEXTURE_CUBE_MAP},e.prototype.addBaseTextureAt=function(t,e,i){if(void 0===i&&(i=this.linkBaseTexture),!this.items[e])throw new Error("Index "+e+" is out of bounds");if(!this.linkBaseTexture||t.parentTextureArray||Object.keys(t._glTextures).length>0){if(!t.resource)throw new Error("CubeResource does not support copying of renderTexture.");this.addResourceAt(t.resource,e)}else t.target=ct.TEXTURE_CUBE_MAP_POSITIVE_X+e,t.parentTextureArray=this.baseTexture,this.items[e]=t;return t.valid&&!this.valid&&this.resize(t.realWidth,t.realHeight),this.items[e]=t,this},e.prototype.upload=function(t,i,r){for(var s=this.itemDirtyIds,n=0;n<e.SIDES;n++){var o=this.items[n];s[n]<o.dirtyId&&(o.valid&&o.resource?(o.resource.upload(t,o,r),s[n]=o.dirtyId):s[n]<-1&&(t.gl.texImage2D(o.target,0,r.internalFormat,i.realWidth,i.realHeight,0,i.format,r.type,null),s[n]=-1))}return!0},e.test=function(t){return Array.isArray(t)&&t.length===e.SIDES},e.SIDES=6,e}(ti),oi=function(t){function e(e,i){var r=this;if(i=i||{},!(e instanceof HTMLImageElement)){var s=new Image;ri.crossOrigin(s,e,i.crossorigin),s.src=e,e=s}return r=t.call(this,e)||this,!e.complete&&r._width&&r._height&&(r._width=0,r._height=0),r.url=e.src,r._process=null,r.preserveBitmap=!1,r.createBitmap=(void 0!==i.createBitmap?i.createBitmap:Et.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,r.alphaMode="number"==typeof i.alphaMode?i.alphaMode:null,void 0!==i.premultiplyAlpha&&(r.premultiplyAlpha=i.premultiplyAlpha),r.bitmap=null,r._load=null,!1!==i.autoLoad&&r.load(),r}return qe(e,t),e.prototype.load=function(t){var e=this;return this._load?this._load:(void 0!==t&&(this.createBitmap=t),this._load=new Promise(function(t,i){var r=e.source;e.url=r.src;var s=function(){e.destroyed||(r.onload=null,r.onerror=null,e.resize(r.width,r.height),e._load=null,e.createBitmap?t(e.process()):t(e))};r.complete&&r.src?s():(r.onload=s,r.onerror=function(t){i(t),e.onError.emit(t)})}),this._load)},e.prototype.process=function(){var t=this,e=this.source;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(e,0,0,e.width,e.height,{premultiplyAlpha:this.alphaMode===vt.UNPACK?"premultiply":"none"}).then(function(e){return t.destroyed?Promise.reject():(t.bitmap=e,t.update(),t._process=null,Promise.resolve(t))}),this._process):Promise.resolve(this)},e.prototype.upload=function(e,i,r){if("number"==typeof this.alphaMode&&(i.alphaMode=this.alphaMode),!this.createBitmap)return t.prototype.upload.call(this,e,i,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(t.prototype.upload.call(this,e,i,r,this.bitmap),!this.preserveBitmap){var s=!0,n=i._glTextures;for(var o in n){var h=n[o];if(h!==r&&h.dirtyId!==i.dirtyId){s=!1;break}}s&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},e.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,t.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},e.test=function(t){return"string"==typeof t||t instanceof HTMLImageElement},e}(ri),hi=function(t){function e(e,i){var r=this;return i=i||{},(r=t.call(this,document.createElement("canvas"))||this)._width=0,r._height=0,r.svg=e,r.scale=i.scale||1,r._overrideWidth=i.width,r._overrideHeight=i.height,r._resolve=null,r._crossorigin=i.crossorigin,r._load=null,!1!==i.autoLoad&&r.load(),r}return qe(e,t),e.prototype.load=function(){var t=this;return this._load?this._load:(this._load=new Promise(function(e){if(t._resolve=function(){t.resize(t.source.width,t.source.height),e(t)},/^\<svg/.test(t.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");t.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t.svg)))}t._loadSvg()}),this._load)},e.prototype._loadSvg=function(){var t=this,e=new Image;ri.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=function(i){t._resolve&&(e.onerror=null,t.onError.emit(i))},e.onload=function(){if(t._resolve){var i=e.width,r=e.height;if(!i||!r)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var s=i*t.scale,n=r*t.scale;(t._overrideWidth||t._overrideHeight)&&(s=t._overrideWidth||t._overrideHeight/r*i,n=t._overrideHeight||t._overrideWidth/i*r),s=Math.round(s),n=Math.round(n);var o=t.source;o.width=s,o.height=n,o._pixiId="canvas_"+me(),o.getContext("2d").drawImage(e,0,0,i,r,0,0,s,n),t._resolve(),t._resolve=null}}},e.getSize=function(t){var i=e.SVG_SIZE.exec(t),r={};return i&&(r[i[1]]=Math.round(parseFloat(i[3])),r[i[5]]=Math.round(parseFloat(i[7]))),r},e.prototype.dispose=function(){t.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},e.test=function(t,e){return"svg"===e||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},e.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,e}(ri),ai=function(t){function e(i,r){var s=this;if(r=r||{},!(i instanceof HTMLVideoElement)){var n=document.createElement("video");n.setAttribute("preload","auto"),n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),"string"==typeof i&&(i=[i]);var o=i[0].src||i[0];ri.crossOrigin(n,o,r.crossorigin);for(var h=0;h<i.length;++h){var a=document.createElement("source"),u=i[h],l=u.src,d=u.mime,c=(l=l||i[h]).split("?").shift().toLowerCase(),p=c.substr(c.lastIndexOf(".")+1);d=d||e.MIME_TYPES[p]||"video/"+p,a.src=l,a.type=d,n.appendChild(a)}i=n}return(s=t.call(this,i)||this).noSubImage=!0,s._autoUpdate=!0,s._isConnectedToTicker=!1,s._updateFPS=r.updateFPS||0,s._msToNextUpdate=0,s.autoPlay=!1!==r.autoPlay,s._load=null,s._resolve=null,s._onCanPlay=s._onCanPlay.bind(s),s._onError=s._onError.bind(s),!1!==r.autoLoad&&s.load(),s}return qe(e,t),e.prototype.update=function(e){if(!this.destroyed){var i=Oe.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-i),(!this._updateFPS||this._msToNextUpdate<=0)&&(t.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},e.prototype.load=function(){var t=this;if(this._load)return this._load;var e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart.bind(this)),e.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise(function(i){t.valid?i(t):(t._resolve=i,e.load())}),this._load},e.prototype._onError=function(t){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(t)},e.prototype._isSourcePlaying=function(){var t=this.source;return t.currentTime>0&&!1===t.paused&&!1===t.ended&&t.readyState>2},e.prototype._isSourceReady=function(){var t=this.source;return 3===t.readyState||4===t.readyState},e.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(Oe.shared.add(this.update,this),this._isConnectedToTicker=!0)},e.prototype._onPlayStop=function(){this._isConnectedToTicker&&(Oe.shared.remove(this.update,this),this._isConnectedToTicker=!1)},e.prototype._onCanPlay=function(){var t=this.source;t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlay);var e=this.valid;this.resize(t.videoWidth,t.videoHeight),!e&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&t.play()},e.prototype.dispose=function(){this._isConnectedToTicker&&Oe.shared.remove(this.update,this);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),t.prototype.dispose.call(this)},Object.defineProperty(e.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(t){t!==this._autoUpdate&&(this._autoUpdate=t,!this._autoUpdate&&this._isConnectedToTicker?(Oe.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(Oe.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(t){t!==this._updateFPS&&(this._updateFPS=t)},enumerable:!1,configurable:!0}),e.test=function(t,i){return t instanceof HTMLVideoElement||e.TYPES.indexOf(i)>-1},e.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],e.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},e}(ri),ui=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qe(e,t),e.test=function(t){return!!window.createImageBitmap&&t instanceof ImageBitmap},e}(ri);ze.push(oi,ui,si,ai,hi,$e,ni,ii);var li=function(){function t(t){this.renderer=t}return t.prototype.destroy=function(){this.renderer=null},t}(),di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return qe(e,t),e.prototype.upload=function(t,e,i){var r=t.gl;return r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.alphaMode===vt.UNPACK),i.width===e.width&&i.height===e.height?r.texSubImage2D(e.target,0,0,0,e.width,e.height,e.format,e.type,this.data):(i.width=e.width,i.height=e.height,r.texImage2D(e.target,0,1===t.context.webGLVersion?r.DEPTH_COMPONENT:r.DEPTH_COMPONENT16,e.width,e.height,0,e.format,e.type,this.data)),!0},e}($e),ci=function(){function t(t,e){this.width=Math.ceil(t||100),this.height=Math.ceil(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Ie("disposeFramebuffer"),this.multisample=bt.NONE}return Object.defineProperty(t.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),t.prototype.addColorTexture=function(t,e){return void 0===t&&(t=0),this.colorTextures[t]=e||new Qe(null,{scaleMode:ft.NEAREST,resolution:1,mipmap:mt.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Qe(new di(null,{width:this.width,height:this.height}),{scaleMode:ft.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:mt.OFF,format:dt.DEPTH_COMPONENT,type:pt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},t.prototype.resize=function(t,e){if(t=Math.ceil(t),e=Math.ceil(e),t!==this.width||e!==this.height){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var i=0;i<this.colorTextures.length;i++){var r=this.colorTextures[i],s=r.resolution;r.setSize(t/s,e/s)}if(this.depthTexture){s=this.depthTexture.resolution;this.depthTexture.setSize(t/s,e/s)}}},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},t}(),pi=function(t){function e(e){var i=this;"number"==typeof e&&(e={width:arguments[0],height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]});i=t.call(this,null,e)||this;var r=e||{},s=r.width,n=r.height;return i.mipmap=0,i.width=Math.ceil(s)||100,i.height=Math.ceil(n)||100,i.valid=!0,i.clearColor=[0,0,0,0],i.framebuffer=new ci(i.width*i.resolution,i.height*i.resolution).addColorTexture(0,i),i.maskStack=[],i.filterStack=[{}],i}return qe(e,t),e.prototype.resize=function(t,e){t=Math.ceil(t),e=Math.ceil(e),this.framebuffer.resize(t*this.resolution,e*this.resolution)},e.prototype.dispose=function(){this.framebuffer.dispose(),t.prototype.dispose.call(this)},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},e}(Qe),fi=function(){function t(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return t.prototype.set=function(t,e,i){var r=e.width,s=e.height;if(i){var n=t.width/2/r,o=t.height/2/s,h=t.x/r+n,a=t.y/s+o;i=Xe.add(i,Xe.NW),this.x0=h+n*Xe.uX(i),this.y0=a+o*Xe.uY(i),i=Xe.add(i,2),this.x1=h+n*Xe.uX(i),this.y1=a+o*Xe.uY(i),i=Xe.add(i,2),this.x2=h+n*Xe.uX(i),this.y2=a+o*Xe.uY(i),i=Xe.add(i,2),this.x3=h+n*Xe.uX(i),this.y3=a+o*Xe.uY(i)}else this.x0=t.x/r,this.y0=t.y/s,this.x1=(t.x+t.width)/r,this.y1=t.y/s,this.x2=(t.x+t.width)/r,this.y2=(t.y+t.height)/s,this.x3=t.x/r,this.y3=(t.y+t.height)/s;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},t}(),gi=new fi,mi=function(t){function e(i,r,s,n,o,h){var a=t.call(this)||this;if(a.noFrame=!1,r||(a.noFrame=!0,r=new Le(0,0,1,1)),i instanceof e&&(i=i.baseTexture),a.baseTexture=i,a._frame=r,a.trim=n,a.valid=!1,a._uvs=gi,a.uvMatrix=null,a.orig=s||r,a._rotate=Number(o||0),!0===o)a._rotate=2;else if(a._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return a.defaultAnchor=h?new Pe(h.x,h.y):new Pe(0,0),a._updateID=0,a.textureCacheIds=[],i.valid?a.noFrame?i.valid&&a.onBaseTextureUpdated(i):a.frame=r:i.once("loaded",a.onBaseTextureUpdated,a),a.noFrame&&i.on("update",a.onBaseTextureUpdated,a),a}return qe(e,t),e.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},e.prototype.onBaseTextureUpdated=function(t){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=t.width,this._frame.height=t.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},e.prototype.destroy=function(t){if(this.baseTexture){if(t){var i=this.baseTexture;i&&i.url&&Te[i.url]&&e.removeFromCache(i.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,e.removeFromCache(this),this.textureCacheIds=null},e.prototype.clone=function(){return new e(this.baseTexture,this.frame.clone(),this.orig.clone(),this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor)},e.prototype.updateUvs=function(){this._uvs===gi&&(this._uvs=new fi),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},e.from=function(t,i,r){void 0===i&&(i={}),void 0===r&&(r=Et.STRICT_TEXTURE_CACHE);var s="string"==typeof t,n=null;s?n=t:(t._pixiId||(t._pixiId="pixiid_"+me()),n=t._pixiId);var o=Te[n];if(s&&r&&!o)throw new Error('The cacheId "'+n+'" does not exist in TextureCache.');return o||(i.resolution||(i.resolution=Ce(t)),(o=new e(new Qe(t,i))).baseTexture.cacheId=n,Qe.addToCache(o.baseTexture,n),e.addToCache(o,n)),o},e.fromURL=function(t,i){var r=Object.assign({autoLoad:!1},null==i?void 0:i.resourceOptions),s=e.from(t,Object.assign({resourceOptions:r},i),!1),n=s.baseTexture.resource;return s.baseTexture.valid?Promise.resolve(s):n.load().then(function(){return Promise.resolve(s)})},e.fromBuffer=function(t,i,r,s){return new e(Qe.fromBuffer(t,i,r,s))},e.fromLoader=function(t,i,r){var s=new oi(t);s.url=i;var n=new e(new Qe(s,{scaleMode:Et.SCALE_MODE,resolution:Ce(i)}));return r||(r=i),Qe.addToCache(n.baseTexture,r),e.addToCache(n,r),r!==i&&(Qe.addToCache(n.baseTexture,i),e.addToCache(n,i)),n},e.addToCache=function(t,e){e&&(-1===t.textureCacheIds.indexOf(e)&&t.textureCacheIds.push(e),Te[e]&&console.warn("Texture added to the cache with an id ["+e+"] that already had an entry"),Te[e]=t)},e.removeFromCache=function(t){if("string"==typeof t){var e=Te[t];if(e){var i=e.textureCacheIds.indexOf(t);return i>-1&&e.textureCacheIds.splice(i,1),delete Te[t],e}}else if(t&&t.textureCacheIds){for(var r=0;r<t.textureCacheIds.length;++r)Te[t.textureCacheIds[r]]===t&&delete Te[t.textureCacheIds[r]];return t.textureCacheIds.length=0,t}return null},Object.defineProperty(e.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frame",{get:function(){return this._frame},set:function(t){this._frame=t,this.noFrame=!1;var e=t.x,i=t.y,r=t.width,s=t.height,n=e+r>this.baseTexture.width,o=i+s>this.baseTexture.height;if(n||o){var h=n&&o?"and":"or",a="X: "+e+" + "+r+" = "+(e+r)+" > "+this.baseTexture.width,u="Y: "+i+" + "+s+" = "+(i+s)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+a+" "+h+" "+u)}this.valid=r&&s&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=t),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotate",{get:function(){return this._rotate},set:function(t){this._rotate=t,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),e.prototype.castToBaseTexture=function(){return this.baseTexture},e}(At);function vi(){var t=document.createElement("canvas");t.width=16,t.height=16;var e=t.getContext("2d");return e.fillStyle="white",e.fillRect(0,0,16,16),new mi(new Qe(new si(t)))}function yi(t){t.destroy=function(){},t.on=function(){},t.once=function(){},t.emit=function(){}}mi.EMPTY=new mi(new Qe),yi(mi.EMPTY),yi(mi.EMPTY.baseTexture),mi.WHITE=vi(),yi(mi.WHITE),yi(mi.WHITE.baseTexture);var _i=function(t){function e(e,i){var r=this,s=null;if(!(e instanceof pi)){var n=arguments[1],o=arguments[2],h=arguments[3],a=arguments[4];console.warn("Please use RenderTexture.create("+n+", "+o+") instead of the ctor directly."),s=arguments[0],i=null,e=new pi({width:n,height:o,scaleMode:h,resolution:a})}return(r=t.call(this,e,i)||this).legacyRenderer=s,r.valid=!0,r.filterFrame=null,r.filterPoolKey=null,r.updateUvs(),r}return qe(e,t),Object.defineProperty(e.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e,i){void 0===i&&(i=!0),t=Math.ceil(t),e=Math.ceil(e),this.valid=t>0&&e>0,this._frame.width=this.orig.width=t,this._frame.height=this.orig.height=e,i&&this.baseTexture.resize(t,e),this.updateUvs()},e.prototype.setResolution=function(t){var e=this.baseTexture;e.resolution!==t&&(e.setResolution(t),this.resize(e.width,e.height,!1))},e.create=function(t){return"number"==typeof t&&(t={width:t,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new e(new pi(t))},e}(mi),xi=function(){function t(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return t.prototype.createTexture=function(t,e){var i=new pi(Object.assign({width:t,height:e,resolution:1},this.textureOptions));return new _i(i)},t.prototype.getOptimalTexture=function(e,i,r){void 0===r&&(r=1);var s=t.SCREEN_KEY;e*=r,i*=r,this.enableFullScreen&&e===this._pixelsWidth&&i===this._pixelsHeight||(s=(65535&(e=de(e)))<<16|65535&(i=de(i))),this.texturePool[s]||(this.texturePool[s]=[]);var n=this.texturePool[s].pop();return n||(n=this.createTexture(e,i)),n.filterPoolKey=s,n.setResolution(r),n},t.prototype.getFilterTexture=function(t,e){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution);return i.filterFrame=t.filterFrame,i},t.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},t.prototype.returnFilterTexture=function(t){this.returnTexture(t)},t.prototype.clear=function(t){if(t=!1!==t)for(var e in this.texturePool){var i=this.texturePool[e];if(i)for(var r=0;r<i.length;r++)i[r].destroy(!0)}this.texturePool={}},t.prototype.setScreenSize=function(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){var i=t.SCREEN_KEY,r=this.texturePool[i];if(this.enableFullScreen=e.width>0&&e.height>0,r)for(var s=0;s<r.length;s++)r[s].destroy(!0);this.texturePool[i]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},t.SCREEN_KEY="screen",t}(),Ti=function(){function t(t,e,i,r,s,n,o){void 0===e&&(e=0),void 0===i&&(i=!1),void 0===r&&(r=5126),this.buffer=t,this.size=e,this.normalized=i,this.type=r,this.stride=s,this.start=n,this.instance=o}return t.prototype.destroy=function(){this.buffer=null},t.from=function(e,i,r,s,n){return new t(e,i,r,s,n)},t}(),bi=0,Ei=function(){function t(t,e,i){void 0===e&&(e=!0),void 0===i&&(i=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=i,this.static=e,this.id=bi++,this.disposeRunner=new Ie("disposeBuffer")}return t.prototype.update=function(t){this.data=t||this.data,this._updateID++},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.data=null},t.from=function(e){return e instanceof Array&&(e=new Float32Array(e)),new t(e)},t}();function wi(t){if(4===t.BYTES_PER_ELEMENT)return t instanceof Float32Array?"Float32Array":t instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===t.BYTES_PER_ELEMENT){if(t instanceof Uint16Array)return"Uint16Array"}else if(1===t.BYTES_PER_ELEMENT&&t instanceof Uint8Array)return"Uint8Array";return null}var Ci={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function Ai(t,e){for(var i=0,r=0,s={},n=0;n<t.length;n++)r+=e[n],i+=t[n].length;var o=new ArrayBuffer(4*i),h=null,a=0;for(n=0;n<t.length;n++){var u=e[n],l=t[n],d=wi(l);s[d]||(s[d]=new Ci[d](o)),h=s[d];for(var c=0;c<l.length;c++){h[(c/u|0)*r+a+c%u]=l[c]}a+=u}return new Float32Array(o)}var Ii={5126:4,5123:2,5121:1},Mi=0,Si={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},Oi=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=Mi++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Ie("disposeGeometry"),this.refCount=0}return t.prototype.addAttribute=function(t,e,i,r,s,n,o,h){if(void 0===i&&(i=0),void 0===r&&(r=!1),void 0===h&&(h=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof Ei||(e instanceof Array&&(e=new Float32Array(e)),e=new Ei(e));var a=t.split("|");if(a.length>1){for(var u=0;u<a.length;u++)this.addAttribute(a[u],e,i,r,s);return this}var l=this.buffers.indexOf(e);return-1===l&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Ti(l,i,r,s,n,o,h),this.instanced=this.instanced||h,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},t.prototype.addIndex=function(t){return t instanceof Ei||(t instanceof Array&&(t=new Uint16Array(t)),t=new Ei(t)),t.index=!0,this.indexBuffer=t,-1===this.buffers.indexOf(t)&&this.buffers.push(t),this},t.prototype.getIndex=function(){return this.indexBuffer},t.prototype.interleave=function(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var t,e=[],i=[],r=new Ei;for(t in this.attributes){var s=this.attributes[t],n=this.buffers[s.buffer];e.push(n.data),i.push(s.size*Ii[s.type]/4),s.buffer=0}for(r.data=Ai(e,i),t=0;t<this.buffers.length;t++)this.buffers[t]!==this.indexBuffer&&this.buffers[t].destroy();return this.buffers=[r],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},t.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t];return this.buffers[e.buffer].data.length/(e.stride/4||e.size)}return 0},t.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},t.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},t.prototype.clone=function(){for(var e=new t,i=0;i<this.buffers.length;i++)e.buffers[i]=new Ei(this.buffers[i].data.slice(0));for(var i in this.attributes){var r=this.attributes[i];e.attributes[i]=new Ti(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},t.merge=function(e){for(var i,r=new t,s=[],n=[],o=[],h=0;h<e.length;h++){i=e[h];for(var a=0;a<i.buffers.length;a++)n[a]=n[a]||0,n[a]+=i.buffers[a].data.length,o[a]=0}for(h=0;h<i.buffers.length;h++)s[h]=new(Si[wi(i.buffers[h].data)])(n[h]),r.buffers[h]=new Ei(s[h]);for(h=0;h<e.length;h++){i=e[h];for(a=0;a<i.buffers.length;a++)s[a].set(i.buffers[a].data,o[a]),o[a]+=i.buffers[a].data.length}if(r.attributes=i.attributes,i.indexBuffer){r.indexBuffer=r.buffers[i.buffers.indexOf(i.indexBuffer)],r.indexBuffer.index=!0;var u=0,l=0,d=0,c=0;for(h=0;h<i.buffers.length;h++)if(i.buffers[h]!==i.indexBuffer){c=h;break}for(var h in i.attributes){var p=i.attributes[h];(0|p.buffer)===c&&(l+=p.size*Ii[p.type]/4)}for(h=0;h<e.length;h++){var f=e[h].indexBuffer.data;for(a=0;a<f.length;a++)r.indexBuffer.data[a+d]+=u;u+=i.buffers[c].data.length/l,d+=f.length}}return r},t}(),Ri=function(t){function e(){var e=t.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return qe(e,t),e}(Oi),Li=function(t){function e(){var e=t.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new Ei(e.vertices),e.uvBuffer=new Ei(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return qe(e,t),e.prototype.map=function(t,e){var i=0,r=0;return this.uvs[0]=i,this.uvs[1]=r,this.uvs[2]=i+e.width/t.width,this.uvs[3]=r,this.uvs[4]=i+e.width/t.width,this.uvs[5]=r+e.height/t.height,this.uvs[6]=i,this.uvs[7]=r+e.height/t.height,i=e.x,r=e.y,this.vertices[0]=i,this.vertices[1]=r,this.vertices[2]=i+e.width,this.vertices[3]=r,this.vertices[4]=i+e.width,this.vertices[5]=r+e.height,this.vertices[6]=i,this.vertices[7]=r+e.height,this.invalidate(),this},e.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},e}(Oi),Pi=0,Ni=function(){function t(t,e){this.uniforms=t,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=Pi++,this.static=!!e}return t.prototype.update=function(){this.dirtyId++},t.prototype.add=function(e,i,r){this.uniforms[e]=new t(i,r)},t.from=function(e,i){return new t(e,i)},t}(),Di=function(){function t(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new Le,this.destinationFrame=new Le,this.filters=[]}return t.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},t}(),Fi=function(t){function e(e){var i=t.call(this,e)||this;return i.defaultFilterStack=[{}],i.texturePool=new xi,i.texturePool.setScreenSize(e.view),i.statePool=[],i.quad=new Ri,i.quadUv=new Li,i.tempRect=new Le,i.activeState={},i.globalUniforms=new Ni({outputFrame:i.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),i.forceClear=!1,i.useMaxPadding=!1,i}return qe(e,t),e.prototype.push=function(t,e){for(var i=this.renderer,r=this.defaultFilterStack,s=this.statePool.pop()||new Di,n=e[0].resolution,o=e[0].padding,h=e[0].autoFit,a=e[0].legacy,u=1;u<e.length;u++){var l=e[u];n=Math.min(n,l.resolution),o=this.useMaxPadding?Math.max(o,l.padding):o+l.padding,h=h||l.autoFit,a=a||l.legacy}1===r.length&&(this.defaultFilterStack[0].renderTexture=i.renderTexture.current),r.push(s),s.resolution=n,s.legacy=a,s.target=t,s.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),s.sourceFrame.pad(o),h&&s.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),s.sourceFrame.ceil(n),s.renderTexture=this.getOptimalFilterTexture(s.sourceFrame.width,s.sourceFrame.height,n),s.filters=e,s.destinationFrame.width=s.renderTexture.width,s.destinationFrame.height=s.renderTexture.height;var d=this.tempRect;d.width=s.sourceFrame.width,d.height=s.sourceFrame.height,s.renderTexture.filterFrame=s.sourceFrame,i.renderTexture.bind(s.renderTexture,s.sourceFrame,d),i.renderTexture.clear()},e.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),i=e.filters;this.activeState=e;var r=this.globalUniforms.uniforms;r.outputFrame=e.sourceFrame,r.resolution=e.resolution;var s=r.inputSize,n=r.inputPixel,o=r.inputClamp;if(s[0]=e.destinationFrame.width,s[1]=e.destinationFrame.height,s[2]=1/s[0],s[3]=1/s[1],n[0]=s[0]*e.resolution,n[1]=s[1]*e.resolution,n[2]=1/n[0],n[3]=1/n[1],o[0]=.5*n[2],o[1]=.5*n[3],o[2]=e.sourceFrame.width*s[2]-.5*n[2],o[3]=e.sourceFrame.height*s[3]-.5*n[3],e.legacy){var h=r.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,r.filterClamp=r.inputClamp}this.globalUniforms.update();var a=t[t.length-1];if(e.renderTexture.framebuffer.multisample>1&&this.renderer.framebuffer.blit(),1===i.length)i[0].apply(this,e.renderTexture,a.renderTexture,yt.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var u=e.renderTexture,l=this.getOptimalFilterTexture(u.width,u.height,e.resolution);l.filterFrame=u.filterFrame;var d=0;for(d=0;d<i.length-1;++d){i[d].apply(this,u,l,yt.CLEAR,e);var c=u;u=l,l=c}i[d].apply(this,u,a.renderTexture,yt.BLEND,e),this.returnFilterTexture(u),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},e.prototype.bindAndClear=function(t,e){if(void 0===e&&(e=yt.CLEAR),t&&t.filterFrame){var i=this.tempRect;i.width=t.filterFrame.width,i.height=t.filterFrame.height,this.renderer.renderTexture.bind(t,t.filterFrame,i)}else this.renderer.renderTexture.bind(t);"boolean"==typeof e&&(e=e?yt.CLEAR:yt.BLEND,ye("5.2.1","Use CLEAR_MODES when using clear applyFilter option")),(e===yt.CLEAR||e===yt.BLIT&&this.forceClear)&&this.renderer.renderTexture.clear()},e.prototype.applyFilter=function(t,e,i,r){var s=this.renderer;this.bindAndClear(i,r),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,s.state.set(t.state),s.shader.bind(t),t.legacy?(this.quadUv.map(e._frame,e.filterFrame),s.geometry.bind(this.quadUv),s.geometry.draw(lt.TRIANGLES)):(s.geometry.bind(this.quad),s.geometry.draw(lt.TRIANGLE_STRIP))},e.prototype.calculateSpriteMatrix=function(t,e){var i=this.activeState,r=i.sourceFrame,s=i.destinationFrame,n=e._texture.orig,o=t.set(s.width,0,0,s.height,r.x,r.y),h=e.worldTransform.copyTo(De.TEMP_MATRIX);return h.invert(),o.prepend(h),o.scale(1/n.width,1/n.height),o.translate(e.anchor.x,e.anchor.y),o},e.prototype.destroy=function(){this.texturePool.clear(!1)},e.prototype.getOptimalFilterTexture=function(t,e,i){return void 0===i&&(i=1),this.texturePool.getOptimalTexture(t,e,i)},e.prototype.getFilterTexture=function(t,e){if("number"==typeof t){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var r=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution);return r.filterFrame=t.filterFrame,r},e.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},e.prototype.emptyPool=function(){this.texturePool.clear(!0)},e.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},e}(li),ki=function(){function t(t){this.renderer=t}return t.prototype.flush=function(){},t.prototype.destroy=function(){this.renderer=null},t.prototype.start=function(){},t.prototype.stop=function(){this.flush()},t.prototype.render=function(t){},t}(),Ui=function(t){function e(e){var i=t.call(this,e)||this;return i.emptyRenderer=new ki(e),i.currentRenderer=i.emptyRenderer,i}return qe(e,t),e.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},e.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},e.prototype.copyBoundTextures=function(t,e){for(var i=this.renderer.texture.boundTextures,r=e-1;r>=0;--r)t[r]=i[r]||null,t[r]&&(t[r]._batchLocation=r)},e.prototype.boundArray=function(t,e,i,r){for(var s=t.elements,n=t.ids,o=t.count,h=0,a=0;a<o;a++){var u=s[a],l=u._batchLocation;if(l>=0&&l<r&&e[l]===u)n[a]=l;else for(;h<r;){var d=e[h];if(!d||d._batchEnabled!==i||d._batchLocation!==h){n[a]=h,u._batchLocation=h,e[h]=u;break}h++}}},e}(li),Bi=0,Hi=function(t){function e(e){var i=t.call(this,e)||this;return i.webGLVersion=1,i.extensions={},i.supports={uint32Indices:!1},i.handleContextLost=i.handleContextLost.bind(i),i.handleContextRestored=i.handleContextRestored.bind(i),e.view.addEventListener("webglcontextlost",i.handleContextLost,!1),e.view.addEventListener("webglcontextrestored",i.handleContextRestored,!1),i}return qe(e,t),Object.defineProperty(e.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),e.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Bi++,t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").restoreContext()},e.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Bi++,this.renderer.runners.contextChange.emit(t)},e.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},e.prototype.createContext=function(t,e){var i;if(Et.PREFER_ENV>=ot.WEBGL2&&(i=t.getContext("webgl2",e)),i)this.webGLVersion=2;else if(this.webGLVersion=1,!(i=t.getContext("webgl",e)||t.getContext("experimental-webgl",e)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=i,this.getExtensions(),this.gl},e.prototype.getExtensions=function(){var t=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),loseContext:t.getExtension("WEBGL_lose_context"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:t.getExtension("EXT_color_buffer_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear")})},e.prototype.handleContextLost=function(t){t.preventDefault()},e.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},e.prototype.destroy=function(){var t=this.renderer.view;t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},e.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},e.prototype.validateContext=function(t){t.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var e="WebGL2RenderingContext"in window&&t instanceof window.WebGL2RenderingContext||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=e,e||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},e}(li),Gi=function(){return function(t){this.framebuffer=t,this.stencil=null,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.multisample=bt.NONE,this.msaaBuffer=null,this.blitFramebuffer=null}}(),Wi=new Le,Vi=function(t){function e(e){var i=t.call(this,e)||this;return i.managedFramebuffers=[],i.unknownFramebuffer=new ci(10,10),i.msaaSamples=null,i}return qe(e,t),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new Le,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var e=this.renderer.context.extensions.drawBuffers,i=this.renderer.context.extensions.depthTexture;Et.PREFER_ENV===ot.WEBGL_LEGACY&&(e=null,i=null),e?t.drawBuffers=function(t){return e.drawBuffersWEBGL(t)}:(this.hasMRT=!1,t.drawBuffers=function(){}),i||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},e.prototype.bind=function(t,e){var i=this.gl;if(t){var r=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer)),r.dirtyId!==t.dirtyId&&(r.dirtyId=t.dirtyId,r.dirtyFormat!==t.dirtyFormat?(r.dirtyFormat=t.dirtyFormat,this.updateFramebuffer(t)):r.dirtySize!==t.dirtySize&&(r.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var s=0;s<t.colorTextures.length;s++){var n=t.colorTextures[s];this.renderer.texture.unbind(n.parentTextureArray||n)}t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,t.width,t.height)}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},e.prototype.setViewport=function(t,e,i,r){var s=this.viewport;s.width===i&&s.height===r&&s.x===t&&s.y===e||(s.x=t,s.y=e,s.width=i,s.height=r,this.gl.viewport(t,e,i,r))},Object.defineProperty(e.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),e.prototype.clear=function(t,e,i,r,s){void 0===s&&(s=at.COLOR|at.DEPTH);var n=this.gl;n.clearColor(t,e,i,r),n.clear(s)},e.prototype.initFramebuffer=function(t){var e=this.gl,i=new Gi(e.createFramebuffer());return i.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=i,this.managedFramebuffers.push(t),t.disposeRunner.add(this),i},e.prototype.resizeFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID];i.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));for(var r=t.colorTextures,s=0;s<r.length;s++)this.renderer.texture.bind(r[s],0);t.depthTexture&&this.renderer.texture.bind(t.depthTexture,0)},e.prototype.updateFramebuffer=function(t){var e=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],r=t.colorTextures.length;e.drawBuffers||(r=Math.min(r,1)),i.multisample>1&&(i.msaaBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,i.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,i.multisample,e.RGBA8,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,i.msaaBuffer));for(var s=[],n=0;n<r;n++)if(!(0===n&&i.multisample>1)){var o=t.colorTextures[n],h=o.parentTextureArray||o;this.renderer.texture.bind(h,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+n,o.target,h._glTextures[this.CONTEXT_UID].texture,0),s.push(e.COLOR_ATTACHMENT0+n)}if((s.length>1&&e.drawBuffers(s),t.depthTexture)&&this.writeDepthTexture){var a=t.depthTexture;this.renderer.texture.bind(a,0),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a._glTextures[this.CONTEXT_UID].texture,0)}i.stencil||!t.stencil&&!t.depth||(i.stencil=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,i.stencil),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height),t.depthTexture||e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,i.stencil))},e.prototype.detectSamples=function(t){var e=this.msaaSamples,i=bt.NONE;if(t<=1||null===e)return i;for(var r=0;r<e.length;r++)if(e[r]<=t){i=e[r];break}return 1===i&&(i=bt.NONE),i},e.prototype.blit=function(t,e,i){var r=this.current,s=this.renderer,n=this.gl,o=this.CONTEXT_UID;if(2===s.context.webGLVersion&&r){var h=r.glFramebuffers[o];if(h){if(!t){if(h.multisample<=1)return;h.blitFramebuffer||(h.blitFramebuffer=new ci(r.width,r.height),h.blitFramebuffer.addColorTexture(0,r.colorTextures[0])),(t=h.blitFramebuffer).width=r.width,t.height=r.height}e||((e=Wi).width=r.width,e.height=r.height),i||(i=e);var a=e.width===i.width&&e.height===i.height;this.bind(t),n.bindFramebuffer(n.READ_FRAMEBUFFER,h.framebuffer),n.blitFramebuffer(e.x,e.y,e.width,e.height,i.x,i.y,i.width,i.height,n.COLOR_BUFFER_BIT,a?n.NEAREST:n.LINEAR)}}},e.prototype.disposeFramebuffer=function(t,e){var i=t.glFramebuffers[this.CONTEXT_UID],r=this.gl;if(i){delete t.glFramebuffers[this.CONTEXT_UID];var s=this.managedFramebuffers.indexOf(t);s>=0&&this.managedFramebuffers.splice(s,1),t.disposeRunner.remove(this),e||(r.deleteFramebuffer(i.framebuffer),i.stencil&&r.deleteRenderbuffer(i.stencil))}},e.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var i=0;i<e.length;i++)this.disposeFramebuffer(e[i],t)},e.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(e&&!e.stencil){t.enableStencil();var i=t.width,r=t.height,s=this.gl,n=s.createRenderbuffer();s.bindRenderbuffer(s.RENDERBUFFER,n),s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,i,r),e.stencil=n,s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,n)}}},e.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new Le},e}(li),Xi=function(){return function(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}(),ji={5126:4,5123:2,5121:1},zi=function(t){function e(e){var i=t.call(this,e)||this;return i._activeGeometry=null,i._activeVao=null,i.hasVao=!0,i.hasInstance=!0,i.canUseUInt32ElementIndex=!1,i.managedGeometries={},i.managedBuffers={},i}return qe(e,t),e.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!t.createVertexArray){var i=this.renderer.context.extensions.vertexArrayObject;Et.PREFER_ENV===ot.WEBGL_LEGACY&&(i=null),i?(t.createVertexArray=function(){return i.createVertexArrayOES()},t.bindVertexArray=function(t){return i.bindVertexArrayOES(t)},t.deleteVertexArray=function(t){return i.deleteVertexArrayOES(t)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(!t.vertexAttribDivisor){var r=t.getExtension("ANGLE_instanced_arrays");r?(t.vertexAttribDivisor=function(t,e){return r.vertexAttribDivisorANGLE(t,e)},t.drawElementsInstanced=function(t,e,i,s,n){return r.drawElementsInstancedANGLE(t,e,i,s,n)},t.drawArraysInstanced=function(t,e,i,s){return r.drawArraysInstancedANGLE(t,e,i,s)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===e.webGLVersion||!!e.extensions.uint32ElementIndex},e.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var i=this.gl,r=t.glVertexArrayObjects[this.CONTEXT_UID];r||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=r={});var s=r[e.program.id]||this.initGeometryVao(t,e.program);this._activeGeometry=t,this._activeVao!==s&&(this._activeVao=s,this.hasVao?i.bindVertexArray(s):this.activateVao(t,e.program)),this.updateBuffers()},e.prototype.reset=function(){this.unbind()},e.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.gl,i=0;i<t.buffers.length;i++){var r=t.buffers[i],s=r._glBuffers[this.CONTEXT_UID];if(r._updateID!==s.updateID){s.updateID=r._updateID;var n=r.index?e.ELEMENT_ARRAY_BUFFER:e.ARRAY_BUFFER;if(e.bindBuffer(n,s.buffer),this._boundBuffer=s,s.byteLength>=r.data.byteLength)e.bufferSubData(n,0,r.data);else{var o=r.static?e.STATIC_DRAW:e.DYNAMIC_DRAW;s.byteLength=r.data.byteLength,e.bufferData(n,r.data,o)}}}},e.prototype.checkCompatibility=function(t,e){var i=t.attributes,r=e.attributeData;for(var s in r)if(!i[s])throw new Error('shader and geometry incompatible, geometry missing the "'+s+'" attribute')},e.prototype.getSignature=function(t,e){var i=t.attributes,r=e.attributeData,s=["g",t.id];for(var n in i)r[n]&&s.push(n);return s.join("-")},e.prototype.initGeometryVao=function(t,e){this.checkCompatibility(t,e);var i=this.gl,r=this.CONTEXT_UID,s=this.getSignature(t,e),n=t.glVertexArrayObjects[this.CONTEXT_UID],o=n[s];if(o)return n[e.id]=o,o;var h=t.buffers,a=t.attributes,u={},l={};for(var d in h)u[d]=0,l[d]=0;for(var d in a)!a[d].size&&e.attributeData[d]?a[d].size=e.attributeData[d].size:a[d].size||console.warn("PIXI Geometry attribute '"+d+"' size cannot be determined (likely the bound shader does not have the attribute)"),u[a[d].buffer]+=a[d].size*ji[a[d].type];for(var d in a){var c=a[d],p=c.size;void 0===c.stride&&(u[c.buffer]===p*ji[c.type]?c.stride=0:c.stride=u[c.buffer]),void 0===c.start&&(c.start=l[c.buffer],l[c.buffer]+=p*ji[c.type])}o=i.createVertexArray(),i.bindVertexArray(o);for(var f=0;f<h.length;f++){var g=h[f];g._glBuffers[r]||(g._glBuffers[r]=new Xi(i.createBuffer()),this.managedBuffers[g.id]=g,g.disposeRunner.add(this)),g._glBuffers[r].refCount++}return this.activateVao(t,e),this._activeVao=o,n[e.id]=o,n[s]=o,o},e.prototype.disposeBuffer=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var i=t._glBuffers[this.CONTEXT_UID],r=this.gl;t.disposeRunner.remove(this),i&&(e||r.deleteBuffer(i.buffer),delete t._glBuffers[this.CONTEXT_UID])}},e.prototype.disposeGeometry=function(t,e){if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],r=this.gl,s=t.buffers;if(t.disposeRunner.remove(this),i){for(var n=0;n<s.length;n++){var o=s[n]._glBuffers[this.CONTEXT_UID];o.refCount--,0!==o.refCount||e||this.disposeBuffer(s[n],e)}if(!e)for(var h in i)if("g"===h[0]){var a=i[h];this._activeVao===a&&this.unbind(),r.deleteVertexArray(a)}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},e.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),i=0;i<e.length;i++)this.disposeGeometry(this.managedGeometries[e[i]],t);e=Object.keys(this.managedBuffers);for(i=0;i<e.length;i++)this.disposeBuffer(this.managedBuffers[e[i]],t)},e.prototype.activateVao=function(t,e){var i=this.gl,r=this.CONTEXT_UID,s=t.buffers,n=t.attributes;t.indexBuffer&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t.indexBuffer._glBuffers[r].buffer);var o=null;for(var h in n){var a=n[h],u=s[a.buffer]._glBuffers[r];if(e.attributeData[h]){o!==u&&(i.bindBuffer(i.ARRAY_BUFFER,u.buffer),o=u);var l=e.attributeData[h].location;if(i.enableVertexAttribArray(l),i.vertexAttribPointer(l,a.size,a.type||i.FLOAT,a.normalized,a.stride,a.start),a.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");i.vertexAttribDivisor(l,1)}}}},e.prototype.draw=function(t,e,i,r){var s=this.gl,n=this._activeGeometry;if(n.indexBuffer){var o=n.indexBuffer.data.BYTES_PER_ELEMENT,h=2===o?s.UNSIGNED_SHORT:s.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?n.instanced?s.drawElementsInstanced(t,e||n.indexBuffer.data.length,h,(i||0)*o,r||1):s.drawElements(t,e||n.indexBuffer.data.length,h,(i||0)*o):console.warn("unsupported index buffer type: uint32")}else n.instanced?s.drawArraysInstanced(t,i,e||n.getSize(),r||1):s.drawArrays(t,i,e||n.getSize());return this},e.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},e}(li),Yi=function(){function t(t){void 0===t&&(t=null),this.type=Tt.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null}return t.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Tt.NONE,this.autoDetect=!0),this._target=null},t.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},t}();function Ki(t,e,i){var r=t.createShader(e);return t.shaderSource(r,i),t.compileShader(r),r}function qi(t,e,i,r){var s=Ki(t,t.VERTEX_SHADER,e),n=Ki(t,t.FRAGMENT_SHADER,i),o=t.createProgram();if(t.attachShader(o,s),t.attachShader(o,n),r)for(var h in r)t.bindAttribLocation(o,r[h],h);return t.linkProgram(o),t.getProgramParameter(o,t.LINK_STATUS)||(t.getShaderParameter(s,t.COMPILE_STATUS)||(console.warn(e),console.error(t.getShaderInfoLog(s))),t.getShaderParameter(n,t.COMPILE_STATUS)||(console.warn(i),console.error(t.getShaderInfoLog(n))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",t.getProgramParameter(o,t.VALIDATE_STATUS)),console.error("gl.getError()",t.getError()),""!==t.getProgramInfoLog(o)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",t.getProgramInfoLog(o)),t.deleteProgram(o),o=null),t.deleteShader(s),t.deleteShader(n),o}function Zi(t){for(var e=new Array(t),i=0;i<e.length;i++)e[i]=!1;return e}function $i(t,e){switch(t){case"float":return 0;case"vec2":return new Float32Array(2*e);case"vec3":return new Float32Array(3*e);case"vec4":return new Float32Array(4*e);case"int":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*e);case"ivec3":return new Int32Array(3*e);case"ivec4":return new Int32Array(4*e);case"bool":return!1;case"bvec2":return Zi(2*e);case"bvec3":return Zi(3*e);case"bvec4":return Zi(4*e);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var Ji,Qi={},tr=Qi;function er(){if(tr===Qi||tr&&tr.isContextLost()){var t=document.createElement("canvas"),e=void 0;Et.PREFER_ENV>=ot.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),tr=e}return tr}function ir(){if(!Ji){Ji=xt.MEDIUM;var t=er();if(t&&t.getShaderPrecisionFormat){var e=t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT);Ji=e.precision?xt.HIGH:xt.MEDIUM}}return Ji}function rr(t,e,i){if("precision"!==t.substring(0,9)){var r=e;return e===xt.HIGH&&i!==xt.HIGH&&(r=xt.MEDIUM),"precision "+r+" float;\n"+t}return i!==xt.HIGH&&"precision highp"===t.substring(0,15)?t.replace("precision highp","precision mediump"):t}var nr={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function or(t){return nr[t]}var hr=null,ar={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ur(t,e){if(!hr){var i=Object.keys(ar);hr={};for(var r=0;r<i.length;++r){var s=i[r];hr[t[s]]=ar[s]}}return hr[e]}var lr=[{test:function(t){return"float"===t.type&&1===t.size},code:function(t){return'\n            if(uv["'+t+'"] !== ud["'+t+'"].value)\n            {\n                ud["'+t+'"].value = uv["'+t+'"]\n                gl.uniform1f(ud["'+t+'"].location, uv["'+t+'"])\n            }\n            '}},{test:function(t){return("sampler2D"===t.type||"samplerCube"===t.type||"sampler2DArray"===t.type)&&1===t.size&&!t.isArray},code:function(t){return't = syncData.textureCount++;\n\n            renderer.texture.bind(uv["'+t+'"], t);\n\n            if(ud["'+t+'"].value !== t)\n            {\n                ud["'+t+'"].value = t;\n                gl.uniform1i(ud["'+t+'"].location, t);\n; // eslint-disable-line max-len\n            }'}},{test:function(t,e){return"mat3"===t.type&&1===t.size&&void 0!==e.a},code:function(t){return'\n            gl.uniformMatrix3fv(ud["'+t+'"].location, false, uv["'+t+'"].toArray(true));\n            '}},{test:function(t,e){return"vec2"===t.type&&1===t.size&&void 0!==e.x},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud["'+t+'"].location, v.x, v.y);\n                }'}},{test:function(t){return"vec2"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud["'+t+'"].location, v[0], v[1]);\n                }\n            '}},{test:function(t,e){return"vec4"===t.type&&1===t.size&&void 0!==e.width},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud["'+t+'"].location, v.x, v.y, v.width, v.height)\n                }'}},{test:function(t){return"vec4"===t.type&&1===t.size},code:function(t){return'\n                cv = ud["'+t+'"].value;\n                v = uv["'+t+'"];\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud["'+t+'"].location, v[0], v[1], v[2], v[3])\n                }'}}],dr={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},cr={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function pr(t,e){var i=["\n        var v = null;\n        var cv = null\n        var t = 0;\n        var gl = renderer.gl\n    "];for(var r in t.uniforms){var s=e[r];if(s){for(var n=t.uniforms[r],o=!1,h=0;h<lr.length;h++)if(lr[h].test(s,n)){i.push(lr[h].code(r,n)),o=!0;break}if(!o){var a=(1===s.size?dr:cr)[s.type].replace("location",'ud["'+r+'"].location');i.push('\n            cv = ud["'+r+'"].value;\n            v = uv["'+r+'"];\n            '+a+";")}}else t.uniforms[r].group&&i.push('\n                    renderer.shader.syncUniformGroup(uv["'+r+'"], syncData);\n                ')}return new Function("ud","uv","renderer","syncData",i.join("\n"))}var fr,gr=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function mr(t){for(var e="",i=0;i<t;++i)i>0&&(e+="\nelse "),i<t-1&&(e+="if(test == "+i+".0){}");return e}function vr(t,e){if(0===t)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var i=e.createShader(e.FRAGMENT_SHADER);;){var r=gr.replace(/%forloop%/gi,mr(t));if(e.shaderSource(i,r),e.compileShader(i),e.getShaderParameter(i,e.COMPILE_STATUS))break;t=t/2|0}return t}function yr(){if("boolean"==typeof fr)return fr;try{var t=new Function("param1","param2","param3","return param1[param2] === param3;");fr=!0===t({a:"b"},"a","b")}catch(e){fr=!1}return fr}var _r="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}",xr="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n",Tr=0,br={},Er=function(){function t(e,i,r){void 0===r&&(r="pixi-shader"),this.id=Tr++,this.vertexSrc=e||t.defaultVertexSrc,this.fragmentSrc=i||t.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(r=r.replace(/\s+/g,"-"),br[r]?(br[r]++,r+="-"+br[r]):br[r]=1,this.vertexSrc="#define SHADER_NAME "+r+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+r+"\n"+this.fragmentSrc,this.vertexSrc=rr(this.vertexSrc,Et.PRECISION_VERTEX,xt.HIGH),this.fragmentSrc=rr(this.fragmentSrc,Et.PRECISION_FRAGMENT,ir())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null}return t.prototype.extractData=function(t,e){var i=er();if(i){var r=qi(i,t,e);this.attributeData=this.getAttributeData(r,i),this.uniformData=this.getUniformData(r,i),i.deleteProgram(r)}else this.uniformData={},this.attributeData={}},t.prototype.getAttributeData=function(t,e){for(var i={},r=[],s=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),n=0;n<s;n++){var o=e.getActiveAttrib(t,n),h=ur(e,o.type),a={type:h,name:o.name,size:or(h),location:0};i[o.name]=a,r.push(a)}r.sort(function(t,e){return t.name>e.name?1:-1});for(n=0;n<r.length;n++)r[n].location=n;return i},t.prototype.getUniformData=function(t,e){for(var i={},r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<r;s++){var n=e.getActiveUniform(t,s),o=n.name.replace(/\[.*?\]$/,""),h=n.name.match(/\[.*?\]$/),a=ur(e,n.type);i[o]={type:a,size:n.size,isArray:h,value:$i(a,n.size)}}return i},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return xr},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return _r},enumerable:!1,configurable:!0}),t.from=function(e,i,r){var s=e+i,n=xe[s];return n||(xe[s]=n=new t(e,i,r)),n},t}(),wr=function(){function t(t,e){for(var i in this.program=t,this.uniformGroup=e?e instanceof Ni?e:new Ni(e):new Ni({}),t.uniformData)this.uniformGroup.uniforms[i]instanceof Array&&(this.uniformGroup.uniforms[i]=new Float32Array(this.uniformGroup.uniforms[i]))}return t.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var i in e.uniforms){var r=e.uniforms[i];if(r.group&&this.checkUniformExists(t,r))return!0}return!1},t.prototype.destroy=function(){this.uniformGroup=null},Object.defineProperty(t.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),t.from=function(e,i,r){return new t(Er.from(e,i),r)},t}(),Cr=0,Ar=1,Ir=2,Mr=3,Sr=4,Or=function(){function t(){this.data=0,this.blendMode=ut.NORMAL,this.polygonOffset=0,this.blend=!0}return Object.defineProperty(t.prototype,"blend",{get:function(){return!!(this.data&1<<Cr)},set:function(t){!!(this.data&1<<Cr)!==t&&(this.data^=1<<Cr)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"offsets",{get:function(){return!!(this.data&1<<Ar)},set:function(t){!!(this.data&1<<Ar)!==t&&(this.data^=1<<Ar)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"culling",{get:function(){return!!(this.data&1<<Ir)},set:function(t){!!(this.data&1<<Ir)!==t&&(this.data^=1<<Ir)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"depthTest",{get:function(){return!!(this.data&1<<Mr)},set:function(t){!!(this.data&1<<Mr)!==t&&(this.data^=1<<Mr)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<Sr)},set:function(t){!!(this.data&1<<Sr)!==t&&(this.data^=1<<Sr)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==ut.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),t.for2d=function(){var e=new t;return e.depthTest=!1,e.blend=!0,e},t}(),Rr="attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Lr="varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n",Pr=function(t){function e(i,r,s){var n=this,o=Er.from(i||e.defaultVertexSrc,r||e.defaultFragmentSrc);return(n=t.call(this,o,s)||this).padding=0,n.resolution=Et.FILTER_RESOLUTION,n.enabled=!0,n.autoFit=!0,n.legacy=!!n.program.attributeData.aTextureCoord,n.state=new Or,n}return qe(e,t),e.prototype.apply=function(t,e,i,r,s){t.applyFilter(this,e,i,r)},Object.defineProperty(e.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(t){this.state.blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultVertexSrc",{get:function(){return Rr},enumerable:!1,configurable:!0}),Object.defineProperty(e,"defaultFragmentSrc",{get:function(){return Lr},enumerable:!1,configurable:!0}),e}(wr),Nr="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n",Dr="varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n",Fr=new De,kr=function(){function t(t,e){this._texture=t,this.mapCoord=new De,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===e?.5:e,this.isSimple=!1}return Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),t.prototype.multiplyUvs=function(t,e){void 0===e&&(e=t);for(var i=this.mapCoord,r=0;r<t.length;r+=2){var s=t[r],n=t[r+1];e[r]=s*i.a+n*i.c+i.tx,e[r+1]=s*i.b+n*i.d+i.ty}return e},t.prototype.update=function(t){var e=this._texture;if(!e||!e.valid)return!1;if(!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var i=e._uvs;this.mapCoord.set(i.x1-i.x0,i.y1-i.y0,i.x3-i.x0,i.y3-i.y0,i.x0,i.y0);var r=e.orig,s=e.trim;s&&(Fr.set(r.width/s.width,0,0,r.height/s.height,-s.x/s.width,-s.y/s.height),this.mapCoord.append(Fr));var n=e.baseTexture,o=this.uClampFrame,h=this.clampMargin/n.resolution,a=this.clampOffset;return o[0]=(e._frame.x+h+a)/n.width,o[1]=(e._frame.y+h+a)/n.height,o[2]=(e._frame.x+e._frame.width-h+a)/n.width,o[3]=(e._frame.y+e._frame.height-h+a)/n.height,this.uClampOffset[0]=a/n.realWidth,this.uClampOffset[1]=a/n.realHeight,this.isSimple=e._frame.width===n.width&&e._frame.height===n.height&&0===e.rotate,!0},t}(),Ur=function(t){function e(e){var i=this,r=new De;return i=t.call(this,Nr,Dr)||this,e.renderable=!1,i.maskSprite=e,i.maskMatrix=r,i}return qe(e,t),e.prototype.apply=function(t,e,i,r){var s=this.maskSprite,n=s._texture;n.valid&&(n.uvMatrix||(n.uvMatrix=new kr(n,0)),n.uvMatrix.update(),this.uniforms.npmAlpha=n.baseTexture.alphaMode?0:1,this.uniforms.mask=n,this.uniforms.otherMatrix=t.calculateSpriteMatrix(this.maskMatrix,s).prepend(n.uvMatrix.mapCoord),this.uniforms.alpha=s.worldAlpha,this.uniforms.maskClamp=n.uvMatrix.uClampFrame,t.applyFilter(this,e,i,r))},e}(Pr),Br=function(t){function e(e){var i=t.call(this,e)||this;return i.enableScissor=!1,i.alphaMaskPool=[],i.maskDataPool=[],i.maskStack=[],i.alphaMaskIndex=0,i}return qe(e,t),e.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},e.prototype.push=function(t,e){var i=e;if(!i.isMaskData){var r=this.maskDataPool.pop()||new Yi;r.pooled=!0,r.maskObject=e,i=r}switch(i.autoDetect&&this.detect(i),i.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),i._target=t,i.type){case Tt.SCISSOR:this.maskStack.push(i),this.renderer.scissor.push(i);break;case Tt.STENCIL:this.maskStack.push(i),this.renderer.stencil.push(i);break;case Tt.SPRITE:i.copyCountersOrReset(null),this.pushSpriteMask(i),this.maskStack.push(i)}},e.prototype.pop=function(t){var e=this.maskStack.pop();if(e&&e._target===t){switch(e.type){case Tt.SCISSOR:this.renderer.scissor.pop();break;case Tt.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Tt.SPRITE:this.popSpriteMask()}e.reset(),e.pooled&&this.maskDataPool.push(e)}},e.prototype.detect=function(t){var e=t.maskObject;if(e.isSprite)t.type=Tt.SPRITE;else if(t.type=Tt.STENCIL,this.enableScissor&&e.isFastRect&&e.isFastRect()){var i=e.worldTransform,r=Math.atan2(i.b,i.a),s=Math.atan2(i.d,i.c);r=Math.round(r*(180/Math.PI)*100),s=((s=Math.round(s*(180/Math.PI)*100)-r)%18e3+18e3)%18e3,0===(r=(r%9e3+9e3)%9e3)&&9e3===s&&(t.type=Tt.SCISSOR)}},e.prototype.pushSpriteMask=function(t){var e=t.maskObject,i=t._target,r=this.alphaMaskPool[this.alphaMaskIndex];r||(r=this.alphaMaskPool[this.alphaMaskIndex]=[new Ur(e)]),r[0].resolution=this.renderer.resolution,r[0].maskSprite=e;var s=i.filterArea;i.filterArea=e.getBounds(!0),this.renderer.filter.push(i,r),i.filterArea=s,this.alphaMaskIndex++},e.prototype.popSpriteMask=function(){this.renderer.filter.pop(),this.alphaMaskIndex--},e}(li),Hr=function(t){function e(e){var i=t.call(this,e)||this;return i.maskStack=[],i.glConst=0,i}return qe(e,t),e.prototype.getStackLength=function(){return this.maskStack.length},e.prototype.setMaskStack=function(t){var e=this.renderer.gl,i=this.getStackLength();this.maskStack=t;var r=this.getStackLength();r!==i&&(0===r?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},e.prototype._useCurrent=function(){},e.prototype.destroy=function(){t.prototype.destroy.call(this),this.maskStack=null},e}(li),Gr=function(t){function e(e){var i=t.call(this,e)||this;return i.glConst=WebGLRenderingContext.SCISSOR_TEST,i}return qe(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._scissorCounter:0},e.prototype.push=function(t){var e=t.maskObject;e.renderable=!0;var i=t._scissorRect,r=e.getBounds(!0),s=this.renderer.gl;e.renderable=!1,i?r.fit(i):s.enable(s.SCISSOR_TEST),t._scissorCounter++,t._scissorRect=r,this._useCurrent()},e.prototype.pop=function(){var t=this.renderer.gl;this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)},e.prototype._useCurrent=function(){var t=this.maskStack[this.maskStack.length-1]._scissorRect,e=this.renderer.renderTexture.current,i=this.renderer.projection,r=i.transform,s=i.sourceFrame,n=i.destinationFrame,o=e?e.resolution:this.renderer.resolution,h=(t.x-s.x)*o+n.x,a=(t.y-s.y)*o+n.y,u=t.width*o,l=t.height*o;r&&(h+=r.tx*o,a+=r.ty*o),e||(a=this.renderer.height-l-a),this.renderer.gl.scissor(h,a,u,l)},e}(Hr),Wr=function(t){function e(e){var i=t.call(this,e)||this;return i.glConst=WebGLRenderingContext.STENCIL_TEST,i}return qe(e,t),e.prototype.getStackLength=function(){var t=this.maskStack[this.maskStack.length-1];return t?t._stencilCounter:0},e.prototype.push=function(t){var e=t.maskObject,i=this.renderer.gl,r=t._stencilCounter;0===r&&(this.renderer.framebuffer.forceStencil(),i.enable(i.STENCIL_TEST)),t._stencilCounter++,i.colorMask(!1,!1,!1,!1),i.stencilFunc(i.EQUAL,r,this._getBitwiseMask()),i.stencilOp(i.KEEP,i.KEEP,i.INCR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent()},e.prototype.pop=function(t){var e=this.renderer.gl;0===this.getStackLength()?(e.disable(e.STENCIL_TEST),e.clear(e.STENCIL_BUFFER_BIT),e.clearStencil(0)):(e.colorMask(!1,!1,!1,!1),e.stencilOp(e.KEEP,e.KEEP,e.DECR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent())},e.prototype._useCurrent=function(){var t=this.renderer.gl;t.colorMask(!0,!0,!0,!0),t.stencilFunc(t.EQUAL,this.getStackLength(),this._getBitwiseMask()),t.stencilOp(t.KEEP,t.KEEP,t.KEEP)},e.prototype._getBitwiseMask=function(){return(1<<this.getStackLength())-1},e}(Hr),Vr=function(t){function e(e){var i=t.call(this,e)||this;return i.destinationFrame=null,i.sourceFrame=null,i.defaultFrame=null,i.projectionMatrix=new De,i.transform=null,i}return qe(e,t),e.prototype.update=function(t,e,i,r){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,i,r),this.transform&&this.projectionMatrix.append(this.transform);var s=this.renderer;s.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,s.globalUniforms.update(),s.shader.shader&&s.shader.syncUniformGroup(s.shader.shader.uniforms.globals)},e.prototype.calculateProjection=function(t,e,i,r){var s=this.projectionMatrix,n=r?-1:1;s.identity(),s.a=1/e.width*2,s.d=n*(1/e.height*2),s.tx=-1-e.x*s.a,s.ty=-n-e.y*s.d},e.prototype.setTransform=function(t){},e}(li),Xr=new Le,jr=new Le,zr=new Le,Yr=function(t){function e(e){var i=t.call(this,e)||this;return i.clearColor=e._backgroundColorRgba,i.defaultMaskStack=[],i.current=null,i.sourceFrame=new Le,i.destinationFrame=new Le,i}return qe(e,t),e.prototype.bind=function(t,e,i){void 0===t&&(t=null);var r,s,n,o=this.renderer;this.current=t,t?(n=(r=t.baseTexture).resolution,e||(Xr.width=t.frame.width,Xr.height=t.frame.height,e=Xr),i||(jr.x=t.frame.x,jr.y=t.frame.y,jr.width=e.width,jr.height=e.height,i=jr),s=r.framebuffer):(n=o.resolution,e||(Xr.width=o.screen.width,Xr.height=o.screen.height,e=Xr),i||((i=Xr).width=e.width,i.height=e.height)),zr.x=i.x*n,zr.y=i.y*n,zr.width=i.width*n,zr.height=i.height*n,this.renderer.framebuffer.bind(s,zr),this.renderer.projection.update(i,e,n,!s),t?this.renderer.mask.setMaskStack(r.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(i)},e.prototype.clear=function(t,e){t=this.current?t||this.current.baseTexture.clearColor:t||this.clearColor,this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e)},e.prototype.resize=function(){this.bind(null)},e.prototype.reset=function(){this.bind(null)},e}(li),Kr=function(){function t(t,e){this.program=t,this.uniformData=e,this.uniformGroups={}}return t.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.program=null},t}(),qr=0,Zr={textureCount:0},$r=function(t){function e(e){var i=t.call(this,e)||this;return i.destroyed=!1,i.systemCheck(),i.gl=null,i.shader=null,i.program=null,i.cache={},i.id=qr++,i}return qe(e,t),e.prototype.systemCheck=function(){if(!yr())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},e.prototype.contextChange=function(t){this.gl=t,this.reset()},e.prototype.bind=function(t,e){t.uniforms.globals=this.renderer.globalUniforms;var i=t.program,r=i.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(t);return this.shader=t,this.program!==i&&(this.program=i,this.gl.useProgram(r.program)),e||(Zr.textureCount=0,this.syncUniformGroup(t.uniformGroup,Zr)),r},e.prototype.setUniforms=function(t){var e=this.shader.program,i=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(i.uniformData,t,this.renderer)},e.prototype.syncUniformGroup=function(t,e){var i=this.getglProgram();t.static&&t.dirtyId===i.uniformGroups[t.id]||(i.uniformGroups[t.id]=t.dirtyId,this.syncUniforms(t,i,e))},e.prototype.syncUniforms=function(t,e,i){(t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t))(e.uniformData,t.uniforms,this.renderer,i)},e.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData);return this.cache[e]||(this.cache[e]=pr(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},e.prototype.getSignature=function(t,e){var i=t.uniforms,r=[];for(var s in i)r.push(s),e[s]&&r.push(e[s].type);return r.join("-")},e.prototype.getglProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},e.prototype.generateShader=function(t){var e=this.gl,i=t.program,r={};for(var s in i.attributeData)r[s]=i.attributeData[s].location;var n=qi(e,i.vertexSrc,i.fragmentSrc,r),o={};for(var s in i.uniformData){var h=i.uniformData[s];o[s]={location:e.getUniformLocation(n,s),value:$i(h.type,h.size)}}var a=new Kr(n,o);return i.glPrograms[this.renderer.CONTEXT_UID]=a,a},e.prototype.reset=function(){this.program=null,this.shader=null},e.prototype.destroy=function(){this.destroyed=!0},e}(li);function Jr(t,e){return void 0===e&&(e=[]),e[ut.NORMAL]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.ADD]=[t.ONE,t.ONE],e[ut.MULTIPLY]=[t.DST_COLOR,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.SCREEN]=[t.ONE,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.OVERLAY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.DARKEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.LIGHTEN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.COLOR_DODGE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.COLOR_BURN]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.HARD_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.SOFT_LIGHT]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.DIFFERENCE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.EXCLUSION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.HUE]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.SATURATION]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.COLOR]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.LUMINOSITY]=[t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.NONE]=[0,0],e[ut.NORMAL_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.ADD_NPM]=[t.SRC_ALPHA,t.ONE,t.ONE,t.ONE],e[ut.SCREEN_NPM]=[t.SRC_ALPHA,t.ONE_MINUS_SRC_COLOR,t.ONE,t.ONE_MINUS_SRC_ALPHA],e[ut.SRC_IN]=[t.DST_ALPHA,t.ZERO],e[ut.SRC_OUT]=[t.ONE_MINUS_DST_ALPHA,t.ZERO],e[ut.SRC_ATOP]=[t.DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ut.DST_OVER]=[t.ONE_MINUS_DST_ALPHA,t.ONE],e[ut.DST_IN]=[t.ZERO,t.SRC_ALPHA],e[ut.DST_OUT]=[t.ZERO,t.ONE_MINUS_SRC_ALPHA],e[ut.DST_ATOP]=[t.ONE_MINUS_DST_ALPHA,t.SRC_ALPHA],e[ut.XOR]=[t.ONE_MINUS_DST_ALPHA,t.ONE_MINUS_SRC_ALPHA],e[ut.SUBTRACT]=[t.ONE,t.ONE,t.ONE,t.ONE,t.FUNC_REVERSE_SUBTRACT,t.FUNC_ADD],e}var Qr=0,ts=1,es=2,is=3,rs=4,ss=function(t){function e(e){var i=t.call(this,e)||this;return i.gl=null,i.stateId=0,i.polygonOffset=0,i.blendMode=ut.NONE,i._blendEq=!1,i.map=[],i.map[Qr]=i.setBlend,i.map[ts]=i.setOffset,i.map[es]=i.setCullFace,i.map[is]=i.setDepthTest,i.map[rs]=i.setFrontFace,i.checks=[],i.defaultState=new Or,i.defaultState.blend=!0,i}return qe(e,t),e.prototype.contextChange=function(t){this.gl=t,this.blendModes=Jr(t),this.set(this.defaultState),this.reset()},e.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,i=0;e;)1&e&&this.map[i].call(this,!!(t.data&1<<i)),e>>=1,i++;this.stateId=t.data}for(i=0;i<this.checks.length;i++)this.checks[i](this,t)},e.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},e.prototype.setBlend=function(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},e.prototype.setOffset=function(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},e.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},e.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},e.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},e.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],i=this.gl;2===e.length?i.blendFunc(e[0],e[1]):i.blendFuncSeparate(e[0],e[1],e[2],e[3]),6===e.length?(this._blendEq=!0,i.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}},e.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},e.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},e.prototype.updateCheck=function(t,e){var i=this.checks.indexOf(t);e&&-1===i?this.checks.push(t):e||-1===i||this.checks.splice(i,1)},e.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},e.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},e}(li),ns=function(t){function e(e){var i=t.call(this,e)||this;return i.count=0,i.checkCount=0,i.maxIdle=Et.GC_MAX_IDLE,i.checkCountMax=Et.GC_MAX_CHECK_COUNT,i.mode=Et.GC_MODE,i}return qe(e,t),e.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==_t.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},e.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,i=!1,r=0;r<e.length;r++){var s=e[r];!s.framebuffer&&this.count-s.touched>this.maxIdle&&(t.destroyTexture(s,!0),e[r]=null,i=!0)}if(i){var n=0;for(r=0;r<e.length;r++)null!==e[r]&&(e[n++]=e[r]);e.length=n}},e.prototype.unload=function(t){var e,i=this.renderer.texture;(null===(e=t._texture)||void 0===e?void 0:e.framebuffer)&&i.destroyTexture(t._texture);for(var r=t.children.length-1;r>=0;r--)this.unload(t.children[r])},e}(li),os=function(){return function(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121}}(),as=function(t){function e(e){var i=t.call(this,e)||this;return i.boundTextures=[],i.currentLocation=-1,i.managedTextures=[],i._unknownBoundTextures=!1,i.unknownTexture=new Qe,i}return qe(e,t),e.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var i=0;i<e;i++)this.boundTextures[i]=null;this.emptyTextures={};var r=new os(t.createTexture());t.bindTexture(t.TEXTURE_2D,r.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=r,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new os(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(i=0;i<6;i++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+i,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(i=0;i<this.boundTextures.length;i++)this.bind(null,i)},e.prototype.bind=function(t,e){void 0===e&&(e=0);var i=this.gl;if(t){if((t=t.castToBaseTexture()).parentTextureArray)return;if(t.valid){t.touched=this.renderer.textureGC.count;var r=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(t.target,r.texture)),r.dirtyId!==t.dirtyId&&(this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),this.updateTexture(t)),this.boundTextures[e]=t}}else this.currentLocation!==e&&(this.currentLocation=e,i.activeTexture(i.TEXTURE0+e)),i.bindTexture(i.TEXTURE_2D,this.emptyTextures[i.TEXTURE_2D].texture),this.boundTextures[e]=null},e.prototype.reset=function(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},e.prototype.unbind=function(t){var e=this.gl,i=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var r=0;r<i.length;r++)i[r]===this.unknownTexture&&this.bind(null,r)}for(r=0;r<i.length;r++)i[r]===t&&(this.currentLocation!==r&&(e.activeTexture(e.TEXTURE0+r),this.currentLocation=r),e.bindTexture(e.TEXTURE_2D,this.emptyTextures[t.target].texture),i[r]=null)},e.prototype.initTexture=function(t){var e=new os(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},e.prototype.initTextureType=function(t,e){if(e.internalFormat=t.format,e.type=t.type,2===this.webGLVersion){var i=this.renderer.gl;t.type===i.FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA32F),t.type===pt.HALF_FLOAT&&(e.type=i.HALF_FLOAT),e.type===i.HALF_FLOAT&&t.format===i.RGBA&&(e.internalFormat=i.RGBA16F)}},e.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var i=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(i,t,e));else{var r=t.realWidth,s=t.realHeight,n=i.gl;(e.width!==r||e.height!==s||e.dirtyId<0)&&(e.width=r,e.height=s,n.texImage2D(t.target,0,e.internalFormat,r,s,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},e.prototype.destroyTexture=function(t,e){var i=this.gl;if((t=t.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(t),i.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var r=this.managedTextures.indexOf(t);-1!==r&&fe(this.managedTextures,r,1)}},e.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&(t.mipmap!==mt.POW2&&2===this.webGLVersion||t.isPowerOfTwo?e.mipmap=t.mipmap>=1:e.mipmap=!1,2===this.webGLVersion||t.isPowerOfTwo?e.wrapMode=t.wrapMode:e.wrapMode=gt.CLAMP,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},e.prototype.setStyle=function(t,e){var i=this.gl;if(e.mipmap&&i.generateMipmap(t.target),i.texParameteri(t.target,i.TEXTURE_WRAP_S,e.wrapMode),i.texParameteri(t.target,i.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===ft.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST);var r=this.renderer.context.extensions.anisotropicFiltering;if(r&&t.anisotropicLevel>0&&t.scaleMode===ft.LINEAR){var s=Math.min(t.anisotropicLevel,i.getParameter(r.MAX_TEXTURE_MAX_ANISOTROPY_EXT));i.texParameterf(t.target,r.TEXTURE_MAX_ANISOTROPY_EXT,s)}}else i.texParameteri(t.target,i.TEXTURE_MIN_FILTER,t.scaleMode===ft.LINEAR?i.LINEAR:i.NEAREST);i.texParameteri(t.target,i.TEXTURE_MAG_FILTER,t.scaleMode===ft.LINEAR?i.LINEAR:i.NEAREST)},e}(li),us=new De,ls=function(t){function e(e,i){void 0===e&&(e=ht.UNKNOWN);var r=t.call(this)||this;return(i=Object.assign({},Et.RENDER_OPTIONS,i)).roundPixels&&(Et.ROUND_PIXELS=i.roundPixels,ye("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),r.options=i,r.type=e,r.screen=new Le(0,0,i.width,i.height),r.view=i.view||document.createElement("canvas"),r.resolution=i.resolution||Et.RESOLUTION,r.transparent=i.transparent,r.autoDensity=i.autoDensity||i.autoResize||!1,r.preserveDrawingBuffer=i.preserveDrawingBuffer,r.clearBeforeRender=i.clearBeforeRender,r._backgroundColor=0,r._backgroundColorRgba=[0,0,0,0],r._backgroundColorString="#000000",r.backgroundColor=i.backgroundColor||r._backgroundColor,r._lastObjectRendered=null,r.plugins={},r}return qe(e,t),e.prototype.initPlugins=function(t){for(var e in t)this.plugins[e]=new t[e](this)},Object.defineProperty(e.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),e.prototype.resize=function(t,e){this.screen.width=t,this.screen.height=e,this.view.width=t*this.resolution,this.view.height=e*this.resolution,this.autoDensity&&(this.view.style.width=t+"px",this.view.style.height=e+"px"),this.emit("resize",t,e)},e.prototype.generateTexture=function(t,e,i,r){0===(r=r||t.getLocalBounds(null,!0)).width&&(r.width=1),0===r.height&&(r.height=1);var s=_i.create({width:0|r.width,height:0|r.height,scaleMode:e,resolution:i});return us.tx=-r.x,us.ty=-r.y,this.render(t,s,!1,us,!!t.parent),s},e.prototype.destroy=function(t){for(var e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null;t&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);this.plugins=null,this.type=ht.UNKNOWN,this.view=null,this.screen=null,this._tempDisplayObjectParent=null,this.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(t){this._backgroundColor=t,this._backgroundColorString=he(t),oe(t,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),e}(At),ds=function(t){function e(i){var r=t.call(this,ht.WEBGL,i)||this;return i=r.options,r.gl=null,r.CONTEXT_UID=0,r.runners={destroy:new Ie("destroy"),contextChange:new Ie("contextChange"),reset:new Ie("reset"),update:new Ie("update"),postrender:new Ie("postrender"),prerender:new Ie("prerender"),resize:new Ie("resize")},r.globalUniforms=new Ni({projectionMatrix:new De},!0),r.addSystem(Br,"mask").addSystem(Hi,"context").addSystem(ss,"state").addSystem($r,"shader").addSystem(as,"texture").addSystem(zi,"geometry").addSystem(Vi,"framebuffer").addSystem(Gr,"scissor").addSystem(Wr,"stencil").addSystem(Vr,"projection").addSystem(ns,"textureGC").addSystem(Fi,"filter").addSystem(Yr,"renderTexture").addSystem(Ui,"batch"),r.initPlugins(e.__plugins),i.context?r.context.initFromContext(i.context):r.context.initFromOptions({alpha:!!r.transparent,antialias:i.antialias,premultipliedAlpha:r.transparent&&"notMultiplied"!==r.transparent,stencil:!0,preserveDrawingBuffer:i.preserveDrawingBuffer,powerPreference:r.options.powerPreference}),r.renderingToScreen=!0,se(2===r.context.webGLVersion?"WebGL 2":"WebGL 1"),r.resize(r.options.width,r.options.height),r}return qe(e,t),e.create=function(t){if(ne())return new e(t);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},e.prototype.addSystem=function(t,e){e||(e=t.name);var i=new t(this);if(this[e])throw new Error('Whoops! The name "'+e+'" is already in use');for(var r in this[e]=i,this.runners)this.runners[r].add(i);return this},e.prototype.render=function(t,e,i,r,s){if(this.renderingToScreen=!e,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=r,!this.context.isLost){if(e||(this._lastObjectRendered=t),!s){var n=t.enableTempParent();t.updateTransform(),t.disableTempParent(n)}this.renderTexture.bind(e),this.batch.currentRenderer.start(),(void 0!==i?i:this.clearBeforeRender)&&this.renderTexture.clear(),t.render(this),this.batch.currentRenderer.flush(),e&&e.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},e.prototype.resize=function(e,i){t.prototype.resize.call(this,e,i),this.runners.resize.emit(e,i)},e.prototype.reset=function(){return this.runners.reset.emit(),this},e.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},e.prototype.destroy=function(e){for(var i in this.runners.destroy.emit(),this.runners)this.runners[i].destroy();t.prototype.destroy.call(this,e),this.gl=null},e.registerPlugin=function(t,i){e.__plugins=e.__plugins||{},e.__plugins[t]=i},e}(ls),cs=function(){return function(){this.texArray=null,this.blend=0,this.type=lt.TRIANGLES,this.start=0,this.size=0,this.data=null}}(),ps=function(){function t(){this.elements=[],this.ids=[],this.count=0}return t.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},t}(),fs=function(){function t(t){this.rawBinaryData=new ArrayBuffer(t),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(t.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),t.prototype.view=function(t){return this[t+"View"]},t.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},t.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},t}(),gs=function(t){function e(e){var i=t.call(this,e)||this;return i.shaderGenerator=null,i.geometryClass=null,i.vertexSize=null,i.state=Or.for2d(),i.size=4*Et.SPRITE_BATCH_SIZE,i._vertexCount=0,i._indexCount=0,i._bufferedElements=[],i._bufferedTextures=[],i._bufferSize=0,i._shader=null,i._packedGeometries=[],i._packedGeometryPoolSize=2,i._flushId=0,i._aBuffers={},i._iBuffers={},i.MAX_TEXTURES=1,i.renderer.on("prerender",i.onPrerender,i),e.runners.contextChange.add(i),i._dcIndex=0,i._aIndex=0,i._iIndex=0,i._attributeBuffer=null,i._indexBuffer=null,i._tempBoundTextures=[],i}return qe(e,t),e.prototype.contextChange=function(){var t=this.renderer.gl;Et.PREFER_ENV===ot.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),Et.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=vr(this.MAX_TEXTURES,t)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()},e.prototype.initFlushBuffers=function(){for(var t=e._drawCallPool,i=e._textureArrayPool,r=this.size/4,s=Math.floor(r/this.MAX_TEXTURES)+1;t.length<r;)t.push(new cs);for(;i.length<s;)i.push(new ps);for(var n=0;n<this.MAX_TEXTURES;n++)this._tempBoundTextures[n]=null},e.prototype.onPrerender=function(){this._flushId=0},e.prototype.render=function(t){t._texture.valid&&(this._vertexCount+t.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=t.vertexData.length/2,this._indexCount+=t.indices.length,this._bufferedTextures[this._bufferSize]=t._texture.baseTexture,this._bufferedElements[this._bufferSize++]=t)},e.prototype.buildTexturesAndDrawCalls=function(){var t=this._bufferedTextures,i=this.MAX_TEXTURES,r=e._textureArrayPool,s=this.renderer.batch,n=this._tempBoundTextures,o=this.renderer.textureGC.count,h=++Qe._globalBatch,a=0,u=r[0],l=0;s.copyBoundTextures(n,i);for(var d=0;d<this._bufferSize;++d){var c=t[d];t[d]=null,c._batchEnabled!==h&&(u.count>=i&&(s.boundArray(u,n,h,i),this.buildDrawCalls(u,l,d),l=d,u=r[++a],++h),c._batchEnabled=h,c.touched=o,u.elements[u.count++]=c)}u.count>0&&(s.boundArray(u,n,h,i),this.buildDrawCalls(u,l,this._bufferSize),++a,++h);for(d=0;d<n.length;d++)n[d]=null;Qe._globalBatch=h},e.prototype.buildDrawCalls=function(t,i,r){var s=this._bufferedElements,n=this._attributeBuffer,o=this._indexBuffer,h=this.vertexSize,a=e._drawCallPool,u=this._dcIndex,l=this._aIndex,d=this._iIndex,c=a[u];c.start=this._iIndex,c.texArray=t;for(var p=i;p<r;++p){var f=s[p],g=f._texture.baseTexture,m=ue[g.alphaMode?1:0][f.blendMode];s[p]=null,i<p&&c.blend!==m&&(c.size=d-c.start,i=p,(c=a[++u]).texArray=t,c.start=d),this.packInterleavedGeometry(f,n,o,l,d),l+=f.vertexData.length/2*h,d+=f.indices.length,c.blend=m}i<r&&(c.size=d-c.start,++u),this._dcIndex=u,this._aIndex=l,this._iIndex=d},e.prototype.bindAndClearTexArray=function(t){for(var e=this.renderer.texture,i=0;i<t.count;i++)e.bind(t.elements[i],t.ids[i]),t.elements[i]=null;t.count=0},e.prototype.updateGeometry=function(){var t=this._packedGeometries,e=this._attributeBuffer,i=this._indexBuffer;Et.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(e.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},e.prototype.drawBatches=function(){for(var t=this._dcIndex,i=this.renderer,r=i.gl,s=i.state,n=e._drawCallPool,o=null,h=0;h<t;h++){var a=n[h],u=a.texArray,l=a.type,d=a.size,c=a.start,p=a.blend;o!==u&&(o=u,this.bindAndClearTexArray(u)),this.state.blendMode=p,s.set(this.state),r.drawElements(l,d,r.UNSIGNED_SHORT,2*c)}},e.prototype.flush=function(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},e.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Et.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},e.prototype.stop=function(){this.flush()},e.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),t.prototype.destroy.call(this)},e.prototype.getAttributeBuffer=function(t){var e=de(Math.ceil(t/8)),i=pe(e),r=8*e;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._aBuffers[r];return s||(this._aBuffers[r]=s=new fs(r*this.vertexSize*4)),s},e.prototype.getIndexBuffer=function(t){var e=de(Math.ceil(t/12)),i=pe(e),r=12*e;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var s=this._iBuffers[i];return s||(this._iBuffers[i]=s=new Uint16Array(r)),s},e.prototype.packInterleavedGeometry=function(t,e,i,r,s){for(var n=e.uint32View,o=e.float32View,h=r/this.vertexSize,a=t.uvs,u=t.indices,l=t.vertexData,d=t._texture.baseTexture._batchLocation,c=Math.min(t.worldAlpha,1),p=c<1&&t._texture.baseTexture.alphaMode?le(t._tintRGB,c):t._tintRGB+(255*c<<24),f=0;f<l.length;f+=2)o[r++]=l[f],o[r++]=l[f+1],o[r++]=a[f],o[r++]=a[f+1],n[r++]=p,o[r++]=d;for(f=0;f<u.length;f++)i[s++]=h+u[f]},e._drawCallPool=[],e._textureArrayPool=[],e}(ki),ms=function(){function t(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return t.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),i=0;i<t;i++)e[i]=i;this.defaultGroupCache[t]=Ni.from({uSamplers:e},!0);var r=this.fragTemplate;r=(r=r.replace(/%count%/gi,""+t)).replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new Er(this.vertexSrc,r)}var s={tint:new Float32Array([1,1,1,1]),translationMatrix:new De,default:this.defaultGroupCache[t]};return new wr(this.programCache[t],s)},t.prototype.generateSampleSrc=function(t){var e="";e+="\n",e+="\n";for(var i=0;i<t;i++)i>0&&(e+="\nelse "),i<t-1&&(e+="if(vTextureId < "+i+".5)"),e+="\n{",e+="\n\tcolor = texture2D(uSamplers["+i+"], vTextureCoord);",e+="\n}";return e+="\n",e+="\n"},t}(),ys=function(t){function e(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i._buffer=new Ei(null,e,!1),i._indexBuffer=new Ei(null,e,!0),i.addAttribute("aVertexPosition",i._buffer,2,!1,pt.FLOAT).addAttribute("aTextureCoord",i._buffer,2,!1,pt.FLOAT).addAttribute("aColor",i._buffer,4,!0,pt.UNSIGNED_BYTE).addAttribute("aTextureId",i._buffer,1,!0,pt.FLOAT).addIndex(i._indexBuffer),i}return qe(e,t),e}(Oi),_s="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",xs="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",Ts=function(){function t(){}return t.create=function(t){var e=Object.assign({vertex:_s,fragment:xs,geometryClass:ys,vertexSize:6},t),i=e.vertex,r=e.fragment,s=e.vertexSize,n=e.geometryClass;return function(t){function e(e){var o=t.call(this,e)||this;return o.shaderGenerator=new ms(i,r),o.geometryClass=n,o.vertexSize=s,o}return qe(e,t),e}(gs)},Object.defineProperty(t,"defaultVertexSrc",{get:function(){return _s},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentTemplate",{get:function(){return xs},enumerable:!1,configurable:!0}),t}(),bs=Ts.create();class Es{onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){const t=this.host,{widgetChildren:e}=t,i=t.contentWidth,r=t.contentHeight;for(let s=0;s<e.length;s++){const t=e[s],n=t.layoutOptions||{},o=t.getMeasuredWidth(),h=t.getMeasuredHeight(),a=this.calculateAnchor(n.anchorLeft||0,i,!1),u=this.calculateAnchor(n.anchorTop||0,r,!1),l=this.calculateAnchor(n.anchorRight||0,i,!0),d=this.calculateAnchor(n.anchorBottom||0,r,!0);let c=a,p=u;switch(n.horizontalAlign){case m.MIDDLE:c=(l+a-o)/2;break;case m.RIGHT:c=l-o}switch(n.verticalAlign){case m.MIDDLE:p=(d+u-h)/2;break;case m.BOTTOM:p=d-h}t.layout(c,p,c+o,p+h)}}onMeasure(t,e,i,r){const s=this.host.widgetChildren;let n=0,h=0;const a=i===o.EXACTLY?o.AT_MOST:i,u=r===o.EXACTLY?o.AT_MOST:r;let l=!1;for(let d=0,c=s.length;d<c;d++){const i=s[d],r=i.layoutOptions||v.DEFAULT;if(r.width===v.FILL_PARENT)throw new Error("AnchorLayout does not support width = FILL_PARENT. Use anchorLeft = 0 & anchorRight = 0");if(r.height===v.FILL_PARENT)throw new Error("AnchorLayout does not support height = FILL_PARENT. Use anchorTop = 0 & anchorBottom = 0");const c=this.calculateAnchor(r.anchorLeft||0,t,!1),p=this.calculateAnchor(r.anchorTop||0,e,!1),f=this.calculateAnchor(r.anchorRight||0,t,!0),g=this.calculateAnchor(r.anchorBottom||0,e,!0),m=r.isWidthPredefined,y=r.isHeightPredefined,_=m?r.width:f-c,x=y?r.height:g-p,T=m?o.EXACTLY:a,b=y?o.EXACTLY:u;l=l||0===r.width||0===r.height,i.measure(_,x,T,b);const E=this.calculateReach(r.anchorLeft||0,r.anchorRight||0,i.getMeasuredWidth()),w=this.calculateReach(r.anchorTop||0,r.anchorBottom||0,i.getMeasuredHeight());n=Math.max(n,E),h=Math.max(h,w)}if(this.measuredWidth=g.resolveMeasuredDimen(n,t,i),this.measuredHeight=g.resolveMeasuredDimen(h,e,r),l)for(let d=0,c=s.length;d<c;d++){const t=s[d],e=t.layoutOptions||v.DEFAULT;if(0===e.width||0===e.height){const i=this.calculateAnchor(e.anchorLeft||0,this.measuredWidth,!1),r=this.calculateAnchor(e.anchorTop||0,this.measuredHeight,!1),s=this.calculateAnchor(e.anchorRight||0,this.measuredWidth,!0),n=this.calculateAnchor(e.anchorBottom||0,this.measuredHeight,!0);t.measure(e.isWidthPredefined?e.width:s-i,e.isHeightPredefined?e.height:n-r,0===e.width||e.isWidthPredefined?o.EXACTLY:o.AT_MOST,0===e.height||e.isHeightPredefined?o.EXACTLY:o.AT_MOST)}}}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}calculateAnchor(t,e,i){const r=Math.abs(t)<1?t*e:t;return i?e-r:r}calculateReach(t,e,i){return Math.abs(t)<1&&Math.abs(e)<1?i/(1-e-t):Math.abs(t)<1?(e+i)/(1-t):Math.abs(e)<1?(t+i)/(1-e):t+i+e}}exports.AnchorLayout=Es;const{REGION_LEFT:ws,REGION_TOP:Cs,REGION_RIGHT:As,REGION_BOTTOM:Is,REGION_CENTER:Ms}=x,{FILL_PARENT:Ss}=v,{EXACTLY:Os,AT_MOST:Rs}=o;class Ls{constructor(){this.leftWidgets=[],this.topWidgets=[],this.rightWidgets=[],this.bottomWidgets=[],this.centerWidgets=[]}onAttach(t){this.host=t}onDetach(){this.host=null,this.clearMeasureCache(),this.clearRegions()}onLayout(){this.layoutChildren(this.leftWidgets,0,this.measuredTopHeight,this.measuredLeftWidth,this.measuredCenterHeight),this.layoutChildren(this.topWidgets,0,0,this.measuredWidth,this.measuredTopHeight),this.layoutChildren(this.rightWidgets,this.measuredWidth-this.measuredRightWidth,this.measuredTopHeight,this.measuredRightWidth,this.measuredCenterHeight),this.layoutChildren(this.bottomWidgets,0,this.measuredTopHeight+this.measuredCenterHeight,this.measuredWidth,this.measuredBottomHeight),this.layoutChildren(this.centerWidgets,this.measuredLeftWidth,this.measuredTopHeight,this.measuredCenterWidth,this.measuredCenterHeight)}layoutChildren(t,e,i,r,s){var n,o;for(let h=0,a=t.length;h<a;h++){const a=t[h];let u=0,l=0;switch(null===(n=a.layoutOptions)||void 0===n?void 0:n.horizontalAlign){case m.CENTER:u=(r-a.getMeasuredWidth())/2;break;case m.RIGHT:u=r-a.getMeasuredWidth();break;default:u=0}switch(null===(o=a.layoutOptions)||void 0===o?void 0:o.verticalAlign){case m.CENTER:l=(s-a.getMeasuredHeight())/2;break;case m.BOTTOM:l=s-a.getMeasuredHeight();break;default:l=0}u+=e,l+=i,a.layout(u,l,u+a.getMeasuredWidth(),l+a.getMeasuredHeight(),!0)}}onMeasure(t,e,i,r){this.indexRegions(),this.clearMeasureCache();const s=i===o.EXACTLY?o.AT_MOST:i,n=r===o.EXACTLY?o.AT_MOST:i;let[h,a,,u]=this.measureChildren(this.topWidgets,t,e,s,n),[l,d,,c]=this.measureChildren(this.bottomWidgets,t,e,s,n),[p,f,g,m]=this.measureChildren(this.centerWidgets,t,e,s,r),[v,,y]=this.measureChildren(this.leftWidgets,t,f,s,o.AT_MOST),[_,,x]=this.measureChildren(this.rightWidgets,t,f,s,o.AT_MOST);const T=v+_+p,b=Math.max(h,l,T),E=a+d+f;if(i===o.EXACTLY?this.measuredWidth=t:i===o.AT_MOST?this.measuredWidth=Math.min(b,t):this.measuredWidth=b,r===o.EXACTLY?this.measuredHeight=e:r===o.AT_MOST?this.measuredHeight=Math.min(E,e):this.measuredHeight=E,h=this.measuredWidth,l=this.measuredWidth,E>this.measuredHeight){const t=u+m+c;if(t<this.measuredHeight){const e=(this.measuredHeight-t)/(E-t);a=u+(a-u)*e,d=c+(d-c)*e,f=m+(f-m)*e}else{const t=this.measuredHeight/E;a*=t,d*=t,f*=t}}if(b>this.measuredWidth){const t=y+g+x;if(t<this.measuredWidth){const e=(this.measuredWidth-t)/(b-t);v=y+(v-y)*e,p=g+(p-g)*e,_=x+(_-x)*e}else{const t=this.measuredWidth/b;v*=t,p*=t,_*=t}}this.measuredLeftWidth=v,this.measuredRightWidth=_,this.measuredCenterWidth=p,this.measuredTopHeight=a,this.measuredBottomHeight=d,this.measuredCenterHeight=f,this.fitChildren(this.leftWidgets,this.measuredLeftWidth,this.measuredCenterHeight),this.fitChildren(this.topWidgets,this.measuredWidth,this.measuredTopHeight),this.fitChildren(this.rightWidgets,this.measuredRightWidth,this.measuredCenterHeight),this.fitChildren(this.bottomWidgets,this.measuredWidth,this.measuredBottomHeight),this.fitChildren(this.centerWidgets,this.measuredCenterWidth,this.measuredCenterHeight)}measureChildren(t,e,i,r,s){let n=0,o=0,h=0,a=0;for(let u=0,l=t.length;u<l;u++){const l=t[u],d=l.layoutOptions||v.DEFAULT;let c=e,p=i,f=r,g=s;d.width<=v.MAX_DIMEN&&(c=d.width,f=Os,h=Math.max(h,c)),d.height<=v.MAX_DIMEN&&(p=d.height,g=Os,a=Math.max(a,p)),l.measure(c,p,f,g),n=Math.max(n,l.getMeasuredWidth()),o=Math.max(o,l.getMeasuredHeight())}return[n,o,h,a]}fitChildren(t,e,i){var r,s,n,o;for(let h=0,a=t.length;h<a;h++){const a=t[h];if(!(a.getMeasuredWidth()<=e&&a.getMeasuredHeight()<=i&&a.getMeasuredWidth()>0&&a.getMeasuredHeight()>0&&(null===(r=a.layoutOptions)||void 0===r?void 0:r.width)!==Ss&&(null===(s=a.layoutOptions)||void 0===s?void 0:s.height)!==Ss)&&(e>0&&i>0)){const t=(null===(n=a.layoutOptions)||void 0===n?void 0:n.width)===Ss?Os:Rs,r=(null===(o=a.layoutOptions)||void 0===o?void 0:o.height)===Ss?Os:Rs;a.measure(e,i,t,r)}}}indexRegions(){this.clearRegions();const{widgetChildren:t}=this.host;for(let e=0,i=t.length;e<i;e++){const i=t[e];switch((i.layoutOptions||v.DEFAULT).region||Ms){case ws:this.leftWidgets.push(i);break;case Cs:this.topWidgets.push(i);break;case As:this.rightWidgets.push(i);break;case Is:this.bottomWidgets.push(i);break;default:this.centerWidgets.push(i)}}}clearRegions(){this.leftWidgets.length=0,this.topWidgets.length=0,this.rightWidgets.length=0,this.bottomWidgets.length=0}clearMeasureCache(){this.measuredLeftWidth=0,this.measuredRightWidth=0,this.measuredCenterWidth=0,this.measuredTopHeight=0,this.measuredBottomHeight=0,this.measuredCenterHeight=0}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}}exports.BorderLayout=Ls;class Ps{constructor(t="vertical",e="center"){this.orientation=t,this.gravity=e}onAttach(t){this.host=t}onDetach(){this.host=null}onLayout(){let t=0;const e=this.host.widgetChildren,i="vertical"===this.orientation?this.measuredWidth:this.measuredHeight;for(let r=0,s=e.length;r<s;r++){const s=e[r],n="vertical"===this.orientation?s.getMeasuredWidth():s.getMeasuredHeight(),o="vertical"===this.orientation?s.getMeasuredHeight():s.getMeasuredWidth();let h=0;if(n<i)switch(this.gravity){case"center":case"middle":h=(i-n)/2;break;case"right":case"bottom":h=i-n}"vertical"===this.orientation?s.layout(h,t,h+n,t+o):s.layout(t,h,t+o,h+n),t+=o}}onMeasure(t,e,i,r){const s=this.host.widgetChildren,n=i===o.EXACTLY?o.AT_MOST:i,h=r===o.EXACTLY?o.AT_MOST:r;let a=0,u=0;for(let l=0,d=s.length;l<d;l++){const i=s[l],r=i.layoutOptions||v.DEFAULT,d=r.isWidthPredefined?r.width:t,c=r.isHeightPredefined?r.height:e,p=r.isWidthPredefined?o.EXACTLY:n,f=r.isHeightPredefined?o.EXACTLY:h;i.measure(d,c,p,f),"vertical"===this.orientation?(u=Math.max(u,i.getMeasuredWidth()),a+=i.getMeasuredHeight()):(u=Math.max(u,i.getMeasuredHeight()),a+=i.getMeasuredWidth())}"vertical"===this.orientation?(this.measuredWidth=u,this.measuredHeight=a):(this.measuredWidth=a,this.measuredHeight=u)}getMeasuredWidth(){return this.measuredWidth}getMeasuredHeight(){return this.measuredHeight}}exports.LinearLayout=Ps;class Ns extends A{constructor(t){if(super(t),!(t.icon instanceof k)){const e=t.icon instanceof mi?t.icon:mi.from(t.icon);t.icon=new k(e)}this.textWidget.setLayoutOptions(null),this.iconWidget=t.icon,this.removeChild(this.textWidget),this.addChild(this.iconWidget),this.addChild(this.textWidget),this.useLayout(new Ps("vertical"))}}exports.ImageButton=Ns;class Ds extends g{constructor(t){super(),this.percentValue=0,this._disabled=!1,this.fill=t.fill||null,this.percentValue=this._minValue,this._minValue=t.minValue||0,this._maxValue=t.maxValue||100,this.decimals=t.decimals||0,this.orientation=t.orientation||Ds.HORIZONTAL,this.onValueChange=t.onValueChange||null,this.onValueChanging=t.onValueChanging||null,this.value=t.value||50,this.track=g.fromContent(t.track||(this.orientation===Ds.HORIZONTAL?Ds.DEFAULT_HORIZONTAL_TRACK.clone():Ds.DEFAULT_VERTICAL_TRACK.clone())),this.handle=g.fromContent(t.handle||Ds.DEFAULT_HANDLE.clone()),this.addChild(this.track,this.handle),this._localCursor=new e.Point,this.handle.contentContainer.buttonMode=!0}initialize(){super.initialize();let t,e=0;const i=()=>{this.emit("change",this.value),this._lastChange!=this.value&&(this._lastChange=this.value,"function"==typeof this.onValueChange&&this.onValueChange(this.value))},r=()=>{this.emit("changing",this.value),this._lastChanging!=this.value&&(this._lastChanging=this.value,"function"==typeof this.onValueChanging&&this.onValueChanging(this.value))},s=(t,e)=>{this.percentValue=this.getValueAtPhysicalPosition(t),this.layoutHandle(),r()},n=this.handle.eventBroker.dnd;n.onPress=(t=>{t.stopPropagation()}),n.onDragStart=(()=>{e=this.percentValue,t=this.orientation===Ds.HORIZONTAL?this.track.width:this.track.height}),n.onDragMove=((i,s)=>{this.percentValue=Math.max(0,Math.min(1,e+(this.orientation===Ds.HORIZONTAL?s.x:s.y)/t)),r(),this.layoutHandle()}),n.onDragEnd=(()=>{i(),this.layoutHandle()});const o=this.track.eventBroker.dnd;o.onPress=((t,e)=>{e&&s(t.data.global),t.stopPropagation()}),o.onDragMove=(t=>{s(t.data.global)}),o.onDragEnd=(()=>{i()}),this.layoutHandle()}get value(){return D.Round(D.Lerp(this._minValue,this._maxValue,this.percentValue),this.decimals)}set value(t){if(t!==this.value){if(isNaN(t))throw new Error("Cannot use NaN as a value");this.percentValue=(Math.max(this._minValue,Math.min(this._maxValue,t))-this._minValue)/(this._maxValue-this._minValue),"function"==typeof this.onValueChange&&this.onValueChange(this.value),"function"==typeof this.onValueChanging&&this.onValueChanging(this.value),this.handle&&this.initialized&&this.layoutHandle()}}get minValue(){return this._minValue}set minValue(t){this._minValue=t,this.update()}get maxValue(){return this._maxValue}set maxValue(t){this._maxValue=t,this.update()}get disabled(){return this._disabled}set disabled(t){t!==this._disabled&&(this._disabled=t,this.handle.contentContainer.buttonMode=!t,this.handle.contentContainer.interactive=!t,this.track.contentContainer.interactive=!t)}getPhysicalRange(){return this.orientation===Ds.HORIZONTAL?this.contentWidth-this.handle.getMeasuredWidth():this.contentHeight-this.handle.getMeasuredHeight()}getValueAtPhysicalPosition(t){const e=this.contentContainer.toLocal(t,null,this._localCursor,!0);let i,r;if(this.orientation===Ds.HORIZONTAL){const t=this.handle.getMeasuredWidth();i=e.x-this.paddingLeft-t/4,r=this.contentWidth-t}else{const t=this.handle.getMeasuredHeight();i=e.y-this.paddingTop-t/4,r=this.contentHeight-t}return i/r}layoutHandle(){const t=this.handle,e=t.getMeasuredWidth(),i=t.getMeasuredHeight();let r,s,n=this.width-this.paddingHorizontal,o=this.height-this.paddingVertical;this.orientation===Ds.HORIZONTAL?(s=(o-i)/2,r=(n-=e)*this.percentValue):(r=(n-e)/2,s=(o-=i)*this.percentValue),t.layout(r,s,r+e,s+i)}onMeasure(t,e,i,r){const s=(this.orientation===Ds.HORIZONTAL?this._maxValue-this._minValue:Math.max(this.handle.contentContainer.width,this.track.contentContainer.width))+this.paddingHorizontal,n=(this.orientation===Ds.VERTICAL?this._maxValue-this._minValue:Math.max(this.handle.contentContainer.height,this.track.contentContainer.height))+this.paddingVertical;switch(i){case o.EXACTLY:this._measuredWidth=t;break;case o.UNBOUNDED:this._measuredWidth=s;break;case o.AT_MOST:this._measuredWidth=Math.min(t,s)}switch(r){case o.EXACTLY:this._measuredHeight=e;break;case o.UNBOUNDED:this._measuredHeight=n;break;case o.AT_MOST:this._measuredHeight=Math.min(e,n)}}onLayout(t,e,i,r,s){super.onLayout(t,e,i,r,s);const{handle:n,track:h}=this;h.layout(0,0,this.width-this.paddingHorizontal,this.height-this.paddingVertical),h.insetContainer.width=h.width,h.insetContainer.height=h.height,n.measure(this.width,this.height,o.AT_MOST,o.AT_MOST),this.layoutHandle()}}exports.Slider=Ds,Ds.DEFAULT_HORIZONTAL_TRACK=(new e.Graphics).beginFill(16777215,1).drawRect(0,0,16,16).endFill().lineStyle(1,0,.7,1,!0).moveTo(1,8).lineTo(15,8),Ds.DEFAULT_VERTICAL_TRACK=(new e.Graphics).beginFill(16777215,1).drawRect(0,0,16,16).endFill().lineStyle(1,0,.7,1,!0).moveTo(8,1).lineTo(8,15),Ds.DEFAULT_HANDLE=(new e.Graphics).beginFill(0).drawCircle(16,16,8).endFill().beginFill(0,.5).drawCircle(16,16,16).endFill(),Ds.HORIZONTAL=4085,Ds.VERTICAL=4094;const Fs=[],ks=[],Us={},Bs={};let Hs=1;class Gs{constructor(t){this.object=t,this.tweens={},this.active=!1,this.onUpdate=null}}class Ws{constructor(){this._ready=!1,this.obj=null,this.parent=null,this.key="",this.time=0,this.callback=null,this.currentTime=0}remove(){this._ready=!0,delete this.parent.tweens[this.key],Object.keys(this.parent.tweens).length||(this.parent.active=!1,this.parent.onUpdate=null,delete Bs[this.obj._tweenObjectId])}set(t,e,i){this.obj=t.object,this.obj._currentCallbackID?this.obj._currentCallbackID++:this.obj._currentCallbackID=1,this.time=i,this.parent=t,this.callback=e,this._ready=!1,this.key=`cb_${this.obj._currentCallbackID}`,this.currentTime=0,this.parent.active||(this.parent.active=!0,Bs[this.obj._tweenObjectId]=this.parent)}update(t){this.currentTime+=t,this.currentTime>=this.time&&(this.remove(),this.callback.call(this.parent))}}class Vs{constructor(){this._ready=!1,this.parent=null,this.obj=null,this.key="",this.from=0,this.to=0,this.time=0,this.ease=0,this.currentTime=0,this.t=0,this.isColor=!1}remove(){this._ready=!0,delete this.parent.tweens[this.key],Object.keys(this.parent.tweens).length||(this.parent.active=!1,delete Bs[this.obj._tweenObjectId])}set(t,e,i,r,s,n){this.isColor=isNaN(i)&&"#"===i[0]||isNaN(r)&&"#"===r[0],this.parent=t,this.obj=t.object,this.key=e,this.surfix=Ys(r),this.isColor?(this.to=D.hexToRgb(r),this.from=D.hexToRgb(i),this.currentColor={r:this.from.r,g:this.from.g,b:this.from.b}):(this.to=Ks(r),this.from=zs(i,r,this.obj,e)),this.time=s,this.currentTime=0,this.ease=n,this._ready=!1,this.parent.active||(this.parent.active=!0,Bs[this.obj._tweenObjectId]=this.parent)}update(t){if(this.currentTime+=t,this.t=Math.min(this.currentTime,this.time)/this.time,this.ease&&(this.t=this.ease.getPosition(this.t)),this.isColor)this.currentColor.r=Math.round(D.Lerp(this.from.r,this.to.r,this.t)),this.currentColor.g=Math.round(D.Lerp(this.from.g,this.to.g,this.t)),this.currentColor.b=Math.round(D.Lerp(this.from.b,this.to.b,this.t)),this.obj[this.key]=D.rgbToNumber(this.currentColor.r,this.currentColor.g,this.currentColor.b);else{const t=D.Lerp(this.from,this.to,this.t);this.obj[this.key]=this.surfix?t+this.surfix:t}this.currentTime>=this.time&&this.remove()}}const Xs=["width","minWidth","maxWidth","anchorLeft","anchorRight","left","right","x"],js=["height","minHeight","maxHeight","anchorTop","anchorBottom","top","bottom","y"];function zs(t,e,i,r){return isNaN(t)||isNaN(e)?isNaN(t)&&isNaN(e)&&-1!==t.indexOf("%")&&-1!==e.indexOf("%")?parseFloat(t.replace("%","")):isNaN(t)&&!isNaN(e)&&-1!==t.indexOf("%")?-1!==Xs.indexOf(r)?i.parent._width*(.01*parseFloat(t.replace("%",""))):-1!==js.indexOf(r)?i.parent._height*(.01*parseFloat(t.replace("%",""))):0:!isNaN(t)&&isNaN(e)&&-1!==e.indexOf("%")?-1!==Xs.indexOf(r)?t/i.parent._width*100:-1!==js.indexOf(r)?t/i.parent._height*100:0:0:t}function Ys(t){if(isNaN(t)&&-1!==t.indexOf("%"))return"%"}function Ks(t){return isNaN(t)?isNaN(t)&&-1!==t.indexOf("%")?parseFloat(t.replace("%","")):void 0:t}function qs(t){t._tweenObjectId||(t._tweenObjectId=Hs,Hs++);let e=Us[t._tweenObjectId];return e||(e=Us[t._tweenObjectId]=new Gs(t)),e}function Zs(){for(let e=0;e<Fs.length;e++)if(Fs[e]._ready)return Fs[e];const t=new Vs;return Fs.push(t),t}function $s(){for(let e=0;e<ks.length;e++)if(ks[e]._ready)return ks[e];const t=new Ws;return ks.push(t),t}const Js={to(t,e,i,r){const s=qs(t);let n=null;for(const o in i)if("onComplete"!==o)if("onUpdate"!==o){if(e){const n=i[o]===t[o];if(void 0===t[o])continue;n?s.tweens[o]&&s.tweens[o].remove():(s.tweens[o]||(s.tweens[o]=Zs()),s.tweens[o].set(s,o,t[o],i[o],e,r))}}else n=i[o];else{const t=$s();t.set(s,i[o],e),s.tweens[t.key]=t}e?s.onUpdate=n:this.set(t,i)},from(t,e,i,r){const s=qs(t);let n=null;for(const o in i)if("onComplete"!==o)if("onUpdate"!==o){if(e){const n=i[o]==t[o];if(void 0===t[o])continue;n?s.tweens[o]&&s.tweens[o].remove():(s.tweens[o]||(s.tweens[o]=Zs()),s.tweens[o].set(s,o,i[o],t[o],e,r))}}else n=i[o];else{const t=$s();t.set(s,i[o],e),s.tweens[t.key]=t}e?s.onUpdate=n:this.set(t,i)},fromTo(t,e,i,r,s){const n=qs(t);let o=null;for(const h in r)if("onComplete"!==h)if("onUpdate"!==h){if(e){const o=i[h]==r[h];if(void 0===t[h]||void 0===i[h])continue;o?(n.tweens[h]&&n.tweens[h].remove(),t[h]=r[h]):(n.tweens[h]||(n.tweens[h]=Zs()),n.tweens[h].set(n,h,i[h],r[h],e,s))}}else o=r[h];else{const t=$s();t.set(n,r[h],e),n.tweens[t.key]=t}e?n.onUpdate=o:this.set(t,r)},set(t,e){const i=qs(t);for(const r in e)void 0!==t[r]&&(i.tweens[r]&&i.tweens[r].remove(),t[r]=e[r])},_update(t){for(const e in Bs){const i=Bs[e];for(const e in i.tweens)i.tweens[e].update(t);i.onUpdate&&i.onUpdate.call(i.object,t)}}};class Qs extends Ds{constructor(t){super({track:t.track||Qs.DEFAULT_TRACK.clone(),handle:t.handle||Qs.DEFAULT_HANDLE.clone(),fill:null,orientation:t.orientation,minValue:0,maxValue:1}),this.scrollingContainer=t.scrollingContainer,this.autohide=t.autohide,this._hidden=!1}initialize(){super.initialize(),this.decimals=3,this.on("changing",()=>{this.scrollingContainer.forcePctPosition(this.orientation===Ds.HORIZONTAL?"x":"y",this.percentValue)}),this.on("change",()=>{this.scrollingContainer.setScrollPosition()})}toggleHidden(t){this.autohide&&(t&&!this._hidden?(Js.to(this,.2,{alpha:0}),this._hidden=!0):!t&&this._hidden&&(Js.to(this,.2,{alpha:1}),this._hidden=!1))}}exports.ScrollBar=Qs,Qs.DEFAULT_TRACK=(new e.Graphics).beginFill(16777215).drawRect(0,0,8,8).endFill(),Qs.DEFAULT_HANDLE=(new e.Graphics).beginFill(0).drawCircle(8,8,4).endFill().beginFill(0,.5).drawCircle(8,8,8).endFill();class tn extends E{constructor(t={}){if(super(),this.forcePctPosition=((t,e)=>{const i=this.getInnerBounds(),r=this.innerContainer.insetContainer;this.scrollX&&"x"===t&&(r.position[t]=-(i.width-this.width)*e),this.scrollY&&"y"===t&&(r.position[t]=-(i.height-this.height)*e),this.scrollPosition[t]=this.targetPosition[t]=r.position[t]}),this.focusPosition=(t=>{const e=this.getInnerBounds(),i=this.innerContainer.insetContainer;let r;if(this.scrollX){const s=Math.max(0,Math.min(e.width,t.x));s+i.x>this.width?(r=s-this.width,i.x=-r):s+i.x<0&&(r=s+i.x,i.x-=r)}if(this.scrollY){const s=Math.max(0,Math.min(e.height,t.y));s+i.y>this.height?(r=s-this.height,i.y=-r):s+i.y<0&&(r=s+i.y,i.y-=r)}this.lastPosition.copyFrom(i.position),this.targetPosition.copyFrom(i.position),this.scrollPosition.copyFrom(i.position),this.updateScrollBars()}),this.setScrollPosition=(t=>{t&&this.scrollVelocity.copyFrom(t);const i=this.innerContainer.insetContainer;this.animating||(this.animating=!0,this.lastPosition.copyFrom(i.position),this.targetPosition.copyFrom(i.position),e.Ticker.shared.add(this.updateScrollPosition))}),this.updateScrollPosition=(t=>{this.stop=!0,this.scrollX&&this.updateDirection("x",t),this.scrollY&&this.updateDirection("y",t),this.stop&&(e.Ticker.shared.remove(this.updateScrollPosition),this.animating=!1),this.updateScrollBars()}),this.updateDirection=((t,e)=>{const i=this.getInnerBounds(),{scrollPosition:r,scrollVelocity:s,targetPosition:n,lastPosition:o}=this,h=this.innerContainer.insetContainer;let a;if(a="y"===t?Math.round(Math.min(0,this.height-i.height)):Math.round(Math.min(0,this.width-i.width)),this.scrolling||0===Math.round(s[t])||(n[t]+=s[t],s[t]=D.Lerp(s[t],0,(5+2.5/Math.max(this.softness,.01))*e),n[t]>0?n[t]=0:n[t]<a&&(n[t]=a)),!this.scrolling&&0===Math.round(s[t])&&(h[t]>0||h[t]<a)){const i=this.scrollPosition[t]>0?0:a;r[t]=D.Lerp(r[t],i,(40-30*this.softness)*e),this.stop=!1}else(this.scrolling||0!==Math.round(s[t]))&&(this.scrolling&&(s[t]=this.scrollPosition[t]-o[t],o.copyFrom(r)),n[t]>0?(s[t]=0,r[t]=100*this.softness*(1-Math.exp(n[t]/-200))):n[t]<a?(s[t]=0,r[t]=a-100*this.softness*(1-Math.exp((a-n[t])/-200))):r[t]=n[t],this.stop=!1);h.position[t]=Math.round(r[t])}),this.mask=new e.Graphics,this.innerContainer=new E,this.innerBounds=new e.Rectangle,super.addChild(this.innerContainer),this.contentContainer.addChild(this.mask),this.contentContainer.mask=this.mask,this.scrollX=void 0!==t.scrollX&&t.scrollX,this.scrollY=void 0!==t.scrollY&&t.scrollY,this.dragScrolling=void 0===t.dragScrolling||t.dragScrolling,this.softness=void 0!==t.softness?Math.max(Math.min(t.softness||0,1),0):.5,this.radius=t.radius||0,this.expandMask=t.expandMask||0,this.overflowY=t.overflowY||0,this.overflowX=t.overflowX||0,this.scrollVelocity=new e.Point,this.scrollPosition=new e.Point,this.targetPosition=new e.Point,this.lastPosition=new e.Point,this.useLayout(new Ls),this.animating=!1,this.scrolling=!1,this.scrollBars=[],t.scrollBars&&this.scrollX){const t=new Qs({orientation:Qs.HORIZONTAL,scrollingContainer:this,minValue:0,maxValue:1}).setLayoutOptions(new x({width:v.FILL_PARENT,height:v.WRAP_CONTENT,region:x.REGION_BOTTOM,horizontalAlign:m.CENTER,verticalAlign:m.BOTTOM})).setBackground(255).setBackgroundAlpha(.8);super.addChild(t),this.scrollBars.push(t)}if(t.scrollBars&&this.scrollY){const t=new Qs({orientation:Qs.VERTICAL,scrollingContainer:this,minValue:0,maxValue:1}).setLayoutOptions(new x({width:v.WRAP_CONTENT,height:v.FILL_PARENT,region:x.REGION_RIGHT,horizontalAlign:m.RIGHT,verticalAlign:m.CENTER})).setBackground(255).setBackgroundAlpha(.8);super.addChild(t),this.scrollBars.push(t)}this.boundCached=0}update(){if(super.update(),this.lastWidth!==this.width||this.lastHeight!==this.height){const t=this.expandMask;this.mask.clear(),this.mask.lineStyle(0),this.mask.beginFill(16777215,1),0===this.radius?this.mask.drawRect(-t,-t,this.width+t,this.height+t):this.mask.drawRoundedRect(-t,-t,this.width+t,this.height+t,this.radius),this.mask.endFill(),this.lastWidth=this.width,this.lastHeight=this.height}}addScrollBar(t){return super.addChild(t),this.scrollBars.push(t),this}addChild(...t){for(let e=0;e<t.length;e++)this.innerContainer.addChild(t[e]);return this.getInnerBounds(!0),this}updateScrollBars(){for(let t=0,e=this.scrollBars.length;t<e;t++){const e=this.scrollBars[t];if(e.orientation===Ds.HORIZONTAL){const t=this.getPercentPosition("x");e.value=t}else if(e.orientation===Ds.VERTICAL){const t=this.getPercentPosition("y");e.value=t}}}getInnerBounds(t){return(t||performance.now()-this.boundCached>1e3)&&(this.innerContainer.insetContainer.getLocalBounds(this.innerBounds),this.innerBounds.height=this.innerBounds.y+this.innerContainer.height||0,this.innerBounds.width=this.innerBounds.x+this.innerContainer.width||0,this.boundCached=performance.now()),this.innerBounds}initialize(){super.initialize(),(this.scrollX||this.scrollY)&&this.initScrolling()}initScrolling(){const t=this.innerContainer.insetContainer,i=new e.Point,{scrollPosition:r,targetPosition:s}=this;if(this.dragScrolling){const e=this.eventBroker.dnd;e.onDragStart=(e=>{this.scrolling||(i.copyFrom(t.position),r.copyFrom(t.position),this.scrolling=!0,this.setScrollPosition(),this.emit("scrollstart",e))}),e.onDragMove=((t,e)=>{this.scrollX&&(s.x=i.x+e.x),this.scrollY&&(s.y=i.y+e.y),this.setScrollPosition()}),e.onDragEnd=(t=>{this.scrolling&&(this.scrolling=!1,this.emit("scrollend",t))})}const n=new e.Point;new d(this,!0).onMouseScroll=((t,e)=>{n.set(.2*-e.x,.2*-e.y),this.setScrollPosition(n)}),this.updateScrollBars()}getPercentPosition(t){const e=this.getInnerBounds(),i=this.innerContainer.insetContainer;return"x"===t?i.x/(this.width-e.width):"y"===t?i.y/(this.height-e.height):0}}exports.ScrollWidget=tn;class en extends E{constructor(t,e,i){super(0,0),this.desc=void 0!==t&&t,this.tweenTime=e||0,this.tweenEase=i,this.items=[]}addChild(t,e,i){super.addChild(t),-1===this.items.indexOf(t)&&this.items.push(t),"function"==typeof e&&(t._sortListValue=e),"function"==typeof i&&(t._sortListThenByValue=i),t._sortListRnd||(t._sortListRnd=Math.random()),this.sort()}removeChild(t){if(arguments.length>1)for(let e=0;e<arguments.length;e++)this.removeChild(arguments[e]);else{super.removeChild(t);const e=this.items.indexOf(t);-1!==e&&this.items.splice(e,1),this.sort()}}sort(t=!1){clearTimeout(this._sortTimeout),t?this._sort():this._sortTimeout=setTimeout(()=>{this._sort()},0)}_sort(){const t=this.desc;let e=0,i=!0;this.items.sort(function(e,i){let r=e._sortListValue()<i._sortListValue()?t?1:-1:e._sortListValue()>i._sortListValue()?t?-1:1:0;return 0===r&&e._sortListThenByValue&&i._sortListThenByValue&&(r=e._sortListThenByValue()<i._sortListThenByValue()?t?1:-1:e._sortListThenByValue()>i._sortListThenByValue()?t?-1:1:0),0===r&&(r=e._sortListRnd>i._sortListRnd?1:e._sortListRnd<i._sortListRnd?-1:0),r});for(let r=0;r<this.items.length;r++){const t=this.items[r];i=!i,this.tweenTime>0?Js.fromTo(t,this.tweenTime,{x:t.x,y:t.y},{x:0,y:e},this.tweenEase):(t.x=0,t.y=e),e+=t.height,"function"==typeof t.altering&&t.altering(i)}this.tweenTime>0&&setTimeout(()=>{this.updatesettings(!1,!0)},1e3*this.tweenTime)}}exports.SortableList=en;class rn extends g{constructor(t,e,i,r,s){super(t.width,t.height),this.bw=e||5,this.vs=void 0===r||r,this.hs=void 0===i||i,this.t=t.baseTexture,this.f=t.frame,this.tile=s,this.hs&&(this.setting.minWidth=2*e),this.vs&&(this.setting.minHeight=2*e),this.update=function(){this.initialized&&(vs&&hs?(str.x=sbr.x=sr.x=this._width-bw,sbl.y=sbr.y=sb.y=this._height-bw,sf.width=st.width=sb.width=this._width-2*bw,sf.height=sl.height=sr.height=this._height-2*bw):hs?(sr.x=this._width-bw,sl.height=sr.height=sf.height=this._height,sf.width=this._width-2*bw):(sb.y=this._height-bw,st.width=sb.width=sf.width=this._width,sf.height=this._height-2*bw),null!==this.tint&&(sf.tint=this.tint,vs&&hs&&(stl.tint=str.tint=sbl.tint=sbr.tint=this.tint),hs&&(sl.tint=sr.tint=this.tint),vs&&(st.tint=sb.tint=this.tint)),null!==this.blendMode&&(sf.blendMode=this.blendMode,vs&&hs&&(stl.blendMode=str.blendMode=sbl.blendMode=sbr.blendMode=this.blendMode),hs&&(sl.blendMode=sr.blendMode=this.blendMode),vs&&(st.blendMode=sb.blendMode=this.blendMode)))}}initialize(){super.initialize();const{f:t,bw:i}=this;this.vs&&this.hs?(this.ftl=new e.Rectangle(t.x,t.y,i,i),this.ftr=new e.Rectangle(t.x+t.width-i,t.y,i,i),this.fbl=new e.Rectangle(t.x,t.y+t.height-i,i,i),this.fbr=new e.Rectangle(t.x+t.width-i,t.y+t.height-i,i,i),this.ft=new e.Rectangle(t.x+i,t.y,t.width-2*i,i),this.fb=new e.Rectangle(t.x+i,t.y+t.height-i,t.width-2*i,i),this.fl=new e.Rectangle(t.x,t.y+i,i,t.height-2*i),this.fr=new e.Rectangle(t.x+t.width-i,t.y+i,i,t.height-2*i),this.ff=new e.Rectangle(t.x+i,t.y+i,t.width-2*i,t.height-2*i)):this.hs?(this.fl=new e.Rectangle(this.f.x,t.y,i,t.height),this.fr=new e.Rectangle(t.x+t.width-i,t.y,i,t.height),this.ff=new e.Rectangle(t.x+i,t.y,t.width-2*i,t.height)):(this.ft=new e.Rectangle(t.x,t.y,t.width,i),this.fb=new e.Rectangle(t.x,t.y+t.height-i,t.width,i),this.ff=new e.Rectangle(t.x,t.y+i,t.width,t.height-2*i));const{t:r,ff:s,fl:n,fr:o,ft:h,fb:a}=this;this.sf=this.tile?new e.extras.TilingSprite(new e.Texture(r,s)):new e.Sprite(new e.Texture(r,s)),this.contentContainer.addChildAt(this.sf,0),this.vs&&this.hs&&(this.stl=new e.Sprite(new e.Texture(r,this.ftl)),this.str=new e.Sprite(new e.Texture(r,this.ftr)),this.sbl=new e.Sprite(new e.Texture(r,this.fbl)),this.sbr=new e.Sprite(new e.Texture(r,this.fbr)),this.contentContainer.addChildAt(this.stl,0),this.contentContainer.addChildAt(this.str,0),this.contentContainer.addChildAt(this.sbl,0),this.contentContainer.addChildAt(this.sbr,0)),hs&&(this.sl=this.tile?new e.extras.TilingSprite(new e.Texture(r,n)):new e.Sprite(new e.Texture(r,n)),this.sr=this.tile?new e.extras.TilingSprite(new e.Texture(r,o)):new e.Sprite(new e.Texture(r,o)),this.contentContainer.addChildAt(this.sl,0),this.contentContainer.addChildAt(this.sr,0)),this.vs&&(this.st=this.tile?new e.extras.TilingSprite(new e.Texture(r,h)):new e.Sprite(new e.Texture(r,h)),this.sb=this.tile?new e.extras.TilingSprite(new e.Texture(r,a)):new e.Sprite(new e.Texture(r,a)),this.contentContainer.addChildAt(this.st,0),this.contentContainer.addChildAt(this.sb,0)),this.vs&&this.hs&&(this.st.x=i,this.sb.x=i,this.sl.y=i,this.sr.y=i,this.stl.width=i,this.str.width=i,this.sbl.width=i,this.sbr.width=i,this.stl.height=i,this.str.height=i,this.sbl.height=i,this.sbr.height=i),this.hs&&(this.sf.x=this.sl.width=this.sr.width=i),this.vs&&(this.sf.y=this.st.height=this.sb.height=i)}update(){}}exports.SliceSprite=rn;class sn extends e.utils.EventEmitter{constructor(t){super(),this.stage=t}}class nn extends sn{constructor(t){super(t),this.checkGroups=new Map}in(t,e){if(!e)throw new Error("Default check groups don't exist!");(this.checkGroups.get(e)||this.initGroup(e)).checks.push(t),t.checkGroup=e}out(t){const e=this.checkGroups.get(t.checkGroup),i=e.checks.indexOf(t);i>0&&e.checks.splice(i,1),t.checkGroup=null}notifyCheck(t){const e=this.checkGroups.get(t.checkGroup);if(!e)return;const{checks:i}=e;for(let r=0,s=i.length;r<s;r++)i[r]!==t&&(i[r].checked=!1);e.selected=t}getSelected(t){var e;return null===(e=this.checkGroups.get(t))||void 0===e?void 0:e.selected}initGroup(t){const e={checks:[],selected:null};return this.checkGroups.set(t,e),e}}class on extends sn{constructor(t){super(t),this.tabGroups=new Map,this.useTab=!0,this.useForward=!0,this.useBack=!0}in(t,e=0,i="default"){let r=this.tabGroups.get(i);r||(r=[],this.tabGroups.set(i,r)),-1===r.indexOf(t)&&(t.tabIndex=void 0!==e?e:-1,t.tabGroup=i,r.push(t),r.sort((t,e)=>t.tabIndex-e.tabIndex))}out(t){const e=this.tabGroups.get(t.tabGroup);if(!e)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}notifyFocus(t){const e=this.currentItem;e&&(e.blur(),this.emit("blur",e)),this.currentItem=t,this.emit("focus",t),this.emit("focusChanged",t,e)}notifyBlur(){this.emit("blur",this.currentItem),this.emit("focusChanged",null,this.currentItem),this.currentItem=null}focus(t){const e=this.currentItem;e&&(e.blur(),this.emit("blur",e)),t.focus(),this.emit("focus",t),this.emit("focusChanged",t,e)}blur(){this.currentItem&&(this.currentItem.blur(),this.emit("blur",this.currentItem),this.emit("focusChanged",null,this.currentItem),this.currentItem=null)}onTab(){const{tabGroups:t,currentItem:e}=this;if(e){const i=t.get(e.tabGroup);let r=i.indexOf(e)+1;r>=i.length&&(r=0),this.focus(i[r])}}onForward(){if(!this.useForward)return;const{currentItem:t,tabGroups:e}=this;if(t){const i=e.get(t.tabGroup);let r=i.indexOf(t)+1;r>=i.length&&(r=i.length-1),this.focus(i[r])}}onBack(){const{currentItem:t,tabGroups:e}=this;if(t){const i=e.get(t.tabGroup);let r=i.indexOf(t)-1;r<0&&(r=0),this.focus(i[r])}}}class hn extends e.Container{constructor(t,i){super(),this.__width=t,this.__height=i,this.minWidth=0,this.minHeight=0,this.widgetChildren=[],this.interactive=!0,this.stage=this,this.hitArea=new e.Rectangle(0,0,0,0),this.initialized=!0,this.resize(t,i),this._checkBoxGroupCtl=new hn.CHECK_BOX_GROUP_CONTROLLER(this),this._focusCtl=new hn.FOCUS_CONTROLLER(this)}measureAndLayout(){this.background&&(this.background.width=this.width,this.background.height=this.height);for(let t=0,e=this.widgetChildren.length;t<e;t++){const e=this.widgetChildren[t],i=e.layoutOptions||v.DEFAULT,r=i.width<v.MAX_DIMEN?o.EXACTLY:o.AT_MOST,s=i.height<v.MAX_DIMEN?o.EXACTLY:o.AT_MOST,n=Math.abs(i.width)<1?i.width*this.width:i.width,h=Math.abs(i.height)<1?i.height*this.height:i.height;e.measure(r===o.EXACTLY?n:this.width,s===o.EXACTLY?h:this.height,r,s);let a=i.x?i.x:0,u=i.y?i.y:0;Math.abs(a)<1&&(a*=this.width),Math.abs(u)<1&&(u*=this.height);const l=i.anchor||_.DEFAULT_ANCHOR,d=a-l.x*e.getMeasuredWidth(),c=u-l.y*e.getMeasuredHeight();e.layout(d,c,d+e.getMeasuredWidth(),c+e.getMeasuredHeight(),!0)}}getBackground(){return this.background}setBackground(t){this.background&&super.removeChild(this.background),this.background=t,t&&(super.addChildAt(t,0),this.background.width=this.width,this.background.height=this.height)}update(t){this.emit("preupdate",this);for(let e=0,i=t.length;e<i;e++){const i=t[e];i.stage=this,i.initialized||i.initialize(),this.update(i.widgetChildren),i.update()}this.emit("postupdate",this)}render(t){this.update(this.widgetChildren),super.render(t)}addChild(t){const e=arguments.length;if(e>1)for(let i=0;i<e;i++)this.addChild(arguments[i]);else t.parent&&t.parent.removeChild(t),t.parent=this,this.widgetChildren.push(t),super.addChild(t.insetContainer);this.measureAndLayout()}removeChild(t){const e=arguments.length;if(e>1)for(let i=0;i<e;i++)this.removeChild(arguments[i]);else{super.removeChild(t.insetContainer);const e=this.widgetChildren.indexOf(t);-1!==e&&(this.children.splice(e,1),t.parent=null)}this.measureAndLayout()}resize(t,e){this.width=t,this.height=e,this.hitArea&&(this.hitArea.width=this.__width,this.hitArea.height=this.__height),this.measureAndLayout()}get width(){return this.__width}set width(t){isNaN(t)||(this.__width=t,this.resize())}get height(){return this.__height}set height(t){isNaN(t)||(this.__height=t,this.resize())}get checkBoxGroupController(){return this._checkBoxGroupCtl}get focusController(){return this._focusCtl}}exports.Stage=hn,hn.CHECK_BOX_GROUP_CONTROLLER=nn,hn.FOCUS_CONTROLLER=on;class an extends e.utils.EventEmitter{constructor(t={}){super(),this.onParentSetProperty=((t,e,i)=>{const r=this.extends,s=r.indexOf(i);if(-1===s)throw new Error("onParentSetProperty triggered when by a non-super style.");const n=this.computedData[t];for(let o=s,h=r.length;o<h;o++){const e=r[o];e.computedData[t]&&(this.computedData[t]=e.computedData[t])}this.data[t]&&(this.computedData[t]=this.data[t]),n!==this.computedData[t]&&this.emit("setProperty",t,this.computedData[t],this)}),this.dirtyID=0,this.data=t,this.extends=[],this.computedData=t,this.computedDirty=!1}getProperty(t){return this.computedDirty&&this.compute(),this.computedData[t]}getProperties(...t){this.computedDirty&&this.compute();const e={};for(let i=0,r=t.length;i<r;i++)e[t[i]]=this.computedData[t[i]];return e}setProperty(t,e){this.computedDirty&&this.compute(),this.data[t]=e,this.computedData[t]=e,this.emit("setProperty",t,e,this),++this.dirtyID}extend(t){this.extends.push(t),this.computedDirty=!0,++this.dirtyID,t.on("setProperty",this.onParentSetProperty)}compute(){const t=this.extends;this.computedData={};for(let e=0,i=t.length;e<i;e++)Object.assign(this.computedData,t[e].computedData);this.computedDirty=!1}static create(t){return new an(t)}}exports.Style=an;class un{static create(t){const e=new un;for(const i in t)e[i]=an.create(t[i]);return e}}let ln;function dn(){void 0===ln&&((ln=document.createElement("INPUT")).setAttribute("type","text"),ln.setAttribute("id","_pui_tempInput"),ln.setAttribute("style","position:fixed; left:-10px; top:-10px; width:0px; height: 0px;"),document.body.appendChild(ln))}exports.StyleSheet=un;class cn extends w{constructor(t){super(t),this.onKeyDown=(t=>{if(t.which!==this.ctrlKey&&t.which!==this.cmdKey||(this.ctrlDown=!0),t.which===this.shiftKey&&(this.shiftDown=!0),!t.defaultPrevented){if(13===t.which)return this.insertTextAtCaret("\n"),void t.preventDefault();if(this.ctrlDown){if(65===t.which)return this.select(),void t.preventDefault();if(90===t.which)return this.value!=this._lastValue&&(this.valueEvent=this._lastValue),this.setCaretIndex(this._lastValue.length+1),void t.preventDefault()}if(8===t.which)return this.deleteSelection()||(this.caret._index>0||1===this.chars.length&&this.caret._atEnd)&&(this.caret._atEnd?(this.valueEvent=this.value.slice(0,this.chars.length-1),this.setCaretIndex(this.caret._index)):(this.valueEvent=this.value.slice(0,this.caret._index-1)+this.value.slice(this.caret._index),this.setCaretIndex(this.caret._index-1))),void t.preventDefault();if(46===t.which)return this.deleteSelection()||this.caret._atEnd||(this.valueEvent=this.value.slice(0,this.caret._index)+this.value.slice(this.caret._index+1),this.setCaretIndex(this.caret._index)),void t.preventDefault();if(37!==t.which&&39!==t.which)return!this.multiLine||38!==t.which&&40!==t.which?void 0:(this.vrdd=38===t.which,this.shiftDown?this.hasSelection?(this.de.y=Math.max(0,Math.min(this.textHeightPX,this.de.y+(this.vrdd?-this.lineHeight:this.lineHeight))),this.updateClosestIndex(this.de,!1),Math.abs(this.si-this.ei)<=1?this.setCaretIndex(this.sie?this.si+1:this.si):(this.caret._index=(this.eie?this.ei+1:this.ei)+(this.caret._down?-1:0),this.selectRange(this.caret._down?this.si:this.si-1,this.caret._index))):(this.si=this.caret._index,this.sie=!1,this.de.copyFrom(this.caret),this.de.y=Math.max(0,Math.min(this.textHeightPX,this.de.y+(this.vrdd?-this.lineHeight:this.lineHeight))),this.updateClosestIndex(this.de,!1),this.caret._index=(this.eie?this.ei+1:ei)-(this.vrdd?0:1),this.selectRange(this.vrdd?this.si-1:this.si,this.caret._index),this.caret._down=!this.vrdd):this.hasSelection?this.setCaretIndex(this.vrdd?this.selectionStart:this.selectionEnd+1):(this.ds.copyFrom(this.caret),this.ds.y+=this.vrdd?-this.lineHeight:this.lineHeight,this.ds.x+=1,this.updateClosestIndex(this.ds,!0),this.setCaretIndex(this.sie?this.si+1:this.si)),void t.preventDefault());if(this.rdd=37===t.which,this.shiftDown)if(this.hasSelection){if(this.selectionStart===this.caret._index)if(this.selectionStart===this.selectionEnd&&this.rdd===this.caret._forward)this.setCaretIndex(this.caret._forward?this.caret._index:this.caret._index+1);else{const t=this.rdd?this.caret._index-1:this.caret._index+1;this.selectRange(t,this.selectionEnd),this.caret._index=Math.min(this.chars.length-1,Math.max(0,t))}else{const t=this.rdd?this.caret._index-1:this.caret._index+1;this.selectRange(this.selectionStart,t),this.caret._index=Math.min(this.chars.length-1,Math.max(0,t))}}else{const t=this.caret._atEnd?this.caret._index+1:this.caret._index,e=this.rdd?t-1:t;this.selectRange(e,e),this.caret._index=e,this.caret._forward=!rdd}else this.hasSelection?this.setCaretIndex(this.rdd?this.selectionStart:this.selectionEnd+1):this.setCaretIndex(this.caret._index+(this.rdd?this.caret._atEnd?0:-1:1));t.preventDefault()}}),this.keyUpEvent=(t=>{t.which!==this.ctrlKey&&t.which!==this.cmdKey||(this.ctrlDown=!1),t.which===this.shiftKey&&(this.shiftDown=!1),this.emit("keyup",t),t.defaultPrevented}),this.copyEvent=(t=>{if(this.emit("copy",t),!t.defaultPrevented){if(this.hasSelection){(t.clipboardData||window.clipboardData).setData("Text",this.value.slice(this.selectionStart,this.selectionEnd+1))}t.preventDefault()}}),this.cutEvent=(t=>{this.emit("cut",t),t.defaultPrevented||(this.hasSelection&&(this.copyEvent(t),this.deleteSelection()),t.preventDefault())}),this.pasteEvent=(t=>{if(this.emit("paste",t),t.defaultPrevented)return;const e=t.clipboardData||window.clipboardData;this.insertTextAtCaret(e.getData("Text")),t.preventDefault()}),this.inputEvent=(t=>{const e=ln.value;e.length&&(this.insertTextAtCaret(e),ln.value=""),t.preventDefault()}),this.inputBlurEvent=(t=>{this.blur()}),this.focus=(()=>{if(!this._isFocused){super.focus();const t=`${this.contentContainer.worldTransform.tx}px`,e=`${this.contentContainer.worldTransform.ty}px`,i=`${this.contentContainer.height}px`,r=`${this.contentContainer.width}px`;ln.setAttribute("style",`position:fixed; left:${t}; top:${e}; height:${i}; width:${r};`),ln.value="",ln.focus(),ln.setAttribute("style","position:fixed; left:-10px; top:-10px; width:0px; height: 0px;"),this.innerContainer.cacheAsBitmap=!1,ln.addEventListener("blur",this.inputBlurEvent,!1),document.addEventListener("keydown",this.onKeyDown,!1),document.addEventListener("keyup",this.keyUpEvent,!1),document.addEventListener("paste",this.pasteEvent,!1),document.addEventListener("copy",this.copyEvent,!1),document.addEventListener("cut",this.cutEvent,!1),ln.addEventListener("input",this.inputEvent,!1),setTimeout(()=>{this.caret.visible||this.selection.visible||this.multiLine||this.setCaretIndex(this.chars.length)},0)}}),this.blur=(()=>{this._isFocused&&(super.blur(),this.ctrlDown=!1,this.shiftDown=!1,this.hideCaret(),this.clearSelection(),this.chars.length>1&&(this.innerContainer.cacheAsBitmap=!0),ln.removeEventListener("blur",this.inputBlurEvent),document.removeEventListener("keydown",this.onKeyDown),document.removeEventListener("keyup",this.keyUpEvent),document.removeEventListener("paste",this.pasteEvent),document.removeEventListener("copy",this.copyEvent),document.removeEventListener("cut",this.cutEvent),ln.removeEventListener("input",this.inputEvent),ln.blur()),this.multiLine||this.resetScrollPosition()}),this.setCaretIndex=(t=>{if(this.caret._atEnd=t>=this.chars.length,this.caret._index=Math.max(0,Math.min(this.chars.length-1,t)),this.chars.length&&t>0){let e=Math.max(0,Math.min(t,this.chars.length-1)),i=this.chars[e];i&&i.wrapped?(this.caret.x=i.x,this.caret.y=i.y):(e=Math.max(0,Math.min(t-1,this.chars.length-1)),i=this.chars[e],this.caret.x=this.chars[e].x+this.chars[e].width,this.caret.y=this.chars[e].lineIndex*this.lineHeight+.5*(this.lineHeight-this.textHeight))}else this.caret.x=0,this.caret.y=.5*(this.lineHeight-this.textHeight);this.scrollToPosition(this.caret),this.showCaret()}),this.select=(()=>{this.selectRange(0,this.chars.length-1)}),this.selectWord=(t=>{let e=this.chars.length,i=0;for(let r=0;r<this.chars.length;r++)this.chars[r].wordIndex===t&&(r<e&&(e=r),r>i&&(i=r));this.selectRange(e,i)}),this.selectRange=((t,e)=>{if(t>-1&&e>-1){const i=Math.min(t,e,this.chars.length-1),r=Math.min(Math.max(t,e),this.chars.length-1);i===this.selectionStart&&r===this.selectionEnd||(this.hasSelection=!0,this.selection.visible=!0,this.selectionStart=i,this.selectionEnd=r,this.hideCaret(),this.updateSelectionGraphics(),this.updateSelectionColors()),this.focus()}else this.clearSelection()}),this.clearSelection=(()=>{this.hasSelection&&(this.hasSelection=!1,this.selection.visible=!1,this.selectionStart=-1,this.selectionEnd=-1,this.updateSelectionColors())}),this.updateSelectionGraphics=(()=>{const t=this.chars[this.selectionStart];if(void 0!==t){let e=t.x,i=t.y,r=0;const s=this.textHeight;let n=t.lineIndex;this.selection.clear();for(let t=this.selectionStart;t<=this.selectionEnd;t++){const o=this.chars[t];o.lineIndex!=n&&(this.drawSelectionRect(e,i,r,s),e=o.x,i=o.y,n=o.lineIndex,r=0),r+=o.width}this.drawSelectionRect(e,i,r,s),this.innerContainer.addChildAt(this.selection,0)}}),this.drawSelectionRect=((t,e,i,r)=>{this.selection.beginFill(`0x${this.selectedBackgroundColor.slice(1)}`,1),this.selection.moveTo(t,e),this.selection.lineTo(t+i,e),this.selection.lineTo(t+i,e+r),this.selection.lineTo(t,e+r),this.selection.endFill()}),dn(),this.options=t,this._dirtyText=!0,this.maxLength=t.maxLength||0,this._value=this._lastValue=t.value||"",this.maxLength&&(this._value=this._value.slice(0,this.maxLength)),this.chars=[],this.multiLine=void 0!==t.multiLine&&t.multiLine,this.color=t.style&&t.style.fill?t.style.fill:"#000000",this.selectedColor=t.selectedColor||"#ffffff",this.selectedBackgroundColor=t.selectedBackgroundColor||"#318cfa",this.tempText=new e.Text("1",t.style),this.textHeight=this.tempText.height,this.lineHeight=t.lineHeight||this.textHeight||this._height,this.tempText.destroy(),this.selection=new e.Graphics,this.selection.visible=!1,this.selection._startIndex=0,this.selection._endIndex=0,this.caret=new e.Graphics,this.caret.visible=!1,this.caret._index=0,this.caret.lineStyle(t.caretWidth||1,"#ffffff",1),this.caret.moveTo(0,0),this.caret.lineTo(0,this.textHeight);const i=void 0!==t.paddingLeft?t.paddingLeft:t.padding,r=void 0!==t.paddingRight?t.paddingRight:t.padding,s=void 0!==t.paddingBottom?t.paddingBottom:t.padding,n=void 0!==t.paddingTop?t.paddingTop:t.padding;this.textContainer=new tn({scrollX:!this.multiLine,scrollY:this.multiLine,dragScrolling:this.multiLine,expandMask:2,softness:.2,overflowX:40,overflowY:40}).setPadding(i||3,n||3,r||3,s||3).setLayoutOptions(new v(v.FILL_PARENT,v.FILL_PARENT)),this.addChild(this.textContainer),this.multiLine&&(this._useNext=this._usePrev=!1,this.textContainer.dragRestrictAxis="y",this.textContainer.dragThreshold=5,this.dragRestrictAxis="x",this.dragThreshold=5),this.sp=new e.Point,this._sp=new e.Point,this.ds=new e.Point,this.de=new e.Point,this.rdd=!1,this.vrdd=!1,this.selectionStart=-1,this.selectionEnd=-1,this.hasSelection=!1,this.t=performance.now(),this.cc=0,this.textLengthPX=0,this.textHeightPX=0,this.lineIndexMax=0,this.ctrlDown=!1,this.shiftDown=!1,this.shiftKey=16,this.ctrlKey=17,this.cmdKey=91,this.setupDrag()}setupDrag(){const t=new u(this);t.onPress=((t,e)=>{if(e){const e=performance.now()-this.t;if(this.t=performance.now(),e<250)if(this.cc++,this.cc>1)this.select();else{this.innerContainer.toLocal(this.sp,void 0,this.ds,!0),this.updateClosestIndex(this.ds,!0);const t=this.chars[this.si];t&&(-1!=t.wordIndex?this.selectWord(t.wordIndex):this.selectRange(this.si,this.si))}else this.cc=0,this.sp.copyFrom(t.data.global),this.innerContainer.toLocal(this.sp,void 0,this.ds,!0),this.chars.length&&(this.updateClosestIndex(this.ds,!0),this.setCaretIndex(this.sie?this.si+1:this.si))}t.data.originalEvent.preventDefault()}),t.onDragMove=((t,e)=>{this.chars.length&&this._isFocused&&(this.de.x=this.sp.x+e.x,this.de.y=this.sp.y+e.y,this.innerContainer.toLocal(this.de,void 0,this.de,!0),this.updateClosestIndex(this.de,!1),this.si<this.ei?(this.selectRange(this.sie?this.si+1:this.si,this.eie?this.ei:this.ei-1),this.caret._index=this.eie?this.ei:this.ei-1):this.si>this.ei?(this.selectRange(this.ei,this.sie?this.si:this.si-1),this.caret._index=this.ei):this.sie===this.eie?this.setCaretIndex(this.sie?this.si+1:this.si):(this.selectRange(this.si,this.ei),this.caret._index=this.ei),this.caret._forward=this.si<=this.ei,this.caret._down=e.y>0,this.scrollToPosition(this.de))})}get innerContainer(){return this.textContainer.innerContainer.insetContainer}update(){this.width!==this._lastWidth&&(this._lastWidth=this._width,this.multiLine&&(this.updateText(),this.caret.visible&&this.setCaretIndex(this.caret._index),this.hasSelection&&this.updateSelectionGraphics())),this._dirtyText&&(this.updateText(),this._dirtyText=!1)}updateText(){this.textLengthPX=0,this.textHeightPX=0,this.lineIndexMax=0;let t=0;const i=this._value.length;let r=0,s=.5*(this.lineHeight-this.textHeight),n=0;if(this.chars.length>i){for(n=this.chars.length-1;n>=i;n--)this.innerContainer.removeChild(this.chars[n]),this.chars[n].destroy();this.chars.splice(i,this.chars.length-i)}let o=!1,h=!1,a=0,u=-1,l=!1;for(n=0;n<this._value.length;n++){(o||h)&&(u=n,a++);let i=this._value[n];o=" "===i,(h="\n"===i)&&(i="");let d=this.chars[n];d?d.text=i:(d=new e.Text(i,this.options.style),this.innerContainer.addChild(d),this.chars.push(d)),d.scale.x=h?0:1,d.wrapped=l,l=!1,!(h||this.multiLine&&r+d.width>=this._width-this.paddingLeft-this.paddingRight)||(t++,r=0,s+=this.lineHeight,-1===u||h)?(d.lineIndex=t,d.x=r,d.y=s,d.wordIndex=o||h?-1:a,(r+=d.width)>this.textLengthPX&&(this.textLengthPX=r),s>this.textHeightPX&&(this.textHeightPX=s)):(n=u-1,u=-1,l=!0)}this.lineIndexMax=t,this.innerContainer.addChild(this.caret),this.innerContainer.cacheAsBitmap&&(this.innerContainer.cacheAsBitmap=!1,this.innerContainer.cacheAsBitmap=!0),this.textContainer.update()}updateClosestIndex(t,e){let i=99999,r=-1,s=!1,n=0;this.lineIndexMax>0&&(n=Math.max(0,Math.min(this.lineIndexMax,Math.floor(t.y/this.lineHeight))));for(let o=0;o<this.chars.length;o++){const e=this.chars[o];if(e.lineIndex!==n)continue;const h=Math.abs(t.x-(e.x+.5*e.width));h<i&&(i=h,r=o,s=t.x>e.x+.5*e.width)}e?(this.si=r,this.sie=s):(this.ei=r,this.eie=s)}deleteSelection(){return!!this.hasSelection&&(this.value=this.value.slice(0,this.selectionStart)+this.value.slice(this.selectionEnd+1),this.setCaretIndex(this.selectionStart),!0)}updateSelectionColors(){for(let t=0;t<this.chars.length;t++)t>=this.selectionStart&&t<=this.selectionEnd?this.chars[t].style.fill=this.selectedColor:this.chars[t].style.fill=this.color}scrollToPosition(t){this._sp.x=t.x,this._sp.y=t.y,this.multiLine&&this._sp.y>=this.lineHeight&&(this._sp.y+=this.lineHeight),this.textContainer.focusPosition(this._sp)}resetScrollPosition(){this._sp.set(0,0),this.textContainer.focusPosition(this._sp)}hideCaret(){this.caret.visible=!1,clearInterval(this.caretInterval)}showCaret(){this.clearSelection(),clearInterval(this.caretInterval),this.caret.alpha=1,this.caret.visible=!0,this.caretInterval=setInterval(()=>{this.caret.alpha=0===this.caret.alpha?1:0},500)}insertTextAtCaret(t){if(this.multiLine||-1===t.indexOf("\n")||(t=t.replace(/\n/g,"")),this.hasSelection&&this.deleteSelection(),!this.maxLength||this.chars.length<this.maxLength)if(this.caret._atEnd)this.valueEvent+=t,this.setCaretIndex(this.chars.length);else{const e=Math.min(this.chars.length-1,this.caret._index);this.valueEvent=this.value.slice(0,e)+t+this.value.slice(e),this.setCaretIndex(e+t.length)}}get valueEvent(){return this._value}set valueEvent(t){this.maxLength&&(t=t.slice(0,this.maxLength)),this._value!=t&&(this.value=t,this.emit("change"))}get value(){return this._value}set value(t){this.maxLength&&(t=t.slice(0,this.maxLength)),this._value!=t&&(this._lastValue=this._value,this._value=t,this._dirtyText=!0,this.update())}get text(){return this.value}set text(t){this.value=t}}exports.TextInput=cn;class pn extends g{constructor(t,i,r){const s=new e.extras.TilingSprite(t);super(i||s.width,r||s.height),this.sprite=s,this.contentContainer.addChild(this.sprite)}update(){null!==this.tint&&(this.sprite.tint=this.tint),null!==this.blendMode&&(this.sprite.blendMode=this.blendMode),this.sprite.width=this._width,this.sprite.height=this._height}get tilePosition(){return this.sprite.tilePosition}set tilingPosition(t){this.sprite.tilePosition=t}get tileScale(){return this.sprite.tileScale}set tileScale(t){this.sprite.tileScale=t}}exports.TilingSprite=pn;class fn extends e.utils.EventEmitter{constructor(t){super(),this._disabled=!0,this._now=0,this.DeltaTime=0,this.Time=performance.now(),this.Ms=0,t&&(this.disabled=!1),fn.shared=this}get disabled(){return this._disabled}set disabled(t){this._disabled?(this._disabled=!1,fn.shared=this,this.update(performance.now(),!0)):this._disabled=!0}update(t){fn.shared._now=t,fn.shared.Ms=fn.shared._now-fn.shared.Time,fn.shared.Time=fn.shared._now,fn.shared.DeltaTime=.001*fn.shared.Ms,fn.shared.emit("update",fn.shared.DeltaTime),Js._update(fn.shared.DeltaTime),fn.shared._disabled||requestAnimationFrame(fn.shared.update)}static on(t,e,i){fn.shared.on(t,e,i)}static once(t,e,i){fn.shared.once(t,e,i)}static removeListener(t,e){fn.shared.removeListener(t,e)}}exports.Ticker=fn,fn.shared=new fn(!0);
},{"pixi.js":"aQiP","@pixi/filter-drop-shadow":"wgG9"}],"h4Qg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiTextInput=void 0;const t=require("@puxi/core"),e=require("pixi.js"),i=require("../Game/Graphics/Resource"),s=require("../Main"),n=[];class h extends t.Stage{constructor(h,u,r,x,a=null){super(r,x),this.x=h,this.y=u,this.width=r,this.height=x,this.interactive=!0,n.push(this),this.baseSkin=i.Resource.cGuiTextAreaBase,this.rollSkin=i.Resource.cGuiTextAreaRoll,a||(a=new e.TextStyle),a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#4C3D57";const o=new e.Container,l=new e.Sprite(this.baseSkin);l.width=r,l.height=x,o.addChild(l),this.textInput=new t.TextInput({value:"",width:r,height:x,style:a||new e.TextStyle,background:o}),this.on("mouseover",()=>{l.texture=this.rollSkin}),this.on("mouseout",()=>{this.textInput.isFocused||(l.texture=this.baseSkin)}),this.textInput.on("click",t=>{this.emit("click",t)}),this.textInput.on("focus",t=>{n.forEach(t=>{t!==this&&t.textInput.blur()}),l.texture=this.rollSkin,this.emit("focus",t)}),this.textInput.on("blur",t=>{l.texture=this.baseSkin,this.emit("blur",t)}),this.textInput.on("change",()=>{this.emit("change",this.textInput.text),this.text=this.textInput.text}),this.textInput.setLayoutOptions(new t.FastLayoutOptions({width:.9999,height:.9999})),this.addChild(this.textInput)}set maxLength(t){this.textInput.maxLength=t||0}get maxLength(){return this.textInput.maxLength}get enabled(){return this.interactive}set enabled(t){this.interactive=t}get editable(){return this.interactive}set editable(t){this.interactive=t}get text(){return this.textInput.text}set text(t){this.textInput.text=t}setSelection(t,e){this.textInput.selectRange(t,e)}}exports.GuiTextInput=h;
},{"@puxi/core":"u6bk","pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q"}],"viLo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColourChangeWindow=void 0;const e=require("pixi.js"),t=require("../Main"),i=require("../Parts/TextPart"),r=require("./GuiButton"),s=require("./GuiCheckBox"),a=require("./GuiCombobox"),o=require("./GuiTextInput"),h=require("./GuiWindow");class l extends h.GuiWindow{constructor(i,h){super(119,0,120,260),this.sortableChildren=!0,this.cont=i,this.m_sidePanel=h,this.m_colourSelector=new e.Graphics,this.addChild(this.m_colourSelector);var l=new e.TextStyle;l.fontFamily=t.Main.GLOBAL_FONT,l.fill=2369840,l.fontSize=12,this.m_redLabel=new e.Text(""),this.m_redLabel.text="Red:",this.m_redLabel.x=18,this.m_redLabel.y=20,this.m_redLabel.style=l,this.addChild(this.m_redLabel),this.m_greenLabel=new e.Text(""),this.m_greenLabel.text="Green:",this.m_greenLabel.x=18,this.m_greenLabel.y=40,this.m_greenLabel.style=l,this.addChild(this.m_greenLabel),this.m_blueLabel=new e.Text(""),this.m_blueLabel.text="Blue:",this.m_blueLabel.x=18,this.m_blueLabel.y=60,this.m_blueLabel.style=l,this.addChild(this.m_blueLabel),this.m_opacityLabel=new e.Text(""),this.m_opacityLabel.text="Opacity:",this.m_opacityLabel.x=18,this.m_opacityLabel.y=80,this.m_opacityLabel.style=l,this.addChild(this.m_opacityLabel),(l=new e.TextStyle).fontSize=9,this.m_redArea=new o.GuiTextInput(67,20,30,15,l),this.m_redArea.text="253",this.m_redArea.maxLength=3,this.m_redArea.on("click",e=>this.redFocus(e)),this.m_redArea.on("focus",e=>this.m_sidePanel.TextAreaGotFocus(e)),this.m_redArea.on("change",e=>this.redText(e)),this.m_redArea.on("blur",e=>this.focusOut(e)),this.addChild(this.m_redArea),this.m_greenArea=new o.GuiTextInput(67,40,30,15,l),this.m_greenArea.text="136",this.m_greenArea.maxLength=3,this.m_greenArea.on("click",e=>this.greenFocus(e)),this.m_greenArea.on("focus",e=>this.m_sidePanel.TextAreaGotFocus(e)),this.m_greenArea.on("change",e=>this.greenText(e)),this.m_greenArea.on("blur",e=>this.focusOut(e)),this.addChild(this.m_greenArea),this.m_blueArea=new o.GuiTextInput(67,60,30,15,l),this.m_blueArea.text="92",this.m_blueArea.maxLength=3,this.m_blueArea.on("click",e=>this.blueFocus(e)),this.m_blueArea.on("focus",e=>this.m_sidePanel.TextAreaGotFocus(e)),this.m_blueArea.on("change",e=>this.blueText(e)),this.m_blueArea.on("blur",e=>this.focusOut(e)),this.addChild(this.m_blueArea),this.m_opacityArea=new o.GuiTextInput(67,80,30,15,l),this.m_opacityArea.text="210",this.m_opacityArea.maxLength=3,this.m_opacityArea.on("click",e=>this.opacityFocus(e)),this.m_opacityArea.on("focus",e=>this.m_sidePanel.TextAreaGotFocus(e)),this.m_opacityArea.on("change",e=>this.opacityText(e)),this.m_opacityArea.on("blur",e=>this.focusOut(e)),this.addChild(this.m_opacityArea),this.m_colourBox=new a.GuiCombobox(10,95,100,30),this.m_colourBox.addItem({label:"  --"}),this.m_colourBox.addItem({label:"  Red"}),this.m_colourBox.addItem({label:"  Orange"}),this.m_colourBox.addItem({label:"  Yellow"}),this.m_colourBox.addItem({label:"  Green"}),this.m_colourBox.addItem({label:"  Turquoise"}),this.m_colourBox.addItem({label:"  Blue"}),this.m_colourBox.addItem({label:"  Purple"}),this.m_colourBox.addItem({label:"  Pink"}),this.m_colourBox.addItem({label:"  Beige"}),this.m_colourBox.addItem({label:"  Brown"}),this.m_colourBox.addItem({label:"  White"}),this.m_colourBox.addItem({label:"  Grey"}),this.m_colourBox.addItem({label:"  Black"}),this.m_colourBox.on("change",e=>this.colourBox(e)),this.m_colourBox.on("close",e=>this.colourBox(e)),(l=new e.TextStyle).fontFamily=t.Main.GLOBAL_FONT,l.fontSize=10,l.fill=4996439,this.m_colourBox.label.style=l,this.addChild(this.m_colourBox),this.redrawBox(),(l=new e.TextStyle).fontFamily=t.Main.GLOBAL_FONT,l.fontSize=10,l.fill=2369840,this.m_defaultBox=new s.GuiCheckBox(5,160,120),this.m_defaultBox.style=l,this.m_defaultBox.label="Make Default",this.m_defaultBox.selected=!1,this.addChild(this.m_defaultBox),this.m_okButton=new r.GuiButton("OK",10,180,100,35,e=>this.okButton(e),r.GuiButton.PURPLE),this.addChild(this.m_okButton),this.m_cancelButton=new r.GuiButton("Cancel",10,210,100,35,e=>this.cancelButton(e),r.GuiButton.PURPLE),this.addChild(this.m_cancelButton)}SetVals(){var e=this.cont.selectedParts[0];this.m_redArea.text=e.red+"",this.m_greenArea.text=e.green+"",this.m_blueArea.text=e.blue+"",this.m_opacityArea.text=e instanceof i.TextPart?"255":e.opacity+"",this.SetComboBoxIndex(),this.redrawBox()}SetComboBoxIndex(){var e=parseInt(this.m_redArea.text),t=parseInt(this.m_greenArea.text),i=parseInt(this.m_blueArea.text);this.m_colourBox.selectedIndex=253==e&&66==t&&42==i?1:253==e&&116==t&&10==i?2:251==e&&241==t&&56==i?3:80==e&&255==t&&72==i?4:52==e&&245==t&&227==i?5:54==e&&89==t&&255==i?6:189==e&&87==t&&255==i?7:255==e&&155==t&&152==i?8:255==e&&216==t&&136==i?9:151==e&&122==t&&46==i?10:253==e&&253==t&&253==i?11:160==e&&160==t&&160==i?12:24==e&&24==t&&24==i?13:0}cancelButton(e){this.visible=!1}redFocus(e){this.m_redArea.setSelection(0,3)}greenFocus(e){this.m_greenArea.setSelection(0,3)}blueFocus(e){this.m_blueArea.setSelection(0,3)}opacityFocus(e){this.m_opacityArea.setSelection(0,3)}focusOut(e){this.m_sidePanel.TextAreaLostFocus()}redText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),e=t+"",this.SetComboBoxIndex(),this.redrawBox(),this.cont.textEntered()}greenText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),e=t+"",this.SetComboBoxIndex(),this.redrawBox(),this.cont.textEntered()}blueText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),e=t+"",this.SetComboBoxIndex(),this.redrawBox(),this.cont.textEntered()}opacityText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),e=t+"",this.cont.textEntered()}colourBox(e){1==e?(this.m_redArea.text="253",this.m_greenArea.text="66",this.m_blueArea.text="42"):2==e?(this.m_redArea.text="253",this.m_greenArea.text="116",this.m_blueArea.text="10"):3==e?(this.m_redArea.text="251",this.m_greenArea.text="241",this.m_blueArea.text="56"):4==e?(this.m_redArea.text="80",this.m_greenArea.text="255",this.m_blueArea.text="72"):5==e?(this.m_redArea.text="52",this.m_greenArea.text="245",this.m_blueArea.text="227"):6==e?(this.m_redArea.text="54",this.m_greenArea.text="89",this.m_blueArea.text="255"):7==e?(this.m_redArea.text="189",this.m_greenArea.text="87",this.m_blueArea.text="255"):8==e?(this.m_redArea.text="255",this.m_greenArea.text="155",this.m_blueArea.text="152"):9==e?(this.m_redArea.text="255",this.m_greenArea.text="216",this.m_blueArea.text="136"):10==e?(this.m_redArea.text="151",this.m_greenArea.text="122",this.m_blueArea.text="46"):11==e?(this.m_redArea.text="253",this.m_greenArea.text="253",this.m_blueArea.text="253"):12==e?(this.m_redArea.text="160",this.m_greenArea.text="160",this.m_blueArea.text="160"):13==e&&(this.m_redArea.text="24",this.m_greenArea.text="24",this.m_blueArea.text="24"),this.redrawBox()}okButton(e){this.cancelButton(e),this.cont.colourButton(parseInt(this.m_redArea.text),parseInt(this.m_greenArea.text),parseInt(this.m_blueArea.text),parseInt(this.m_opacityArea.text),this.m_defaultBox.selected)}redrawBox(){this.m_colourSelector.clear(),this.m_colourSelector.beginFill(e.utils.rgb2hex([parseInt(this.m_redArea.text)/255,parseInt(this.m_greenArea.text)/255,parseInt(this.m_blueArea.text)/255]),1),this.m_colourSelector.lineStyle(1,2236962,1),this.m_colourSelector.drawRect(40,128,40,30),this.m_colourSelector.endFill()}}exports.ColourChangeWindow=l;
},{"pixi.js":"aQiP","../Main":"aM6Q","../Parts/TextPart":"T0pq","./GuiButton":"IBBZ","./GuiCheckBox":"nOXD","./GuiCombobox":"a9Q3","./GuiTextInput":"h4Qg","./GuiWindow":"BOXT"}],"qnZ8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiSlider=void 0;const e=require("@puxi/core"),i=require("../Game/Graphics/Resource");class t extends e.Stage{constructor(t){super(80,20),this.trackSprite=new e.Sprite(i.Resource.cGuiSliderGroove),t||(t={track:this.trackSprite,handle:new e.Sprite(i.Resource.cGuiSliderThumb)}),this.slider=new e.Slider(t),this.addChild(this.slider),this.slider.on("change",e=>{this.emit("change",e)})}set minValue(e){this.slider.minValue=e}get minValue(){return this.slider.minValue}set maxValue(e){this.slider.maxValue=e}get maxValue(){return this.slider.maxValue}set value(e){this.slider.value=e}get value(){return this.slider.value}set enabled(e){this.interactive=e}get enabled(){return this.interactive}}exports.GuiSlider=t;
},{"@puxi/core":"u6bk","../Game/Graphics/Resource":"VWUR"}],"hjO3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GuiTextArea=void 0;const e=require("@puxi/core"),t=require("pixi.js"),i=require("../Game/Graphics/Resource"),s=require("../Main");class r extends e.Stage{constructor(r,n,o,u,h=null){super(o,u),this.text="",this.x=r,this.y=n,this.width=o,this.height=u,this.interactive=!0,this.baseSkin=i.Resource.cGuiTextAreaBase,this.rollSkin=i.Resource.cGuiTextAreaRoll,h||(h=new t.TextStyle),h.fontFamily=s.Main.GLOBAL_FONT,h.fill="#4C3D57";const a=new t.Container,l=new t.Sprite(this.baseSkin);l.width=o,l.height=u,a.addChild(l);const x=new e.TextInput({multiLine:!0,value:"",width:o,height:u,style:h||new t.TextStyle,background:a});x.setPadding(5,5),this.on("mouseover",()=>{l.texture=this.rollSkin}),this.on("mouseout",()=>{x.isFocused||(l.texture=this.baseSkin)}),x.on("focus",()=>{l.texture=this.rollSkin}),x.on("blur",()=>{l.texture=this.baseSkin}),x.on("change",()=>{this.text=x.text}),x.setLayoutOptions(new e.FastLayoutOptions({width:.9999,height:.9999})),this.addChild(x)}}exports.GuiTextArea=r;
},{"@puxi/core":"u6bk","pixi.js":"aQiP","../Game/Graphics/Resource":"VWUR","../Main":"aM6Q"}],"O6IY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PartEditWindow=void 0;const t=require("pixi.js"),e=require("../Game/Globals/ControllerGameGlobals"),i=require("../General/Input"),s=require("../Main"),n=require("../Parts/Circle"),o=require("../Parts/PrismaticJoint"),l=require("../Parts/Rectangle"),h=require("../Parts/RevoluteJoint"),a=require("../Parts/ShapePart"),r=require("../Parts/Triangle"),m=require("./ColourChangeWindow"),d=require("./GuiButton"),_=require("./GuiCheckBox"),u=require("./GuiSlider"),c=require("./GuiTextArea"),x=require("./GuiTextInput"),b=require("./GuiWindow");class B extends b.GuiWindow{constructor(e){super(0,90,120,500),this.enteringInput=!1,this.sliderDown=!1,this.m_fixateBox2=null,this.cont=e,this.visible=!1,this.m_colourWindow=new m.ColourChangeWindow(this.cont,this),this.addChild(this.m_colourWindow),this.m_colourWindow.visible=!1,this.m_objectEditPanel=new t.Sprite,this.addChild(this.m_objectEditPanel),this.m_textEditPanel=new t.Sprite,this.addChild(this.m_textEditPanel),this.m_fixedJointPanel=new t.Sprite,this.addChild(this.m_fixedJointPanel),this.m_jointEditPanel=new t.Sprite,this.addChild(this.m_jointEditPanel),this.m_thrustersEditPanel=new t.Sprite,this.addChild(this.m_thrustersEditPanel),this.m_multiEditPanel=new t.Sprite,this.addChild(this.m_multiEditPanel),this.m_buildBoxPanel=new t.Sprite,this.addChild(this.m_buildBoxPanel),this.m_cannonPanel=new t.Sprite,this.addChild(this.m_cannonPanel);var i=new t.TextStyle;i.fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fontSize=14,i.fill="#242930";var n=new t.TextStyle;n.fontFamily=s.Main.GLOBAL_FONT,n.fontSize=9,n.fill="#666570",this.m_shapeHeader=new t.Text(""),this.m_shapeHeader.anchor.set(.5),this.m_shapeHeader.text="Circle",this.m_shapeHeader.x=60,this.m_shapeHeader.y=25,this.m_shapeHeader.style=i,this.m_objectEditPanel.addChild(this.m_shapeHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_objectEditPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteButton(),d.GuiButton.ORANGE),this.m_objectEditPanel.addChild(this.m_deleteButton),this.m_cutButton=new d.GuiButton("Cut",10,60,100,35,()=>this.cont.cutButton(),d.GuiButton.ORANGE),this.m_objectEditPanel.addChild(this.m_cutButton),this.m_copyButton=new d.GuiButton("Copy",10,90,100,35,()=>this.cont.copyButton(),d.GuiButton.ORANGE),this.m_objectEditPanel.addChild(this.m_copyButton),this.m_pasteButton=new d.GuiButton("Paste",10,120,100,35,()=>this.cont.pasteButton(),d.GuiButton.ORANGE),this.m_objectEditPanel.addChild(this.m_pasteButton),this.m_rotateButton=new d.GuiButton("Rotate",10,150,100,35,()=>this.cont.rotateButton(),d.GuiButton.BLUE),this.m_objectEditPanel.addChild(this.m_rotateButton),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fill="#242930",i.fontSize=12,this.m_densityLabel=new t.Text(""),this.m_densityLabel.text="Density",this.m_densityLabel.x=39,this.m_densityLabel.y=186,this.m_densityLabel.style=i,this.m_objectEditPanel.addChild(this.m_densityLabel),this.m_densitySlider=new u.GuiSlider,this.m_densitySlider.x=20,this.m_densitySlider.y=205,this.m_densitySlider.minValue=1,this.m_densitySlider.maxValue=30,this.m_densitySlider.value=15,this.m_densitySlider.on("change",t=>this.cont.densitySlider(t)),this.m_objectEditPanel.addChild(this.m_densitySlider),(i=new t.TextStyle).fontSize=9,this.m_densityArea=new x.GuiTextInput(35,220,50,15,i),this.m_densityArea.text="10",this.m_densityArea.maxLength=5,this.m_densityArea.on("click",t=>this.densityFocus(t)),this.m_densityArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_densityArea.on("change",t=>this.cont.textEntered()),this.m_densityArea.on("blur",t=>this.cont.densityText(t)),this.m_objectEditPanel.addChild(this.m_densityArea),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,i.fill=2369840,this.m_collisionBox=new _.GuiCheckBox(5,240,120),this.m_collisionBox.style=i,this.m_collisionBox.disabledStyle=n,this.m_collisionBox.label="Collides",this.m_collisionBox.selected=!0,this.m_collisionBox.on("change",t=>this.cont.collisionBox(t)),this.m_objectEditPanel.addChild(this.m_collisionBox),this.m_cameraBox=new _.GuiCheckBox(5,260,120),this.m_cameraBox.style=i,this.m_cameraBox.disabledStyle=n,this.m_cameraBox.label="Camera Focus",this.m_cameraBox.selected=!1,this.m_cameraBox.on("change",t=>this.cont.cameraBox(t)),this.m_objectEditPanel.addChild(this.m_cameraBox),this.m_fixateBox=new _.GuiCheckBox(5,300,120),this.m_fixateBox.style=i,this.m_fixateBox.disabledStyle=n,this.m_fixateBox.label="Fixate",this.m_fixateBox.selected=!1,this.m_fixateBox.on("change",t=>this.cont.fixateBox(t)),this.m_objectEditPanel.addChild(this.m_fixateBox),this.m_colourButton=new d.GuiButton("Change Color",5,320,110,35,()=>this.colourButton(),d.GuiButton.BLUE),this.m_objectEditPanel.addChild(this.m_colourButton),this.m_frontButton=new d.GuiButton("Move to Front",5,350,110,35,()=>this.cont.frontButton(),d.GuiButton.PINK),this.m_objectEditPanel.addChild(this.m_frontButton),this.m_backButton=new d.GuiButton("Move to Back",5,380,110,35,()=>this.cont.backButton(),d.GuiButton.PINK),this.m_objectEditPanel.addChild(this.m_backButton),this.m_outlineBox=new _.GuiCheckBox(5,415,120),this.m_outlineBox.style=i,this.m_outlineBox.disabledStyle=n,this.m_outlineBox.label="Show Outlines",this.m_outlineBox.selected=!1,this.m_outlineBox.on("change",t=>this.cont.outlineBox(t)),this.m_objectEditPanel.addChild(this.m_outlineBox),this.m_terrainBox=new _.GuiCheckBox(5,435,120),this.m_terrainBox.style=i,this.m_terrainBox.disabledStyle=n,this.m_terrainBox.label="Outlines Behind",this.m_terrainBox.selected=!1,this.m_terrainBox.on("change",t=>this.cont.terrainBox(t)),this.m_objectEditPanel.addChild(this.m_terrainBox),this.m_undragableBox=new _.GuiCheckBox(5,280,120),this.m_undragableBox.style=i,this.m_undragableBox.disabledStyle=n,this.m_undragableBox.label="Undraggable",this.m_undragableBox.selected=!1,this.m_undragableBox.on("change",t=>this.cont.undragableBox(t)),this.m_objectEditPanel.addChild(this.m_undragableBox),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fill="#242930",i.fontSize=14,this.m_cannonHeader=new t.Text(""),this.m_cannonHeader.text="Cannon",this.m_cannonHeader.width=110,this.m_cannonHeader.height=20,this.m_cannonHeader.x=5,this.m_cannonHeader.y=15,this.m_cannonHeader.style=i,this.m_cannonPanel.addChild(this.m_cannonHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_cannonPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteButton(),d.GuiButton.ORANGE),this.m_cannonPanel.addChild(this.m_deleteButton),this.m_cutButton=new d.GuiButton("Cut",10,60,100,35,()=>this.cont.cutButton(),d.GuiButton.ORANGE),this.m_cannonPanel.addChild(this.m_cutButton),this.m_copyButton=new d.GuiButton("Copy",10,90,100,35,()=>this.cont.copyButton(),d.GuiButton.ORANGE),this.m_cannonPanel.addChild(this.m_copyButton),this.m_rotateButton=new d.GuiButton("Rotate",10,120,100,35,()=>this.cont.rotateButton(),d.GuiButton.BLUE),this.m_cannonPanel.addChild(this.m_rotateButton),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fill="#242930",i.fontSize=12,this.m_densityLabel=new t.Text(""),this.m_densityLabel.text="Density",this.m_densityLabel.x=39,this.m_densityLabel.y=156,this.m_densityLabel.style=i,this.m_cannonPanel.addChild(this.m_densityLabel),this.m_densitySlider7=new u.GuiSlider,this.m_densitySlider7.x=20,this.m_densitySlider7.y=175,this.m_densitySlider7.minValue=1,this.m_densitySlider7.maxValue=30,this.m_densitySlider7.value=15,this.m_densitySlider7.on("change",t=>this.cont.densitySlider(t)),this.m_cannonPanel.addChild(this.m_densitySlider7),(i=new t.TextStyle).fontSize=9,this.m_densityArea7=new x.GuiTextInput(35,190,50,15,i),this.m_densityArea7.text="10",this.m_densityArea7.maxLength=5,this.m_densityArea7.on("click",t=>this.densityFocus(t)),this.m_densityArea7.on("focus",t=>this.TextAreaGotFocus(t)),this.m_densityArea7.on("change",t=>this.cont.textEntered()),this.m_densityArea7.on("blur",t=>this.cont.densityText(t)),this.m_densityArea7.on("hide",t=>this.cont.densityText(t)),this.m_cannonPanel.addChild(this.m_densityArea7),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,i.fill=2369840,this.m_collisionBox7=new _.GuiCheckBox(5,210,120),this.m_collisionBox7.style=i,this.m_collisionBox7.label="Collides",this.m_collisionBox7.selected=!0,this.m_collisionBox7.on("change",t=>this.cont.collisionBox(t)),this.m_cannonPanel.addChild(this.m_collisionBox7),this.m_fixateBox7=new _.GuiCheckBox(5,250,120),this.m_fixateBox7.style=i,this.m_fixateBox7.disabledStyle=n,this.m_fixateBox7.label="Fixate",this.m_fixateBox7.selected=!1,this.m_fixateBox7.on("change",t=>this.cont.fixateBox(t)),this.m_cannonPanel.addChild(this.m_fixateBox7),this.m_colourButton=new d.GuiButton("Change Color",5,270,110,35,()=>this.colourButton(),d.GuiButton.BLUE),this.m_cannonPanel.addChild(this.m_colourButton),this.m_frontButton=new d.GuiButton("Move to Front",5,300,110,35,()=>this.cont.frontButton(),d.GuiButton.PINK),this.m_cannonPanel.addChild(this.m_frontButton),this.m_backButton=new d.GuiButton("Move to Back",5,330,110,35,()=>this.cont.backButton(),d.GuiButton.PINK),this.m_cannonPanel.addChild(this.m_backButton),this.m_outlineBox7=new _.GuiCheckBox(5,365,120),this.m_outlineBox7.style=i,this.m_outlineBox7.disabledStyle=n,this.m_outlineBox7.label="Show Outlines",this.m_outlineBox7.selected=!1,this.m_outlineBox7.on("change",t=>this.cont.outlineBox(t)),this.m_cannonPanel.addChild(this.m_outlineBox7),this.m_terrainBox7=new _.GuiCheckBox(5,385,120),this.m_terrainBox7.style=i,this.m_terrainBox7.label="Outlines Behind",this.m_terrainBox7.selected=!1,this.m_terrainBox7.on("change",t=>this.cont.terrainBox(t)),this.m_cannonPanel.addChild(this.m_terrainBox7),this.m_undragableBox7=new _.GuiCheckBox(5,230,120),this.m_undragableBox7.style=i,this.m_undragableBox7.disabledStyle=n,this.m_undragableBox7.label="Undraggable",this.m_undragableBox7.selected=!1,this.m_undragableBox7.on("change",t=>this.cont.undragableBox(t)),this.m_cannonPanel.addChild(this.m_undragableBox7),(i=new t.TextStyle).fontSize=10,i.fontFamily=s.Main.GLOBAL_FONT,i.fill=2369840,this.m_strengthLabel7=new t.Text(""),this.m_strengthLabel7.text="Cannon Strength",this.m_strengthLabel7.style=i,this.m_strengthLabel7.width=120,this.m_strengthLabel7.height=20,this.m_strengthLabel7.x=21,this.m_strengthLabel7.y=434,this.m_strengthLabel7.style=i,this.m_cannonPanel.addChild(this.m_strengthLabel7),this.m_strengthSlider7=new u.GuiSlider,this.m_strengthSlider7.x=20,this.m_strengthSlider7.y=451,this.m_strengthSlider7.minValue=1,this.m_strengthSlider7.maxValue=30,this.m_strengthSlider7.value=15,this.m_strengthSlider7.on("change",t=>this.cont.cannonSlider(t)),this.m_cannonPanel.addChild(this.m_strengthSlider7),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=10,this.m_strengthArea7=new x.GuiTextInput(35,468,50,15,i),this.m_strengthArea7.text="15",this.m_strengthArea7.maxLength=5,this.m_strengthArea7.on("click",t=>this.cannonFocus(t)),this.m_strengthArea7.on("focus",t=>this.TextAreaGotFocus(t)),this.m_strengthArea7.on("change",t=>this.cont.textEntered(t)),this.m_strengthArea7.on("blur",t=>this.cont.cannonText(t)),this.m_strengthArea7.on("hide",t=>this.cont.cannonText(t)),this.m_cannonPanel.addChild(this.m_strengthArea7),this.m_fireKeyArea=new x.GuiTextInput(60,412,37,15,i),this.m_fireKeyArea.editable=!1,this.m_fireKeyArea.on("click",t=>this.cannonKeyFocus(t)),this.m_fireKeyArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_fireKeyArea.on("keydown",t=>this.cont.fireKeyText(t)),this.m_fireKeyArea.on("blur",t=>this.TextAreaLostFocus(t)),this.m_fireKeyArea.on("hide",t=>this.TextAreaLostFocus(t)),this.m_cannonPanel.addChild(this.m_fireKeyArea),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fill="#242930",i.align="right",this.m_fireKeyLabel=new t.Text(""),this.m_fireKeyLabel.text="Fire:",this.m_fireKeyLabel.width=50,this.m_fireKeyLabel.height=20,this.m_fireKeyLabel.x=2,this.m_fireKeyLabel.y=411,this.m_fireKeyLabel.style=i,this.m_cannonPanel.addChild(this.m_fireKeyLabel),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fontSize=14,i.fill="#242930",this.m_jointHeader=new t.Text(""),this.m_jointHeader.anchor.set(.5),this.m_jointHeader.text="Multiple Objects",this.m_jointHeader.x=60,this.m_jointHeader.y=25,this.m_jointHeader.style=i,this.m_multiEditPanel.addChild(this.m_jointHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_multiEditPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.multiDeleteButton(),d.GuiButton.ORANGE),this.m_multiEditPanel.addChild(this.m_deleteButton),this.m_cutButton=new d.GuiButton("Cut",10,60,100,35,()=>this.cont.cutButton(),d.GuiButton.ORANGE),this.m_multiEditPanel.addChild(this.m_cutButton),this.m_copyButton=new d.GuiButton("Copy",10,90,100,35,()=>this.cont.copyButton(),d.GuiButton.ORANGE),this.m_multiEditPanel.addChild(this.m_copyButton),this.m_pasteButton=new d.GuiButton("Paste",10,120,100,35,()=>this.cont.pasteButton(),d.GuiButton.ORANGE),this.m_multiEditPanel.addChild(this.m_pasteButton),this.m_rotateButton=new d.GuiButton("Rotate",10,150,100,35,()=>this.cont.rotateButton(),d.GuiButton.BLUE),this.m_multiEditPanel.addChild(this.m_rotateButton),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,i.fill=2369840,this.m_outlineBox3=new _.GuiCheckBox(5,300,120),this.m_outlineBox3.style=i,this.m_outlineBox3.label="Show Outlines",this.m_outlineBox3.selected=!0,this.m_outlineBox3.on("change",t=>this.cont.outlineBox(t)),this.m_multiEditPanel.addChild(this.m_outlineBox3),this.m_terrainBox3=new _.GuiCheckBox(5,320,120),this.m_terrainBox3.style=i,this.m_terrainBox3.label="Outlines Behind",this.m_terrainBox3.selected=!1,this.m_terrainBox3.on("change",t=>this.cont.terrainBox(t)),this.m_multiEditPanel.addChild(this.m_terrainBox3),this.m_colourButton=new d.GuiButton("Change Color",5,260,110,35,()=>this.colourButton(),d.GuiButton.BLUE),this.m_multiEditPanel.addChild(this.m_colourButton),this.m_collisionBox2=new _.GuiCheckBox(5,190,120),this.m_collisionBox2.style=i,this.m_collisionBox2.disabledStyle=n,this.m_collisionBox2.label="Collides",this.m_collisionBox2.selected=!1,this.m_collisionBox2.on("change",t=>this.cont.collisionBox(t)),this.m_multiEditPanel.addChild(this.m_collisionBox2),this.m_fixateBox2=new _.GuiCheckBox(5,230,120),this.m_fixateBox2.style=i,this.m_fixateBox2.disabledStyle=n,this.m_fixateBox2.label="Fixate",this.m_fixateBox2.selected=!1,this.m_fixateBox2.on("change",t=>this.cont.fixateBox(t)),this.m_multiEditPanel.addChild(this.m_fixateBox2),this.m_undragableBox2=new _.GuiCheckBox(5,210,120),this.m_undragableBox2.style=i,this.m_undragableBox2.disabledStyle=n,this.m_undragableBox2.label="Undraggable",this.m_undragableBox2.selected=!1,this.m_undragableBox2.on("click",t=>this.cont.undragableBox(t)),this.m_multiEditPanel.addChild(this.m_undragableBox2),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fontSize=14,i.fill="#242930",this.m_jointHeader=new t.Text(""),this.m_jointHeader.text="Text",this.m_jointHeader.x=60,this.m_jointHeader.y=25,this.m_jointHeader.style=i,this.m_textEditPanel.addChild(this.m_jointHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_textEditPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteButton(),d.GuiButton.ORANGE),this.m_textEditPanel.addChild(this.m_deleteButton),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fill="#242930",this.m_textLabel=new t.Text(""),this.m_textLabel.text="Text:",this.m_textLabel.width=55,this.m_textLabel.height=20,this.m_textLabel.x=45,this.m_textLabel.y=68,this.m_textLabel.style=i,this.m_textEditPanel.addChild(this.m_textLabel),this.m_textArea=new c.GuiTextArea(15,85,90,70),this.m_textArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_textArea.on("focus",t=>this.cont.textTextStart(t)),this.m_textArea.on("change",t=>this.cont.textText(t)),this.m_textArea.on("blur",t=>this.cont.textTextFinish(t)),this.m_textArea.on("blur",t=>this.TextAreaLostFocus(t)),this.m_textArea.on("hide",t=>this.TextAreaLostFocus(t)),this.m_textEditPanel.addChild(this.m_textArea),this.m_sizeLabel=new t.Text(""),this.m_sizeLabel.text="Text Size:",this.m_sizeLabel.width=55,this.m_sizeLabel.height=20,this.m_sizeLabel.x=15,this.m_sizeLabel.y=170,this.m_sizeLabel.style=i,this.m_textEditPanel.addChild(this.m_sizeLabel),(i=new t.TextStyle).fontSize=9,this.m_sizeArea=new x.GuiTextInput(72,170,30,15,i),this.m_sizeArea.text="12",this.m_sizeArea.maxLength=4,this.m_sizeArea.on("click",t=>this.sizeFocus(t)),this.m_sizeArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_sizeArea.on("change",t=>this.cont.textEntered(t)),this.m_sizeArea.on("blur",t=>this.cont.sizeText(t)),this.m_sizeArea.on("hide",t=>this.cont.sizeText(t)),this.m_textEditPanel.addChild(this.m_sizeArea),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,i.fill=2369840,this.m_scaleWithZoomBox=new _.GuiCheckBox(2,195,120),this.m_scaleWithZoomBox.style=i,this.m_scaleWithZoomBox.label="Scale with Zoom",this.m_scaleWithZoomBox.selected=!0,this.m_scaleWithZoomBox.on("change",t=>this.cont.scaleWithZoomBox(t)),this.m_textEditPanel.addChild(this.m_scaleWithZoomBox),this.m_alwaysVisibleBox=new _.GuiCheckBox(2,215,120),this.m_alwaysVisibleBox.style=i,this.m_alwaysVisibleBox.label="Always Display",this.m_alwaysVisibleBox.selected=!1,this.m_alwaysVisibleBox.on("change",t=>this.cont.alwaysVisibleBox(t)),this.m_textEditPanel.addChild(this.m_alwaysVisibleBox),this.m_colourButton=new d.GuiButton("Change Color",5,290,110,35,()=>this.colourButton(),d.GuiButton.BLUE),this.m_textEditPanel.addChild(this.m_colourButton),this.m_frontButton=new d.GuiButton("Move to Front",5,320,110,35,()=>this.cont.frontButton(),d.GuiButton.PINK),this.m_textEditPanel.addChild(this.m_frontButton),this.m_backButton=new d.GuiButton("Move to Back",5,350,110,35,()=>this.cont.backButton(),d.GuiButton.PINK),this.m_textEditPanel.addChild(this.m_backButton),(i=new t.TextStyle).fontSize=9,this.m_textKeyArea=new x.GuiTextInput(45,268,30,15,i),this.m_textKeyArea.editable=!1,this.m_textKeyArea.on("click",t=>this.controlKey1Focus(t)),this.m_textKeyArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_textKeyArea.on("keydown",t=>this.cont.textKeyBox(t)),this.m_textKeyArea.on("blur",t=>this.TextAreaLostFocus(t)),this.m_textKeyArea.on("hide",t=>this.TextAreaLostFocus(t)),this.m_textEditPanel.addChild(this.m_textKeyArea),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=10,i.fill=2369840,this.m_textKeyLabel=new t.Text(""),this.m_textKeyLabel.text="Display Text Key:",this.m_textKeyLabel.anchor.set(.5),this.m_textKeyLabel.x=63,this.m_textKeyLabel.y=260,this.m_textKeyLabel.style=i,this.m_textEditPanel.addChild(this.m_textKeyLabel),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fontSize=14,i.fill="#242930",this.m_jointHeader=new t.Text(""),this.m_jointHeader.text="Fixed Joint",this.m_jointHeader.anchor.set(.5),this.m_jointHeader.x=60,this.m_jointHeader.y=25,this.m_jointHeader.style=i,this.m_fixedJointPanel.addChild(this.m_jointHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_fixedJointPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteButton(),d.GuiButton.ORANGE),this.m_fixedJointPanel.addChild(this.m_deleteButton),this.m_jointHeader=new t.Text(""),this.m_jointHeader.text="Build Box",this.m_jointHeader.anchor.set(.5),this.m_jointHeader.x=60,this.m_jointHeader.y=25,this.m_jointHeader.style=i,this.m_buildBoxPanel.addChild(this.m_jointHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_buildBoxPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteBuildBoxButton(),d.GuiButton.ORANGE),this.m_buildBoxPanel.addChild(this.m_deleteButton),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fontSize=14,i.fill="#242930",this.m_thrustersHeader=new t.Text(""),this.m_thrustersHeader.text="Thrusters",this.m_thrustersHeader.anchor.set(.5),this.m_thrustersHeader.x=60,this.m_thrustersHeader.y=25,this.m_thrustersHeader.style=i,this.m_thrustersEditPanel.addChild(this.m_thrustersHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_thrustersEditPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteButton(),d.GuiButton.ORANGE),this.m_thrustersEditPanel.addChild(this.m_deleteButton),this.m_cutButton=new d.GuiButton("Cut",10,60,100,35,()=>this.cont.cutButton(),d.GuiButton.ORANGE),this.m_thrustersEditPanel.addChild(this.m_cutButton),this.m_copyButton=new d.GuiButton("Copy",10,90,100,35,()=>this.cont.copyButton(),d.GuiButton.ORANGE),this.m_thrustersEditPanel.addChild(this.m_copyButton),this.m_pasteButton=new d.GuiButton("Paste",10,120,100,35,()=>this.cont.pasteButton(),d.GuiButton.ORANGE),this.m_thrustersEditPanel.addChild(this.m_pasteButton),this.m_rotateButton=new d.GuiButton("Rotate",10,150,100,35,()=>this.cont.rotateButton(),d.GuiButton.BLUE),this.m_thrustersEditPanel.addChild(this.m_rotateButton),(i=new t.TextStyle).fontSize=10,i.fontFamily=s.Main.GLOBAL_FONT,i.fill="#242930",this.m_thrustLabel=new t.Text(""),this.m_thrustLabel.text="Thruster Strength",this.m_thrustLabel.style=i,this.m_thrustLabel.anchor.set(.5),this.m_thrustLabel.x=81,this.m_thrustLabel.y=200,this.m_thrustLabel.style=i,this.m_thrustersEditPanel.addChild(this.m_thrustLabel),this.m_thrustSlider=new u.GuiSlider,this.m_thrustSlider.x=20,this.m_thrustSlider.y=207,this.m_thrustSlider.minValue=1,this.m_thrustSlider.maxValue=30,this.m_thrustSlider.value=15,this.m_thrustSlider.on("change",t=>this.cont.thrustSlider(t)),this.m_thrustersEditPanel.addChild(this.m_thrustSlider),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=10,this.m_thrustArea=new x.GuiTextInput(35,224,50,15,i),this.m_thrustArea.text="10",this.m_thrustArea.maxLength=5,this.m_thrustArea.on("click",t=>this.thrustFocus(t)),this.m_thrustArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_thrustArea.on("change",t=>this.cont.textEntered(t)),this.m_thrustArea.on("blur",t=>this.cont.thrustText(t)),this.m_thrustArea.on("hide",t=>this.cont.thrustText(t)),this.m_thrustersEditPanel.addChild(this.m_thrustArea),this.m_thrustKeyArea=new x.GuiTextInput(65,259,37,15,i),this.m_thrustKeyArea.editable=!1,this.m_thrustKeyArea.on("click",t=>this.thrustKeyFocus(t)),this.m_thrustKeyArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_thrustKeyArea.on("keydown",t=>this.cont.thrustKeyText(t)),this.m_thrustKeyArea.on("blur",t=>this.TextAreaLostFocus(t)),this.m_thrustKeyArea.on("hide",t=>this.TextAreaLostFocus(t)),this.m_thrustersEditPanel.addChild(this.m_thrustKeyArea),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fill=2369840,i.align="right",this.m_thrustKeyLabel=new t.Text(""),this.m_thrustKeyLabel.text="Activate:",this.m_thrustKeyLabel.anchor.set(.5),this.m_thrustKeyLabel.x=34.5,this.m_thrustKeyLabel.y=278,this.m_thrustKeyLabel.style=i,this.m_thrustersEditPanel.addChild(this.m_thrustKeyLabel),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=10,i.fill=2369840,this.m_autoBox3=new _.GuiCheckBox(5,290,120),this.m_autoBox3.style=i,this.m_autoBox3.disabledStyle=i,this.m_autoBox3.label="Auto-On",this.m_autoBox3.selected=!1,this.m_autoBox3.on("change",t=>this.cont.autoBox1(t)),this.m_thrustersEditPanel.addChild(this.m_autoBox3),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.align="center",i.fontSize=14,this.m_jointHeader=new t.Text(""),this.m_jointHeader.text="Rotating Joint",this.m_jointHeader.anchor.set(.5),this.m_jointHeader.x=60,this.m_jointHeader.y=25,this.m_jointHeader.style=i,this.m_jointEditPanel.addChild(this.m_jointHeader),this.m_backButton=new d.GuiButton("X",90,-5,35,35,()=>this.backButton(),d.GuiButton.X),this.m_jointEditPanel.addChild(this.m_backButton),this.m_deleteButton=new d.GuiButton("Delete",10,30,100,35,()=>this.cont.deleteButton(),d.GuiButton.ORANGE),this.m_jointEditPanel.addChild(this.m_deleteButton),this.m_cutButton=new d.GuiButton("Cut",10,60,100,35,()=>this.cont.cutButton(),d.GuiButton.ORANGE),this.m_jointEditPanel.addChild(this.m_cutButton),this.m_copyButton=new d.GuiButton("Copy",10,90,100,35,()=>this.cont.copyButton(),d.GuiButton.ORANGE),this.m_jointEditPanel.addChild(this.m_copyButton),this.m_pasteButton=new d.GuiButton("Paste",10,120,100,35,()=>this.cont.pasteButton(),d.GuiButton.ORANGE),this.m_jointEditPanel.addChild(this.m_pasteButton),(i=new t.TextStyle).fontSize=9,this.m_minDispArea=new x.GuiTextInput(42,409,30,15,i),this.m_minDispArea.text="None",this.m_minDispArea.maxLength=4,this.m_minDispArea.on("click",t=>this.minDispFocus(t)),this.m_minDispArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_minDispArea.on("change",t=>this.cont.textEntered()),this.m_minDispArea.on("blur",t=>this.cont.minLimitText(t)),this.m_minDispArea.on("hide",t=>this.cont.minLimitText(t)),this.m_jointEditPanel.addChild(this.m_minDispArea),this.m_maxDispArea=new x.GuiTextInput(42,444,30,15,i),this.m_maxDispArea.text="None",this.m_maxDispArea.maxLength=4,this.m_maxDispArea.on("click",t=>this.maxDispFocus(t)),this.m_maxDispArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_maxDispArea.on("change",t=>this.cont.textEntered()),this.m_maxDispArea.on("blur",t=>this.cont.maxLimitText(t)),this.m_maxDispArea.on("hide",t=>this.cont.maxLimitText(t)),this.m_jointEditPanel.addChild(this.m_maxDispArea),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,i.fill=2369840,this.m_enableMotorBox=new _.GuiCheckBox(5,152,120),this.m_enableMotorBox.style=i,this.m_enableMotorBox.label="Enable Motor",this.m_enableMotorBox.selected=!1,this.m_enableMotorBox.on("change",t=>this.cont.motorBox(t)),this.m_jointEditPanel.addChild(this.m_enableMotorBox),this.m_rigidJointBox=new _.GuiCheckBox(5,284,120),this.m_rigidJointBox.style=i,this.m_rigidJointBox.disabledStyle=n,this.m_rigidJointBox.label="Floppy Joint",this.m_rigidJointBox.selected=!0,this.m_rigidJointBox.on("change",t=>this.cont.rigidBox(t)),this.m_jointEditPanel.addChild(this.m_rigidJointBox),this.m_autoBox1=new _.GuiCheckBox(5,347,120),this.m_autoBox1.style=i,this.m_autoBox1.disabledStyle=n,this.m_autoBox1.label="Auto-On CW",this.m_autoBox1.selected=!1,this.m_autoBox1.on("change",t=>this.cont.autoBox1(t)),this.m_jointEditPanel.addChild(this.m_autoBox1),this.m_autoBox2=new _.GuiCheckBox(5,367,120),this.m_autoBox2.style=i,this.m_autoBox2.disabledStyle=n,this.m_autoBox2.label="Auto-On CCW",this.m_autoBox2.selected=!1,this.m_autoBox2.on("change",t=>this.cont.autoBox2(t)),this.m_jointEditPanel.addChild(this.m_autoBox2),this.m_outlineBox2=new _.GuiCheckBox(5,472,120),this.m_outlineBox2.style=i,this.m_outlineBox2.label="Show Outlines",this.m_outlineBox2.selected=!1,this.m_outlineBox2.on("change",t=>this.cont.outlineBox(t)),this.m_jointEditPanel.addChild(this.m_outlineBox2),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fill=2369840,this.m_strengthLabel=new t.Text(""),this.m_strengthLabel.text="Motor Strength",this.m_strengthLabel.anchor.set(.5),this.m_strengthLabel.style=i,this.m_strengthLabel.x=60,this.m_strengthLabel.y=187,this.m_strengthLabel.style=i,this.m_jointEditPanel.addChild(this.m_strengthLabel),this.m_speedLabel=new t.Text(""),this.m_speedLabel.text="Motor Speed",this.m_speedLabel.style=i,this.m_speedLabel.anchor.set(.5),this.m_speedLabel.x=60,this.m_speedLabel.y=242,this.m_speedLabel.style=i,this.m_jointEditPanel.addChild(this.m_speedLabel),this.m_strengthSlider=new u.GuiSlider,this.m_strengthSlider.x=20,this.m_strengthSlider.y=192,this.m_strengthSlider.minValue=1,this.m_strengthSlider.maxValue=30,this.m_strengthSlider.value=15,this.m_strengthSlider.on("change",t=>this.cont.strengthSlider(t)),this.m_jointEditPanel.addChild(this.m_strengthSlider),this.m_speedSlider=new u.GuiSlider,this.m_speedSlider.x=20,this.m_speedSlider.y=247,this.m_speedSlider.minValue=1,this.m_speedSlider.maxValue=30,this.m_speedSlider.value=15,this.m_speedSlider.on("change",t=>this.cont.speedSlider(t)),this.m_jointEditPanel.addChild(this.m_speedSlider),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,this.m_strengthArea=new x.GuiTextInput(35,209,50,15,i),this.m_strengthArea.text="10",this.m_strengthArea.maxLength=5,this.m_strengthArea.height=15,this.m_strengthArea.on("click",t=>this.strengthFocus(t)),this.m_strengthArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_strengthArea.on("change",t=>this.cont.textEntered(t)),this.m_strengthArea.on("blur",t=>this.cont.strengthText(t)),this.m_strengthArea.on("hide",t=>this.cont.strengthText(t)),this.m_jointEditPanel.addChild(this.m_strengthArea),this.m_speedArea=new x.GuiTextInput(35,264,50,15,i),this.m_speedArea.text="10",this.m_speedArea.maxLength=5,this.m_speedArea.on("click",t=>this.speedFocus(t)),this.m_speedArea.on("focus",t=>this.TextAreaGotFocus(t)),this.m_speedArea.on("change",t=>this.cont.textEntered(t)),this.m_speedArea.on("blur",t=>this.cont.speedText(t)),this.m_speedArea.on("hide",t=>this.cont.speedText(t)),this.m_jointEditPanel.addChild(this.m_speedArea),this.m_controlKeyArea1=new x.GuiTextInput(70,306,30,15,i),this.m_controlKeyArea1.editable=!1,this.m_controlKeyArea1.on("click",t=>this.controlKey1Focus(t)),this.m_controlKeyArea1.on("focus",t=>this.TextAreaGotFocus(t)),this.m_controlKeyArea1.on("keydown",t=>this.cont.controlKeyText1(t)),this.m_controlKeyArea1.on("blur",t=>this.TextAreaLostFocus(t)),this.m_controlKeyArea1.on("hide",t=>this.TextAreaLostFocus(t)),this.m_jointEditPanel.addChild(this.m_controlKeyArea1),this.m_controlKeyArea2=new x.GuiTextInput(70,326,30,15,i),this.m_controlKeyArea2.editable=!1,this.m_controlKeyArea2.on("click",t=>this.controlKey2Focus(t)),this.m_controlKeyArea2.on("focus",t=>this.TextAreaGotFocus(t)),this.m_controlKeyArea2.on("keydown",t=>this.cont.controlKeyText2(t)),this.m_controlKeyArea2.on("blur",t=>this.TextAreaLostFocus(t)),this.m_controlKeyArea2.on("hide",t=>this.TextAreaLostFocus(t)),this.m_jointEditPanel.addChild(this.m_controlKeyArea2),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=12,i.fill="#242930",this.m_limitLabel1=new t.Text(""),this.m_limitLabel1.text="Lower Limit (degrees)",this.m_limitLabel1.x=15,this.m_limitLabel1.y=395,this.m_limitLabel1.style=i,this.m_jointEditPanel.addChild(this.m_limitLabel1),this.m_limitLabel2=new t.Text(""),this.m_limitLabel2.text="Upper Limit (degrees)",this.m_limitLabel2.x=15,this.m_limitLabel2.y=430,this.m_limitLabel2.style=i,this.m_jointEditPanel.addChild(this.m_limitLabel2),this.m_inputLabel1=new t.Text(""),this.m_inputLabel1.text="Rotate CW:",this.m_inputLabel1.x=10,this.m_inputLabel1.y=307,this.m_inputLabel1.style=i,this.m_jointEditPanel.addChild(this.m_inputLabel1),this.m_inputLabel2=new t.Text(""),this.m_inputLabel2.text="Rotate CCW:",this.m_inputLabel2.x=10,this.m_inputLabel2.y=327,this.m_inputLabel2.style=i,this.m_jointEditPanel.addChild(this.m_inputLabel2),this.m_colourButton=new d.GuiButton("Change Color",5,382,110,35,()=>this.colourButton(),d.GuiButton.BLUE),this.m_jointEditPanel.addChild(this.m_colourButton),this.m_frontButton=new d.GuiButton("Move to Front",5,412,110,35,()=>this.cont.frontButton(),d.GuiButton.PINK),this.m_jointEditPanel.addChild(this.m_frontButton),this.m_backButton=new d.GuiButton("Move to Back",5,442,110,35,()=>this.cont.backButton(),d.GuiButton.PINK),this.m_jointEditPanel.addChild(this.m_backButton),(i=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,i.fontSize=9,i.fill=2369840,this.m_collisionBox3=new _.GuiCheckBox(5,367,120),this.m_collisionBox3.style=i,this.m_collisionBox3.disabledStyle=n,this.m_collisionBox3.label="Collides",this.m_collisionBox3.selected=!0,this.m_collisionBox3.on("click",t=>this.cont.collisionBox(t)),this.m_jointEditPanel.addChild(this.m_collisionBox3)}backButton(){this.visible=!1}colourButton(){this.m_colourWindow.visible=!0,this.m_colourWindow.SetVals()}DisableStuffForShapesLevel(){this.m_densitySlider.enabled=!1,this.m_densityArea.enabled=!1,this.m_densityArea.focusEnabled=!1,this.m_densityArea.editable=!1,this.m_collisionBox.enabled=!1,this.m_cameraBox.enabled=!1,this.m_undragableBox.enabled=!1,this.m_collisionBox2.enabled=!1,this.m_collisionBox3.enabled=!1,this.m_undragableBox2.enabled=!1}DisableStuffForCarLevel(){this.m_densitySlider.enabled=!1,this.m_densityArea.enabled=!1,this.m_densityArea.focusEnabled=!1,this.m_densityArea.editable=!1,this.m_collisionBox.enabled=!1,this.m_cameraBox.enabled=!1,this.m_undragableBox.enabled=!1,this.m_collisionBox2.enabled=!1,this.m_collisionBox3.enabled=!1,this.m_undragableBox2.enabled=!1,this.m_minDispArea.enabled=!1,this.m_minDispArea.focusEnabled=!1,this.m_minDispArea.editable=!1,this.m_maxDispArea.enabled=!1,this.m_maxDispArea.focusEnabled=!1,this.m_maxDispArea.editable=!1,this.m_rigidJointBox.enabled=!1,this.m_autoBox1.enabled=!1,this.m_autoBox2.enabled=!1,this.m_controlKeyArea1.enabled=!1,this.m_controlKeyArea1.focusEnabled=!1,this.m_controlKeyArea1.editable=!1,this.m_controlKeyArea2.enabled=!1,this.m_controlKeyArea2.focusEnabled=!1,this.m_controlKeyArea2.editable=!1,this.m_speedSlider.enabled=!1,this.m_strengthSlider.enabled=!1,this.m_speedArea.enabled=!1,this.m_speedArea.focusEnabled=!1,this.m_speedArea.editable=!1,this.m_strengthArea.enabled=!1,this.m_strengthArea.focusEnabled=!1,this.m_strengthArea.editable=!1}DisableStuffForJumpbotLevel(){this.m_collisionBox.enabled=!1,this.m_cameraBox.enabled=!1,this.m_undragableBox.enabled=!1,this.m_collisionBox2.enabled=!1,this.m_collisionBox3.enabled=!1,this.m_undragableBox2.enabled=!1,this.m_minDispArea.enabled=!1,this.m_minDispArea.focusEnabled=!1,this.m_minDispArea.editable=!1,this.m_maxDispArea.enabled=!1,this.m_maxDispArea.focusEnabled=!1,this.m_maxDispArea.editable=!1,this.m_rigidJointBox.enabled=!1,this.m_autoBox1.enabled=!1,this.m_autoBox2.enabled=!1,this.m_controlKeyArea1.enabled=!1,this.m_controlKeyArea1.focusEnabled=!1,this.m_controlKeyArea1.editable=!1,this.m_controlKeyArea2.enabled=!1,this.m_controlKeyArea2.focusEnabled=!1,this.m_controlKeyArea2.editable=!1}DisableStuffForDumpbotLevel(){this.m_collisionBox.enabled=!1,this.m_cameraBox.enabled=!1,this.m_undragableBox.enabled=!1,this.m_collisionBox2.enabled=!1,this.m_collisionBox3.enabled=!1,this.m_undragableBox2.enabled=!1,this.m_minDispArea.enabled=!1,this.m_minDispArea.focusEnabled=!1,this.m_minDispArea.editable=!1,this.m_maxDispArea.enabled=!1,this.m_maxDispArea.focusEnabled=!1,this.m_maxDispArea.editable=!1,this.m_autoBox1.enabled=!1,this.m_autoBox2.enabled=!1}DisableStuffForCatapultLevel(){this.m_collisionBox.enabled=!1,this.m_undragableBox.enabled=!1,this.m_collisionBox2.enabled=!1,this.m_collisionBox3.enabled=!1,this.m_undragableBox2.enabled=!1,this.m_autoBox1.enabled=!1,this.m_autoBox2.enabled=!1,this.m_controlKeyArea1.enabled=!1,this.m_controlKeyArea1.focusEnabled=!1,this.m_controlKeyArea1.editable=!1,this.m_controlKeyArea2.enabled=!1,this.m_controlKeyArea2.focusEnabled=!1,this.m_controlKeyArea2.editable=!1}DisableStuffForHomeMoviesLevel(){this.m_collisionBox.enabled=!1,this.m_undragableBox.enabled=!1,this.m_collisionBox2.enabled=!1,this.m_collisionBox3.enabled=!1,this.m_undragableBox2.enabled=!1,this.m_autoBox1.enabled=!1,this.m_autoBox2.enabled=!1}ShowObjectPanel(i){this.visible=!0,this.m_colourWindow.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!1,this.m_objectEditPanel.visible=!0,this.m_textEditPanel.visible=!1,this.m_thrustersEditPanel.visible=!1,this.m_multiEditPanel.visible=!1,this.m_buildBoxPanel.visible=!1,this.m_cannonPanel.visible=!1,this.m_densitySlider.value=i.density,this.m_densitySlider.minValue=e.ControllerGameGlobals.minDensity,this.m_densitySlider.maxValue=e.ControllerGameGlobals.maxDensity,this.m_densityArea.text=i.density.toString(),this.m_collisionBox.selected=i.collide,this.m_collisionBox.visible="sandbox"===this.cont.controllerType||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.nonCollidingAllowed||!ControllerChallenge.playChallengeMode),this.m_fixateBox.selected=i.isStatic,this.m_fixateBox.visible="sandbox"===this.cont.conditionsButton||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.fixateAllowed||!ControllerChallenge.playChallengeMode),this.m_cameraBox.selected=i.isCameraFocus,this.m_outlineBox.selected=i.outline,this.m_terrainBox.selected=i.terrain,this.m_undragableBox.selected=i.undragable,i instanceof n.Circle&&(this.m_shapeHeader.text="Circle"),i instanceof l.Rectangle&&(this.m_shapeHeader.text="Rectangle"),i instanceof r.Triangle&&(this.m_shapeHeader.text="Triangle");var o=new t.TextStyle;o.fontFamily=s.Main.GLOBAL_FONT,o.fontSize=14,o.align="center",this.m_shapeHeader.style=o}ShowCannonPanel(e){this.visible=!0,this.m_colourWindow.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!1,this.m_objectEditPanel.visible=!1,this.m_textEditPanel.visible=!1,this.m_thrustersEditPanel.visible=!1,this.m_multiEditPanel.visible=!1,this.m_buildBoxPanel.visible=!1,this.m_cannonPanel.visible=!0,this.m_densitySlider7.value=e.density,this.m_densityArea7.text=e.density.toString(),this.m_collisionBox7.selected=e.collide,this.m_collisionBox7.visible="sandbox"===this.cont.controllerType&&!("challenge"===this.cont.controllerType)||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.nonCollidingAllowed||!ControllerChallenge.playChallengeMode),this.m_fixateBox7.selected=e.isStatic,this.m_fixateBox7.visible="sandbox"===this.cont.controllerType&&!("challenge"===this.cont.controllerType)||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.fixateAllowed||!ControllerChallenge.playChallengeMode),this.m_outlineBox7.selected=e.outline,this.m_terrainBox7.selected=e.terrain,this.m_undragableBox7.selected=e.undragable,this.m_cannonHeader.text="Cannon";var n=new t.TextStyle;n.fontFamily=s.Main.GLOBAL_FONT,n.fontSize=14,n.align="center",this.m_cannonHeader.style=n,this.m_strengthSlider7.value=e.strength,this.m_strengthArea7.text=e.strength+"";var o=i.Input.getKeyString(e.fireKey);null==o&&(o="Unk: "+e.fireKey),this.m_fireKeyArea.text=o}ShowTextPanel(t){this.visible=!0,this.m_colourWindow.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!1,this.m_objectEditPanel.visible=!1,this.m_thrustersEditPanel.visible=!1,this.m_multiEditPanel.visible=!1,this.m_textEditPanel.visible=!0,this.m_buildBoxPanel.visible=!1,this.m_cannonPanel.visible=!1,this.m_alwaysVisibleBox.selected=t.alwaysVisible,this.m_scaleWithZoomBox.selected=t.scaleWithZoom,this.m_textKeyArea.enabled=!t.alwaysVisible;var e=i.Input.getKeyString(t.displayKey);null==e&&(e="Unk: "+t.displayKey),this.m_textKeyArea.text=e,this.m_textArea.text=t.m_textField.text,this.m_sizeArea.text=t.size+""}ShowMultiSelectPanel(t){this.visible=!0,this.m_colourWindow.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!1,this.m_objectEditPanel.visible=!1,this.m_thrustersEditPanel.visible=!1,this.m_multiEditPanel.visible=!0,this.m_textEditPanel.visible=!1,this.m_cannonPanel.visible=!1,this.m_outlineBox3.selected=!0,this.m_terrainBox3.selected=!1,this.m_fixateBox2.selected=!1,this.m_undragableBox2.selected=!1,this.m_collisionBox2.selected=!0,this.m_collisionBox2.visible="sandbox"===this.cont.controllerType&&!("challenge"===this.cont.controllerType)||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.nonCollidingAllowed||!ControllerChallenge.playChallengeMode),this.m_fixateBox2.visible="sandbox"===this.cont.controllerType&&!("challenge"===this.cont.controllerType)||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.fixateAllowed||!ControllerChallenge.playChallengeMode),this.m_buildBoxPanel.visible=!1;for(var e=0;e<t.length;e++)(t[e]instanceof a.ShapePart&&!t[e].outline||t[e]instanceof o.PrismaticJoint&&!t[e].outline)&&(this.m_outlineBox3.selected=!1),t[e]instanceof a.ShapePart&&t[e].terrain&&(this.m_terrainBox3.selected=!0),t[e]instanceof a.ShapePart&&t[e].isStatic&&(this.m_fixateBox2.selected=!0),t[e]instanceof a.ShapePart&&t[e].undragable&&(this.m_undragableBox2.selected=!0),t[e]instanceof a.ShapePart&&!t[e].collide&&(this.m_collisionBox2.selected=!1)}ShowJointPanel(n){var l,a;if(this.visible=!0,this.m_colourWindow.visible=!1,this.m_objectEditPanel.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!0,this.m_thrustersEditPanel.visible=!1,this.m_multiEditPanel.visible=!1,this.m_textEditPanel.visible=!1,this.m_buildBoxPanel.visible=!1,this.m_cannonPanel.visible=!1,n instanceof h.RevoluteJoint){var r=n;this.m_enableMotorBox.selected=r.enableMotor,this.m_rigidJointBox.selected=!r.isStiff,this.m_strengthLabel.text="Motor Strength",this.m_strengthSlider.value=r.motorStrength,this.m_strengthSlider.enabled=r.enableMotor,this.m_strengthSlider.maxValue=e.ControllerGameGlobals.maxRJStrength,this.m_strengthArea.text=r.motorStrength+"",this.m_speedLabel.text="Motor Speed",this.m_speedSlider.value=r.motorSpeed,this.m_speedSlider.enabled=r.enableMotor,this.m_speedSlider.maxValue=e.ControllerGameGlobals.maxRJSpeed,this.m_speedArea.text=r.motorSpeed+"",this.m_autoBox1.selected=r.autoCW,this.m_autoBox2.selected=r.autoCCW,this.m_limitLabel1.visible=!0,this.m_minDispArea.visible=!0,this.m_limitLabel2.visible=!0,this.m_maxDispArea.visible=!0,r.motorLowerLimit==-Number.MAX_VALUE?this.m_minDispArea.text="None":this.m_minDispArea.text=String(r.motorLowerLimit),r.motorUpperLimit==Number.MAX_VALUE?this.m_maxDispArea.text="None":this.m_maxDispArea.text=String(r.motorUpperLimit),this.m_inputLabel1.text="Rotate CW:",null==(l=i.Input.getKeyString(r.motorCWKey))&&(l="Unk: "+r.motorCWKey),this.m_controlKeyArea1.text=l,this.m_controlKeyArea1.enabled=r.enableMotor,this.m_controlKeyArea1.focusEnabled=r.enableMotor,this.m_inputLabel2.text="Rotate CCW:",null==(l=i.Input.getKeyString(r.motorCCWKey))&&(l="Unk: "+r.motorCCWKey),this.m_controlKeyArea2.text=l,this.m_controlKeyArea2.enabled=r.enableMotor,this.m_controlKeyArea2.focusEnabled=r.enableMotor,this.m_rigidJointBox.enabled=r.enableMotor,this.m_rigidJointBox.focusEnabled=r.enableMotor,this.m_strengthArea.enabled=r.enableMotor,this.m_strengthArea.editable=r.enableMotor,this.m_strengthArea.focusEnabled=r.enableMotor,this.m_speedArea.enabled=r.enableMotor,this.m_speedArea.focusEnabled=r.enableMotor,this.m_speedArea.editable=r.enableMotor,this.m_autoBox1.enabled=r.enableMotor,this.m_autoBox2.enabled=r.enableMotor,this.m_inputLabel1.x=10,this.m_inputLabel2.x=10,this.m_controlKeyArea1.x=70,this.m_controlKeyArea2.x=70,this.m_autoBox1.label="Auto-On CW",this.m_autoBox2.visible=!0,this.m_colourButton.visible=!1,this.m_frontButton.visible=!1,this.m_backButton.visible=!1,this.m_outlineBox2.visible=!1,this.m_collisionBox3.visible=!1,this.m_jointHeader.text="Rotating Joint",(a=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=14,a.align="center",this.m_jointHeader.style=a}else if(n instanceof o.PrismaticJoint){var m=n;this.m_enableMotorBox.selected=m.enablePiston,this.m_rigidJointBox.selected=!m.isStiff,this.m_strengthLabel.text="Piston Strength",this.m_strengthSlider.value=m.pistonStrength,this.m_strengthSlider.enabled=m.enablePiston,this.m_strengthSlider.maxValue=e.ControllerGameGlobals.maxSJStrength,this.m_strengthArea.text=m.pistonStrength+"",this.m_speedLabel.text="Piston Speed",this.m_speedSlider.value=m.pistonSpeed,this.m_speedSlider.enabled=m.enablePiston,this.m_speedSlider.maxValue=e.ControllerGameGlobals.maxSJSpeed,this.m_speedArea.text=m.pistonSpeed+"",this.m_autoBox1.selected=m.autoOscillate,this.m_outlineBox2.selected=m.outline,this.m_limitLabel1.visible=!1,this.m_minDispArea.visible=!1,this.m_limitLabel2.visible=!1,this.m_maxDispArea.visible=!1,this.m_inputLabel1.text="Expand:",null==(l=i.Input.getKeyString(m.pistonUpKey))&&(l="Unk: "+m.pistonUpKey),this.m_controlKeyArea1.text=l,this.m_controlKeyArea1.enabled=m.enablePiston,this.m_controlKeyArea1.focusEnabled=m.enablePiston,this.m_inputLabel2.text="Contract:",null==(l=i.Input.getKeyString(m.pistonDownKey))&&(l="Unk: "+m.pistonDownKey),this.m_controlKeyArea2.text=l,this.m_controlKeyArea2.enabled=m.enablePiston,this.m_controlKeyArea2.focusEnabled=m.enablePiston,this.m_rigidJointBox.enabled=m.enablePiston,this.m_rigidJointBox.focusEnabled=m.enablePiston,this.m_strengthArea.enabled=m.enablePiston,this.m_strengthArea.editable=m.enablePiston,this.m_strengthArea.focusEnabled=m.enablePiston,this.m_speedArea.enabled=m.enablePiston,this.m_speedArea.focusEnabled=m.enablePiston,this.m_speedArea.editable=m.enablePiston,this.m_autoBox1.enabled=m.enablePiston,this.m_inputLabel1.x=-3,this.m_inputLabel2.x=-3,this.m_controlKeyArea1.x=60,this.m_controlKeyArea2.x=60,this.m_autoBox1.label="Auto Oscillate",this.m_autoBox2.visible=!1,this.m_colourButton.visible=!0,this.m_frontButton.visible=!0,this.m_backButton.visible=!0,this.m_outlineBox2.visible=!0,this.m_collisionBox3.visible="sandbox"===this.cont.controllerType&&!("challenge"===this.cont.controllerType)||"challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.nonCollidingAllowed||!ControllerChallenge.playChallengeMode),this.m_collisionBox3.selected=m.collide,this.m_jointHeader.text="Sliding Joint",(a=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=14,a.align="center",this.m_jointHeader.style=a}else this.m_fixedJointPanel.visible=!0,this.m_jointEditPanel.visible=!1;(a=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=9,a.fill="#242930",this.m_limitLabel1.style=a,this.m_limitLabel2.style=a,(a=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=9,a.fill="#242930",a.align="right",this.m_inputLabel1.style=a,this.m_inputLabel2.style=a,(a=new t.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=9,a.fill="#242930",this.m_speedLabel.style=a,this.m_strengthLabel.style=a,this.m_inputLabel1.visible=!("challenge"===this.cont.controllerType)||!ControllerChallenge.playChallengeMode||"challenge"===this.cont.controllerType&&ControllerChallenge.challenge.botControlAllowed,this.m_inputLabel2.visible=!("challenge"===this.cont.controllerType)||!ControllerChallenge.playChallengeMode||"challenge"===this.cont.controllerType&&ControllerChallenge.challenge.botControlAllowed,this.m_controlKeyArea1.visible=!("challenge"===this.cont.controllerType)||!ControllerChallenge.playChallengeMode||"challenge"===this.cont.controllerType&&ControllerChallenge.challenge.botControlAllowed,this.m_controlKeyArea2.visible=!("challenge"===this.cont.controllerType)||!ControllerChallenge.playChallengeMode||"challenge"===this.cont.controllerType&&ControllerChallenge.challenge.botControlAllowed}ShowThrustersPanel(t){this.visible=!0,this.m_colourWindow.visible=!1,this.m_objectEditPanel.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!1,this.m_thrustersEditPanel.visible=!0,this.m_multiEditPanel.visible=!1,this.m_textEditPanel.visible=!1,this.m_buildBoxPanel.visible=!1,this.m_cannonPanel.visible=!1,this.m_autoBox3.selected=t.autoOn,this.m_thrustSlider.value=t.strength,this.m_thrustSlider.maxValue=e.ControllerGameGlobals.maxThrusterStrength,this.m_thrustArea.text=t.strength+"";var s=i.Input.getKeyString(t.thrustKey);null==s&&(s="Unk: "+t.thrustKey),this.m_thrustKeyArea.text=s,this.m_thrustKeyLabel.visible=!("challenge"===this.cont.controllerType)||!ControllerChallenge.playChallengeMode||"challenge"===this.cont.controllerType&&ControllerChallenge.challenge.botControlAllowed,this.m_thrustKeyArea.visible=!("challenge"===this.cont.controllerType)||!ControllerChallenge.playChallengeMode||"challenge"===this.cont.controllerType&&ControllerChallenge.challenge.botControlAllowed}ShowBuildBoxPanel(){this.visible=!0,this.m_colourWindow.visible=!1,this.m_objectEditPanel.visible=!1,this.m_fixedJointPanel.visible=!1,this.m_jointEditPanel.visible=!1,this.m_thrustersEditPanel.visible=!1,this.m_multiEditPanel.visible=!1,this.m_textEditPanel.visible=!1,this.m_buildBoxPanel.visible=!0,this.m_cannonPanel.visible=!1}TextAreaGotFocus(t=null){this.enteringInput=!0}TextAreaLostFocus(t=null){this.enteringInput=!1}sliderClicked(t){this.sliderDown=!0}sliderReleased(t){this.sliderDown=!1}EnteringInput(){return this.visible||(this.enteringInput=!1),this.enteringInput}SetDensity(t){this.m_densityArea.text=t.toString(),this.m_densitySlider.value=t,this.m_densityArea7.text=t.toString(),this.m_densitySlider7.value=t}SetStrength(t){this.m_strengthArea.text=t.toString(),this.m_strengthSlider.value=t}SetSpeed(t){this.m_speedArea.text=t.toString(),this.m_speedSlider.value=t}SetThrust(t){this.m_thrustArea.text=t.toString(),this.m_thrustSlider.value=t}SetCannon(t){this.m_strengthArea7.text=t.toString(),this.m_strengthSlider7.value=t}EnableMotorStuff(t){this.m_strengthSlider.enabled=t,this.m_speedSlider.enabled=t,this.m_controlKeyArea1.enabled=t,this.m_controlKeyArea2.enabled=t,this.m_rigidJointBox.enabled=t,this.m_strengthArea.enabled=t,this.m_strengthArea.editable=t,this.m_speedArea.enabled=t,this.m_speedArea.editable=t,this.m_autoBox1.enabled=t,this.m_autoBox2.enabled=t}EnableTextStuff(t){this.m_textKeyArea.enabled=t}deselectBox2(){this.m_autoBox2.selected=!1}deselectBox1(){this.m_autoBox1.selected=!1}sizeFocus(t){this.m_sizeArea.setSelection(0,4)}minDispFocus(t){this.m_minDispArea.enabled&&this.m_minDispArea.setSelection(0,10)}maxDispFocus(t){this.m_maxDispArea.enabled&&this.m_maxDispArea.setSelection(0,10)}densityFocus(t){this.m_densityArea.enabled&&this.m_densityArea.setSelection(0,10)}strengthFocus(t){this.m_strengthArea.enabled&&this.m_strengthArea.setSelection(0,10)}speedFocus(t){this.m_speedArea.enabled&&this.m_speedArea.setSelection(0,10)}thrustFocus(t){this.m_thrustArea.enabled&&this.m_thrustArea.setSelection(0,10)}cannonFocus(t){this.m_strengthArea7.enabled&&this.m_strengthArea7.setSelection(0,10)}controlKey1Focus(t){this.m_controlKeyArea1.enabled&&this.m_controlKeyArea1.setSelection(0,10)}controlKey2Focus(t){this.m_controlKeyArea2.enabled&&this.m_controlKeyArea2.setSelection(0,10)}thrustKeyFocus(t){this.m_thrustKeyArea.enabled&&this.m_thrustKeyArea.setSelection(0,10)}cannonKeyFocus(t){this.m_fireKeyArea.enabled&&this.m_fireKeyArea.setSelection(0,10)}ColourWindowShowing(){return this.visible&&this.m_colourWindow.visible}BuildWindowShowing(){return this.visible&&this.m_buildBoxPanel.visible}}exports.PartEditWindow=B;
},{"pixi.js":"aQiP","../Game/Globals/ControllerGameGlobals":"K8aL","../General/Input":"xLqP","../Main":"aM6Q","../Parts/Circle":"PfXD","../Parts/PrismaticJoint":"nZSh","../Parts/Rectangle":"jYSx","../Parts/RevoluteJoint":"AUAw","../Parts/ShapePart":"CDAe","../Parts/Triangle":"CRRv","./ColourChangeWindow":"viLo","./GuiButton":"IBBZ","./GuiCheckBox":"nOXD","./GuiSlider":"qnZ8","./GuiTextArea":"hjO3","./GuiTextInput":"h4Qg","./GuiWindow":"BOXT"}],"F66q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ImportWindow=void 0;const t=require("pixi.js"),e=require("../General/Database"),i=require("../Main"),o=require("./GuiButton"),s=require("./GuiTextArea"),r=require("./GuiWindow");class a extends r.GuiWindow{constructor(e,r){super(244,83,312,434,!1),this.cont=e,this.type=r;var n=new t.TextStyle;n.fontFamily=i.Main.GLOBAL_FONT,n.fill="#242930",n.fontSize=12,n.align="center",this.msgArea=new t.Text(""),this.msgArea.x=150,this.msgArea.y=42.5,this.msgArea.anchor.set(.5,.5),this.msgArea.text="Copy and paste the text you got from exporting\nyour "+(this.type==a.TYPE_ROBOT?"robot":this.type==a.TYPE_REPLAY?"replay":"challenge")+' in the box below, then press "Import."',this.msgArea.style=n,this.addChild(this.msgArea),(n=new t.TextStyle).fontSize=10,this.linkArea=new s.GuiTextArea(15,85,265,260,n),this.addChild(this.linkArea),this.importButton=new o.GuiButton("Import",100,345,100,35,t=>this.doImport(t),o.GuiButton.ORANGE),this.addChild(this.importButton),this.cancelButton=new o.GuiButton("Cancel",100,375,100,35,t=>this.cont.HideImportDialog(t),o.GuiButton.PURPLE),this.addChild(this.cancelButton)}doImport(t){this.linkArea.text.length>0&&(this.cont.HideImportDialog(t),this.type==a.TYPE_ROBOT?this.cont.processLoadedRobot(e.Database.ImportRobot(this.linkArea.text)):this.type==a.TYPE_REPLAY?this.cont.processLoadedReplay(e.Database.ImportReplay(this.linkArea.text)):this.type==a.TYPE_CHALLENGE&&this.cont.processLoadedChallenge(e.Database.ImportChallenge(this.linkArea.text)))}}exports.ImportWindow=a,a.TYPE_ROBOT=0,a.TYPE_REPLAY=1,a.TYPE_CHALLENGE=2;
},{"pixi.js":"aQiP","../General/Database":"CVYw","../Main":"aM6Q","./GuiButton":"IBBZ","./GuiTextArea":"hjO3","./GuiWindow":"BOXT"}],"pdwH":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyPress=void 0;class e{constructor(e,s){this.frame=e,this.key=s}}exports.KeyPress=e;
},{}],"TXMb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ReplaySyncPoint=void 0;class e{constructor(){this.frame=0,this.positions=new Array,this.angles=new Array,this.cannonballPositions=new Array}}exports.ReplaySyncPoint=e;
},{}],"zJxm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CameraAction=void 0;const e=require("./Action");class t extends e.Action{constructor(e,t,s=null){super(e),this.isChecked=t,this.oldCameraPart=s}UndoAction(){this.partAffected.isCameraFocus=!this.isChecked,this.oldCameraPart&&(this.oldCameraPart.isCameraFocus=!0)}RedoAction(){this.partAffected.isCameraFocus=this.isChecked,this.oldCameraPart&&(this.oldCameraPart.isCameraFocus=!1)}}exports.CameraAction=t;
},{"./Action":"xELh"}],"wdsq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ChangeSliderAction=void 0;const t=require("../Parts/Cannon"),e=require("../Parts/PrismaticJoint"),i=require("../Parts/RevoluteJoint"),s=require("../Parts/Thrusters"),h=require("./Action");class n extends h.Action{constructor(t,e,i){super(t),this.type=e,this.change=i}UndoAction(){this.type==n.DENSITY_TYPE?this.partAffected.density-=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof i.RevoluteJoint?this.partAffected.motorStrength-=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof e.PrismaticJoint?this.partAffected.pistonStrength-=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof s.Thrusters?this.partAffected.strength-=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof t.Cannon?this.partAffected.strength-=this.change:this.type==n.SPEED_TYPE&&this.partAffected instanceof i.RevoluteJoint?this.partAffected.motorSpeed-=this.change:this.partAffected.pistonSpeed-=this.change}RedoAction(){this.type==n.DENSITY_TYPE?this.partAffected.density+=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof i.RevoluteJoint?this.partAffected.motorStrength+=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof e.PrismaticJoint?this.partAffected.pistonStrength+=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof s.Thrusters?this.partAffected.strength+=this.change:this.type==n.STRENGTH_TYPE&&this.partAffected instanceof t.Cannon?this.partAffected.strength+=this.change:this.type==n.SPEED_TYPE&&this.partAffected instanceof i.RevoluteJoint?this.partAffected.motorSpeed+=this.change:this.partAffected.pistonSpeed+=this.change}}exports.ChangeSliderAction=n,n.DENSITY_TYPE=0,n.STRENGTH_TYPE=1,n.SPEED_TYPE=2;
},{"../Parts/Cannon":"vdN1","../Parts/PrismaticJoint":"nZSh","../Parts/RevoluteJoint":"AUAw","../Parts/Thrusters":"Yw1p","./Action":"xELh"}],"wJ8e":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ClearAction=void 0;const t=require("./Action");class r extends t.Action{constructor(t){super(t[0]),this.parts=t}UndoAction(){for(var t=0;t<this.parts.length;t++)r.m_controller.allParts.push(this.parts[t]),this.parts[t].isEnabled=!0}RedoAction(){for(var t=0;t<this.parts.length;t++)r.m_controller.DeletePart(this.parts[t],!1)}}exports.ClearAction=r;
},{"./Action":"xELh"}],"VT9P":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColourChangeAction=void 0;const t=require("../Parts/PrismaticJoint"),e=require("../Parts/ShapePart"),i=require("../Parts/TextPart"),r=require("./Action");class s extends r.Action{constructor(t,e,i,r,s){super(t),this.red=e,this.green=i,this.blue=r,this.opacity=s}UndoAction(){(this.partAffected instanceof e.ShapePart||this.partAffected instanceof t.PrismaticJoint||this.partAffected instanceof i.TextPart)&&(this.partAffected.red-=this.red,this.partAffected.green-=this.green,this.partAffected.blue-=this.blue,this.partAffected instanceof i.TextPart||(this.partAffected.opacity-=this.opacity))}RedoAction(){(this.partAffected instanceof e.ShapePart||this.partAffected instanceof t.PrismaticJoint||this.partAffected instanceof i.TextPart)&&(this.partAffected.red+=this.red,this.partAffected.green+=this.green,this.partAffected.blue+=this.blue,this.partAffected instanceof i.TextPart||(this.partAffected.opacity+=this.opacity))}}exports.ColourChangeAction=s;
},{"../Parts/PrismaticJoint":"nZSh","../Parts/ShapePart":"CDAe","../Parts/TextPart":"T0pq","./Action":"xELh"}],"gn4K":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ControlKeyAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e,s,i){super(t),this.type=e,this.oldKey=s,this.newKey=i}UndoAction(){this.type==e.CW_TYPE?this.partAffected.motorCWKey=this.oldKey:this.type==e.CCW_TYPE?this.partAffected.motorCCWKey=this.oldKey:this.type==e.EXPAND_TYPE?this.partAffected.pistonUpKey=this.oldKey:this.type==e.CONTRACT_TYPE?this.partAffected.pistonDownKey=this.oldKey:this.type==e.TEXT_TYPE?this.partAffected.displayKey=this.oldKey:this.type==e.THRUSTERS_TYPE?this.partAffected.thrustKey=this.oldKey:this.type==e.CANNON_TYPE&&(this.partAffected.fireKey=this.oldKey)}RedoAction(){this.type==e.CW_TYPE?this.partAffected.motorCWKey=this.newKey:this.type==e.CCW_TYPE?this.partAffected.motorCCWKey=this.newKey:this.type==e.EXPAND_TYPE?this.partAffected.pistonUpKey=this.newKey:this.type==e.CONTRACT_TYPE?this.partAffected.pistonDownKey=this.newKey:this.type==e.TEXT_TYPE?this.partAffected.displayKey=this.newKey:this.type==e.THRUSTERS_TYPE?this.partAffected.thrustKey=this.newKey:this.type==e.CANNON_TYPE&&(this.partAffected.fireKey=this.oldKey)}}exports.ControlKeyAction=e,e.CW_TYPE=0,e.CCW_TYPE=1,e.EXPAND_TYPE=2,e.CONTRACT_TYPE=3,e.TEXT_TYPE=4,e.THRUSTERS_TYPE=5,e.CANNON_TYPE=6;
},{"./Action":"xELh"}],"irRs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CreateAction=void 0;const e=require("./Action");class t extends e.Action{constructor(e){super(e)}UndoAction(){t.m_controller.DeletePart(this.partAffected,!1)}RedoAction(){t.m_controller.allParts.push(this.partAffected),this.partAffected.isEnabled=!0}}exports.CreateAction=t;
},{"./Action":"xELh"}],"cRW3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.DeleteAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e){super(t),this.joints=e}UndoAction(){e.m_controller.allParts.push(this.partAffected);for(var t=0;t<this.joints.length;t++)e.m_controller.allParts.push(this.joints[t]),this.joints[t].isEnabled=!0;this.partAffected.isEnabled=!0}RedoAction(){e.m_controller.DeletePart(this.partAffected,!1)}}exports.DeleteAction=e;
},{"./Action":"xELh"}],"gzRi":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.EnterTextAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e,i){super(t),this.oldText=e,this.newText=i}UndoAction(){this.partAffected.text=this.oldText,this.partAffected.m_textField.text=this.oldText}RedoAction(){this.partAffected.text=this.newText,this.partAffected.m_textField.text=this.newText}}exports.EnterTextAction=e;
},{"./Action":"xELh"}],"BvkN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.JointCheckboxAction=void 0;const t=require("../Parts/PrismaticJoint"),e=require("../Parts/RevoluteJoint"),i=require("./Action");class s extends i.Action{constructor(t,e,i,s=!1){super(t),this.type=e,this.isChecked=i,this.sideEffect=s}UndoAction(){this.type==s.ENABLE_TYPE&&this.partAffected instanceof e.RevoluteJoint?this.partAffected.enableMotor=!this.isChecked:this.type==s.ENABLE_TYPE&&this.partAffected instanceof t.PrismaticJoint?this.partAffected.enablePiston=!this.isChecked:this.type==s.RIGID_TYPE&&this.partAffected instanceof e.RevoluteJoint?this.partAffected.isStiff=this.isChecked:this.type==s.RIGID_TYPE&&this.partAffected instanceof t.PrismaticJoint?this.partAffected.isStiff=this.isChecked:this.type==s.AUTO_CW_TYPE?(this.partAffected.autoCW=!this.isChecked,this.sideEffect&&(this.partAffected.autoCCW=this.isChecked)):this.type==s.AUTO_CCW_TYPE?(this.partAffected.autoCCW=!this.isChecked,this.sideEffect&&(this.partAffected.autoCW=this.isChecked)):this.type==s.AUTO_ON_TYPE?this.partAffected.autoOn=!this.isChecked:this.partAffected.autoOscillate=!this.isChecked}RedoAction(){this.type==s.ENABLE_TYPE&&this.partAffected instanceof e.RevoluteJoint?this.partAffected.enableMotor=this.isChecked:this.type==s.ENABLE_TYPE&&this.partAffected instanceof t.PrismaticJoint?this.partAffected.enablePiston=this.isChecked:this.type==s.RIGID_TYPE&&this.partAffected instanceof e.RevoluteJoint?this.partAffected.isStiff=!this.isChecked:this.type==s.RIGID_TYPE&&this.partAffected instanceof t.PrismaticJoint?this.partAffected.isStiff=!this.isChecked:this.type==s.AUTO_CW_TYPE?(this.partAffected.autoCW=this.isChecked,this.sideEffect&&(this.partAffected.autoCCW=!this.isChecked)):this.type==s.AUTO_CCW_TYPE?(this.partAffected.autoCCW=this.isChecked,this.sideEffect&&(this.partAffected.autoCW=!this.isChecked)):this.type==s.AUTO_ON_TYPE?this.partAffected.autoOn=this.isChecked:this.partAffected.autoOscillate=this.isChecked}}exports.JointCheckboxAction=s,s.ENABLE_TYPE=0,s.RIGID_TYPE=1,s.AUTO_CW_TYPE=2,s.AUTO_CCW_TYPE=3,s.AUTO_OSCILLATE_TYPE=4,s.AUTO_ON_TYPE=5;
},{"../Parts/PrismaticJoint":"nZSh","../Parts/RevoluteJoint":"AUAw","./Action":"xELh"}],"a7X3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LimitChangeAction=void 0;const t=require("./Action");class i extends t.Action{constructor(t,i,e,o){super(t),this.type=i,this.oldLimit=e,this.newLimit=o}UndoAction(){this.type==i.MIN_TYPE?this.partAffected.motorLowerLimit=this.oldLimit:this.partAffected.motorUpperLimit=this.oldLimit}RedoAction(){this.type==i.MIN_TYPE?this.partAffected.motorLowerLimit=this.newLimit:this.partAffected.motorUpperLimit=this.newLimit}}exports.LimitChangeAction=i,i.MIN_TYPE=0,i.MAX_TYPE=1;
},{"./Action":"xELh"}],"a0WD":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MassCreateAction=void 0;const t=require("../Parts/ShapePart"),r=require("../Parts/TextPart"),e=require("./Action");class s extends e.Action{constructor(t){super(t[0]),this.parts=t}UndoAction(){for(var e=0;e<this.parts.length;e++)(this.parts[e]instanceof t.ShapePart||this.parts[e]instanceof r.TextPart)&&s.m_controller.DeletePart(this.parts[e],!1)}RedoAction(){for(var t=0;t<this.parts.length;t++)s.m_controller.allParts.push(this.parts[t]),this.parts[t].isEnabled=!0}}exports.MassCreateAction=s;
},{"../Parts/ShapePart":"CDAe","../Parts/TextPart":"T0pq","./Action":"xELh"}],"fZPQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoveAction=void 0;const t=require("../Parts/ShapePart"),e=require("../Parts/TextPart"),s=require("../Parts/Thrusters"),o=require("./Action");class r extends o.Action{constructor(t,e,s,o){super(t),this.xMove=s,this.yMove=o,this.movedParts=e}UndoAction(){for(var o=0;o<this.movedParts.length;o++)this.movedParts[o]instanceof t.ShapePart||this.movedParts[o]instanceof s.Thrusters?this.movedParts[o].Move(this.movedParts[o].centerX-this.xMove,this.movedParts[o].centerY-this.yMove):this.movedParts[o]instanceof e.TextPart?this.movedParts[o].Move(this.movedParts[o].x-this.xMove,this.movedParts[o].y-this.yMove):this.movedParts[o].Move(this.movedParts[o].anchorX-this.xMove,this.movedParts[o].anchorY-this.yMove)}RedoAction(){for(var o=0;o<this.movedParts.length;o++)this.movedParts[o]instanceof t.ShapePart||this.movedParts[o]instanceof s.Thrusters?this.movedParts[o].Move(this.movedParts[o].centerX+this.xMove,this.movedParts[o].centerY+this.yMove):this.movedParts[o]instanceof e.TextPart?this.movedParts[o].Move(this.movedParts[o].x+this.xMove,this.movedParts[o].y+this.yMove):this.movedParts[o].Move(this.movedParts[o].anchorX+this.xMove,this.movedParts[o].anchorY+this.yMove)}}exports.MoveAction=r;
},{"../Parts/ShapePart":"CDAe","../Parts/TextPart":"T0pq","../Parts/Thrusters":"Yw1p","./Action":"xELh"}],"xG66":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MoveZAction=void 0;const t=require("../General/Util"),e=require("../Parts/TextPart"),r=require("./Action");class l extends r.Action{constructor(t,e,r=-1){super(t),this.type=e,this.oldIndex=r}UndoAction(){this.partAffected instanceof e.TextPart?this.type==l.FRONT_TYPE?(this.partAffected.inFront=!1,l.m_controller.removeChild(this.partAffected.m_textField),l.m_controller.addChildAt(this.partAffected.m_textField,l.m_controller.getChildIndex(l.m_controller.m_canvas))):(this.partAffected.inFront=!0,l.m_controller.removeChild(this.partAffected.m_textField),l.m_controller.addChildAt(this.partAffected.m_textField,l.m_controller.getChildIndex(l.m_controller.m_canvas)+1)):(l.m_controller.allParts=t.Util.RemoveFromArray(this.partAffected,l.m_controller.allParts),l.m_controller.allParts=t.Util.InsertIntoArray(this.partAffected,l.m_controller.allParts,this.oldIndex))}RedoAction(){if(this.partAffected instanceof e.TextPart)this.type==l.FRONT_TYPE?(this.partAffected.inFront=!0,l.m_controller.removeChild(this.partAffected.m_textField),l.m_controller.addChildAt(this.partAffected.m_textField,l.m_controller.getChildIndex(l.m_controller.m_canvas)+1)):(this.partAffected.inFront=!1,l.m_controller.removeChild(this.partAffected.m_textField),l.m_controller.addChildAt(this.partAffected.m_textField,l.m_controller.getChildIndex(l.m_controller.m_canvas)));else if(this.type==l.FRONT_TYPE)l.m_controller.allParts=t.Util.RemoveFromArray(this.partAffected,l.m_controller.allParts),l.m_controller.allParts.push(this.partAffected);else{for(var r=!1,o=l.m_controller.allParts.length-1;o>0;o--)if(l.m_controller.allParts[o]==this.partAffected&&(r=!0),r){if(!l.m_controller.allParts[o-1].isEditable)break;l.m_controller.allParts[o]=l.m_controller.allParts[o-1]}l.m_controller.allParts[o]=this.partAffected}}}exports.MoveZAction=l,l.FRONT_TYPE=0,l.BACK_TYPE=1;
},{"../General/Util":"Zvyo","../Parts/TextPart":"T0pq","./Action":"xELh"}],"Ta8o":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiCollideAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e){super(t[0]),this.partsAffected=t,this.collide=e}UndoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].collide=!this.collide}RedoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].collide=this.collide}}exports.MultiCollideAction=e;
},{"./Action":"xELh"}],"f3tu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiColourChangeAction=void 0;const t=require("../Parts/TextPart"),e=require("./Action");class s extends e.Action{constructor(t,e,s,i,r,o,c,d,h){super(t[0]),this.partsAffected=t,this.red=e,this.green=s,this.blue=i,this.opacity=r,this.oldReds=o,this.oldGreens=c,this.oldBlues=d,this.oldOpacitys=h}UndoAction(){for(var e=0;e<this.partsAffected.length;e++)this.partsAffected[e].red=this.oldReds[e],this.partsAffected[e].green=this.oldGreens[e],this.partsAffected[e].blue=this.oldBlues[e],this.partsAffected[e]instanceof t.TextPart||(this.partsAffected[e].opacity=this.oldOpacitys[e])}RedoAction(){for(var e=0;e<this.partsAffected.length;e++)this.partsAffected[e].red=this.red,this.partsAffected[e].green=this.green,this.partsAffected[e].blue=this.blue,this.partsAffected[e]instanceof t.TextPart||(this.partsAffected[e].opacity=this.opacity)}}exports.MultiColourChangeAction=s;
},{"../Parts/TextPart":"T0pq","./Action":"xELh"}],"eBnP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiFixateAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e){super(t[0]),this.partsAffected=t,this.fixate=e}UndoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].isStatic=!this.fixate}RedoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].isStatic=this.fixate}}exports.MultiFixateAction=e;
},{"./Action":"xELh"}],"mnQg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiOutlineAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e){super(t[0]),this.partsAffected=t,this.outline=e}UndoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].outline=!this.outline}RedoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].outline=this.outline}}exports.MultiOutlineAction=e;
},{"./Action":"xELh"}],"oMea":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiTerrainAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e){super(t[0]),this.partsAffected=t,this.terrain=e}UndoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].terrain=!this.terrain}RedoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].terrain=this.terrain}}exports.MultiTerrainAction=e;
},{"./Action":"xELh"}],"uT1E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MultiUndragableAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e){super(t[0]),this.partsAffected=t,this.undragable=e}UndoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].undragable=!this.undragable}RedoAction(){for(var t=0;t<this.partsAffected.length;t++)this.partsAffected[t].undragable=this.undragable}}exports.MultiUndragableAction=e;
},{"./Action":"xELh"}],"l0X7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResizeShapesAction=void 0;const t=require("pixi.js"),e=require("../Parts/Cannon"),s=require("../Parts/JointPart"),f=require("../Parts/PrismaticJoint"),a=require("../Parts/TextPart"),r=require("../Parts/Thrusters"),c=require("../Parts/Triangle"),i=require("./Action");class h extends i.Action{constructor(t,e){super(t[0]),this.partsAffected=t,this.scaleFactor=e}UndoAction(){var i=this.partsAffected[0]instanceof s.JointPart?this.partsAffected[0].anchorX:this.partsAffected[0]instanceof a.TextPart?this.partsAffected[0].x+this.partsAffected[0].w/2:this.partsAffected[0].centerX,h=this.partsAffected[0]instanceof s.JointPart?this.partsAffected[0].anchorY:this.partsAffected[0]instanceof a.TextPart?this.partsAffected[0].y+this.partsAffected[0].h/2:this.partsAffected[0].centerY;for(d=0;d<this.partsAffected.length;d++)this.partsAffected[d].dragXOff=(this.partsAffected[d]instanceof s.JointPart?this.partsAffected[d].anchorX:this.partsAffected[d]instanceof a.TextPart?this.partsAffected[d].x+this.partsAffected[d].w/2:this.partsAffected[d].centerX)-i,this.partsAffected[d].dragYOff=(this.partsAffected[d]instanceof s.JointPart?this.partsAffected[d].anchorY:this.partsAffected[d]instanceof a.TextPart?this.partsAffected[d].y+this.partsAffected[d].h/2:this.partsAffected[d].centerY)-h,this.partsAffected[d].PrepareForResizing();for(var d=0;d<this.partsAffected.length;d++)this.partsAffected[d]instanceof t.Circle?(this.partsAffected[d].radius=this.partsAffected[d].radius/this.scaleFactor,this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff/this.scaleFactor,h+this.partsAffected[d].dragYOff/this.scaleFactor)):this.partsAffected[d]instanceof t.Rectangle?(this.partsAffected[d].w=this.partsAffected[d].w/this.scaleFactor,this.partsAffected[d].h=this.partsAffected[d].h/this.scaleFactor,this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff/this.scaleFactor,h+this.partsAffected[d].dragYOff/this.scaleFactor)):this.partsAffected[d]instanceof c.Triangle?(this.partsAffected[d].centerX=i+this.partsAffected[d].dragXOff/this.scaleFactor,this.partsAffected[d].centerY=h+this.partsAffected[d].dragYOff/this.scaleFactor,this.partsAffected[d].x1=this.partsAffected[d].centerX+this.partsAffected[d].initX1/this.scaleFactor,this.partsAffected[d].y1=this.partsAffected[d].centerY+this.partsAffected[d].initY1/this.scaleFactor,this.partsAffected[d].x2=this.partsAffected[d].centerX+this.partsAffected[d].initX2/this.scaleFactor,this.partsAffected[d].y2=this.partsAffected[d].centerY+this.partsAffected[d].initY2/this.scaleFactor,this.partsAffected[d].x3=this.partsAffected[d].centerX+this.partsAffected[d].initX3/this.scaleFactor,this.partsAffected[d].y3=this.partsAffected[d].centerY+this.partsAffected[d].initY3/this.scaleFactor):this.partsAffected[d]instanceof e.Cannon?(this.partsAffected[d].w=this.partsAffected[d].w/this.scaleFactor,this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff/this.scaleFactor,h+this.partsAffected[d].dragYOff/this.scaleFactor)):this.partsAffected[d]instanceof s.JointPart?(this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff/this.scaleFactor,h+this.partsAffected[d].dragYOff/this.scaleFactor),this.partsAffected[d]instanceof f.PrismaticJoint&&(this.partsAffected[d].initLength=this.partsAffected[d].initInitLength/this.scaleFactor)):this.partsAffected[d]instanceof a.TextPart?(this.partsAffected[d].w=this.partsAffected[d].w/this.scaleFactor,this.partsAffected[d].h=this.partsAffected[d].h/this.scaleFactor,this.partsAffected[d].x=i+this.partsAffected[d].dragXOff/this.scaleFactor-this.partsAffected[d].w/2,this.partsAffected[d].y=h+this.partsAffected[d].dragYOff/this.scaleFactor-this.partsAffected[d].h/2):this.partsAffected[d]instanceof r.Thrusters&&this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff/this.scaleFactor,h+this.partsAffected[d].dragYOff/this.scaleFactor)}RedoAction(){var i=this.partsAffected[0]instanceof s.JointPart?this.partsAffected[0].anchorX:this.partsAffected[0]instanceof a.TextPart?this.partsAffected[0].x+this.partsAffected[0].w/2:this.partsAffected[0].centerX,h=this.partsAffected[0]instanceof s.JointPart?this.partsAffected[0].anchorY:this.partsAffected[0]instanceof a.TextPart?this.partsAffected[0].y+this.partsAffected[0].h/2:this.partsAffected[0].centerY;for(d=0;d<this.partsAffected.length;d++)this.partsAffected[d].dragXOff=(this.partsAffected[d]instanceof s.JointPart?this.partsAffected[d].anchorX:this.partsAffected[d]instanceof a.TextPart?this.partsAffected[d].x+this.partsAffected[d].w/2:this.partsAffected[d].centerX)-i,this.partsAffected[d].dragYOff=(this.partsAffected[d]instanceof s.JointPart?this.partsAffected[d].anchorY:this.partsAffected[d]instanceof a.TextPart?this.partsAffected[d].y+this.partsAffected[d].h/2:this.partsAffected[d].centerY)-h,this.partsAffected[d].PrepareForResizing();for(var d=0;d<this.partsAffected.length;d++)this.partsAffected[d]instanceof t.Circle?(this.partsAffected[d].radius=this.partsAffected[d].radius*this.scaleFactor,this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff*this.scaleFactor,h+this.partsAffected[d].dragYOff*this.scaleFactor)):this.partsAffected[d]instanceof t.Rectangle?(this.partsAffected[d].w=this.partsAffected[d].w*this.scaleFactor,this.partsAffected[d].h=this.partsAffected[d].h*this.scaleFactor,this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff*this.scaleFactor,h+this.partsAffected[d].dragYOff*this.scaleFactor)):this.partsAffected[d]instanceof c.Triangle?(this.partsAffected[d].centerX=i+this.partsAffected[d].dragXOff*this.scaleFactor,this.partsAffected[d].centerY=h+this.partsAffected[d].dragYOff*this.scaleFactor,this.partsAffected[d].x1=this.partsAffected[d].centerX+this.partsAffected[d].initX1*this.scaleFactor,this.partsAffected[d].y1=this.partsAffected[d].centerY+this.partsAffected[d].initY1*this.scaleFactor,this.partsAffected[d].x2=this.partsAffected[d].centerX+this.partsAffected[d].initX2*this.scaleFactor,this.partsAffected[d].y2=this.partsAffected[d].centerY+this.partsAffected[d].initY2*this.scaleFactor,this.partsAffected[d].x3=this.partsAffected[d].centerX+this.partsAffected[d].initX3*this.scaleFactor,this.partsAffected[d].y3=this.partsAffected[d].centerY+this.partsAffected[d].initY3*this.scaleFactor):this.partsAffected[d]instanceof e.Cannon?(this.partsAffected[d].w=this.partsAffected[d].w*this.scaleFactor,this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff*this.scaleFactor,h+this.partsAffected[d].dragYOff*this.scaleFactor)):this.partsAffected[d]instanceof s.JointPart?(this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff*this.scaleFactor,h+this.partsAffected[d].dragYOff*this.scaleFactor),this.partsAffected[d]instanceof f.PrismaticJoint&&(this.partsAffected[d].initLength=this.partsAffected[d].initInitLength*this.scaleFactor)):this.partsAffected[d]instanceof a.TextPart?(this.partsAffected[d].w=this.partsAffected[d].w*this.scaleFactor,this.partsAffected[d].h=this.partsAffected[d].h*this.scaleFactor,this.partsAffected[d].x=i+this.partsAffected[d].dragXOff*this.scaleFactor-this.partsAffected[d].w/2,this.partsAffected[d].y=h+this.partsAffected[d].dragYOff*this.scaleFactor-this.partsAffected[d].h/2):this.partsAffected[d]instanceof r.Thrusters&&this.partsAffected[d].Move(i+this.partsAffected[d].dragXOff/this.scaleFactor,h+this.partsAffected[d].dragYOff/this.scaleFactor)}}exports.ResizeShapesAction=h;
},{"pixi.js":"aQiP","../Parts/Cannon":"vdN1","../Parts/JointPart":"avwv","../Parts/PrismaticJoint":"nZSh","../Parts/TextPart":"T0pq","../Parts/Thrusters":"Yw1p","../Parts/Triangle":"CRRv","./Action":"xELh"}],"VEDY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ResizeTextAction=void 0;const t=require("./Action");class e extends t.Action{constructor(t,e,h,s,c){super(t),this.changeX=e,this.changeY=h,this.changeW=s,this.changeH=c}UndoAction(){this.partAffected.x-=this.changeX,this.partAffected.y-=this.changeY,this.partAffected.w-=this.changeW,this.partAffected.h-=this.changeH}RedoAction(){this.partAffected.x+=this.changeX,this.partAffected.y+=this.changeY,this.partAffected.w+=this.changeW,this.partAffected.h+=this.changeH}}exports.ResizeTextAction=e;
},{"./Action":"xELh"}],"SMyw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.RotateAction=void 0;const t=require("../General/Util"),e=require("../Parts/PrismaticJoint"),r=require("../Parts/ShapePart"),a=require("../Parts/Thrusters"),s=require("./Action");class i extends s.Action{constructor(t,e,r){super(t),this.angle=r,this.rotatedParts=e}UndoAction(){for(var s=0;s<this.rotatedParts.length;s++)this.rotatedParts[s]instanceof r.ShapePart||this.rotatedParts[s]instanceof a.Thrusters?(this.rotatedParts[s].rotateAngle=Math.atan2(this.rotatedParts[s].centerY-this.partAffected.centerY,this.rotatedParts[s].centerX-this.partAffected.centerX),this.rotatedParts[s].rotateOrientation=this.rotatedParts[s].angle):(this.rotatedParts[s].rotateAngle=Math.atan2(this.rotatedParts[s].anchorY-this.partAffected.centerY,this.rotatedParts[s].anchorX-this.partAffected.centerX),this.rotatedParts[s]instanceof e.PrismaticJoint&&(this.rotatedParts[s].rotateOrientation=t.Util.GetAngle(this.rotatedParts[s].axis))),this.rotatedParts[s].RotateAround(this.partAffected.centerX,this.partAffected.centerY,-this.angle)}RedoAction(){for(var s=0;s<this.rotatedParts.length;s++)this.rotatedParts[s]instanceof r.ShapePart||this.rotatedParts[s]instanceof a.Thrusters?(this.rotatedParts[s].rotateAngle=Math.atan2(this.rotatedParts[s].centerY-this.partAffected.centerY,this.rotatedParts[s].centerX-this.partAffected.centerX),this.rotatedParts[s].rotateOrientation=this.rotatedParts[s].angle):(this.rotatedParts[s].rotateAngle=Math.atan2(this.rotatedParts[s].anchorY-this.partAffected.centerY,this.rotatedParts[s].anchorX-this.partAffected.centerX),this.rotatedParts[s]instanceof e.PrismaticJoint&&(this.rotatedParts[s].rotateOrientation=t.Util.GetAngle(this.rotatedParts[s].axis))),this.rotatedParts[s].RotateAround(this.partAffected.centerX,this.partAffected.centerY,this.angle)}}exports.RotateAction=i;
},{"../General/Util":"Zvyo","../Parts/PrismaticJoint":"nZSh","../Parts/ShapePart":"CDAe","../Parts/Thrusters":"Yw1p","./Action":"xELh"}],"V2A2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ShapeCheckboxAction=void 0;const t=require("../Parts/ShapePart"),e=require("./Action");class i extends e.Action{constructor(t,e,i){super(t),this.type=e,this.isChecked=i}UndoAction(){this.type==i.COLLIDE_TYPE?(this.partAffected,t.ShapePart,this.partAffected.collide=!this.isChecked):this.type==i.FIXATE_TYPE?this.partAffected.isStatic=!this.isChecked:this.type==i.OUTLINE_TYPE?(this.partAffected,t.ShapePart,this.partAffected.outline=!this.isChecked):this.type==i.TERRAIN_TYPE?this.partAffected.terrain=!this.isChecked:this.partAffected.undragable=!this.isChecked}RedoAction(){this.type==i.COLLIDE_TYPE?(this.partAffected,t.ShapePart,this.partAffected.collide=this.isChecked):this.type==i.FIXATE_TYPE?this.partAffected.isStatic=this.isChecked:this.type==i.OUTLINE_TYPE?(this.partAffected,t.ShapePart,this.partAffected.outline=this.isChecked):this.type==i.TERRAIN_TYPE?this.partAffected.terrain=this.isChecked:this.partAffected.undragable=!this.isChecked}}exports.ShapeCheckboxAction=i,i.COLLIDE_TYPE=0,i.FIXATE_TYPE=1,i.OUTLINE_TYPE=2,i.TERRAIN_TYPE=3,i.UNDRAGABLE_TYPE=4;
},{"../Parts/ShapePart":"CDAe","./Action":"xELh"}],"vJ2q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextCheckboxAction=void 0;const e=require("./Action");class t extends e.Action{constructor(e,t,s){super(e),this.type=t,this.isChecked=s}UndoAction(){this.type==t.SCALE_TYPE?this.partAffected.scaleWithZoom=!this.isChecked:this.partAffected.alwaysVisible=!this.isChecked}RedoAction(){this.type==t.SCALE_TYPE?this.partAffected.scaleWithZoom=this.isChecked:this.partAffected.alwaysVisible=this.isChecked}}exports.TextCheckboxAction=t,t.SCALE_TYPE=0,t.DISPLAY_TYPE=1;
},{"./Action":"xELh"}],"c1cn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextSizeChangeAction=void 0;const e=require("./Action");class t extends e.Action{constructor(e,t){super(e),this.change=t}UndoAction(){this.partAffected.size-=this.change}RedoAction(){this.partAffected.size+=this.change}}exports.TextSizeChangeAction=t;
},{"./Action":"xELh"}],"u77w":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContactFilter=void 0;const e=require("@box2d/core");class t extends e.b2ContactFilter{constructor(){super()}ShouldCollide(e,t){const i=e.GetUserData(),s=t.GetUserData();return!!(i&&i.isSandbox||s&&s.isSandbox)||!!(!i||!s||i.collide||i.editable&&!s.editable||-1!=i.isPiston&&-1!=s.isPiston)&&(!!(!i||!s||s.collide||s.editable&&!i.editable||-1!=i.isPiston&&-1!=s.isPiston)&&(!(i&&s&&-1!=i.isPiston&&-1!=s.isPiston&&!i.collide&&(!i.editable||s.editable))&&(!(i&&s&&-1!=i.isPiston&&-1!=s.isPiston&&!s.collide&&(!s.editable||i.editable))&&(!(!i||!s||-1==i.isPiston||-1==s.isPiston||i.isPiston!=s.isPiston||e.GetBody()==t.GetBody()||e.GetFilterData().groupIndex!=t.GetFilterData().groupIndex)||super.ShouldCollide(e,t)))))}}exports.ContactFilter=t;
},{"@box2d/core":"kjbO"}],"sy4E":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ContactListener=void 0;const t=require("@box2d/core");class e extends t.b2ContactListener{constructor(t){super(),this.cont=t}BeginContact(t){this.cont.ContactAdded(t)}}exports.ContactListener=e;
},{"@box2d/core":"kjbO"}],"Cq9K":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ControllerGame=void 0;const t=require("pixi.js"),s=require("../General/Database"),i=require("../General/Util"),a=require("../Main"),l=require("../Parts/Part"),o=require("../Parts/Cannon"),r=require("../Parts/FixedJoint"),n=require("../Parts/JointPart"),h=require("../Parts/PrismaticJoint"),d=require("../Parts/RevoluteJoint"),c=require("../Parts/ShapePart"),m=require("../Parts/TextPart"),g=require("../Parts/Thrusters"),b=require("../Parts/Triangle"),P=require("./CameraMovement"),G=require("./Controller"),u=require("./Draw"),C=require("./Replay"),p=require("./Robot"),_=require("./Globals/ControllerGameGlobals"),f=require("../General/Input"),y=require("../Actions/Action"),w=require("../Gui/MainEditPanel"),S=require("../Gui/DropDownMenu"),A=require("../Gui/PartEditWindow"),D=require("../General/LSOManager"),R=require("../Gui/AdvancedSandboxWindow"),T=require("../Gui/ImportWindow"),v=require("./ControllerSandbox"),W=require("./KeyPress"),I=require("./ReplaySyncPoint"),x=require("@box2d/core"),O=require("../Actions/CameraAction"),E=require("../Actions/ChangeSliderAction"),M=require("../Actions/ClearAction"),Y=require("../Actions/ColourChangeAction"),X=require("../Actions/ControlKeyAction"),J=require("../Actions/CreateAction"),N=require("../Actions/DeleteAction"),B=require("../Actions/EnterTextAction"),L=require("../Actions/JointCheckboxAction"),F=require("../Actions/LimitChangeAction"),k=require("../Actions/MassCreateAction"),U=require("../Actions/MoveAction"),H=require("../Actions/MoveZAction"),K=require("../Actions/MultiCollideAction"),V=require("../Actions/MultiColourChangeAction"),Z=require("../Actions/MultiFixateAction"),q=require("../Actions/MultiOutlineAction"),z=require("../Actions/MultiTerrainAction"),j=require("../Actions/MultiUndragableAction"),Q=require("../Actions/ResizeShapesAction"),$=require("../Actions/ResizeTextAction"),tt=require("../Actions/RotateAction"),et=require("../Actions/ShapeCheckboxAction"),it=require("../Actions/TextCheckboxAction"),at=require("../Actions/TextSizeChangeAction"),lt=require("./ContactFilter"),ot=require("./ContactListener"),rt=require("../Parts/Rectangle"),nt=require("../Parts/Circle");class ht extends G.Controller{constructor(){super(),this.controllerType="game",this.m_world=null,this.m_groundBody=null,this.m_mouseJoint=null,this.m_iterations=10,this.m_timeStep=1/30,this.m_physScale=_.ControllerGameGlobals.INIT_PHYS_SCALE,this.m_buildAreas=new Array,this.m_badBuildAreas=new Array,this.m_selectedBuildAreas=new Array,this.m_chooserWindow=null,this.m_loginWindow=null,this.m_newUserWindow=null,this.m_scoreWindow=null,this.m_progressDialog=null,this.m_linkDialog=null,this.m_tutorialDialog=null,this.m_postReplayWindow=null,this.m_rateDialog=null,this.m_restrictionsDialog=null,this.m_conditionsDialog=null,this.m_sandboxWindow=null,this.m_challengeWindow=null,this.m_reportWindow=null,this.m_loadWindow=null,this.m_exportDialog=null,this.m_importDialog=null,this.hasPanned=!0,this.hasZoomed=!0,this.redrawBuildArea=!0,this.redrawRobot=!0,this.paused=!0,this.simStarted=!1,this.wonChallenge=!1,this.canSaveReplay=!0,this.autoPanning=!0,this.cameraPart=null,this.curAction=-1,this.actionStep=0,this.lastAction=-1,this.partsFit=!0,this.draggingTutorial=!1,this.selectingCondition=!1,this.delayedSelection=!1,this.ignoreAClick=!1,this.backToSaveWindow=!1,this.clickedReport=!1,this.clickedSave=!1,this.clickedSaveReplay=!1,this.clickedSaveChallenge=!1,this.clickedSubmitScore=!1,this.redirectAfterRating=0,this.saveAfterRestrictions=!1,this.selectedParts=new Array,this.rotatingPart=null,this.rotatingParts=null,this.draggingPart=null,this.draggingParts=null,this.jointPart=null,this.lastSelectedShape=null,this.lastSelectedJoint=null,this.lastSelectedText=null,this.lastSelectedThrusters=null,this.copiedJoint=null,this.copiedThrusters=null,this.removedGraphics=new Array,this.oldText="",this.allParts=new Array,_.ControllerGameGlobals.cannonballs=new Array,this.actions=new Array,f.Input.m_currController=this,y.Action.m_controller=this,this.m_canvas=new t.Graphics,this.m_guiPanel=new w.MainEditPanel(this),this.m_guiMenu=new S.DropDownMenu(this),this.m_sidePanel=new A.PartEditWindow(this),this.m_fader=new t.Graphics,this.m_fader.beginFill(0,.2),this.m_fader.lineStyle(0,0,.2),this.m_fader.moveTo(0,0),this.m_fader.lineTo(800,0),this.m_fader.lineTo(800,600),this.m_fader.lineTo(0,600),this.m_fader.lineTo(0,0),this.m_fader.endFill(),this.m_fader.visible=!1,this.uneditableText=new t.Text(""),this.uneditableText.x=0,this.uneditableText.y=102,this.uneditableText.width=800,this.uneditableText.text="The current robot is uneditable.  Some features, including saving and submitting scores, will be disabled.",this.uneditableText.visible=!1;var e=new t.TextStyle;e.align="center",e.fontFamily=a.Main.GLOBAL_FONT,e.fontSize=12,this.uneditableText.style=e,this.rotatingText=new t.Text(""),this.rotatingText.x=0,this.rotatingText.y=102,this.rotatingText.width=800,this.rotatingText.text="Move the mouse around to rotate the shape, and click when you're done.",this.rotatingText.visible=!1,this.rotatingText.style=e,this.scalingText=new t.Text(""),this.scalingText.x=0,this.scalingText.y=102,this.scalingText.width=800,this.scalingText.text="Move the mouse to the right to increase the shape's size, and left to decrease it.",this.scalingText.visible=!1,this.scalingText.style=e,this.boxText=new t.Text(""),this.boxText.x=0,this.boxText.y=102,this.boxText.width=800,this.boxText.text="Use the mouse to click and drag a box for the given condition.  You can use the arrow keys to scroll.",this.boxText.visible=!1,this.boxText.style=e,this.horizLineText=new t.Text(""),this.horizLineText.x=0,this.horizLineText.y=102,this.horizLineText.width=800,this.horizLineText.text="Use the mouse to draw a horizontal line for the given condition.  You can use the arrow keys to scroll.",this.horizLineText.visible=!1,this.horizLineText.style=e,this.vertLineText=new t.Text(""),this.vertLineText.x=0,this.vertLineText.y=102,this.vertLineText.width=800,this.vertLineText.text="Use the mouse to draw a vertical line for the given condition.  You can use the arrow keys to scroll.",this.vertLineText.visible=!1,this.vertLineText.style=e,this.shapeText=new t.Text(""),this.shapeText.x=0,this.shapeText.y=102,this.shapeText.width=800,this.shapeText.text="Select a shape for the given condition.  You can use the arrow keys to scroll.",this.shapeText.visible=!1,this.shapeText.style=e,this.draw=new u.Draw,this.draw.m_sprite=this.m_canvas,this.draw.m_drawScale=this.m_physScale,this.draw.m_drawYOff=-100,_.ControllerGameGlobals.showColours?this.draw.m_fillAlpha=1:this.draw.m_fillAlpha=.5,_.ControllerGameGlobals.playingReplay?_.ControllerGameGlobals.replay.cont=this:_.ControllerGameGlobals.viewingUnsavedReplay=!1,this.on("added",t=>this.Init(t))}Init(t){if(this.addChild(this.m_canvas),this.addChild(this.uneditableText),this.addChild(this.rotatingText),this.addChild(this.scalingText),this.addChild(this.boxText),this.addChild(this.horizLineText),this.addChild(this.vertLineText),this.addChild(this.shapeText),this.addChild(this.m_guiPanel),this.addChild(this.m_sidePanel),this.addChild(this.m_guiMenu),this.addChild(this.m_fader),_.ControllerGameGlobals.playingReplay){this.allParts=this.allParts.concat(_.ControllerGameGlobals.replayParts);for(var e=0;e<this.allParts.length;e++)if(this.allParts[e]instanceof m.TextPart){var s=new m.TextPart(this,this.allParts[e].x,this.allParts[e].y,this.allParts[e].w,this.allParts[e].h,this.allParts[e].text);s.alwaysVisible=this.allParts[e].alwaysVisible,s.displayKey=this.allParts[e].displayKey,s.red=this.allParts[e].red,s.green=this.allParts[e].green,s.blue=this.allParts[e].blue,s.size=this.allParts[e].size,this.allParts[e]=s}}if(_.ControllerGameGlobals.loadedParts){if("challenge"===this.controllerType&&ControllerChallenge.playChallengeMode&&!_.ControllerGameGlobals.justLoadedRobotWithChallenge)for(e=0;e<_.ControllerGameGlobals.loadedParts.length;e++)_.ControllerGameGlobals.loadedParts[e].isEditable=!1;if(_.ControllerGameGlobals.justLoadedRobotWithChallenge)for(this.allParts=this.allParts.concat(ControllerChallenge.challenge.allParts),e=0;e<this.allParts.length;e++)this.allParts[e].isEditable=!1;for(_.ControllerGameGlobals.justLoadedRobotWithChallenge=!1,this.allParts=this.allParts.concat(_.ControllerGameGlobals.loadedParts),e=0;e<this.allParts.length;e++)this.allParts[e]instanceof m.TextPart&&((s=new m.TextPart(this,this.allParts[e].x,this.allParts[e].y,this.allParts[e].w,this.allParts[e].h,this.allParts[e].text)).alwaysVisible=this.allParts[e].alwaysVisible,s.displayKey=this.allParts[e].displayKey,s.red=this.allParts[e].red,s.green=this.allParts[e].green,s.blue=this.allParts[e].blue,s.size=this.allParts[e].size,this.allParts[e].isEditable||(s.isEditable=!1),this.allParts[e]=s);_.ControllerGameGlobals.loadedParts=null,_.ControllerGameGlobals.initX!=Number.MAX_VALUE?(this.draw.m_drawXOff=_.ControllerGameGlobals.initX,this.draw.m_drawYOff=_.ControllerGameGlobals.initY,this.m_physScale=_.ControllerGameGlobals.initZoom):"challenge"!==this.controllerType&&this.CenterOnLoadedRobot()}else _.ControllerGameGlobals.playingReplay||(_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.curRobotEditable=!0,_.ControllerGameGlobals.curRobotPublic=!1);_.ControllerGameGlobals.initX=Number.MAX_VALUE,_.ControllerGameGlobals.initY=Number.MAX_VALUE,_.ControllerGameGlobals.initZoom=Number.MAX_VALUE,"challenge"===this.controllerType?(_.ControllerGameGlobals.minDensity=this.challenge.minDensity==-Number.MAX_VALUE?1:this.challenge.minDensity,_.ControllerGameGlobals.maxDensity=this.challenge.maxDensity==Number.MAX_VALUE?30:this.challenge.maxDensity,_.ControllerGameGlobals.maxRJStrength=this.challenge.maxRJStrength==Number.MAX_VALUE?30:this.challenge.maxRJStrength,_.ControllerGameGlobals.maxRJSpeed=this.challenge.maxRJSpeed==Number.MAX_VALUE?30:this.challenge.maxRJSpeed,_.ControllerGameGlobals.maxSJStrength=this.challenge.maxSJStrength==Number.MAX_VALUE?30:this.challenge.maxSJStrength,_.ControllerGameGlobals.maxSJSpeed=this.challenge.maxSJSpeed==Number.MAX_VALUE?30:this.challenge.maxSJSpeed,_.ControllerGameGlobals.maxThrusterStrength=this.challenge.maxThrusterStrength==Number.MAX_VALUE?30:this.challenge.maxThrusterStrength):(_.ControllerGameGlobals.minDensity=1,_.ControllerGameGlobals.maxDensity=30,_.ControllerGameGlobals.maxRJStrength=30,_.ControllerGameGlobals.maxRJSpeed=30,_.ControllerGameGlobals.maxSJStrength=30,_.ControllerGameGlobals.maxSJSpeed=30,_.ControllerGameGlobals.maxThrusterStrength=30),h.PrismaticJoint.jbTutorial=!1,a.Main.inIFrame&&(_.ControllerGameGlobals.curRobotEditable=!1,this.uneditableText.text="")}BuildBuildArea(){for(var e=0;e<this.m_buildAreas.length;e++)this.removeChild(this.m_buildAreas[e]),this.removeChild(this.m_badBuildAreas[e]),this.removeChild(this.m_selectedBuildAreas[e]);this.m_buildAreas=new Array,this.m_badBuildAreas=new Array,this.m_selectedBuildAreas=new Array;var s=this.sSky.lastCloudIndex+1;for(e=0;e<this.NumBuildingAreas();e++){var i=new t.Sprite;i.graphics.lineStyle(6,14594141);var a=new t.Matrix;a.createGradientBox(700,550,Math.PI/2),i.graphics.beginGradientFill(GradientType.LINEAR,[16748311,16761168],[.15,.15],[0,255],a),i.graphics.drawRect(0,0,700,550),i.graphics.endFill(),this.addChildAt(i,s),this.m_buildAreas.push(i);var l=new t.Sprite;l.graphics.lineStyle(6,14576221),(a=new t.Matrix).createGradientBox(700,550,Math.PI/2),l.graphics.beginGradientFill(GradientType.LINEAR,[16731415,16748368],[.15,.15],[0,255],a),l.graphics.drawRect(0,0,700,550),l.graphics.endFill(),this.addChildAt(l,s),this.m_badBuildAreas.push(l);var o=new t.Sprite;o.graphics.lineStyle(6,16697949),(a=new t.Matrix).createGradientBox(700,550,Math.PI/2),o.graphics.beginGradientFill(GradientType.LINEAR,[16731415,16748368],[.15,.15],[0,255],a),o.graphics.drawRect(0,0,700,550),o.graphics.endFill(),this.addChildAt(o,s),this.m_selectedBuildAreas.push(o)}}PlayShapeSound(){if(a.Main.enableSound){var t=Math.floor(i.Util.RangedRandom(0,5));(0==t?_.ControllerGameGlobals.shapeSound1:1==t?_.ControllerGameGlobals.shapeSound2:2==t?_.ControllerGameGlobals.shapeSound3:3==t?_.ControllerGameGlobals.shapeSound4:_.ControllerGameGlobals.shapeSound5).play()}}PlayJointSound(){if(a.Main.enableSound){var t=Math.floor(i.Util.RangedRandom(0,5));(0==t?_.ControllerGameGlobals.jointSound1:1==t?_.ControllerGameGlobals.jointSound2:2==t?_.ControllerGameGlobals.jointSound3:3==t?_.ControllerGameGlobals.jointSound4:_.ControllerGameGlobals.jointSound5).play()}}GetPhysScale(){return this.m_physScale}GetMinX(){return-Number.MAX_VALUE}GetMaxX(){return Number.MAX_VALUE}GetMinY(){return-Number.MAX_VALUE}GetMaxY(){return Number.MAX_VALUE}Update(){if(!this.m_fader.visible){_.ControllerGameGlobals.showColours?this.draw.m_fillAlpha=1:this.draw.m_fillAlpha=.5,_.ControllerGameGlobals.playingReplay&&!this.simStarted&&this.playButton(new MouseEvent("")),_.ControllerGameGlobals.mouseXWorldPhys=(f.Input.mouseX+this.draw.m_drawXOff)/this.m_physScale,_.ControllerGameGlobals.mouseYWorldPhys=(f.Input.mouseY+this.draw.m_drawYOff)/this.m_physScale,_.ControllerGameGlobals.prevMouseXWorld=_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.prevMouseYWorld=_.ControllerGameGlobals.mouseYWorld,_.ControllerGameGlobals.mouseXWorld=f.Input.mouseX,_.ControllerGameGlobals.mouseYWorld=f.Input.mouseY,a.Main.ShowMouse(),!this.paused&&this.autoPanning&&this.HandleCamera(),this.MouseDrag(),this.HandleKey();for(var t=0;t<this.allParts.length;t++)(this.allParts[t]instanceof d.RevoluteJoint||this.allParts[t]instanceof h.PrismaticJoint)&&this.allParts[t].CheckForBreakage(this.m_world);this.m_guiMenu.Update(),this.m_guiPanel.Update(this.curAction),this.uneditableText.visible=!_.ControllerGameGlobals.curRobotEditable&&!_.ControllerGameGlobals.playingReplay&&!this.simStarted,this.rotatingText.visible=this.curAction==_.ControllerGameGlobals.ROTATE,this.scalingText.visible=this.curAction==_.ControllerGameGlobals.RESIZING_SHAPES,this.newText&&this.lastSelectedText instanceof m.TextPart&&(this.lastSelectedText.text=this.newText.text,this.lastSelectedText.m_textField.text=this.newText.text,this.newText=null);var e=Date.now();this.paused||(_.ControllerGameGlobals.playingReplay||(this.frameCounter%_.ControllerGameGlobals.REPLAY_SYNC_FRAMES==0&&this.AddSyncPoint(),this.m_world.Step(1/60,{velocityIterations:5,positionIterations:5}),this.m_world.Step(1/60,{velocityIterations:this.m_iterations,positionIterations:this.m_iterations})),this.frameCounter++,this.m_guiPanel.SetTimer(this.frameCounter),(this.frameCounter>=9e3||_.ControllerGameGlobals.cannonballs.length>500)&&(this.canSaveReplay=!1))}if(this.draw.m_drawScale=this.m_physScale,this.draw.drawColours=_.ControllerGameGlobals.showColours,this.simStarted)for(t=0;t<this.m_buildAreas.length;t++)this.m_buildAreas[t].visible=!1,this.m_badBuildAreas[t].visible=!1,this.m_selectedBuildAreas[t].visible=!1;else{for(t=0;t<this.m_buildAreas.length;t++){var i=this.GetBuildingAreaNumber(t);(this.hasPanned||this.hasZoomed||this.redrawBuildArea)&&(this.m_buildAreas[t].x=this.World2ScreenX(i.lowerBound.x),this.m_buildAreas[t].y=this.World2ScreenY(i.lowerBound.y),this.m_badBuildAreas[t].x=this.World2ScreenX(i.lowerBound.x),this.m_badBuildAreas[t].y=this.World2ScreenY(i.lowerBound.y),this.m_selectedBuildAreas[t].x=this.World2ScreenX(i.lowerBound.x),this.m_selectedBuildAreas[t].y=this.World2ScreenY(i.lowerBound.y)),(this.hasZoomed||this.redrawBuildArea)&&(this.m_buildAreas[t].width=this.World2ScreenX(i.upperBound.x)-this.World2ScreenX(i.lowerBound.x),this.m_buildAreas[t].height=this.World2ScreenY(i.upperBound.y)-this.World2ScreenY(i.lowerBound.y),this.m_badBuildAreas[t].width=this.World2ScreenX(i.upperBound.x)-this.World2ScreenX(i.lowerBound.x),this.m_badBuildAreas[t].height=this.World2ScreenY(i.upperBound.y)-this.World2ScreenY(i.lowerBound.y),this.m_selectedBuildAreas[t].width=this.World2ScreenX(i.upperBound.x)-this.World2ScreenX(i.lowerBound.x),this.m_selectedBuildAreas[t].height=this.World2ScreenY(i.upperBound.y)-this.World2ScreenY(i.lowerBound.y)),this.m_selectedBuildAreas[t].visible=this.m_sidePanel.BuildWindowShowing()&&this.selectedBuildArea==ControllerChallenge.challenge.buildAreas[t],this.m_buildAreas[t].visible=!this.m_selectedBuildAreas[t].visible&&this.partsFit,this.m_badBuildAreas[t].visible=!this.m_selectedBuildAreas[t].visible&&!this.partsFit}this.redrawBuildArea=!1}(this.hasPanned||this.hasZoomed||!this.paused||this.draggingPart||-1!=this.curAction||this.redrawRobot)&&(this.m_canvas.clear(),this.draw.DrawWorld(this.allParts,this.selectedParts,this.m_world,!this.simStarted,!1,_.ControllerGameGlobals.showJoints,_.ControllerGameGlobals.showOutlines,"ControllerChallenge"===this.constructor.name?this.challenge:void 0),this.redrawRobot=!1);var l=this.FindPartToSnapTo();if(this.simStarted||(_.ControllerGameGlobals.snapToCenter&&l&&(this.curAction==_.ControllerGameGlobals.NEW_FIXED_JOINT||this.curAction==_.ControllerGameGlobals.NEW_REVOLUTE_JOINT||this.curAction==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT||this.curAction==_.ControllerGameGlobals.NEW_THRUSTERS)?this.draw.DrawTempShape(this.curAction,this.actionStep,this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY,l.centerX,l.centerY):this.curAction==_.ControllerGameGlobals.FINALIZING_JOINT&&this.candidateJointType==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT&&1==this.actionStep?this.draw.DrawTempShape(_.ControllerGameGlobals.NEW_PRISMATIC_JOINT,this.actionStep,this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY,this.candidateJointX,this.candidateJointY):this.curAction==_.ControllerGameGlobals.FINALIZING_JOINT&&this.candidateJointType==_.ControllerGameGlobals.NEW_THRUSTERS?this.draw.DrawTempShape(_.ControllerGameGlobals.NEW_THRUSTERS,this.actionStep,this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY,this.candidateJointX,this.candidateJointY):this.curAction==_.ControllerGameGlobals.FINALIZING_JOINT?this.draw.DrawTempShape(this.curAction,this.actionStep,this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY,this.candidateJointX,this.candidateJointY):this.draw.DrawTempShape(this.curAction,this.actionStep,this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys)),a.Main.m_fpsCounter.updatePhys(e),s.Database.errorOccurred&&(this.m_progressDialog.StopTimer(),this.m_progressDialog.SetMessage(s.Database.lastErrorMsg,!0),s.Database.errorOccurred=!1,s.Database.versionErrorOccurred?(s.Database.versionErrorOccurred=!1,this.m_progressDialog.ShowOKAndCancelButton(5)):this.m_progressDialog.ShowOKButton(),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog),a.Main.ShowMouse()),!this.paused&&this.ChallengeOver()&&(this.wonChallenge=!0,this.pauseButton(new MouseEvent("")),!_.ControllerGameGlobals.playingReplay||_.ControllerGameGlobals.viewingUnsavedReplay))if(this.m_fader.visible=!0,this instanceof ControllerTutorial||this.WonChallenge()){if(this.m_scoreWindow)try{this.removeChild(this.m_scoreWindow)}catch(o){}this.m_scoreWindow=new ScoreWindow(this,this.GetScore()),a.Main.enableSound&&(_.ControllerGameGlobals.musicChannel=_.ControllerGameGlobals.winSound.play(),st=new SoundTransform(.5),_.ControllerGameGlobals.musicChannel.soundTransform=st),this.addChild(this.m_scoreWindow),this instanceof ControllerTutorial?D.LSOManager.SetLevelDone(a.Main.nextControllerType-10):(this instanceof ControllerMonkeyBars||this instanceof ControllerClimb||this instanceof ControllerRace||this instanceof ControllerSpaceship)&&D.LSOManager.SetLevelDone(a.Main.nextControllerType+8)}else _.ControllerGameGlobals.failedChallenge=!0,this.ShowDialog3("Sorry, you have failed this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),a.Main.enableSound&&(_.ControllerGameGlobals.musicChannel=_.ControllerGameGlobals.loseSound.play(),st=new SoundTransform(.5),_.ControllerGameGlobals.musicChannel.soundTransform=st)}MoveCameraForReplay(t){if(t.x!=Number.POSITIVE_INFINITY){var e=this.draw.m_drawXOff,s=this.draw.m_drawYOff;this.draw.m_drawXOff=t.x,this.draw.m_drawYOff=t.y,this.autoPanning=!1,e==this.draw.m_drawXOff&&s==this.draw.m_drawYOff||(this.hasPanned=!0)}var i=this.m_physScale;this.m_physScale=t.scale,this.m_physScale!=i&&(this.hasZoomed=!0),this.autoPanning&&this.HandleCamera()}AddSyncPoint(){if(0==this.syncPoints.length||this.frameCounter!=this.syncPoints[this.syncPoints.length-1].frame){var t=new Array,e=new I.ReplaySyncPoint;e.frame=this.frameCounter;for(var s=0;s<this.allParts.length;s++)this.allParts[s]instanceof c.ShapePart&&!this.allParts[s].isStatic&&!i.Util.ObjectInArray(this.allParts[s].GetBody(),t)&&(e.positions.push(i.Util.Vector(this.allParts[s].GetBody().GetPosition().x,this.allParts[s].GetBody().GetPosition().y)),e.angles.push(this.allParts[s].GetBody().GetAngle()),t.push(this.allParts[s].GetBody()));for(s=0;s<_.ControllerGameGlobals.cannonballs.length;s++)e.cannonballPositions.push(i.Util.Vector(_.ControllerGameGlobals.cannonballs[s].GetPosition().x,_.ControllerGameGlobals.cannonballs[s].GetPosition().y));this.syncPoints.push(e)}}ComputeReplaySplines(t){for(var e=new Array,s=new Array,a=0;a<_.ControllerGameGlobals.replay.syncPoints.length-1;a++){e.push(_.ControllerGameGlobals.replay.syncPoints[a+1].frame-_.ControllerGameGlobals.replay.syncPoints[a].frame);for(var l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)if(0==t)l.push((_.ControllerGameGlobals.replay.syncPoints[a+1].positions[o].x-_.ControllerGameGlobals.replay.syncPoints[a].positions[o].x)/e[a]);else if(1==t)l.push((_.ControllerGameGlobals.replay.syncPoints[a+1].positions[o].y-_.ControllerGameGlobals.replay.syncPoints[a].positions[o].y)/e[a]);else{var r=_.ControllerGameGlobals.replay.syncPoints[a+1].angles[o]-_.ControllerGameGlobals.replay.syncPoints[a].angles[o];if(Math.abs(r)>20){var n=i.Util.NormalizeAngle(_.ControllerGameGlobals.replay.syncPoints[a].angles[o]),h=i.Util.NormalizeAngle(_.ControllerGameGlobals.replay.syncPoints[a+1].angles[o]);r=Math.abs(n-h)<Math.PI?h-n:n>h?h+2*Math.PI-n:h-(n+2*Math.PI)}l.push(r/e[a])}s.push(l)}var d=new Array,c=new Array;for(d.push(0),d.push(2*(e[0]+e[1])),l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)l.push(0);for(c.push(l),l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)s.length<2?l.push(0):l.push(6*(s[1][o]-s[0][o]));for(c.push(l),a=2;a<_.ControllerGameGlobals.replay.syncPoints.length-1;a++){for(d.push(2*(e[a-1]+e[a])-e[a-1]*e[a-1]/d[a-1]),l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)l.push(6*(s[a][o]-s[a-1][o])-e[a-1]*c[a-1][o]/d[a-1]);c.push(l)}var m=new Array;for(l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)l.push(0);for(m[_.ControllerGameGlobals.replay.syncPoints.length-1]=l,a=_.ControllerGameGlobals.replay.syncPoints.length-2;a>0;a--){for(l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)l.push((c[a][o]-e[a]*m[a+1][o])/d[a]);m[a]=l}for(l=new Array,o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)l.push(0);m[0]=l;var g=new Array,b=new Array,P=new Array,G=new Array,u=new Array;for(a=0;a<_.ControllerGameGlobals.replay.syncPoints.length-1;a++){var C=new Array,p=new Array,f=new Array,y=new Array;for(o=0;o<_.ControllerGameGlobals.replay.syncPoints[0].positions.length;o++)C.push(0==t?_.ControllerGameGlobals.replay.syncPoints[a].positions[o].x:1==t?_.ControllerGameGlobals.replay.syncPoints[a].positions[o].y:_.ControllerGameGlobals.replay.syncPoints[a].angles[o]),r=_.ControllerGameGlobals.replay.syncPoints[a+1].angles[o]-_.ControllerGameGlobals.replay.syncPoints[a].angles[o],Math.abs(r)>20&&(n=i.Util.NormalizeAngle(_.ControllerGameGlobals.replay.syncPoints[a].angles[o]),h=i.Util.NormalizeAngle(_.ControllerGameGlobals.replay.syncPoints[a+1].angles[o]),r=Math.abs(n-h)<Math.PI?h-n:n>h?h+2*Math.PI-n:h-(n+2*Math.PI)),p.push(-e[a]*m[a+1][o]/6-e[a]*m[a][o]/3+(0==t?_.ControllerGameGlobals.replay.syncPoints[a+1].positions[o].x-C[o]:1==t?_.ControllerGameGlobals.replay.syncPoints[a+1].positions[o].y-C[o]:r)/e[a]),f.push(m[a][o]/2),y.push((m[a+1][o]-m[a][o])/(6*e[a]));b.push(C),P.push(p),G.push(f),u.push(y)}return g.push(b),g.push(P),g.push(G),g.push(u),g}SyncReplay(t){for(var e=new Array,s=0,a=0;a<this.allParts.length;a++)this.allParts[a]instanceof c.ShapePart&&!this.allParts[a].isStatic&&!i.Util.ObjectInArray(this.allParts[a].GetBody(),e)&&(this.allParts[a].GetBody().SetXForm(t.positions[s],t.angles[s]),s++,e.push(this.allParts[a].GetBody()));for(a=0;a<_.ControllerGameGlobals.cannonballs.length;a++)_.ControllerGameGlobals.cannonballs[a].SetXForm(t.cannonballPositions[a],0)}SyncReplay2(t,e){for(var s=_.ControllerGameGlobals.replay.syncPoints.indexOf(t),a=new Array,l=0,o=0;o<this.allParts.length;o++)if(this.allParts[o]instanceof c.ShapePart&&!this.allParts[o].isStatic&&!i.Util.ObjectInArray(this.allParts[o].GetBody(),a)){var r=this.replaySplineXs[0][s][l]+(this.frameCounter-t.frame)*(this.replaySplineXs[1][s][l]+(this.frameCounter-t.frame)*(this.replaySplineXs[2][s][l]+(this.frameCounter-t.frame)*this.replaySplineXs[3][s][l])),n=this.replaySplineYs[0][s][l]+(this.frameCounter-t.frame)*(this.replaySplineYs[1][s][l]+(this.frameCounter-t.frame)*(this.replaySplineYs[2][s][l]+(this.frameCounter-t.frame)*this.replaySplineYs[3][s][l])),h=this.replaySplineAngles[0][s][l]+(this.frameCounter-t.frame)*(this.replaySplineAngles[1][s][l]+(this.frameCounter-t.frame)*(this.replaySplineAngles[2][s][l]+(this.frameCounter-t.frame)*this.replaySplineAngles[3][s][l]));this.allParts[o].GetBody().SetXForm(i.Util.Vector(r,n),h),l++,a.push(this.allParts[o].GetBody())}for(o=0;o<_.ControllerGameGlobals.cannonballs.length;o++)if(t.cannonballPositions.length>o){var d=e.frame-t.frame,m=(t.cannonballPositions[o].x*(e.frame-this.frameCounter)+e.cannonballPositions[o].x*(this.frameCounter-t.frame))/d,g=(t.cannonballPositions[o].y*(e.frame-this.frameCounter)+e.cannonballPositions[o].y*(this.frameCounter-t.frame))/d;_.ControllerGameGlobals.cannonballs[o].SetXForm(i.Util.Vector(m,g),0)}else _.ControllerGameGlobals.cannonballs[o].SetXForm(e.cannonballPositions[o],0)}IsPaused(){return this.paused}World2ScreenX(t){return t*this.m_physScale-this.draw.m_drawXOff}World2ScreenY(t){return t*this.m_physScale-this.draw.m_drawYOff}Screen2WorldX(t){return(t+this.draw.m_drawXOff)/this.m_physScale}Screen2WorldY(t){return(t+this.draw.m_drawYOff)/this.m_physScale}ChallengeOver(){throw new l.IllegalOperationError("abstract ControllerGameGlobals.ChallengeOver() called")}WonChallenge(){return!1}LostChallenge(){return!1}GetScore(){throw new l.IllegalOperationError("abstract ControllerGameGlobals.GetScore() called")}ContactAdded(t){}GetBuildingArea(){throw new l.IllegalOperationError("abstract ControllerGameGlobals.GetBuildingArea() called")}GetBuildingAreaNumber(t){return this.GetBuildingArea()}NumBuildingAreas(){return 1}GetBoxForConditions(){this.boxText.visible=!0,this.curAction=_.ControllerGameGlobals.DRAWING_BOX,this.actionStep=0,this.selectingCondition=!0}GetHorizontalLineForConditions(){this.horizLineText.visible=!0,this.curAction=_.ControllerGameGlobals.DRAWING_HORIZONTAL_LINE,this.actionStep=0,this.selectingCondition=!0}GetVerticalLineForConditions(){this.vertLineText.visible=!0,this.curAction=_.ControllerGameGlobals.DRAWING_VERTICAL_LINE,this.actionStep=0,this.selectingCondition=!0}GetShapeForConditions(){this.m_conditionsDialog.shape1||(this.selectedParts=new Array),this.shapeText.visible=!0,this.curAction=_.ControllerGameGlobals.SELECTING_SHAPE,this.selectingCondition=!0}CheckIfPartsFit(){var t=this.allParts.filter(this.PartIsEditable),e=this.NumBuildingAreas();if(this.partsFit=!0,"sandbox"!==this.controllerType&&("challenge"!==this.controllerType||ControllerChallenge.playChallengeMode)&&0!=e)for(var s,i,a,l,r=0;r<t.length;r++){for(var n=!1,h=0;h<e;h++){var d=this.GetBuildingAreaNumber(h);if(t[r]instanceof nt.Circle)s=t[r].centerX-t[r].radius,i=t[r].centerX+t[r].radius,a=t[r].centerY-t[r].radius,l=t[r].centerY+t[r].radius;else if(t[r]instanceof rt.Rectangle||t[r]instanceof b.Triangle||t[r]instanceof o.Cannon){var c=t[r].GetVertices();s=Number.MAX_VALUE,a=Number.MAX_VALUE,i=-Number.MAX_VALUE,l=-Number.MAX_VALUE;for(var m=0;m<c.length;m++)s=Math.min(s,c[m].x),i=Math.max(i,c[m].x),a=Math.min(a,c[m].y),l=Math.max(l,c[m].y)}else s=Number.MAX_VALUE,a=Number.MAX_VALUE,i=-Number.MAX_VALUE,l=-Number.MAX_VALUE;if(s>=d.lowerBound.x&&a>=d.lowerBound.y&&i<d.upperBound.x&&l<d.upperBound.y){n=!0;break}}if(!n){this.partsFit=!1;break}}}HandleKey(){if(this.paused)this.simStarted||this.m_sidePanel.EnteringInput()||(f.Input.isKeyDown(37)&&(this.draw.m_drawXOff-=10,this.hasPanned=!0),f.Input.isKeyDown(39)&&(this.draw.m_drawXOff+=10,this.hasPanned=!0),f.Input.isKeyDown(38)&&(this.draw.m_drawYOff-=10,this.hasPanned=!0),f.Input.isKeyDown(40)&&(this.draw.m_drawYOff+=10,this.hasPanned=!0));else{_.ControllerGameGlobals.playingReplay&&_.ControllerGameGlobals.replay.Update(this.frameCounter)&&this.pauseButton(new MouseEvent(""));for(var t=0;t<this.allParts.length;t++)this.allParts[t].Update(this.m_world)}}CenterOnLoadedRobot(){for(var t=null,e=0;e<this.allParts.length;e++)this.allParts[e]instanceof c.ShapePart&&this.allParts[e].isCameraFocus&&(t=this.allParts[e]);if(!t){for(e=0;e<this.allParts.length;e++)this.allParts[e].checkedCollisionGroup=!1;for(e=0;e<this.allParts.length;e++)this.allParts[e]instanceof c.ShapePart&&this.allParts[e].SetCollisionGroup(-(e+1));t=this.FindCenterOfRobot()}if(t){var s=this.draw.m_drawXOff,i=this.draw.m_drawYOff;this.draw.m_drawXOff=t.centerX*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_X,this.draw.m_drawYOff=t.centerY*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_Y,s==this.draw.m_drawXOff&&i==this.draw.m_drawYOff||(this.hasPanned=!0)}}HandleCamera(){if(this.cameraPart){var t=this.draw.m_drawXOff,e=this.draw.m_drawYOff;this.draw.m_drawXOff=this.cameraPart.GetBody().GetWorldCenter().x*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_X,this.draw.m_drawYOff=this.cameraPart.GetBody().GetWorldCenter().y*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_Y,(isNaN(this.draw.m_drawXOff)||isNaN(this.draw.m_drawYOff))&&(this.draw.m_drawXOff=t,this.draw.m_drawYOff=e),t==this.draw.m_drawXOff&&e==this.draw.m_drawYOff||(this.hasPanned=!0)}}MouseDrag(){if(this.simStarted){if(!this.paused&&("sandbox"===this.controllerType&&"challenge"!==this.controllerType||"challenge"===this.controllerType&&ControllerChallenge.challenge.mouseDragAllowed)){if(f.Input.mouseDown&&!this.m_mouseJoint){var t=this.GetBodyAtMouse();if(!_.ControllerGameGlobals.playingReplay&&t){var e=new x.b2MouseJointDef;e.bodyA=this.m_groundBody,e.bodyB=t,e.target.Set(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),e.maxForce=300*t.GetMass(),x.b2LinearStiffness(e,5,.7,e.bodyA,e.bodyB),this.m_mouseJoint=this.m_world.CreateJoint(e),t.SetAwake(!0)}}if(this.m_mouseJoint){var s=new x.b2Vec2(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys);this.m_mouseJoint.SetTarget(s)}f.Input.mouseDown||this.m_mouseJoint&&(this.m_world.DestroyJoint(this.m_mouseJoint),this.m_mouseJoint=null)}}else{if(f.Input.mouseDown&&_.ControllerGameGlobals.mouseYWorld>=100&&!this.m_sidePanel.sliderDown&&!this.m_guiMenu.MouseOverMenu(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)&&(_.ControllerGameGlobals.mouseXWorld>=120||!this.m_sidePanel.visible)&&(_.ControllerGameGlobals.mouseXWorld>=230||_.ControllerGameGlobals.mouseYWorld>=340||!this.m_sidePanel.ColourWindowShowing())&&this.curAction!=_.ControllerGameGlobals.BOX_SELECTING&&this.curAction!=_.ControllerGameGlobals.DRAWING_BUILD_BOX&&this.curAction!=_.ControllerGameGlobals.DRAWING_BOX&&this.curAction!=_.ControllerGameGlobals.DRAWING_HORIZONTAL_LINE&&this.curAction!=_.ControllerGameGlobals.DRAWING_VERTICAL_LINE&&(!this.m_tutorialDialog||!this.m_tutorialDialog.MouseOver(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld))){var a=this.GetPartAtMouse();if(!_.ControllerGameGlobals.wasMouseDown&&_.ControllerGameGlobals.curRobotEditable&&a instanceof c.ShapePart){var l=a;if(null==this.draggingPart&&(-1==this.curAction||this.curAction==_.ControllerGameGlobals.SELECTING_SHAPE)){this.MouseOverSelectedPart()?this.delayedSelection=!0:(i.Util.ObjectInArray(l,this.selectedParts)?f.Input.isKeyDown(16)&&(this.selectedParts=i.Util.RemoveFromArray(l,this.selectedParts)):(f.Input.isKeyDown(16)||(this.selectedParts=new Array),this.selectedParts.push(l)),this.redrawRobot=!0),this.draggingPart=this.selectedParts[0],this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingParts=new Array;for(var G=0;G<this.selectedParts.length;G++)this.draggingParts=i.Util.RemoveDuplicates(this.draggingParts.concat(this.selectedParts[G].GetAttachedParts()));for(G=0;G<this.draggingParts.length;G++)this.draggingParts[G]instanceof c.ShapePart||this.draggingParts[G]instanceof g.Thrusters?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].centerX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].centerY):this.draggingParts[G]instanceof n.JointPart?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].anchorX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].anchorY):(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].x,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].y)}}else if(!_.ControllerGameGlobals.wasMouseDown&&_.ControllerGameGlobals.curRobotEditable&&a instanceof n.JointPart&&null==this.draggingPart&&(-1==this.curAction||this.curAction==_.ControllerGameGlobals.SELECTING_SHAPE)){for(this.MouseOverSelectedPart()?this.delayedSelection=!0:(i.Util.ObjectInArray(a,this.selectedParts)?f.Input.isKeyDown(16)&&(this.selectedParts=i.Util.RemoveFromArray(a,this.selectedParts)):(f.Input.isKeyDown(16)||(this.selectedParts=new Array),this.selectedParts.push(a)),this.redrawRobot=!0),this.draggingPart=a,this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingParts=new Array,G=0;G<this.selectedParts.length;G++)this.draggingParts=i.Util.RemoveDuplicates(this.draggingParts.concat(this.selectedParts[G].GetAttachedParts()));for(G=0;G<this.draggingParts.length;G++)this.draggingParts[G]instanceof c.ShapePart||this.draggingParts[G]instanceof g.Thrusters?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].centerX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].centerY):this.draggingParts[G]instanceof n.JointPart?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].anchorX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].anchorY):(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].x,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].y)}else if(!_.ControllerGameGlobals.wasMouseDown&&_.ControllerGameGlobals.curRobotEditable&&a instanceof m.TextPart&&null==this.draggingPart&&(-1==this.curAction||this.curAction==_.ControllerGameGlobals.SELECTING_SHAPE))if(this.MouseOverSelectedPart()?this.delayedSelection=!0:(i.Util.ObjectInArray(a,this.selectedParts)?f.Input.isKeyDown(16)&&(this.selectedParts=i.Util.RemoveFromArray(a,this.selectedParts)):(f.Input.isKeyDown(16)||(this.selectedParts=new Array),this.selectedParts.push(a)),this.redrawRobot=!0),this.draggingPart=a,this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,a.InsideMoveBox(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys,this.m_physScale,!0))this.curAction=_.ControllerGameGlobals.RESIZING_TEXT;else{for(this.draggingParts=new Array,G=0;G<this.selectedParts.length;G++)this.draggingParts=i.Util.RemoveDuplicates(this.draggingParts.concat(this.selectedParts[G].GetAttachedParts()));for(G=0;G<this.draggingParts.length;G++)this.draggingParts[G]instanceof c.ShapePart||this.draggingParts[G]instanceof g.Thrusters?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].centerX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].centerY):this.draggingParts[G]instanceof n.JointPart?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].anchorX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].anchorY):(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].x,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].y)}else if(!_.ControllerGameGlobals.wasMouseDown&&_.ControllerGameGlobals.curRobotEditable&&a instanceof g.Thrusters&&null==this.draggingPart&&(-1==this.curAction||this.curAction==_.ControllerGameGlobals.SELECTING_SHAPE)){for(this.MouseOverSelectedPart()?this.delayedSelection=!0:(i.Util.ObjectInArray(a,this.selectedParts)?f.Input.isKeyDown(16)&&(this.selectedParts=i.Util.RemoveFromArray(a,this.selectedParts)):(f.Input.isKeyDown(16)||(this.selectedParts=new Array),this.selectedParts.push(a)),this.redrawRobot=!0),this.draggingPart=a,this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingParts=new Array,G=0;G<this.selectedParts.length;G++)this.draggingParts=i.Util.RemoveDuplicates(this.draggingParts.concat(this.selectedParts[G].GetAttachedParts()));for(G=0;G<this.draggingParts.length;G++)this.draggingParts[G]instanceof c.ShapePart||this.draggingParts[G]instanceof g.Thrusters?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].centerX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].centerY):this.draggingParts[G]instanceof n.JointPart?(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].anchorX,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].anchorY):(this.draggingParts[G].dragXOff=_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].x,this.draggingParts[G].dragYOff=_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].y)}else if(null==this.draggingPart&&null==this.rotatingPart&&(-1==this.curAction||this.curAction==_.ControllerGameGlobals.SELECTING_SHAPE)){if(f.Input.isKeyDown(16)&&_.ControllerGameGlobals.curRobotEditable)this.curAction=_.ControllerGameGlobals.BOX_SELECTING,this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys;else{var u=this.draw.m_drawXOff,C=this.draw.m_drawYOff;this.draw.m_drawXOff-=_.ControllerGameGlobals.mouseXWorld-_.ControllerGameGlobals.prevMouseXWorld,this.draw.m_drawYOff-=_.ControllerGameGlobals.mouseYWorld-_.ControllerGameGlobals.prevMouseYWorld,u==this.draw.m_drawXOff&&C==this.draw.m_drawYOff||(this.hasPanned=!0)}this.selectedParts=new Array,this.redrawRobot=!0}}if(f.Input.mouseDown&&!this.m_sidePanel.sliderDown&&!this.m_guiMenu.MouseOverMenu(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)&&_.ControllerGameGlobals.mouseYWorld>=100&&(_.ControllerGameGlobals.mouseXWorld>=120||!this.m_sidePanel.visible)&&(_.ControllerGameGlobals.mouseXWorld>=230||_.ControllerGameGlobals.mouseYWorld>=340||!this.m_sidePanel.ColourWindowShowing())&&this.curAction!=_.ControllerGameGlobals.BOX_SELECTING&&(this.m_tutorialDialog&&this.m_tutorialDialog.MouseOver(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)||this.RefreshSidePanel()),f.Input.mouseDown||(this.draggingTutorial=!1),this.draggingTutorial&&(this.m_tutorialDialog.x=_.ControllerGameGlobals.mouseXWorld-this.initDragX,this.m_tutorialDialog.y=_.ControllerGameGlobals.mouseYWorld-this.initDragY),null!=this.draggingPart&&this.curAction!=_.ControllerGameGlobals.RESIZING_TEXT){for(G=0;G<this.draggingParts.length;G++)this.draggingParts[G].Move(_.ControllerGameGlobals.mouseXWorldPhys-this.draggingParts[G].dragXOff,_.ControllerGameGlobals.mouseYWorldPhys-this.draggingParts[G].dragYOff);_.ControllerGameGlobals.curRobotID=""}if(this.curAction==_.ControllerGameGlobals.ROTATE&&null!=this.rotatingPart){var p=Math.atan2(_.ControllerGameGlobals.mouseYWorldPhys-this.rotatingPart.centerY,_.ControllerGameGlobals.mouseXWorldPhys-this.rotatingPart.centerX);for(G=0;G<this.rotatingParts.length;G++)this.rotatingParts[G].RotateAround(this.rotatingPart.centerX,this.rotatingPart.centerY,p-this.initRotatingAngle);_.ControllerGameGlobals.curRobotID=""}if(this.curAction==_.ControllerGameGlobals.SELECTING_SHAPE&&1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart&&this.selectedParts[0]!=this.m_conditionsDialog.shape1&&(this.m_conditionsDialog.visible=!0,this.m_fader.visible=!0,this.curAction=-1,this.m_sidePanel.visible=!1,this.shapeText.visible=!1,this.selectingCondition=!1,this.m_conditionsDialog.FinishSelectingForCondition(this.selectedParts[0])),this.curAction==_.ControllerGameGlobals.RESIZING_SHAPES){var y=_.ControllerGameGlobals.mouseXWorld-this.firstClickX;for(y>=0?(y/=75,y+=1):(y/=25,y=-1/(y-=1)),G=0;G<this.draggingParts.length;G++)if(this.draggingParts[G]instanceof nt.Circle)this.draggingParts[G].initRadius*y>nt.Circle.MAX_RADIUS&&(y=nt.Circle.MAX_RADIUS/this.draggingParts[G].initRadius),this.draggingParts[G].initRadius*y<nt.Circle.MIN_RADIUS&&(y=nt.Circle.MIN_RADIUS/this.draggingParts[G].initRadius);else if(this.draggingParts[G]instanceof rt.Rectangle)this.draggingParts[G].initW*y>rt.Rectangle.MAX_WIDTH&&(y=rt.Rectangle.MAX_WIDTH/this.draggingParts[G].initW),this.draggingParts[G].initW*y<rt.Rectangle.MIN_WIDTH&&(y=rt.Rectangle.MIN_WIDTH/this.draggingParts[G].initW),this.draggingParts[G].initH*y>rt.Rectangle.MAX_WIDTH&&(y=rt.Rectangle.MAX_WIDTH/this.draggingParts[G].initH),this.draggingParts[G].initH*y<rt.Rectangle.MIN_WIDTH&&(y=rt.Rectangle.MIN_WIDTH/this.draggingParts[G].initH);else if(this.draggingParts[G]instanceof b.Triangle){var w=i.Util.GetDist(this.draggingParts[G].initX1,this.draggingParts[G].initY1,this.draggingParts[G].initX2,this.draggingParts[G].initY2);w*y>b.Triangle.MAX_SIDE_LENGTH&&(y=b.Triangle.MAX_SIDE_LENGTH/w),w*y<b.Triangle.MIN_SIDE_LENGTH&&(y=b.Triangle.MIN_SIDE_LENGTH/w);var S=i.Util.GetDist(this.draggingParts[G].initX1,this.draggingParts[G].initY1,this.draggingParts[G].initX3,this.draggingParts[G].initY3);S*y>b.Triangle.MAX_SIDE_LENGTH&&(y=b.Triangle.MAX_SIDE_LENGTH/S),S*y<b.Triangle.MIN_SIDE_LENGTH&&(y=b.Triangle.MIN_SIDE_LENGTH/S);var A=i.Util.GetDist(this.draggingParts[G].initX2,this.draggingParts[G].initY2,this.draggingParts[G].initX3,this.draggingParts[G].initY3);A*y>b.Triangle.MAX_SIDE_LENGTH&&(y=b.Triangle.MAX_SIDE_LENGTH/A),A*y<b.Triangle.MIN_SIDE_LENGTH&&(y=b.Triangle.MIN_SIDE_LENGTH/A)}else this.draggingParts[G]instanceof o.Cannon&&(this.draggingParts[G].initW*y>o.Cannon.MAX_WIDTH&&(y=o.Cannon.MAX_WIDTH/this.draggingParts[G].initW),this.draggingParts[G].initW*y<o.Cannon.MIN_WIDTH&&(y=o.Cannon.MIN_WIDTH/this.draggingParts[G].initW));for(G=0;G<this.draggingParts.length;G++)this.draggingParts[G]instanceof nt.Circle?(this.draggingParts[G].radius=this.draggingParts[G].initRadius*y,this.draggingParts[G].Move(this.initDragX+this.draggingParts[G].dragXOff*y,this.initDragY+this.draggingParts[G].dragYOff*y)):this.draggingParts[G]instanceof rt.Rectangle?(this.draggingParts[G].w=this.draggingParts[G].initW*y,this.draggingParts[G].h=this.draggingParts[G].initH*y,this.draggingParts[G].Move(this.initDragX+this.draggingParts[G].dragXOff*y,this.initDragY+this.draggingParts[G].dragYOff*y)):this.draggingParts[G]instanceof b.Triangle?(this.draggingParts[G].centerX=this.initDragX+this.draggingParts[G].dragXOff*y,this.draggingParts[G].centerY=this.initDragY+this.draggingParts[G].dragYOff*y,this.draggingParts[G].x1=this.draggingParts[G].centerX+this.draggingParts[G].initX1*y,this.draggingParts[G].y1=this.draggingParts[G].centerY+this.draggingParts[G].initY1*y,this.draggingParts[G].x2=this.draggingParts[G].centerX+this.draggingParts[G].initX2*y,this.draggingParts[G].y2=this.draggingParts[G].centerY+this.draggingParts[G].initY2*y,this.draggingParts[G].x3=this.draggingParts[G].centerX+this.draggingParts[G].initX3*y,this.draggingParts[G].y3=this.draggingParts[G].centerY+this.draggingParts[G].initY3*y):this.draggingParts[G]instanceof o.Cannon?(this.draggingParts[G].w=this.draggingParts[G].initW*y,this.draggingParts[G].Move(this.initDragX+this.draggingParts[G].dragXOff*y,this.initDragY+this.draggingParts[G].dragYOff*y)):this.draggingParts[G]instanceof n.JointPart?(this.draggingParts[G].Move(this.initDragX+this.draggingParts[G].dragXOff*y,this.initDragY+this.draggingParts[G].dragYOff*y),this.draggingParts[G]instanceof h.PrismaticJoint&&(this.draggingParts[G].initLength=this.draggingParts[G].initInitLength*y)):this.draggingParts[G]instanceof m.TextPart?(this.draggingParts[G].w=this.draggingParts[G].initW*y,this.draggingParts[G].h=this.draggingParts[G].initH*y,this.draggingParts[G].x=this.initDragX+this.draggingParts[G].dragXOff*y-this.draggingParts[G].w/2,this.draggingParts[G].y=this.initDragY+this.draggingParts[G].dragYOff*y-this.draggingParts[G].h/2):this.draggingParts[G]instanceof g.Thrusters&&this.draggingParts[G].Move(this.initDragX+this.draggingParts[G].dragXOff*y,this.initDragY+this.draggingParts[G].dragYOff*y);this.mostRecentScaleFactor=y}if(this.curAction==_.ControllerGameGlobals.FINALIZING_JOINT&&i.Util.GetDist(this.candidateJointX,this.candidateJointY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys)>15/this.m_physScale)if(this.candidateJointType==_.ControllerGameGlobals.NEW_REVOLUTE_JOINT){var D=new d.RevoluteJoint(this.potentialJointPart1,this.potentialJointPart2,this.candidateJointX,this.candidateJointY);this.copiedJoint instanceof d.RevoluteJoint&&D.SetJointProperties(this.copiedJoint),this.allParts.push(D),this.AddAction(new J.CreateAction(D)),this.m_sidePanel.ShowJointPanel(D),this.selectedParts=new Array,this.selectedParts.push(D),this.curAction=-1,this.potentialJointPart1.highlightForJoint=!1,this.potentialJointPart2.highlightForJoint=!1,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayJointSound()}else if(this.candidateJointType==_.ControllerGameGlobals.NEW_FIXED_JOINT){var R=new r.FixedJoint(this.potentialJointPart1,this.potentialJointPart2,this.candidateJointX,this.candidateJointY);this.allParts.push(R),this.AddAction(new J.CreateAction(R)),this.m_sidePanel.ShowJointPanel(R),this.selectedParts=new Array,this.selectedParts.push(R),this.curAction=-1,this.potentialJointPart1.highlightForJoint=!1,this.potentialJointPart2.highlightForJoint=!1,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayJointSound()}else if(this.candidateJointType==_.ControllerGameGlobals.NEW_THRUSTERS){var T=new g.Thrusters(this.potentialJointPart1,this.candidateJointX,this.candidateJointY);this.copiedThrusters&&(T.strength=this.copiedThrusters.strength,T.angle=this.copiedThrusters.angle,T.thrustKey=this.copiedThrusters.thrustKey,T.autoOn=this.copiedThrusters.autoOn),this.allParts.push(T),this.AddAction(new J.CreateAction(T)),this.m_sidePanel.ShowThrustersPanel(T),this.selectedParts=new Array,this.selectedParts.push(T),this.curAction=-1,this.potentialJointPart1.highlightForJoint=!1,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayJointSound()}else if(this.candidateJointType==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT&&0==this.actionStep)this.jointPart=this.potentialJointPart1,this.firstClickX=this.candidateJointX,this.firstClickY=this.candidateJointY,this.curAction=_.ControllerGameGlobals.NEW_PRISMATIC_JOINT,this.actionStep++,this.PlayJointSound();else if(this.candidateJointType==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT){var v=new h.PrismaticJoint(this.jointPart,this.potentialJointPart1,this.firstClickX,this.firstClickY,this.candidateJointX,this.candidateJointY);this.copiedJoint instanceof h.PrismaticJoint&&v.SetJointProperties(this.copiedJoint),this.allParts.push(v),this.AddAction(new J.CreateAction(v)),this.m_sidePanel.ShowJointPanel(v),this.selectedParts=new Array,this.selectedParts.push(v),this.curAction=-1,this.jointPart.highlightForJoint=!1,this.potentialJointPart1.highlightForJoint=!1,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayJointSound()}this.curAction==_.ControllerGameGlobals.RESIZING_TEXT&&(this.draggingPart.Resize(_.ControllerGameGlobals.mouseXWorldPhys-this.initDragX,_.ControllerGameGlobals.mouseYWorldPhys-this.initDragY),this.redrawRobot=!0)}if(this.simStarted&&f.Input.mouseDown&&!this.m_guiMenu.MouseOverMenu(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)&&_.ControllerGameGlobals.mouseYWorld>=100&&(_.ControllerGameGlobals.mouseXWorld>=120||!this.m_sidePanel.visible)&&(_.ControllerGameGlobals.mouseXWorld>=230||_.ControllerGameGlobals.mouseYWorld>=340||!this.m_sidePanel.ColourWindowShowing())&&this.curAction!=_.ControllerGameGlobals.BOX_SELECTING&&!this.m_mouseJoint&&!(this.m_tutorialDialog&&this.m_tutorialDialog.MouseOver(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)||this.draggingTutorial)){var W=_.ControllerGameGlobals.mouseXWorld!=_.ControllerGameGlobals.prevMouseXWorld||_.ControllerGameGlobals.mouseYWorld!=_.ControllerGameGlobals.prevMouseYWorld;this.draw.m_drawXOff-=_.ControllerGameGlobals.mouseXWorld-_.ControllerGameGlobals.prevMouseXWorld,this.draw.m_drawYOff-=_.ControllerGameGlobals.mouseYWorld-_.ControllerGameGlobals.prevMouseYWorld,this.autoPanning=!1,W&&(this.hasPanned=!0,this.cameraMovements.push(new P.CameraMovement(this.frameCounter,this.draw.m_drawXOff,this.draw.m_drawYOff,this.m_physScale)))}var I=this.Screen2WorldY(85),O=this.Screen2WorldY(600);I<this.GetMinY()?this.draw.m_drawYOff+=this.World2ScreenY(this.GetMinY())-this.World2ScreenY(I):O>this.GetMaxY()&&(this.draw.m_drawYOff-=this.World2ScreenY(O)-this.World2ScreenY(this.GetMaxY()));var E=this.Screen2WorldX(0),M=this.Screen2WorldX(800);E<this.GetMinX()?(this.draw.m_drawXOff+=this.World2ScreenX(this.GetMinX())-this.World2ScreenX(E),this.hasPanned=!0):M>this.GetMaxX()&&(this.draw.m_drawXOff-=this.World2ScreenX(M)-this.World2ScreenX(this.GetMaxX()),this.hasPanned=!0),_.ControllerGameGlobals.wasMouseDown=f.Input.mouseDown}keyInput(t,e){for(var s=!1,i=0;i<this.allParts.length;i++)this.allParts[i].KeyInput(t,e,_.ControllerGameGlobals.playingReplay),!s&&e&&!_.ControllerGameGlobals.playingReplay&&(this.allParts[i]instanceof m.TextPart&&t==this.allParts[i].displayKey||this.allParts[i]instanceof o.Cannon&&t==this.allParts[i].fireKey)&&(s=!0,this.keyPresses.push(new W.KeyPress(this.frameCounter,t)))}keyPress(t,e){this.paused||_.ControllerGameGlobals.playingReplay||this.keyInput(t,e),this.simStarted||this.m_sidePanel.EnteringInput()||this.m_fader.visible||(e&&49==t?this.circleButton():e&&50==t?this.rectButton():e&&51==t?this.triangleButton():e&&52==t?this.fjButton():e&&53==t?this.rjButton():e&&54==t?this.pjButton():e&&55==t?this.textButton():e&&82==t?this.rotateButton():e&&88==t?this.cutButton():e&&67==t?this.copyButton():e&&86==t?this.pasteButton():!e||8!=t&&46!=t?e&&89==t?this.redoButton():e&&90==t?this.undoButton():!e||107!=t&&187!=t?!e||109!=t&&189!=t?e&&80==t&&this.playButton():this.zoomOutButton():this.zoomInButton():1==this.selectedParts.length&&!this.selectedParts[0]instanceof m.TextPart?this.deleteButton():this.multiDeleteButton()),e&&27==t&&(this.m_chooserWindow&&this.m_chooserWindow.visible&&!this.m_chooserWindow.fader.visible&&(this.m_chooserWindow.visible=!1,this.m_fader.visible=!1),this.m_challengeWindow&&this.m_challengeWindow.visible&&!this.m_challengeWindow.fader.visible&&(this.m_challengeWindow.visible=!1,this.m_fader.visible=!1),this.m_sidePanel.visible&&!this.m_fader.visible&&(this.m_sidePanel.visible=!1),this.m_scoreWindow&&this.m_scoreWindow.visible&&(this.m_scoreWindow.visible=!1,this.m_fader.visible=!1),this.m_progressDialog&&this.m_progressDialog.visible&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible?this.m_chooserWindow.HideFader():this.m_challengeWindow&&this.m_challengeWindow.visible?this.m_challengeWindow.HideFader():this.m_loginWindow&&this.m_loginWindow.visible?this.m_loginWindow.HideFader():this.m_newUserWindow&&this.m_newUserWindow.visible?this.m_newUserWindow.HideFader():this.m_fader.visible=!1),this.m_tutorialDialog&&this.m_tutorialDialog.visible&&this.m_tutorialDialog.closeWindow(new MouseEvent("")),this.m_linkDialog&&this.m_linkDialog.visible&&(this.m_linkDialog.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible?this.m_chooserWindow.HideFader():this.m_fader.visible=!1),this.m_loginWindow&&this.m_loginWindow.visible&&!this.m_loginWindow.fader.visible&&this.m_loginWindow.cancelButtonPressed(new MouseEvent("")),this.m_newUserWindow&&this.m_newUserWindow.visible&&this.m_newUserWindow.cancelButtonPressed(new MouseEvent("")))}mouseMove(t,e){}mouseClick(t){if(this.m_guiMenu.MouseClick(t,_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld),t&&this.delayedSelection&&(this.delayedSelection=!1,_.ControllerGameGlobals.mouseXWorldPhys==this.initDragX&&_.ControllerGameGlobals.mouseYWorldPhys==this.initDragY)){var e=this.GetPartAtMouse();i.Util.ObjectInArray(e,this.selectedParts)?f.Input.isKeyDown(16)&&(this.selectedParts=i.Util.RemoveFromArray(e,this.selectedParts)):(f.Input.isKeyDown(16)||(this.selectedParts=new Array),this.selectedParts.push(e)),this.redrawRobot=!0,this.RefreshSidePanel()}if(t&&null!=this.rotatingPart)this.curAction=-1,this.AddAction(new tt.RotateAction(this.rotatingPart,this.rotatingParts,i.Util.NormalizeAngle(Math.atan2(_.ControllerGameGlobals.mouseYWorldPhys-this.rotatingPart.centerY,_.ControllerGameGlobals.mouseXWorldPhys-this.rotatingPart.centerX)-this.initRotatingAngle))),this.CheckIfPartsFit(),this.rotatingPart=null;else if(t&&null!=this.draggingPart)if(this.ignoreAClick)this.ignoreAClick=!1;else{if(this.curAction==_.ControllerGameGlobals.PASTE||this.curAction==_.ControllerGameGlobals.RESIZING_TEXT||_.ControllerGameGlobals.mouseXWorldPhys==this.initDragX&&_.ControllerGameGlobals.mouseYWorldPhys==this.initDragY||this.AddAction(new U.MoveAction(this.draggingPart,this.draggingParts,_.ControllerGameGlobals.mouseXWorldPhys-this.initDragX,_.ControllerGameGlobals.mouseYWorldPhys-this.initDragY)),this.curAction==_.ControllerGameGlobals.RESIZING_TEXT){var s=this.draggingPart;this.AddAction(new $.ResizeTextAction(s,s.x-s.initX,s.y-s.initY,s.w-s.initW,s.h-s.initH))}if(this.CheckIfPartsFit(),this.curAction==_.ControllerGameGlobals.PASTE){for(var a=!1,l=0;l<this.draggingParts.length;l++)if(this.draggingParts[l]instanceof c.ShapePart){a=!0;break}a&&this.PlayShapeSound()}this.curAction<14&&(this.curAction=-1),this.draggingPart=null}else if(t||this.curAction!=_.ControllerGameGlobals.RESIZING_SHAPES)if(t||this.curAction!=_.ControllerGameGlobals.DRAWING_BUILD_BOX&&this.curAction!=_.ControllerGameGlobals.DRAWING_BOX&&this.curAction!=_.ControllerGameGlobals.DRAWING_HORIZONTAL_LINE&&this.curAction!=_.ControllerGameGlobals.DRAWING_VERTICAL_LINE||0!=this.actionStep||!(_.ControllerGameGlobals.mouseYWorld>100)||this.m_guiMenu.MouseOverMenu(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)||this.m_tutorialDialog&&this.m_tutorialDialog.MouseOver(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld))if(this.curAction!=_.ControllerGameGlobals.DRAWING_BOX&&this.curAction!=_.ControllerGameGlobals.DRAWING_HORIZONTAL_LINE&&this.curAction!=_.ControllerGameGlobals.DRAWING_VERTICAL_LINE||1!=this.actionStep){if(this.curAction==_.ControllerGameGlobals.DRAWING_BUILD_BOX&&1==this.actionStep&&(Math.abs(this.firstClickX-_.ControllerGameGlobals.mouseXWorldPhys)>.5||Math.abs(this.firstClickY-_.ControllerGameGlobals.mouseYWorldPhys)>.5)){this.curAction=-1;var r=new x.b2AABB;r.lowerBound=i.Util.Vector(Math.min(this.firstClickX,_.ControllerGameGlobals.mouseXWorldPhys),Math.min(this.firstClickY,_.ControllerGameGlobals.mouseYWorldPhys)),r.upperBound=i.Util.Vector(Math.max(this.firstClickX,_.ControllerGameGlobals.mouseXWorldPhys),Math.max(this.firstClickY,_.ControllerGameGlobals.mouseYWorldPhys)),ControllerChallenge.challenge.buildAreas.push(r),this.selectedBuildArea=ControllerChallenge.challenge.buildAreas[ControllerChallenge.challenge.buildAreas.length-1],this.m_sidePanel.ShowBuildBoxPanel(),this.BuildBuildArea(),this.redrawRobot=!0,this.redrawBuildArea=!0}}else(Math.abs(this.firstClickX-_.ControllerGameGlobals.mouseXWorldPhys)>.1||Math.abs(this.firstClickY-_.ControllerGameGlobals.mouseYWorldPhys)>.1)&&(this.curAction=-1,this.m_conditionsDialog.visible=!0,this.m_fader.visible=!0,this.selectingCondition=!1,this.m_conditionsDialog.FinishDrawingCondition(this.firstClickX,this.firstClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),this.boxText.visible=!1,this.horizLineText.visible=!1,this.vertLineText.visible=!1,this.redrawRobot=!0);else this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys,this.actionStep++;else this.ignoreAClick?this.ignoreAClick=!1:(this.curAction=-1,this.AddAction(new Q.ResizeShapesAction(this.draggingParts,this.mostRecentScaleFactor)),this.draggingParts=new Array,this.CheckIfPartsFit());if(!t&&!this.draggingTutorial&&this.m_tutorialDialog&&this.m_tutorialDialog.MouseOver(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld))return this.draggingTutorial=!0,this.initDragX=_.ControllerGameGlobals.mouseXWorld-this.m_tutorialDialog.x,void(this.initDragY=_.ControllerGameGlobals.mouseYWorld-this.m_tutorialDialog.y);if(!(!_.ControllerGameGlobals.curRobotEditable||_.ControllerGameGlobals.mouseYWorld<100||_.ControllerGameGlobals.mouseXWorld<120&&this.m_sidePanel.visible||this.m_guiMenu.MouseOverMenu(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld)||_.ControllerGameGlobals.mouseXWorld<230&&_.ControllerGameGlobals.mouseYWorld<340&&this.m_sidePanel.ColourWindowShowing()||this.m_tutorialDialog&&this.m_tutorialDialog.MouseOver(_.ControllerGameGlobals.mouseXWorld,_.ControllerGameGlobals.mouseYWorld))){if(t&&1==this.selectedParts.length&&_.ControllerGameGlobals.centerOnSelected)this.CenterOnSelected();else if(0==this.selectedParts.length&&-1==this.curAction&&"challenge"===this.controllerType&&!ControllerChallenge.playChallengeMode)for(l=0;l<ControllerChallenge.challenge.buildAreas.length;l++)if(_.ControllerGameGlobals.mouseXWorldPhys>ControllerChallenge.challenge.buildAreas[l].lowerBound.x&&_.ControllerGameGlobals.mouseXWorldPhys<ControllerChallenge.challenge.buildAreas[l].upperBound.x&&_.ControllerGameGlobals.mouseYWorldPhys>ControllerChallenge.challenge.buildAreas[l].lowerBound.y&&_.ControllerGameGlobals.mouseYWorldPhys<ControllerChallenge.challenge.buildAreas[l].upperBound.y){this.selectedBuildArea=ControllerChallenge.challenge.buildAreas[l],this.m_sidePanel.ShowBuildBoxPanel();break}if(this.curAction==_.ControllerGameGlobals.NEW_CIRCLE)if(t||0!=this.actionStep){if(t&&1==this.actionStep){var h=i.Util.GetDist(this.firstClickX,this.firstClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys);if(h>0){this.curAction=-1;var d=new nt.Circle(this.firstClickX,this.firstClickY,h);this.allParts.push(d),this.selectedParts=new Array,this.selectedParts.push(d),this.AddAction(new J.CreateAction(d)),this.CheckIfPartsFit(),this.m_sidePanel.ShowObjectPanel(d),_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayShapeSound()}}}else this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys,this.actionStep++;else if(this.curAction==_.ControllerGameGlobals.NEW_RECT)if(t||0!=this.actionStep){if(t&&1==this.actionStep&&(_.ControllerGameGlobals.mouseXWorldPhys!=this.firstClickX||_.ControllerGameGlobals.mouseYWorldPhys!=this.firstClickY)){this.curAction=-1;var P=new rt.Rectangle(this.firstClickX,this.firstClickY,_.ControllerGameGlobals.mouseXWorldPhys-this.firstClickX,_.ControllerGameGlobals.mouseYWorldPhys-this.firstClickY);this.allParts.push(P),this.selectedParts=new Array,this.selectedParts.push(P),this.AddAction(new J.CreateAction(P)),this.CheckIfPartsFit(),this.m_sidePanel.ShowObjectPanel(P),_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayShapeSound()}}else this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys,this.actionStep++;else if(this.curAction==_.ControllerGameGlobals.NEW_CANNON)if(t||0!=this.actionStep){if(t&&1==this.actionStep&&(_.ControllerGameGlobals.mouseXWorldPhys!=this.firstClickX||_.ControllerGameGlobals.mouseYWorldPhys!=this.firstClickY)){this.curAction=-1;var G=_.ControllerGameGlobals.mouseXWorldPhys>=this.firstClickX||_.ControllerGameGlobals.mouseYWorldPhys>=this.firstClickY?Math.max(_.ControllerGameGlobals.mouseXWorldPhys-this.firstClickX,2*(_.ControllerGameGlobals.mouseYWorldPhys-this.firstClickY)):Math.min(_.ControllerGameGlobals.mouseXWorldPhys-this.firstClickX,2*(_.ControllerGameGlobals.mouseYWorldPhys-this.firstClickY)),u=new o.Cannon(this.firstClickX,this.firstClickY,G);this.allParts.push(u),this.selectedParts=new Array,this.selectedParts.push(u),this.AddAction(new J.CreateAction(u)),this.CheckIfPartsFit(),this.m_sidePanel.ShowCannonPanel(u),_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayShapeSound()}}else this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys,this.actionStep++;else if(this.curAction==_.ControllerGameGlobals.NEW_TRIANGLE)if(t||0!=this.actionStep){if(t&&1==this.actionStep){if(_.ControllerGameGlobals.mouseXWorldPhys!=this.firstClickX||_.ControllerGameGlobals.mouseYWorldPhys!=this.firstClickY){var C,p=_.ControllerGameGlobals.mouseXWorldPhys,y=_.ControllerGameGlobals.mouseYWorldPhys,w=i.Util.GetDist(this.firstClickX,this.firstClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys);w<b.Triangle.MIN_SIDE_LENGTH?(C=Math.atan2(this.firstClickY-_.ControllerGameGlobals.mouseYWorldPhys,_.ControllerGameGlobals.mouseXWorldPhys-this.firstClickX),p=this.firstClickX+b.Triangle.MIN_SIDE_LENGTH*Math.cos(C),y=this.firstClickY-b.Triangle.MIN_SIDE_LENGTH*Math.sin(C)):w>b.Triangle.MAX_SIDE_LENGTH&&(C=Math.atan2(this.firstClickY-_.ControllerGameGlobals.mouseYWorldPhys,_.ControllerGameGlobals.mouseXWorldPhys-this.firstClickX),p=this.firstClickX+b.Triangle.MAX_SIDE_LENGTH*Math.cos(C),y=this.firstClickY-b.Triangle.MAX_SIDE_LENGTH*Math.sin(C)),this.secondClickX=p,this.secondClickY=y,this.actionStep++,this.PlayShapeSound()}}else if(t&&2==this.actionStep&&!(_.ControllerGameGlobals.mouseXWorldPhys==this.firstClickX&&_.ControllerGameGlobals.mouseYWorldPhys==this.firstClickY||_.ControllerGameGlobals.mouseXWorldPhys==this.secondClickX&&_.ControllerGameGlobals.mouseYWorldPhys==this.secondClickY)){var S=i.Util.GetDist(this.firstClickX,this.firstClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),A=i.Util.GetDist(this.secondClickX,this.secondClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),D=i.Util.GetDist(this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY),R=i.Util.NormalizeAngle(Math.acos((D*D+S*S-A*A)/(2*D*S))),T=i.Util.NormalizeAngle(Math.acos((D*D+A*A-S*S)/(2*D*A))),v=i.Util.NormalizeAngle(Math.acos((S*S+A*A-D*D)/(2*S*A)));if(S<=b.Triangle.MAX_SIDE_LENGTH&&S>=b.Triangle.MIN_SIDE_LENGTH&&A<=b.Triangle.MAX_SIDE_LENGTH&&A>=b.Triangle.MIN_SIDE_LENGTH&&R>=b.Triangle.MIN_TRIANGLE_ANGLE&&T>=b.Triangle.MIN_TRIANGLE_ANGLE&&v>=b.Triangle.MIN_TRIANGLE_ANGLE){this.curAction=-1;var W=new b.Triangle(this.firstClickX,this.firstClickY,this.secondClickX,this.secondClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys);this.allParts.push(W),this.selectedParts=new Array,this.selectedParts.push(W),this.AddAction(new J.CreateAction(W)),this.CheckIfPartsFit(),this.m_sidePanel.ShowObjectPanel(W),_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayShapeSound()}}}else this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys,this.actionStep++;else if(t&&0==this.actionStep&&this.curAction==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT)this.MaybeStartCreatingPrismaticJoint();else if(t&&1==this.actionStep&&this.curAction==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT)i.Util.GetDist(this.firstClickX,this.firstClickY,_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys)>.3&&this.MaybeFinishCreatingPrismaticJoint();else if(!t||0!=this.actionStep||this.curAction!=_.ControllerGameGlobals.NEW_REVOLUTE_JOINT&&this.curAction!=_.ControllerGameGlobals.NEW_FIXED_JOINT)if(t&&this.curAction==_.ControllerGameGlobals.BOX_SELECTING){for(this.selectedParts=new Array,l=0;l<this.allParts.length;l++)this.allParts[l].isEditable&&this.allParts[l].IntersectsBox(Math.min(this.firstClickX,_.ControllerGameGlobals.mouseXWorldPhys),Math.min(this.firstClickY,_.ControllerGameGlobals.mouseYWorldPhys),Math.abs(this.firstClickX-_.ControllerGameGlobals.mouseXWorldPhys),Math.abs(this.firstClickY-_.ControllerGameGlobals.mouseYWorldPhys))&&this.selectedParts.push(this.allParts[l]);0==this.selectedParts.length?this.m_sidePanel.visible=!1:1==this.selectedParts.length&&this.selectedParts[0]instanceof o.Cannon?this.m_sidePanel.ShowCannonPanel(this.selectedParts[0]):1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart?this.m_sidePanel.ShowObjectPanel(this.selectedParts[0]):1==this.selectedParts.length&&this.selectedParts[0]instanceof n.JointPart?this.m_sidePanel.ShowJointPanel(this.selectedParts[0]):1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart?this.m_sidePanel.ShowTextPanel(this.selectedParts[0]):1==this.selectedParts.length&&this.selectedParts[0]instanceof g.Thrusters?this.m_sidePanel.ShowThrustersPanel(this.selectedParts[0]):this.m_sidePanel.ShowMultiSelectPanel(this.selectedParts),this.curAction=-1,this.redrawRobot=!0}else if(t&&this.curAction==_.ControllerGameGlobals.FINALIZING_JOINT)if(this.candidateJointType==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT||this.candidateJointType==_.ControllerGameGlobals.NEW_THRUSTERS){this.potentialJointPart1.highlightForJoint=!1;var I=-1;for(l=0;l<this.candidateJointParts.length;l++)this.potentialJointPart1==this.candidateJointParts[l]&&(I=l);++I==this.candidateJointParts.length&&(I=0),this.potentialJointPart1=this.candidateJointParts[I],this.potentialJointPart1.highlightForJoint=!0}else{this.potentialJointPart1.highlightForJoint=!1,this.potentialJointPart2.highlightForJoint=!1;var O=-1,E=-1;for(l=0;l<this.candidateJointParts.length;l++)this.potentialJointPart1==this.candidateJointParts[l]&&(O=l),this.potentialJointPart2==this.candidateJointParts[l]&&(E=l);O==this.candidateJointParts.length-2&&E==this.candidateJointParts.length-1?(O=0,E=1):++E==this.candidateJointParts.length&&(E=++O+1),this.potentialJointPart1=this.candidateJointParts[O],this.potentialJointPart2=this.candidateJointParts[E],this.potentialJointPart1.highlightForJoint=!0,this.potentialJointPart2.highlightForJoint=!0}else if(t||this.curAction!=_.ControllerGameGlobals.NEW_TEXT||0!=this.actionStep)if(t&&this.curAction==_.ControllerGameGlobals.NEW_TEXT&&1==this.actionStep){var M=_.ControllerGameGlobals.mouseXWorldPhys,Y=_.ControllerGameGlobals.mouseYWorldPhys;if(Math.abs(M-this.firstClickX)<1||Math.abs(Y-this.firstClickY)<.5){var X=(this.firstClickX+M)/2,N=(this.firstClickY+Y)/2;this.firstClickX=X-2,this.firstClickY=N-1,M=X+2,Y=N+1}var B=new m.TextPart(this,Math.min(this.firstClickX,M),Math.min(this.firstClickY,Y),Math.max(this.firstClickX,M)-Math.min(this.firstClickX,M),Math.max(this.firstClickY,Y)-Math.min(this.firstClickY,Y),"New Text");this.selectedParts.push(B),this.allParts.push(B),this.AddAction(new J.CreateAction(B)),this.curAction=-1,_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.ShowTextPanel(B),this.redrawRobot=!0}else t&&this.curAction==_.ControllerGameGlobals.NEW_THRUSTERS?this.MaybeCreateThrusters():t&&this.curAction==_.ControllerGameGlobals.RESIZING_TEXT&&(this.curAction=-1);else this.firstClickX=_.ControllerGameGlobals.mouseXWorldPhys,this.firstClickY=_.ControllerGameGlobals.mouseYWorldPhys,this.actionStep++;else this.MaybeCreateJoint()}}RefreshSidePanel(){0==this.selectedParts.length||this.selectingCondition?this.m_sidePanel.visible=!1:1==this.selectedParts.length&&this.selectedParts[0]instanceof o.Cannon?(this.m_sidePanel.ShowCannonPanel(this.selectedParts[0]),this.lastSelectedShape=null):1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart?(this.m_sidePanel.ShowObjectPanel(this.selectedParts[0]),this.lastSelectedShape=null):1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart?(this.m_sidePanel.ShowTextPanel(this.selectedParts[0]),this.lastSelectedText=null):1==this.selectedParts.length&&this.selectedParts[0]instanceof n.JointPart?(this.m_sidePanel.ShowJointPanel(this.selectedParts[0]),this.lastSelectedJoint=null):1==this.selectedParts.length&&this.selectedParts[0]instanceof g.Thrusters?(this.m_sidePanel.ShowThrustersPanel(this.selectedParts[0]),this.lastSelectedThrusters=null):this.m_sidePanel.ShowMultiSelectPanel(this.selectedParts)}AddAction(t){for(;this.lastAction+1!=this.actions.length;)this.actions.pop();this.lastAction=this.actions.length,this.actions.push(t)}CenterOnSelected(){if(1==this.selectedParts.length){var t,e;this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof g.Thrusters?(t=this.selectedParts[0].centerX,e=this.selectedParts[0].centerY):this.selectedParts[0]instanceof n.JointPart?(t=this.selectedParts[0].anchorX,e=this.selectedParts[0].anchorY):this.selectedParts[0]instanceof m.TextPart&&(t=this.selectedParts[0].x+this.selectedParts[0].w/2,e=this.selectedParts[0].y+this.selectedParts[0].h/2);var s=this.draw.m_drawXOff,i=this.draw.m_drawYOff;this.draw.m_drawXOff+=this.World2ScreenX(t)-_.ControllerGameGlobals.ZOOM_FOCUS_X,this.draw.m_drawYOff+=this.World2ScreenY(e)-_.ControllerGameGlobals.ZOOM_FOCUS_Y,s==this.draw.m_drawXOff&&i==this.draw.m_drawYOff||(this.hasPanned=!0)}}circleButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_CIRCLE?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_CIRCLE,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1))}rectButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_RECT?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_RECT,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1))}triangleButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_TRIANGLE?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_TRIANGLE,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1))}fjButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_FIXED_JOINT?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_FIXED_JOINT,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1,this.potentialJointPart1=null,this.potentialJointPart2=null,this.copiedJoint=null))}rjButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_REVOLUTE_JOINT?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_REVOLUTE_JOINT,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1,this.potentialJointPart1=null,this.potentialJointPart2=null,this.copiedJoint=null))}pjButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_PRISMATIC_JOINT?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_PRISMATIC_JOINT,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1,this.potentialJointPart1=null,this.potentialJointPart2=null,this.copiedJoint=null))}textButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction==_.ControllerGameGlobals.NEW_TEXT?(this.curAction=-1,this.redrawRobot=!0):(this.curAction=_.ControllerGameGlobals.NEW_TEXT,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1))}thrustersButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction=_.ControllerGameGlobals.NEW_THRUSTERS,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1,this.copiedThrusters=null)}cannonButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.curAction=_.ControllerGameGlobals.NEW_CANNON,this.actionStep=0,this.selectedParts=new Array,this.m_sidePanel.visible=!1)}mochiAdStarted(){_.ControllerGameGlobals.adStarted=!0}mochiAdFinished(){_.ControllerGameGlobals.adStarted=!1,this.playButton(new MouseEvent(""),!1)}playButton(t=!0){if(!this.selectingCondition&&!_.ControllerGameGlobals.adStarted){this.CheckIfPartsFit();var e=this.TooManyShapes();if(this.partsFit&&!e||_.ControllerGameGlobals.playingReplay){if(this.m_guiPanel.ShowGamePanel(),this.m_sidePanel.visible=!1,this.selectedParts=new Array,this.curAction=-1,this.paused=!1,!this.simStarted){this.frameCounter=0,this.m_guiPanel.SetTimer(this.frameCounter),this.cameraMovements=new Array,this.cameraMovements.push(new P.CameraMovement(0,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,this.m_physScale)),this.keyPresses=new Array,this.syncPoints=new Array,_.ControllerGameGlobals.cannonballs=new Array,_.ControllerGameGlobals.playingReplay&&(_.ControllerGameGlobals.replay.syncPointIndex=0,_.ControllerGameGlobals.replay.cameraMovementIndex=0,_.ControllerGameGlobals.replay.keyPressIndex=0,_.ControllerGameGlobals.replay.syncPoints.length>0&&(this.replaySplineXs=this.ComputeReplaySplines(0),this.replaySplineYs=this.ComputeReplaySplines(1),this.replaySplineAngles=this.ComputeReplaySplines(2))),this.simStarted=!0,this.autoPanning=!0,this.canSaveReplay=!0;for(var s=0;s<this.allParts.length;s++)this.allParts[s].checkedCollisionGroup=!1;for(s=0;s<this.allParts.length;s++)this.allParts[s]instanceof c.ShapePart&&this.allParts[s].SetCollisionGroup(-(s+1));for(this.CreateWorld(),s=this.allParts.length;s>=0;s--)(this.allParts[s]instanceof c.ShapePart||this.allParts[s]instanceof m.TextPart)&&this.allParts[s].Init(this.m_world);for(_.ControllerGameGlobals.collisionGroup=1,s=0;s<this.allParts.length;s++)this.allParts[s]instanceof h.PrismaticJoint&&(_.ControllerGameGlobals.collisionGroup*=2),(this.allParts[s]instanceof n.JointPart||this.allParts[s]instanceof g.Thrusters)&&this.allParts[s].Init(this.m_world);for(this.cameraPart=null,s=0;s<this.allParts.length;s++)this.allParts[s]instanceof c.ShapePart&&this.allParts[s].isCameraFocus&&this.allParts[s].isEnabled&&(this.cameraPart=this.allParts[s]);this.cameraPart||(this.cameraPart=this.FindCenterOfRobot()),this.savedDrawXOff=this.Screen2WorldX(_.ControllerGameGlobals.ZOOM_FOCUS_X),this.savedDrawYOff=this.Screen2WorldY(_.ControllerGameGlobals.ZOOM_FOCUS_Y)}}else this.m_fader.visible=!0,this.partsFit?e&&this.ShowDialog3("Your robot contains too many shapes!  (Limit 500)"):this.ShowDialog3("You must fit your robot inside the starting box first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()}}editButton(t=!1){}pauseButton(){_.ControllerGameGlobals.playingReplay&&_.ControllerGameGlobals.replay.Update(this.frameCounter)&&this.ShowPostReplayWindow(),this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0}resetButton(t=!0){if(_.ControllerGameGlobals.playingReplay){for(var e=0;e<this.allParts.length;e++)this.allParts[e].UnInit(this.m_world);this.simStarted=!1,this.playButton(!1)}else{for(this.m_guiPanel.ShowEditPanel(),this.paused=!0,this.simStarted=!1,_.ControllerGameGlobals.playingReplay=!1,e=0;e<this.allParts.length;e++)this.allParts[e].UnInit(this.m_world);this.draw.m_drawXOff=this.savedDrawXOff*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_X,this.draw.m_drawYOff=this.savedDrawYOff*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_Y,this.hasPanned=!0,t&&(""==_.ControllerGameGlobals.curChallengeID||!_.ControllerGameGlobals.curChallengePublic||_.ControllerGameGlobals.ratedCurChallenge||D.LSOManager.HasRatedChallenge(_.ControllerGameGlobals.curChallengeID)?""==_.ControllerGameGlobals.curRobotID||!_.ControllerGameGlobals.curRobotPublic||_.ControllerGameGlobals.ratedCurRobot||D.LSOManager.HasRatedRobot(_.ControllerGameGlobals.curRobotID)||(_.ControllerGameGlobals.ratedCurRobot=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,0,0,!0),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.paused=!0):(_.ControllerGameGlobals.ratedCurChallenge=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,2,0,!0),this.addChild(this.m_rateDialog),this.m_fader.visible=!0))}this.wonChallenge=!1,this.redrawBuildArea=!0}rewindButton(t=!0){if(_.ControllerGameGlobals.playingReplay)if(_.ControllerGameGlobals.viewingUnsavedReplay){this.paused=!0,this.simStarted=!1,_.ControllerGameGlobals.playingReplay=!1,this.wonChallenge=!1,_.ControllerGameGlobals.viewingUnsavedReplay=!1,this.m_guiPanel.ShowEditPanel(!0);for(var e=0;e<this.allParts.length;e++)this.allParts[e].UnInit(this.m_world);this.draw.m_drawXOff=this.savedDrawXOff*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_X,this.draw.m_drawYOff=this.savedDrawYOff*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_Y,this.hasPanned=!0,this.redrawBuildArea=!0}else t&&""!=_.ControllerGameGlobals.curReplayID&&!_.ControllerGameGlobals.ratedCurReplay&&_.ControllerGameGlobals.curReplayPublic&&!D.LSOManager.HasRatedReplay(_.ControllerGameGlobals.curReplayID)?(_.ControllerGameGlobals.ratedCurReplay=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,1,5),this.addChild(this.m_rateDialog),this.m_fader.visible=!0):(a.Main.changeControllers=!0,_.ControllerGameGlobals.playingReplay=!1,_.ControllerGameGlobals.showTutorial=!1,_.ControllerGameGlobals.replayParts=new Array,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.curRobotEditable=!0,_.ControllerGameGlobals.curReplayID="");else this.resetButton(!1),this.playButton()}reportButton(){this.selectingCondition||(_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic?"_Public"==_.ControllerGameGlobals.userName?(this.clickedReport=!0,this.loginButton(!0,!1)):(this.m_reportWindow&&this.removeChild(this.m_reportWindow),this.m_reportWindow=new ReportWindow(this,1,_.ControllerGameGlobals.curReplayID),this.addChild(this.m_reportWindow),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):""!=_.ControllerGameGlobals.curChallengeID&&_.ControllerGameGlobals.curChallengePublic?"_Public"==_.ControllerGameGlobals.userName?(this.clickedReport=!0,this.loginButton(e,!0,!1)):(this.m_reportWindow&&this.removeChild(this.m_reportWindow),this.m_reportWindow=new ReportWindow(this,2,_.ControllerGameGlobals.curChallengeID),this.addChild(this.m_reportWindow),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):""!=_.ControllerGameGlobals.curRobotID&&_.ControllerGameGlobals.curRobotPublic?"_Public"==_.ControllerGameGlobals.userName?(this.clickedReport=!0,this.loginButton(!0,!1)):(this.m_reportWindow&&this.removeChild(this.m_reportWindow),this.m_reportWindow=new ReportWindow(this,0,_.ControllerGameGlobals.curRobotID),this.addChild(this.m_reportWindow),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):(this.m_fader.visible=!0,this.ShowDialog3("You can only report publicly saved robots."),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}finishReporting(){-1!=s.Database.FinishReporting(e)&&(this.ShowDialog3("Thank you, the moderators have been notified."),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),a.Main.ShowMouse())}featureButton(){this.selectingCondition||(_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic?(s.Database.FeatureReplay(_.ControllerGameGlobals.curReplayID,!_.ControllerGameGlobals.curReplayFeatured,this.finishFeaturing),this.m_fader.visible=!0,this.ShowDialog("Featuring..."),a.Main.ShowHourglass()):""!=_.ControllerGameGlobals.curChallengeID&&_.ControllerGameGlobals.curChallengePublic?(s.Database.FeatureChallenge(_.ControllerGameGlobals.curChallengeID,!_.ControllerGameGlobals.curChallengeFeatured,this.finishFeaturing),this.m_fader.visible=!0,this.ShowDialog("Featuring..."),a.Main.ShowHourglass()):""!=_.ControllerGameGlobals.curRobotID&&_.ControllerGameGlobals.curRobotPublic?(s.Database.FeatureRobot(_.ControllerGameGlobals.curRobotID,!_.ControllerGameGlobals.curRobotFeatured,this.finishFeaturing),this.m_fader.visible=!0,this.ShowDialog("Featuring..."),a.Main.ShowHourglass()):(this.m_fader.visible=!0,this.ShowDialog3("You can only feature publicly saved robots."),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}finishFeaturing(){s.Database.FinishFeaturing(e)&&(this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_fader.visible=!1,a.Main.ShowMouse(),_.ControllerGameGlobals.playingReplay?_.ControllerGameGlobals.curReplayFeatured=!_.ControllerGameGlobals.curReplayFeatured:""!=_.ControllerGameGlobals.curChallengeID?_.ControllerGameGlobals.curChallengeFeatured=!_.ControllerGameGlobals.curChallengeFeatured:_.ControllerGameGlobals.curRobotFeatured=!_.ControllerGameGlobals.curRobotFeatured)}rateButton(){this.selectingCondition||(""!=_.ControllerGameGlobals.curRobotID&&_.ControllerGameGlobals.curRobotPublic&&!D.LSOManager.HasRatedRobot(_.ControllerGameGlobals.curRobotID)?(this.m_fader.visible=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,0),this.addChild(this.m_rateDialog)):""!=_.ControllerGameGlobals.curRobotID&&_.ControllerGameGlobals.curRobotPublic?(this.m_fader.visible=!0,this.ShowDialog3("You've already rated this robot!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}rateWindowClosed(t,e){this.m_rateDialog.visible=!1,_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic?s.Database.RateReplay(_.ControllerGameGlobals.curReplayID,t,this.finishRatingReplay):""!=_.ControllerGameGlobals.curChallengeID&&_.ControllerGameGlobals.curChallengePublic?s.Database.RateChallenge(_.ControllerGameGlobals.curChallengeID,t,this.finishRatingChallenge):s.Database.RateRobot(_.ControllerGameGlobals.curRobotID,t,this.finishRatingRobot),this.redirectAfterRating=e,this.m_fader.visible=!0,this.ShowDialog("Rating..."),a.Main.ShowHourglass(),this.curAction=-1}conditionsButton(){this.curAction=-1,this.boxText.visible=!1,this.horizLineText.visible=!1,this.vertLineText.visible=!1,this.shapeText.visible=!1,this.m_sidePanel.visible=!1,this.m_conditionsDialog&&this.removeChild(this.m_conditionsDialog),this.m_conditionsDialog=new ConditionsWindow(this),this.addChild(this.m_conditionsDialog),this.m_fader.visible=!0}restrictionsButton(){this.selectingCondition||(this.m_sidePanel.visible=!1,this.m_restrictionsDialog&&this.removeChild(this.m_restrictionsDialog),this.m_restrictionsDialog=new RestrictionsWindow(this),this.addChild(this.m_restrictionsDialog),this.m_fader.visible=!0,this.saveAfterRestrictions=!1)}buildBoxButton(){this.selectingCondition||(this.curAction=_.ControllerGameGlobals.DRAWING_BUILD_BOX,this.actionStep=0)}sandboxSettingsButton(){_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&(this.simStarted||("sandbox"!==this.controllerType||"challenge"===this.controllerType&&ControllerChallenge.playOnlyMode?(this.m_fader.visible=!0,this.ShowDialog3("That feature instanceof only available in Sandbox mode!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):(this.m_sandboxWindow=new R.AdvancedSandboxWindow(this,v.ControllerSandbox.settings),this.m_fader.visible=!0,this.addChild(this.m_sandboxWindow))))}commentButton(t="",e=!1){this.selectingCondition||(""==t&&(t=_.ControllerGameGlobals.curRobotID,e=_.ControllerGameGlobals.curRobotPublic),""!=t&&e?(s.Database.CommentOnRobot(t,this.finishCommenting),this.m_fader.visible=!0,this.ShowDialog("Connecting to forum..."),a.Main.ShowHourglass(),this.curAction=-1):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}finishCommenting(){if(s.Database.waitingForResponse&&(s.Database.curTransactionType==s.Database.ACTION_COMMENT_ROBOT||s.Database.curTransactionType==s.Database.ACTION_COMMENT_REPLAY)){var t=s.Database.FinishCommenting();-1!=t&&(this.m_chooserWindow&&this.m_chooserWindow.visible?this.m_chooserWindow.HideFader():this.m_fader.visible=!1,this.m_progressDialog.visible=!1,a.Main.BrowserRedirect("http://www.incredibots.com/forums/posting.php?mode=reply&t="+t+("_Public"==_.ControllerGameGlobals.userName?"":"&sid="+_.ControllerGameGlobals.sessionID),!0),a.Main.ShowMouse())}}finishRatingRobot(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_RATE_ROBOT&&(s.Database.FinishRating()&&(D.LSOManager.SetRobotRated(_.ControllerGameGlobals.curRobotID),this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_postReplayWindow&&this.m_postReplayWindow.visible?this.m_postReplayWindow.HideFader():this.m_fader.visible=!1,this.m_rateDialog.visible=!1,a.Main.ShowMouse()),1==this.redirectAfterRating?this.loadButton():2==this.redirectAfterRating?this.loadRobotButton():3==this.redirectAfterRating?this.loadReplayButton():4==this.redirectAfterRating?this.loadChallengeButton():5==this.redirectAfterRating&&this.rewindButton(),this.redirectAfterRating=0)}finishRatingReplay(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_RATE_REPLAY&&(s.Database.FinishRating(e)&&(D.LSOManager.SetReplayRated(_.ControllerGameGlobals.curReplayID),this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_postReplayWindow&&this.m_postReplayWindow.visible?this.m_postReplayWindow.HideFader():this.m_fader.visible=!1,this.m_rateDialog.visible=!1,a.Main.ShowMouse()),1==this.redirectAfterRating?this.loadButton():2==this.redirectAfterRating?this.loadRobotButton():3==this.redirectAfterRating?this.loadReplayButton():4==this.redirectAfterRating?this.loadChallengeButton():5==this.redirectAfterRating&&this.rewindButton(),this.redirectAfterRating=0)}finishRatingChallenge(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_RATE_CHALLENGE&&(s.Database.FinishRating()&&(D.LSOManager.SetChallengeRated(_.ControllerGameGlobals.curChallengeID),this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_postReplayWindow&&this.m_postReplayWindow.visible?this.m_postReplayWindow.HideFader():this.m_fader.visible=!1,this.m_rateDialog.visible=!1,a.Main.ShowMouse()),1==this.redirectAfterRating?this.loadButton():2==this.redirectAfterRating?this.loadRobotButton():3==this.redirectAfterRating?this.loadReplayButton():4==this.redirectAfterRating?this.loadChallengeButton():5==this.redirectAfterRating&&this.rewindButton(),this.redirectAfterRating=0)}embedButton(t="",e=!1){this.selectingCondition||(""==t&&(t=_.ControllerGameGlobals.curRobotID,e=_.ControllerGameGlobals.curRobotPublic),""!=t&&e?(this.m_fader.visible=!0,this.ShowLinkDialog("Copy the HTML below into your\n  website to embed this robot.",null,!1,t)):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}linkButton(t="",e=!1){this.selectingCondition||(""==t&&(t=_.ControllerGameGlobals.curRobotID,e=_.ControllerGameGlobals.curRobotPublic),""!=t&&e?(this.m_fader.visible=!0,this.ShowLinkDialog("     Use the link below to\n        link to this robot.","http://incredibots2.com/?robotID="+t)):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}rateReplayButton(){this.selectingCondition||(""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic&&!D.LSOManager.HasRatedReplay(_.ControllerGameGlobals.curReplayID)?(this.m_fader.visible=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,1),this.addChild(this.m_rateDialog)):""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic?(this.m_fader.visible=!0,this.ShowDialog3("You've already rated this replay!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}commentReplayButton(t="",e=!1){""==t&&(t=_.ControllerGameGlobals.curReplayID,e=_.ControllerGameGlobals.curReplayPublic),""!=t&&e?(s.Database.CommentOnReplay(t,this.finishCommenting),this.m_fader.visible=!0,this.ShowDialog("Connecting to forum..."),a.Main.ShowHourglass(),this.curAction=-1):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}embedReplayButton(t="",e=!1){""==t&&(t=_.ControllerGameGlobals.curReplayID,e=_.ControllerGameGlobals.curReplayPublic),""!=t&&e?(this.m_fader.visible=!0,this.ShowLinkDialog("Copy the HTML below into your\n  website to embed this replay.",null,!0,t)):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}linkReplayButton(t="",e=!1){""==t&&(t=_.ControllerGameGlobals.curReplayID,e=_.ControllerGameGlobals.curReplayPublic),""!=t&&e?(this.m_fader.visible=!0,this.ShowLinkDialog("     Use the link below to\n       link to this replay.","http://incredibots2.com/?replayID="+t)):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}rateChallengeButton(){this.selectingCondition||(""!=_.ControllerGameGlobals.curChallengeID&&_.ControllerGameGlobals.curChallengePublic&&!D.LSOManager.HasRatedChallenge(_.ControllerGameGlobals.curChallengeID)?(this.m_fader.visible=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,2),this.addChild(this.m_rateDialog)):""!=_.ControllerGameGlobals.curChallengeID&&_.ControllerGameGlobals.curChallengePublic?(this.m_fader.visible=!0,this.ShowDialog3("You've already rated this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}commentChallengeButton(t="",e=!1){this.selectingCondition||(""==t&&(t=_.ControllerGameGlobals.curChallengeID,e=_.ControllerGameGlobals.curChallengePublic),""!=t&&e?(s.Database.CommentOnChallenge(t,this.finishCommenting),this.m_fader.visible=!0,this.ShowDialog("Connecting to forum..."),a.Main.ShowHourglass(),this.curAction=-1):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}embedChallengeButton(t="",e=!1){this.selectingCondition||(""==t&&(t=_.ControllerGameGlobals.curChallengeID,e=_.ControllerGameGlobals.curChallengePublic),""!=t&&e?(this.m_fader.visible=!0,this.ShowLinkDialog("Copy the HTML below into your\n  website to embed this challenge.",null,!1,t,!0)):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}linkChallengeButton(t="",e=!1){this.selectingCondition||(""==t&&(t=_.ControllerGameGlobals.curChallengeID,e=_.ControllerGameGlobals.curChallengePublic),""!=t&&e?(this.m_fader.visible=!0,this.ShowLinkDialog("     Use the link below to\n       link to this challenge.","http://incredibots2.com/?challengeID="+t)):(this.m_fader.visible=!0,this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}tutorialButton(){this.m_tutorialDialog&&(this.m_tutorialDialog.visible=!0,this.m_tutorialDialog.ResetPosition())}rotateButton(){if(_.ControllerGameGlobals.curRobotEditable){for(var t=this.selectedParts.length-1;t>=0;t--)this.selectedParts[t]instanceof m.TextPart&&(this.selectedParts=i.Util.RemoveFromArray(this.selectedParts[t],this.selectedParts));if(0!=this.selectedParts.length){for(this.curAction=_.ControllerGameGlobals.ROTATE,this.rotatingPart=null,t=0;t<this.selectedParts.length;t++)(this.selectedParts[t]instanceof c.ShapePart&&(!this.rotatingPart||this.rotatingPart instanceof g.Thrusters||this.selectedParts[t].GetMass()>this.rotatingPart.GetMass())||this.selectedParts[t]instanceof g.Thrusters&&!this.rotatingPart)&&(this.rotatingPart=this.selectedParts[t]);if(null!=this.rotatingPart){if(this.rotatingParts=new Array,1==this.selectedParts.length&&this.rotatingPart instanceof g.Thrusters)this.rotatingParts.push(this.rotatingPart);else{for(t=0;t<this.selectedParts.length;t++)this.rotatingParts=this.rotatingParts.concat(this.selectedParts[t].GetAttachedParts());this.rotatingParts=i.Util.RemoveDuplicates(this.rotatingParts)}for(t=0;t<this.rotatingParts.length;t++)this.rotatingParts[t]instanceof c.ShapePart||this.rotatingParts[t]instanceof g.Thrusters?(this.rotatingParts[t].rotateAngle=Math.atan2(this.rotatingParts[t].centerY-this.rotatingPart.centerY,this.rotatingParts[t].centerX-this.rotatingPart.centerX),this.rotatingParts[t].rotateOrientation=this.rotatingParts[t].angle):(this.rotatingParts[t].rotateAngle=Math.atan2(this.rotatingParts[t].anchorY-this.rotatingPart.centerY,this.rotatingParts[t].anchorX-this.rotatingPart.centerX),this.rotatingParts[t]instanceof h.PrismaticJoint&&(this.rotatingParts[t].rotateOrientation=i.Util.GetAngle(this.rotatingParts[t].axis)));this.initRotatingAngle=Math.atan2(_.ControllerGameGlobals.mouseYWorldPhys-this.rotatingPart.centerY,_.ControllerGameGlobals.mouseXWorldPhys-this.rotatingPart.centerX)}}}}mirrorHorizontal(){if(_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&!this.simStarted&&0!=this.selectedParts.length){for(var t=new Array,e=this.selectedParts[0]instanceof n.JointPart?this.selectedParts[0].anchorX:this.selectedParts[0]instanceof m.TextPart?this.selectedParts[0].x+this.selectedParts[0].w/2:this.selectedParts[0].centerX,s=this.selectedParts[0]instanceof n.JointPart?this.selectedParts[0].anchorY:this.selectedParts[0]instanceof m.TextPart?this.selectedParts[0].y+this.selectedParts[0].h/2:this.selectedParts[0].centerY,a=new Array,l=0;l<this.selectedParts.length;l++)if(this.selectedParts[l]instanceof nt.Circle){var c=new nt.Circle(e-(this.selectedParts[l].centerX-e),this.selectedParts[l].centerY,this.selectedParts[l].radius);c.angle=Math.PI-this.selectedParts[l].angle,c.isStatic=this.selectedParts[l].isStatic,c.density=this.selectedParts[l].density,c.collide=this.selectedParts[l].collide,c.red=this.selectedParts[l].red,c.green=this.selectedParts[l].green,c.blue=this.selectedParts[l].blue,c.opacity=this.selectedParts[l].opacity,c.outline=this.selectedParts[l].outline,c.terrain=this.selectedParts[l].terrain,c.undragable=this.selectedParts[l].undragable,t.push(c),a.push(c)}else if(this.selectedParts[l]instanceof rt.Rectangle){var P=new rt.Rectangle(e-(this.selectedParts[l].x-e),this.selectedParts[l].y,-this.selectedParts[l].w,this.selectedParts[l].h);P.angle=Math.PI-this.selectedParts[l].angle,P.isStatic=this.selectedParts[l].isStatic,P.density=this.selectedParts[l].density,P.collide=this.selectedParts[l].collide,P.red=this.selectedParts[l].red,P.green=this.selectedParts[l].green,P.blue=this.selectedParts[l].blue,P.opacity=this.selectedParts[l].opacity,P.outline=this.selectedParts[l].outline,P.terrain=this.selectedParts[l].terrain,P.undragable=this.selectedParts[l].undragable,t.push(P),a.push(P)}else if(this.selectedParts[l]instanceof b.Triangle){var G=this.selectedParts[l].GetVertices(),u=new b.Triangle(e-(G[0].x-e),G[0].y,e-(G[1].x-e),G[1].y,e-(G[2].x-e),G[2].y);u.isStatic=this.selectedParts[l].isStatic,u.density=this.selectedParts[l].density,u.collide=this.selectedParts[l].collide,u.red=this.selectedParts[l].red,u.green=this.selectedParts[l].green,u.blue=this.selectedParts[l].blue,u.opacity=this.selectedParts[l].opacity,u.outline=this.selectedParts[l].outline,u.terrain=this.selectedParts[l].terrain,u.undragable=this.selectedParts[l].undragable,t.push(u),a.push(u)}else if(this.selectedParts[l]instanceof o.Cannon){var C=new o.Cannon(e-(this.selectedParts[l].x-e)-this.selectedParts[l].w,this.selectedParts[l].y,this.selectedParts[l].w);C.angle=Math.PI-this.selectedParts[l].angle,C.isStatic=this.selectedParts[l].isStatic,C.density=this.selectedParts[l].density,C.collide=this.selectedParts[l].collide,C.red=this.selectedParts[l].red,C.green=this.selectedParts[l].green,C.blue=this.selectedParts[l].blue,C.opacity=this.selectedParts[l].opacity,C.outline=this.selectedParts[l].outline,C.terrain=this.selectedParts[l].terrain,C.undragable=this.selectedParts[l].undragable,C.fireKey=this.selectedParts[l].fireKey,C.strength=this.selectedParts[l].strength,t.push(C),a.push(C)}else if(this.selectedParts[l]instanceof m.TextPart){var p=new m.TextPart(this,e-(this.selectedParts[l].x+this.selectedParts[l].w/2-e),this.selectedParts[l].y,this.selectedParts[l].w,this.selectedParts[l].h,this.selectedParts[l].text,this.selectedParts[l].inFront);p.red=this.selectedParts[l].red,p.green=this.selectedParts[l].green,p.blue=this.selectedParts[l].blue,p.size=this.selectedParts[l].size,p.alwaysVisible=this.selectedParts[l].alwaysVisible,p.inFront=this.selectedParts[l].inFront,p.scaleWithZoom=this.selectedParts[l].scaleWithZoom,p.displayKey=this.selectedParts[l].displayKey,t.push(p),a.push(-1)}else(this.selectedParts[l]instanceof n.JointPart||this.selectedParts[l]instanceof g.Thrusters)&&a.push(-1);for(l=0;l<this.selectedParts.length;l++){var f=-1,y=-1;if(this.selectedParts[l]instanceof n.JointPart){for(var w=0;w<this.selectedParts.length;w++)this.selectedParts[w]==this.selectedParts[l].part1&&(f=w),this.selectedParts[w]==this.selectedParts[l].part2&&(y=w);if(-1==f||-1==y)continue}else if(this.selectedParts[l]instanceof g.Thrusters){for(w=0;w<this.selectedParts.length;w++)this.selectedParts[w]==this.selectedParts[l].shape&&(f=w);if(-1==f)continue}if(this.selectedParts[l]instanceof r.FixedJoint){var S=new r.FixedJoint(a[f],a[y],e-(this.selectedParts[l].anchorX-e),this.selectedParts[l].anchorY);t.push(S)}else if(this.selectedParts[l]instanceof d.RevoluteJoint){var A=new d.RevoluteJoint(a[f],a[y],e-(this.selectedParts[l].anchorX-e),this.selectedParts[l].anchorY);A.enableMotor=this.selectedParts[l].enableMotor,A.motorCWKey=this.selectedParts[l].motorCCWKey,A.motorCCWKey=this.selectedParts[l].motorCWKey,A.motorStrength=this.selectedParts[l].motorStrength,A.motorSpeed=this.selectedParts[l].motorSpeed,A.motorLowerLimit=-this.selectedParts[l].motorUpperLimit,A.motorUpperLimit=-this.selectedParts[l].motorLowerLimit,A.isStiff=this.selectedParts[l].isStiff,A.autoCW=this.selectedParts[l].autoCCW,A.autoCCW=this.selectedParts[l].autoCW,t.push(A)}else if(this.selectedParts[l]instanceof h.PrismaticJoint){var D=new h.PrismaticJoint(a[f],a[y],0,0,1,1);D.anchorX=e-(this.selectedParts[l].anchorX-e),D.anchorY=this.selectedParts[l].anchorY;var R=Math.atan2(this.selectedParts[l].axis.y,this.selectedParts[l].axis.x);R=i.Util.NormalizeAngle(Math.PI-R),D.axis=new x.b2Vec2(Math.cos(R),Math.sin(R)),D.axis.Normalize(),D.initLength=this.selectedParts[l].initLength,D.enablePiston=this.selectedParts[l].enablePiston,D.pistonUpKey=this.selectedParts[l].pistonUpKey,D.pistonDownKey=this.selectedParts[l].pistonDownKey,D.pistonStrength=this.selectedParts[l].pistonStrength,D.pistonSpeed=this.selectedParts[l].pistonSpeed,D.isStiff=this.selectedParts[l].isStiff,D.autoOscillate=this.selectedParts[l].autoOscillate,D.red=this.selectedParts[l].red,D.green=this.selectedParts[l].green,D.blue=this.selectedParts[l].blue,D.opacity=this.selectedParts[l].opacity,D.outline=this.selectedParts[l].outline,D.collide=this.selectedParts[l].collide,t.push(D)}else if(this.selectedParts[l]instanceof g.Thrusters){var T=new g.Thrusters(a[f],e-(this.selectedParts[l].centerX-e),this.selectedParts[l].centerY);T.angle=Math.PI-this.selectedParts[l].angle,T.strength=this.selectedParts[l].strength,T.thrustKey=this.selectedParts[l].thrustKey,T.autoOn=this.selectedParts[l].autoOn,t.push(T)}}if(t.length>0){for(this.selectedParts=new Array,this.draggingParts=new Array,l=0;l<t.length;l++)t[l].dragXOff=e-(t[l]instanceof n.JointPart?t[l].anchorX:t[l]instanceof m.TextPart?t[l].x-t[l].w/2:t[l].centerX),t[l].dragYOff=s-(t[l]instanceof n.JointPart?t[l].anchorY:t[l]instanceof m.TextPart?t[l].y-t[l].h/2:t[l].centerY),this.selectedParts.push(t[l]),this.draggingParts.push(t[l]),this.allParts.push(t[l]);this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingPart=this.selectedParts[0],this.draggingPart.Move(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),this.RefreshSidePanel(),this.AddAction(new k.MassCreateAction(this.selectedParts)),this.curAction=_.ControllerGameGlobals.PASTE,_.ControllerGameGlobals.curRobotID=""}}}mirrorVertical(){if(_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&!this.simStarted&&0!=this.selectedParts.length){for(var t=new Array,e=this.selectedParts[0]instanceof n.JointPart?this.selectedParts[0].anchorX:this.selectedParts[0]instanceof m.TextPart?this.selectedParts[0].x+this.selectedParts[0].w/2:this.selectedParts[0].centerX,s=this.selectedParts[0]instanceof n.JointPart?this.selectedParts[0].anchorY:this.selectedParts[0]instanceof m.TextPart?this.selectedParts[0].y+this.selectedParts[0].h/2:this.selectedParts[0].centerY,a=new Array,l=0;l<this.selectedParts.length;l++)if(this.selectedParts[l]instanceof nt.Circle){var c=new nt.Circle(this.selectedParts[l].centerX,s-(this.selectedParts[l].centerY-s),this.selectedParts[l].radius);c.angle=2*Math.PI-this.selectedParts[l].angle,c.isStatic=this.selectedParts[l].isStatic,c.density=this.selectedParts[l].density,c.collide=this.selectedParts[l].collide,c.red=this.selectedParts[l].red,c.green=this.selectedParts[l].green,c.blue=this.selectedParts[l].blue,c.opacity=this.selectedParts[l].opacity,c.outline=this.selectedParts[l].outline,c.terrain=this.selectedParts[l].terrain,c.undragable=this.selectedParts[l].undragable,t.push(c),a.push(c)}else if(this.selectedParts[l]instanceof rt.Rectangle){var P=new rt.Rectangle(this.selectedParts[l].x,s-(this.selectedParts[l].y-s),this.selectedParts[l].w,-this.selectedParts[l].h);P.angle=2*Math.PI-this.selectedParts[l].angle,P.isStatic=this.selectedParts[l].isStatic,P.density=this.selectedParts[l].density,P.collide=this.selectedParts[l].collide,P.red=this.selectedParts[l].red,P.green=this.selectedParts[l].green,P.blue=this.selectedParts[l].blue,P.opacity=this.selectedParts[l].opacity,P.outline=this.selectedParts[l].outline,P.terrain=this.selectedParts[l].terrain,P.undragable=this.selectedParts[l].undragable,t.push(P),a.push(P)}else if(this.selectedParts[l]instanceof b.Triangle){var G=this.selectedParts[l].GetVertices(),u=new b.Triangle(G[0].x,s-(G[0].y-s),G[1].x,s-(G[1].y-s),G[2].x,s-(G[2].y-s));u.isStatic=this.selectedParts[l].isStatic,u.density=this.selectedParts[l].density,u.collide=this.selectedParts[l].collide,u.red=this.selectedParts[l].red,u.green=this.selectedParts[l].green,u.blue=this.selectedParts[l].blue,u.opacity=this.selectedParts[l].opacity,u.outline=this.selectedParts[l].outline,u.terrain=this.selectedParts[l].terrain,u.undragable=this.selectedParts[l].undragable,t.push(u),a.push(u)}else if(this.selectedParts[l]instanceof o.Cannon){var C=new o.Cannon(this.selectedParts[l].x,s-(this.selectedParts[l].y-s)-this.selectedParts[l].w/2,this.selectedParts[l].w);C.angle=2*Math.PI-this.selectedParts[l].angle,C.isStatic=this.selectedParts[l].isStatic,C.density=this.selectedParts[l].density,C.collide=this.selectedParts[l].collide,C.red=this.selectedParts[l].red,C.green=this.selectedParts[l].green,C.blue=this.selectedParts[l].blue,C.opacity=this.selectedParts[l].opacity,C.outline=this.selectedParts[l].outline,C.terrain=this.selectedParts[l].terrain,C.undragable=this.selectedParts[l].undragable,C.fireKey=this.selectedParts[l].fireKey,C.strength=this.selectedParts[l].strength,t.push(C),a.push(C)}else if(this.selectedParts[l]instanceof m.TextPart){var p=new m.TextPart(this,this.selectedParts[l].x,s-(this.selectedParts[l].y+this.selectedParts[l].h/2-s),this.selectedParts[l].w,this.selectedParts[l].h,this.selectedParts[l].text,this.selectedParts[l].inFront);p.red=this.selectedParts[l].red,p.green=this.selectedParts[l].green,p.blue=this.selectedParts[l].blue,p.size=this.selectedParts[l].size,p.alwaysVisible=this.selectedParts[l].alwaysVisible,p.inFront=this.selectedParts[l].inFront,p.scaleWithZoom=this.selectedParts[l].scaleWithZoom,p.displayKey=this.selectedParts[l].displayKey,t.push(p),a.push(-1)}else(this.selectedParts[l]instanceof n.JointPart||this.selectedParts[l]instanceof g.Thrusters)&&a.push(-1);for(l=0;l<this.selectedParts.length;l++){var f=-1,y=-1;if(this.selectedParts[l]instanceof n.JointPart){for(var w=0;w<this.selectedParts.length;w++)this.selectedParts[w]==this.selectedParts[l].part1&&(f=w),this.selectedParts[w]==this.selectedParts[l].part2&&(y=w);if(-1==f||-1==y)continue}else if(this.selectedParts[l]instanceof g.Thrusters){for(w=0;w<this.selectedParts.length;w++)this.selectedParts[w]==this.selectedParts[l].shape&&(f=w);if(-1==f)continue}if(this.selectedParts[l]instanceof r.FixedJoint){var S=new r.FixedJoint(a[f],a[y],this.selectedParts[l].anchorX,s-(this.selectedParts[l].anchorY-s));t.push(S)}else if(this.selectedParts[l]instanceof d.RevoluteJoint){var A=new d.RevoluteJoint(a[f],a[y],this.selectedParts[l].anchorX,s-(this.selectedParts[l].anchorY-s));A.enableMotor=this.selectedParts[l].enableMotor,A.motorCWKey=this.selectedParts[l].motorCCWKey,A.motorCCWKey=this.selectedParts[l].motorCWKey,A.motorStrength=this.selectedParts[l].motorStrength,A.motorSpeed=this.selectedParts[l].motorSpeed,A.motorLowerLimit=-this.selectedParts[l].motorUpperLimit,A.motorUpperLimit=-this.selectedParts[l].motorLowerLimit,A.isStiff=this.selectedParts[l].isStiff,A.autoCW=this.selectedParts[l].autoCCW,A.autoCCW=this.selectedParts[l].autoCW,t.push(A)}else if(this.selectedParts[l]instanceof h.PrismaticJoint){var D=new h.PrismaticJoint(a[f],a[y],0,0,1,1);D.anchorX=this.selectedParts[l].anchorX,D.anchorY=s-(this.selectedParts[l].anchorY-s);var R=Math.atan2(this.selectedParts[l].axis.y,this.selectedParts[l].axis.x);R=i.Util.NormalizeAngle(2*Math.PI-R),D.axis=new x.b2Vec2(Math.cos(R),Math.sin(R)),D.axis.Normalize(),D.initLength=this.selectedParts[l].initLength,D.enablePiston=this.selectedParts[l].enablePiston,D.pistonUpKey=this.selectedParts[l].pistonUpKey,D.pistonDownKey=this.selectedParts[l].pistonDownKey,D.pistonStrength=this.selectedParts[l].pistonStrength,D.pistonSpeed=this.selectedParts[l].pistonSpeed,D.isStiff=this.selectedParts[l].isStiff,D.autoOscillate=this.selectedParts[l].autoOscillate,D.red=this.selectedParts[l].red,D.green=this.selectedParts[l].green,D.blue=this.selectedParts[l].blue,D.opacity=this.selectedParts[l].opacity,D.outline=this.selectedParts[l].outline,D.collide=this.selectedParts[l].collide,t.push(D)}else if(this.selectedParts[l]instanceof g.Thrusters){var T=new g.Thrusters(a[f],this.selectedParts[l].centerX,s-(this.selectedParts[l].centerY-s));T.angle=2*Math.PI-this.selectedParts[l].angle,T.strength=this.selectedParts[l].strength,T.thrustKey=this.selectedParts[l].thrustKey,T.autoOn=this.selectedParts[l].autoOn,t.push(T)}}if(t.length>0){for(this.selectedParts=new Array,this.draggingParts=new Array,l=0;l<t.length;l++)t[l].dragXOff=e-(t[l]instanceof n.JointPart?t[l].anchorX:t[l]instanceof m.TextPart?t[l].x-t[l].w/2:t[l].centerX),t[l].dragYOff=s-(t[l]instanceof n.JointPart?t[l].anchorY:t[l]instanceof m.TextPart?t[l].y-t[l].h/2:t[l].centerY),this.selectedParts.push(t[l]),this.draggingParts.push(t[l]),this.allParts.push(t[l]);this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingPart=this.selectedParts[0],this.draggingPart.Move(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),this.RefreshSidePanel(),this.AddAction(new k.MassCreateAction(this.selectedParts)),this.curAction=_.ControllerGameGlobals.PASTE,_.ControllerGameGlobals.curRobotID=""}}}scaleButton(){if(_.ControllerGameGlobals.curRobotEditable&&!this.selectingCondition&&!this.simStarted&&0!=this.selectedParts.length){this.initDragX=this.selectedParts[0]instanceof n.JointPart?this.selectedParts[0].anchorX:this.selectedParts[0]instanceof m.TextPart?this.selectedParts[0].x+this.selectedParts[0].w/2:this.selectedParts[0].centerX,this.initDragY=this.selectedParts[0]instanceof n.JointPart?this.selectedParts[0].anchorY:this.selectedParts[0]instanceof m.TextPart?this.selectedParts[0].y+this.selectedParts[0].h/2:this.selectedParts[0].centerY,this.firstClickX=_.ControllerGameGlobals.mouseXWorld,this.firstClickY=_.ControllerGameGlobals.mouseYWorld,this.draggingParts=new Array;for(var t=0;t<this.selectedParts.length;t++)this.draggingParts=i.Util.RemoveDuplicates(this.draggingParts.concat(this.selectedParts[t].GetAttachedParts()));for(t=0;t<this.draggingParts.length;t++)this.draggingParts[t].dragXOff=(this.draggingParts[t]instanceof n.JointPart?this.draggingParts[t].anchorX:this.draggingParts[t]instanceof m.TextPart?this.draggingParts[t].x+this.draggingParts[t].w/2:this.draggingParts[t].centerX)-this.initDragX,this.draggingParts[t].dragYOff=(this.draggingParts[t]instanceof n.JointPart?this.draggingParts[t].anchorY:this.draggingParts[t]instanceof m.TextPart?this.draggingParts[t].y+this.draggingParts[t].h/2:this.draggingParts[t].centerY)-this.initDragY,this.draggingParts[t].PrepareForResizing();this.curAction=_.ControllerGameGlobals.RESIZING_SHAPES}}deleteButton(){_.ControllerGameGlobals.curRobotEditable&&(this.simStarted||1==this.selectedParts.length&&(this.DeletePart(this.selectedParts[0]),this.curAction=-1,this.m_sidePanel.visible=!1,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0))}deleteBuildBoxButton(){_.ControllerGameGlobals.curRobotEditable&&(this.simStarted||(this.selectedBuildArea&&(ControllerChallenge.challenge.buildAreas=i.Util.RemoveFromArray(this.selectedBuildArea,ControllerChallenge.challenge.buildAreas),this.BuildBuildArea(),this.redrawBuildArea=!0),this.m_sidePanel.visible=!1))}multiDeleteButton(){if(_.ControllerGameGlobals.curRobotEditable&&!this.simStarted){for(var t=new Array,e=0;e<this.selectedParts.length;e++)this.selectedParts[e]instanceof c.ShapePart&&(t=(t=t.concat(this.selectedParts[e].GetActiveJoints())).concat(this.selectedParts[e].GetActiveThrusters())),this.DeletePart(this.selectedParts[e],!1,!1);if(0!=this.selectedParts.length){var s=i.Util.RemoveDuplicates(this.selectedParts.concat(t));for(this.AddAction(new M.ClearAction(s)),e=0;e<s.length;e++)this.selectedParts=i.Util.RemoveFromArray(s[e],this.selectedParts);this.CheckIfPartsFit(),this.m_sidePanel.visible=!1,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0}}}densitySlider(t){if(1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart){var e=this.selectedParts[0].density;this.selectedParts[0].density=t,_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetDensity(t),e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.DENSITY_TYPE,t-e))}}densityText(t){if(this.lastSelectedShape instanceof c.ShapePart){var e=this.lastSelectedShape.density,s=parseInt(t);s<_.ControllerGameGlobals.minDensity&&(s=_.ControllerGameGlobals.minDensity),s>_.ControllerGameGlobals.maxDensity&&(s=_.ControllerGameGlobals.maxDensity),isNaN(s)&&(s=_.ControllerGameGlobals.minDensity>15?_.ControllerGameGlobals.minDensity:_.ControllerGameGlobals.maxDensity<15?_.ControllerGameGlobals.maxDensity:15),this.lastSelectedShape.density=s,_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetDensity(s),e!=s&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.DENSITY_TYPE,s-e))}this.m_sidePanel.TextAreaLostFocus()}strengthText(t){if(this.lastSelectedJoint instanceof n.JointPart){var e;this.lastSelectedJoint instanceof d.RevoluteJoint&&(e=this.lastSelectedJoint.motorStrength),this.lastSelectedJoint instanceof h.PrismaticJoint&&(e=this.lastSelectedJoint.pistonStrength);var s=parseInt(t);this.lastSelectedJoint instanceof d.RevoluteJoint&&(s<1&&(s=1),s>_.ControllerGameGlobals.maxRJStrength&&(s=_.ControllerGameGlobals.maxRJStrength),isNaN(s)&&(s=Math.min(15,_.ControllerGameGlobals.maxRJStrength))),this.lastSelectedJoint instanceof h.PrismaticJoint&&(s<1&&(s=1),s>_.ControllerGameGlobals.maxSJStrength&&(s=_.ControllerGameGlobals.maxSJStrength),isNaN(s)&&(s=Math.min(15,_.ControllerGameGlobals.maxSJStrength))),this.lastSelectedJoint instanceof d.RevoluteJoint&&(this.lastSelectedJoint.motorStrength=s),this.lastSelectedJoint instanceof h.PrismaticJoint&&(this.lastSelectedJoint.pistonStrength=s),_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetStrength(s),e!=s&&this.AddAction(new E.ChangeSliderAction(this.lastSelectedJoint,E.ChangeSliderAction.STRENGTH_TYPE,s-e))}this.m_sidePanel.TextAreaLostFocus()}speedText(t){if(this.lastSelectedJoint instanceof n.JointPart){var e;this.lastSelectedJoint instanceof d.RevoluteJoint&&(e=this.lastSelectedJoint.motorSpeed),this.lastSelectedJoint instanceof h.PrismaticJoint&&(e=this.lastSelectedJoint.pistonSpeed);var s=parseInt(t);this.lastSelectedJoint instanceof d.RevoluteJoint&&(s<1&&(s=1),s>_.ControllerGameGlobals.maxRJSpeed&&(s=_.ControllerGameGlobals.maxRJSpeed),isNaN(s)&&(s=Math.min(15,_.ControllerGameGlobals.maxRJSpeed))),this.lastSelectedJoint instanceof h.PrismaticJoint&&(s<1&&(s=1),s>_.ControllerGameGlobals.maxSJSpeed&&(s=_.ControllerGameGlobals.maxSJSpeed),isNaN(s)&&(s=Math.min(15,_.ControllerGameGlobals.maxSJSpeed))),this.lastSelectedJoint instanceof d.RevoluteJoint&&(this.lastSelectedJoint.motorSpeed=s),this.lastSelectedJoint instanceof h.PrismaticJoint&&(this.lastSelectedJoint.pistonSpeed=s),_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetSpeed(s),e!=s&&this.AddAction(new E.ChangeSliderAction(this.lastSelectedJoint,E.ChangeSliderAction.SPEED_TYPE,s-e))}this.m_sidePanel.TextAreaLostFocus()}thrustText(t){if(this.lastSelectedThrusters instanceof g.Thrusters){var e;e=this.lastSelectedThrusters.strength;var s=parseInt(t);s<1&&(s=1),s>_.ControllerGameGlobals.maxThrusterStrength&&(s=_.ControllerGameGlobals.maxThrusterStrength),isNaN(s)&&(s=Math.min(15,_.ControllerGameGlobals.maxThrusterStrength)),this.lastSelectedThrusters.strength=s,_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetThrust(s),e!=s&&this.AddAction(new E.ChangeSliderAction(this.lastSelectedThrusters,E.ChangeSliderAction.SPEED_TYPE,s-e))}this.m_sidePanel.TextAreaLostFocus()}cannonText(t){if(this.lastSelectedShape instanceof o.Cannon){var e;e=this.lastSelectedShape.strength;var s=parseInt(t);s<1&&(s=1),s>30&&(s=30),isNaN(s)&&(s=15),this.lastSelectedShape.strength=s,_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetCannon(s),e!=s&&this.AddAction(new E.ChangeSliderAction(this.lastSelectedShape,E.ChangeSliderAction.STRENGTH_TYPE,s-e))}this.m_sidePanel.TextAreaLostFocus()}cameraBox(t){if(1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart){this.selectedParts[0].isCameraFocus=t,_.ControllerGameGlobals.curRobotID="";var e=null;if(t)for(var s=0;s<this.allParts.length;s++)this.allParts[s]instanceof c.ShapePart&&this.allParts[s]!=this.selectedParts[0]&&this.allParts[s].isCameraFocus&&(this.allParts[s].isCameraFocus=!1,e=this.allParts[s]);this.AddAction(new O.CameraAction(this.selectedParts[0],t,e))}}collisionBox(t){if(1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart)this.selectedParts[0].collide=t,_.ControllerGameGlobals.curRobotID="",this.AddAction(new et.ShapeCheckboxAction(this.selectedParts[0],et.ShapeCheckboxAction.COLLIDE_TYPE,t));else if(1==this.selectedParts.length&&this.selectedParts[0]instanceof h.PrismaticJoint)this.selectedParts[0].collide=t,_.ControllerGameGlobals.curRobotID="",this.AddAction(new et.ShapeCheckboxAction(this.selectedParts[0],et.ShapeCheckboxAction.COLLIDE_TYPE,t));else if(this.selectedParts.length>1){for(var e=new Array,s=0;s<this.selectedParts.length;s++)(this.selectedParts[s]instanceof c.ShapePart||this.selectedParts[s]instanceof h.PrismaticJoint)&&this.selectedParts[s].collide!=t&&(this.selectedParts[s].collide=t,e.push(this.selectedParts[s]));e.length>0&&(_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new K.MultiCollideAction(e,t)))}}fixateBox(t){if(1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart)this.selectedParts[0].isStatic=valueed,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new et.ShapeCheckboxAction(this.selectedParts[0],et.ShapeCheckboxAction.FIXATE_TYPE,t));else if(this.selectedParts.length>1){for(var e=new Array,s=0;s<this.selectedParts.length;s++)this.selectedParts[s]instanceof c.ShapePart&&this.selectedParts[s].isStatic!=t&&(this.selectedParts[s].isStatic=t,e.push(this.selectedParts[s]));e.length>0&&(_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new Z.MultiFixateAction(e,t)))}}outlineBox(t){if(1==this.selectedParts.length&&(this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof h.PrismaticJoint))this.selectedParts[0].outline=t,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new et.ShapeCheckboxAction(this.selectedParts[0],et.ShapeCheckboxAction.OUTLINE_TYPE,t));else if(this.selectedParts.length>1){for(var e=new Array,s=0;s<this.selectedParts.length;s++)(this.selectedParts[s]instanceof c.ShapePart||this.selectedParts[s]instanceof h.PrismaticJoint)&&this.selectedParts[s].outline!=t&&(this.selectedParts[s].outline=t,e.push(this.selectedParts[s]));e.length>0&&(_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new q.MultiOutlineAction(e,t)))}}terrainBox(t){if(1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart)this.selectedParts[0].terrain=t,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new et.ShapeCheckboxAction(this.selectedParts[0],et.ShapeCheckboxAction.TERRAIN_TYPE,t));else if(this.selectedParts.length>1){for(var e=new Array,s=0;s<this.selectedParts.length;s++)this.selectedParts[s]instanceof c.ShapePart&&this.selectedParts[s].terrain!=t&&(this.selectedParts[s].terrain=t,e.push(this.selectedParts[s]));e.length>0&&(_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new z.MultiTerrainAction(e,t)))}}undragableBox(t){if(1==this.selectedParts.length&&this.selectedParts[0]instanceof c.ShapePart)this.selectedParts[0].undragable=t,_.ControllerGameGlobals.curRobotID="",this.AddAction(new et.ShapeCheckboxAction(this.selectedParts[0],et.ShapeCheckboxAction.UNDRAGABLE_TYPE,t));else if(this.selectedParts.length>1){for(var e=new Array,s=0;s<this.selectedParts.length;s++)this.selectedParts[s]instanceof c.ShapePart&&this.selectedParts[s].undragable!=t&&(this.selectedParts[s].undragable=t,e.push(this.selectedParts[s]));e.length>0&&(_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new j.MultiUndragableAction(e,t)))}}frontButton(){if(!this.simStarted){if(1==this.selectedParts.length&&(this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof h.PrismaticJoint)){for(var t=-1,e=0;e<this.allParts.length;e++)this.allParts[e]==this.selectedParts[0]&&(t=e);this.allParts=i.Util.RemoveFromArray(this.selectedParts[0],this.allParts),this.allParts.push(this.selectedParts[0]),_.ControllerGameGlobals.curRobotID="",this.AddAction(new H.MoveZAction(this.selectedParts[0],H.MoveZAction.FRONT_TYPE,t))}else 1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart&&(this.selectedParts[0].inFront||(this.selectedParts[0].inFront=!0,this.removeChild(this.selectedParts[0].m_textField),this.addChildAt(this.selectedParts[0].m_textField,this.getChildIndex(this.m_canvas)+1),this.AddAction(new H.MoveZAction(this.selectedParts[0],H.MoveZAction.FRONT_TYPE))));this.redrawRobot=!0}}backButton(){if(!this.simStarted){if(1==this.selectedParts.length&&(this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof h.PrismaticJoint)){for(var t=-1,e=!1,s=this.allParts.length-1;s>0;s--)if(this.allParts[s]==this.selectedParts[0]&&(t=s,e=!0),e){if(!this.allParts[s-1].isEditable)break;this.allParts[s]=this.allParts[s-1]}this.allParts[s]=this.selectedParts[0],_.ControllerGameGlobals.curRobotID="",this.AddAction(new H.MoveZAction(this.selectedParts[0],H.MoveZAction.BACK_TYPE,t))}else 1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart&&this.selectedParts[0].inFront&&(this.selectedParts[0].inFront=!1,this.removeChild(this.selectedParts[0].m_textField),this.addChildAt(this.selectedParts[0].m_textField,this.getChildIndex(this.m_canvas)),this.AddAction(new H.MoveZAction(this.selectedParts[0],H.MoveZAction.BACK_TYPE)));this.redrawRobot=!0}}scaleWithZoomBox(){1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart&&(this.selectedParts[0].scaleWithZoom=value,_.ControllerGameGlobals.curRobotID="",this.AddAction(new it.TextCheckboxAction(this.selectedParts[0],it.TextCheckboxAction.SCALE_TYPE,value)))}alwaysVisibleBox(){1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart&&(this.selectedParts[0].alwaysVisible=value,_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.EnableTextStuff(!value),this.AddAction(new it.TextCheckboxAction(this.selectedParts[0],it.TextCheckboxAction.DISPLAY_TYPE,value)))}textKeyBox(t){if(t.currentTarget.enabled){var e;if(this.selectedParts[0]instanceof m.TextPart){var s=this.selectedParts[0].displayKey;this.selectedParts[0].displayKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.TEXT_TYPE,s,t.keyCode))}null==(e=f.Input.getKeyString(t.keyCode))&&(e="Unk: "+t.keyCode),t.target.text=e,t.target.setSelection(0,10),_.ControllerGameGlobals.curRobotID=""}}textEntered(){this.selectedParts[0]instanceof c.ShapePart?this.lastSelectedShape=this.selectedParts[0]:this.selectedParts[0]instanceof n.JointPart?this.lastSelectedJoint=this.selectedParts[0]:this.selectedParts[0]instanceof m.TextPart?this.lastSelectedText=this.selectedParts[0]:this.selectedParts[0]instanceof g.Thrusters&&(this.lastSelectedThrusters=this.selectedParts[0])}colourButton(t,e,s,i,a){var l,o,r,n;if(a&&(_.ControllerGameGlobals.defaultR=t,_.ControllerGameGlobals.defaultG=e,_.ControllerGameGlobals.defaultB=s,_.ControllerGameGlobals.defaultO=i),1==this.selectedParts.length)(this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof h.PrismaticJoint||this.selectedParts[0]instanceof m.TextPart)&&(l=this.selectedParts[0].red,o=this.selectedParts[0].green,r=this.selectedParts[0].blue,this.selectedParts[0].red=t,this.selectedParts[0].green=e,this.selectedParts[0].blue=s,this.selectedParts[0]instanceof m.TextPart||(n=this.selectedParts[0].opacity,this.selectedParts[0].opacity=i),l==this.selectedParts[0].red&&o==this.selectedParts[0].green&&r==this.selectedParts[0].blue&&(this.selectedParts[0]instanceof m.TextPart||n==this.selectedParts[0].opacity)||(this.AddAction(new Y.ColourChangeAction(this.selectedParts[0],this.selectedParts[0].red-l,this.selectedParts[0].green-o,this.selectedParts[0].blue-r,this.selectedParts[0]instanceof m.TextPart?0:this.selectedParts[0].opacity-n)),_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0));else if(this.selectedParts.length>1){for(var d=new Array,g=new Array,b=new Array,P=new Array,G=new Array,u=0;u<this.selectedParts.length;u++)(this.selectedParts[u]instanceof c.ShapePart||this.selectedParts[u]instanceof h.PrismaticJoint||this.selectedParts[u]instanceof m.TextPart)&&(this.selectedParts[u].red==t&&this.selectedParts[u].green==e&&this.selectedParts[u].blue==s&&(this.selectedParts[u]instanceof m.TextPart||this.selectedParts[u].opacity==i)||(g.push(this.selectedParts[u].red),b.push(this.selectedParts[u].green),P.push(this.selectedParts[u].blue),G.push(this.selectedParts[u]instanceof m.TextPart?0:this.selectedParts[u].opacity),this.selectedParts[u].red=t,this.selectedParts[u].green=e,this.selectedParts[u].blue=s,this.selectedParts[u]instanceof m.TextPart||(this.selectedParts[u].opacity=i),d.push(this.selectedParts[u])));d.length>0&&(_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.AddAction(new V.MultiColourChangeAction(d,t,e,s,i,g,b,P,G)))}}textTextStart(){1==this.selectedParts.length&&this.selectedParts[0]instanceof m.TextPart&&(this.oldText=this.selectedParts[0].text)}textText(t){this.textEntered(t),this.lastSelectedText instanceof m.TextPart&&(this.newText=t.target,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0)}textTextFinish(){this.lastSelectedText instanceof m.TextPart&&this.AddAction(new B.EnterTextAction(this.lastSelectedText,this.oldText,this.lastSelectedText.text))}sizeText(t){if(this.lastSelectedText instanceof m.TextPart){var e=this.lastSelectedText.size;this.lastSelectedText.size=parseInt(t.target.text),this.lastSelectedText.size<4&&(this.lastSelectedText.size=4),this.lastSelectedText.size>36&&(this.lastSelectedText.size=36),t.target.text=this.lastSelectedText.size+"",_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,e!=this.lastSelectedText.size&&this.AddAction(new at.TextSizeChangeAction(this.lastSelectedText,this.lastSelectedText.size-e))}this.m_sidePanel.TextAreaLostFocus()}minLimitText(t){var e=Number(t.target.text.replace("\n",""));if(""==t.target.text&&(e=NaN),this.lastSelectedJoint instanceof d.RevoluteJoint){isNaN(e)?(e=-Number.MAX_VALUE,t.target.text="None"):e>=0&&(e=0,t.target.text=0);var s=this.lastSelectedJoint.motorLowerLimit;this.lastSelectedJoint.motorLowerLimit=e,e!=s&&this.AddAction(new F.LimitChangeAction(this.lastSelectedJoint,F.LimitChangeAction.MIN_TYPE,s,e))}this.m_sidePanel.TextAreaLostFocus(),_.ControllerGameGlobals.curRobotID=""}maxLimitText(t){var e=Number(t.target.text.replace("\n",""));if(""==t.target.text&&(e=NaN),this.lastSelectedJoint instanceof d.RevoluteJoint){isNaN(e)?(e=Number.MAX_VALUE,t.target.text="None"):e<=0&&(e=0,t.target.text=0);var s=this.lastSelectedJoint.motorUpperLimit;this.lastSelectedJoint.motorUpperLimit=e,e!=s&&this.AddAction(new F.LimitChangeAction(this.lastSelectedJoint,F.LimitChangeAction.MAX_TYPE,s,e))}this.m_sidePanel.TextAreaLostFocus(),_.ControllerGameGlobals.curRobotID=""}controlKeyText1(t){var e,s;t.currentTarget.enabled&&(this.selectedParts[0]instanceof d.RevoluteJoint?(s=this.selectedParts[0].motorCWKey,this.selectedParts[0].motorCWKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.CW_TYPE,s,t.keyCode))):(s=this.selectedParts[0].pistonUpKey,this.selectedParts[0].pistonUpKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.EXPAND_TYPE,s,t.keyCode))),null==(e=f.Input.getKeyString(t.keyCode))&&(e="Unk: "+t.keyCode),t.target.text=e,t.target.setSelection(0,10),_.ControllerGameGlobals.curRobotID="")}controlKeyText2(t){var e,s;t.currentTarget.enabled&&(this.selectedParts[0]instanceof d.RevoluteJoint?(s=this.selectedParts[0].motorCCWKey,this.selectedParts[0].motorCCWKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.CCW_TYPE,s,t.keyCode))):(s=this.selectedParts[0].pistonDownKey,this.selectedParts[0].pistonDownKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.CONTRACT_TYPE,s,t.keyCode))),null==(e=f.Input.getKeyString(t.keyCode))&&(e="Unk: "+t.keyCode),t.target.text=e,t.target.setSelection(0,10),_.ControllerGameGlobals.curRobotID="")}thrustKeyText(t){var e,s;t.currentTarget.enabled&&(this.selectedParts[0]instanceof g.Thrusters&&(s=this.selectedParts[0].thrustKey,this.selectedParts[0].thrustKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.THRUSTERS_TYPE,s,t.keyCode))),null==(e=f.Input.getKeyString(t.keyCode))&&(e="Unk: "+t.keyCode),t.target.text=e,t.target.setSelection(0,10),_.ControllerGameGlobals.curRobotID="")}fireKeyText(t){var e,s;t.currentTarget.enabled&&(this.selectedParts[0]instanceof o.Cannon&&(s=this.selectedParts[0].fireKey,this.selectedParts[0].fireKey=t.keyCode,s!=t.keyCode&&this.AddAction(new X.ControlKeyAction(this.selectedParts[0],X.ControlKeyAction.CANNON_TYPE,s,t.keyCode))),null==(e=f.Input.getKeyString(t.keyCode))&&(e="Unk: "+t.keyCode),t.target.text=e,t.target.setSelection(0,10),_.ControllerGameGlobals.curRobotID="")}autoBox1(t){if(this.selectedParts[0]instanceof d.RevoluteJoint){var e=t&&this.selectedParts[0].autoCCW;this.selectedParts[0].autoCW=t,t&&(this.selectedParts[0].autoCCW=!1,this.m_sidePanel.deselectBox2()),this.AddAction(new L.JointCheckboxAction(this.selectedParts[0],L.JointCheckboxAction.AUTO_CW_TYPE,t,e))}else this.selectedParts[0]instanceof h.PrismaticJoint?(this.selectedParts[0].autoOscillate=t,this.AddAction(new L.JointCheckboxAction(this.selectedParts[0],L.JointCheckboxAction.AUTO_OSCILLATE_TYPE,t))):this.selectedParts[0]instanceof g.Thrusters&&(this.selectedParts[0].autoOn=t,this.AddAction(new L.JointCheckboxAction(this.selectedParts[0],L.JointCheckboxAction.AUTO_ON_TYPE,t)));_.ControllerGameGlobals.curRobotID=""}autoBox2(t){if(this.selectedParts[0]instanceof d.RevoluteJoint){var e=t&&this.selectedParts[0].autoCW;this.selectedParts[0].autoCCW=t,t&&(this.selectedParts[0].autoCW=!1,this.m_sidePanel.deselectBox1()),this.AddAction(new L.JointCheckboxAction(this.selectedParts[0],L.JointCheckboxAction.AUTO_CCW_TYPE,t,e))}_.ControllerGameGlobals.curRobotID=""}motorBox(t){this.selectedParts[0]instanceof d.RevoluteJoint?this.selectedParts[0].enableMotor=t:this.selectedParts[0]instanceof h.PrismaticJoint&&(this.selectedParts[0].enablePiston=t),this.m_sidePanel.EnableMotorStuff(t),_.ControllerGameGlobals.curRobotID="",this.AddAction(new L.JointCheckboxAction(this.selectedParts[0],L.JointCheckboxAction.ENABLE_TYPE,t))}rigidBox(t){this.selectedParts[0]instanceof d.RevoluteJoint?this.selectedParts[0].isStiff=!t:this.selectedParts[0]instanceof h.PrismaticJoint&&(this.selectedParts[0].isStiff=!t),_.ControllerGameGlobals.curRobotID="",this.AddAction(new L.JointCheckboxAction(this.selectedParts[0],L.JointCheckboxAction.RIGID_TYPE,t))}strengthSlider(t){var e;this.selectedParts[0]instanceof d.RevoluteJoint?(e=this.selectedParts[0].motorStrength,this.selectedParts[0].motorStrength=t,e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.STRENGTH_TYPE,t-e))):this.selectedParts[0]instanceof h.PrismaticJoint&&(e=this.selectedParts[0].pistonStrength,this.selectedParts[0].pistonStrength=t,e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.STRENGTH_TYPE,t-e))),_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetStrength(t)}speedSlider(t){var e;this.selectedParts[0]instanceof d.RevoluteJoint?(e=this.selectedParts[0].motorSpeed,this.selectedParts[0].motorSpeed=t,e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.SPEED_TYPE,t-e))):this.selectedParts[0]instanceof h.PrismaticJoint&&(e=this.selectedParts[0].pistonSpeed,this.selectedParts[0].pistonSpeed=t,e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.SPEED_TYPE,this.m_checkBoxRoll-e))),_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetSpeed(t)}thrustSlider(t){var e;this.selectedParts[0]instanceof g.Thrusters&&(e=this.selectedParts[0].strength,this.selectedParts[0].strength=t,e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.STRENGTH_TYPE,t-e))),_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetThrust(t)}cannonSlider(t){var e;this.selectedParts[0]instanceof o.Cannon&&(e=this.selectedParts[0].strength,this.selectedParts[0].strength=t,e!=t&&this.AddAction(new E.ChangeSliderAction(this.selectedParts[0],E.ChangeSliderAction.STRENGTH_TYPE,t-e))),_.ControllerGameGlobals.curRobotID="",this.m_sidePanel.SetCannon(t)}zoomInButton(){this.Zoom(!0)}zoomOutButton(){this.Zoom(!1)}clearButton(){if(!this.simStarted&&!this.selectingCondition){for(var t=this.allParts.filter(this.PartIsEditable),e=0;e<t.length;e++)(t[e]instanceof c.ShapePart||t[e]instanceof m.TextPart)&&this.DeletePart(t[e],!1);0!=t.length&&(_.ControllerGameGlobals.curRobotEditable&&this.AddAction(new M.ClearAction(t)),this.CheckIfPartsFit(),_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0),_.ControllerGameGlobals.curRobotEditable||(_.ControllerGameGlobals.curRobotEditable=!0),this.m_sidePanel&&this.m_sidePanel.visible&&(this.m_sidePanel.visible=!1)}}undoButton(){this.selectingCondition||_.ControllerGameGlobals.curRobotEditable&&-1!=this.lastAction&&!this.simStarted&&(this.actions[this.lastAction].UndoAction(),this.lastAction--,this.curAction=-1,_.ControllerGameGlobals.curRobotID="",this.CheckIfPartsFit(),0==this.selectedParts.length&&(this.m_sidePanel.visible=!1),this.RefreshSidePanel(),this.redrawRobot=!0)}redoButton(){this.selectingCondition||_.ControllerGameGlobals.curRobotEditable&&this.lastAction<this.actions.length-1&&!this.simStarted&&(this.actions[this.lastAction+1].RedoAction(),this.lastAction++,this.curAction=-1,_.ControllerGameGlobals.curRobotID="",this.CheckIfPartsFit(),0==this.selectedParts.length&&(this.m_sidePanel.visible=!1),this.RefreshSidePanel(),this.redrawRobot=!0)}cutButton(){if(!this.selectingCondition&&!this.simStarted)if(this.copiedJoint=null,this.copiedThrusters=null,1==this.selectedParts.length)_.ControllerGameGlobals.clipboardParts=new Array,this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof m.TextPart?_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[0].MakeCopy()):this.selectedParts[0]instanceof n.JointPart?this.copiedJoint=this.selectedParts[0]:this.selectedParts[0]instanceof g.Thrusters&&(this.copiedThrusters=this.selectedParts[0]),this.DeletePart(this.selectedParts[0]),this.m_sidePanel.visible=!1,this.curAction=-1,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0;else if(this.selectedParts.length>1){_.ControllerGameGlobals.clipboardParts=new Array;for(var t=new Array,e=new Array,s=0;s<this.selectedParts.length;s++)if(this.selectedParts[s]instanceof c.ShapePart){var a=this.selectedParts[s].MakeCopy();_.ControllerGameGlobals.clipboardParts.push(a),t.push(a),e=e.concat(this.selectedParts[s].GetActiveJoints()),this.DeletePart(this.selectedParts[s],!1,!1)}else this.selectedParts[s]instanceof m.TextPart?(_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[s].MakeCopy()),t.push(-1),this.DeletePart(this.selectedParts[s],!1,!1)):t.push(-1);for(s=0;s<this.selectedParts.length;s++)if(this.selectedParts[s]instanceof n.JointPart){for(var l=-1,o=-1,r=0;r<this.selectedParts.length;r++)this.selectedParts[r]==this.selectedParts[s].part1&&(l=r),this.selectedParts[r]==this.selectedParts[s].part2&&(o=r);-1!=l&&-1!=o&&_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[s].MakeCopy(t[l],t[o])),this.DeletePart(this.selectedParts[s],!1,!1)}else if(this.selectedParts[s]instanceof g.Thrusters){for(l=-1,r=0;r<this.selectedParts.length;r++)this.selectedParts[r]==this.selectedParts[s].shape&&(l=r);-1!=l&&_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[s].MakeCopy(t[l])),this.DeletePart(this.selectedParts[s],!1,!1)}var h=i.Util.RemoveDuplicates(this.selectedParts.concat(e));this.AddAction(new M.ClearAction(h)),this.selectedParts=new Array,this.m_sidePanel.visible=!1,this.CheckIfPartsFit(),this.curAction=-1,_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0}}copyButton(){if(!this.selectingCondition&&!this.simStarted)if(this.copiedJoint=null,this.copiedThrusters=null,1==this.selectedParts.length)_.ControllerGameGlobals.clipboardParts=new Array,this.selectedParts[0]instanceof c.ShapePart||this.selectedParts[0]instanceof m.TextPart?_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[0].MakeCopy()):this.selectedParts[0]instanceof n.JointPart?this.copiedJoint=this.selectedParts[0]:this.selectedParts[0]instanceof g.Thrusters&&(this.copiedThrusters=this.selectedParts[0]),this.curAction=-1;else if(this.selectedParts.length>1){_.ControllerGameGlobals.clipboardParts=new Array;for(var t=new Array,e=0;e<this.selectedParts.length;e++)if(this.selectedParts[e]instanceof c.ShapePart){var s=this.selectedParts[e].MakeCopy();_.ControllerGameGlobals.clipboardParts.push(s),t.push(s)}else this.selectedParts[e]instanceof m.TextPart?(_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[e].MakeCopy()),t.push(-1)):t.push(-1);for(e=0;e<this.selectedParts.length;e++)if(this.selectedParts[e]instanceof n.JointPart){for(var i=-1,a=-1,l=0;l<this.selectedParts.length;l++)this.selectedParts[l]==this.selectedParts[e].part1&&(i=l),this.selectedParts[l]==this.selectedParts[e].part2&&(a=l);-1!=i&&-1!=a&&_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[e].MakeCopy(t[i],t[a]))}else if(this.selectedParts[e]instanceof g.Thrusters){for(i=-1,l=0;l<this.selectedParts.length;l++)this.selectedParts[l]==this.selectedParts[e].shape&&(i=l);-1!=i&&_.ControllerGameGlobals.clipboardParts.push(this.selectedParts[e].MakeCopy(t[i]))}this.curAction=-1}}pasteButton(){if(!this.selectingCondition&&_.ControllerGameGlobals.curRobotEditable&&!this.simStarted){for(var t=!1,e=!1,s=!1,l=!1,P=!1,G=!1,u=!1,C=!1,p=!1,f=0;f<_.ControllerGameGlobals.clipboardParts.length;f++)_.ControllerGameGlobals.clipboardParts[f].isStatic&&(p=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof nt.Circle&&(t=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof rt.Rectangle&&(e=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof b.Triangle&&(s=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof r.FixedJoint&&(l=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof d.RevoluteJoint&&(P=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof h.PrismaticJoint&&(G=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof g.Thrusters&&(u=!0),_.ControllerGameGlobals.clipboardParts[f]instanceof o.Cannon&&(C=!0);if("challenge"===this.controllerType&&ControllerChallenge.playChallengeMode&&(p&&!ControllerChallenge.challenge.fixateAllowed||t&&!ControllerChallenge.challenge.circlesAllowed||e&&!ControllerChallenge.challenge.rectanglesAllowed||s&&!ControllerChallenge.challenge.trianglesAllowed||l&&!ControllerChallenge.challenge.fixedJointsAllowed||P&&!ControllerChallenge.challenge.rotatingJointsAllowed||G&&!ControllerChallenge.challenge.slidingJointsAllowed||u&&!ControllerChallenge.challenge.thrustersAllowed||C&&!ControllerChallenge.challenge.cannonsAllowed))return this.m_fader.visible=!0,this.ShowDialog3("Sorry, some of the copied parts are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),void a.Main.ShowMouse();if(1==_.ControllerGameGlobals.clipboardParts.length&&_.ControllerGameGlobals.clipboardParts[0]instanceof c.ShapePart)_.ControllerGameGlobals.clipboardParts[0].Move(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),this.allParts.push(_.ControllerGameGlobals.clipboardParts[0]),this.selectedParts=new Array,this.selectedParts.push(_.ControllerGameGlobals.clipboardParts[0]),this.draggingPart=_.ControllerGameGlobals.clipboardParts[0],this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingParts=this.draggingPart.GetAttachedParts(),this.draggingPart.dragXOff=0,this.draggingPart.dragYOff=0,_.ControllerGameGlobals.clipboardParts[0]instanceof o.Cannon?this.m_sidePanel.ShowCannonPanel(_.ControllerGameGlobals.clipboardParts[0]):this.m_sidePanel.ShowObjectPanel(_.ControllerGameGlobals.clipboardParts[0]),this.AddAction(new J.CreateAction(_.ControllerGameGlobals.clipboardParts[0])),_.ControllerGameGlobals.clipboardParts[0]=_.ControllerGameGlobals.clipboardParts[0].MakeCopy(),this.curAction=_.ControllerGameGlobals.PASTE,_.ControllerGameGlobals.curRobotID="";else if(this.copiedJoint)this.copiedJoint instanceof r.FixedJoint?this.curAction=_.ControllerGameGlobals.NEW_FIXED_JOINT:this.copiedJoint instanceof d.RevoluteJoint?this.curAction=_.ControllerGameGlobals.NEW_REVOLUTE_JOINT:this.curAction=_.ControllerGameGlobals.NEW_PRISMATIC_JOINT,this.actionStep=0;else if(this.copiedThrusters)this.curAction=_.ControllerGameGlobals.NEW_THRUSTERS;else{for(this.draggingPart=null,this.m_sidePanel.visible=!1,this.selectedParts=new Array,this.draggingParts=new Array,f=0;f<_.ControllerGameGlobals.clipboardParts.length;f++)_.ControllerGameGlobals.clipboardParts[f]instanceof c.ShapePart?(!this.draggingPart||this.draggingPart instanceof m.TextPart||_.ControllerGameGlobals.clipboardParts[f].GetMass()>this.draggingPart.GetMass())&&(this.draggingPart=_.ControllerGameGlobals.clipboardParts[f]):_.ControllerGameGlobals.clipboardParts[f]instanceof m.TextPart&&!this.draggingPart&&(this.draggingPart=_.ControllerGameGlobals.clipboardParts[f]);var y=new Array;for(f=0;f<_.ControllerGameGlobals.clipboardParts.length;f++)y.push(_.ControllerGameGlobals.clipboardParts[f]);for(f=0;f<_.ControllerGameGlobals.clipboardParts.length;f++)_.ControllerGameGlobals.clipboardParts[f]instanceof c.ShapePart?(_.ControllerGameGlobals.clipboardParts[f].dragXOff=this.draggingPart.centerX-_.ControllerGameGlobals.clipboardParts[f].centerX,_.ControllerGameGlobals.clipboardParts[f].dragYOff=this.draggingPart.centerY-_.ControllerGameGlobals.clipboardParts[f].centerY,this.allParts.push(_.ControllerGameGlobals.clipboardParts[f]),this.selectedParts.push(_.ControllerGameGlobals.clipboardParts[f]),this.draggingParts=i.Util.RemoveDuplicates(this.draggingParts.concat(_.ControllerGameGlobals.clipboardParts[f].GetAttachedParts())),_.ControllerGameGlobals.clipboardParts[f]=_.ControllerGameGlobals.clipboardParts[f].MakeCopy(),y[f]!=this.draggingPart&&y[f].Move(y[f].centerX-this.draggingPart.centerX+_.ControllerGameGlobals.mouseXWorldPhys,y[f].centerY-this.draggingPart.centerY+_.ControllerGameGlobals.mouseYWorldPhys)):_.ControllerGameGlobals.clipboardParts[f]instanceof m.TextPart&&(this.draggingPart instanceof c.ShapePart?(_.ControllerGameGlobals.clipboardParts[f].dragXOff=this.draggingPart.centerX-_.ControllerGameGlobals.clipboardParts[f].x,_.ControllerGameGlobals.clipboardParts[f].dragYOff=this.draggingPart.centerY-_.ControllerGameGlobals.clipboardParts[f].y):(_.ControllerGameGlobals.clipboardParts[f].dragXOff=this.draggingPart.x-_.ControllerGameGlobals.clipboardParts[f].x,_.ControllerGameGlobals.clipboardParts[f].dragYOff=this.draggingPart.y-_.ControllerGameGlobals.clipboardParts[f].y),this.allParts.push(_.ControllerGameGlobals.clipboardParts[f]),this.selectedParts.push(_.ControllerGameGlobals.clipboardParts[f]),this.draggingParts=this.draggingParts.concat(_.ControllerGameGlobals.clipboardParts[f].GetAttachedParts()),_.ControllerGameGlobals.clipboardParts[f]=_.ControllerGameGlobals.clipboardParts[f].MakeCopy(),y[f]!=this.draggingPart&&(this.draggingPart instanceof c.ShapePart?y[f].Move(y[f].x-this.draggingPart.centerX+_.ControllerGameGlobals.mouseXWorldPhys,y[f].y-this.draggingPart.centerY+_.ControllerGameGlobals.mouseYWorldPhys):y[f].Move(y[f].x-this.draggingPart.x+_.ControllerGameGlobals.mouseXWorldPhys,y[f].y-this.draggingPart.y+_.ControllerGameGlobals.mouseYWorldPhys)));for(f=0;f<_.ControllerGameGlobals.clipboardParts.length;f++)if(_.ControllerGameGlobals.clipboardParts[f]instanceof n.JointPart){_.ControllerGameGlobals.clipboardParts[f].dragXOff=this.draggingPart.centerX-_.ControllerGameGlobals.clipboardParts[f].anchorX,_.ControllerGameGlobals.clipboardParts[f].dragYOff=this.draggingPart.centerY-_.ControllerGameGlobals.clipboardParts[f].anchorY,this.allParts.push(_.ControllerGameGlobals.clipboardParts[f]),this.selectedParts.push(_.ControllerGameGlobals.clipboardParts[f]);for(var w=-1,S=-1,A=0;A<y.length;A++)y[A]==_.ControllerGameGlobals.clipboardParts[f].part1&&(w=A),y[A]==_.ControllerGameGlobals.clipboardParts[f].part2&&(S=A);_.ControllerGameGlobals.clipboardParts[f]=_.ControllerGameGlobals.clipboardParts[f].MakeCopy(_.ControllerGameGlobals.clipboardParts[w],_.ControllerGameGlobals.clipboardParts[S]),y[f].Move(y[f].anchorX-this.draggingPart.centerX+_.ControllerGameGlobals.mouseXWorldPhys,y[f].anchorY-this.draggingPart.centerY+_.ControllerGameGlobals.mouseYWorldPhys)}else if(_.ControllerGameGlobals.clipboardParts[f]instanceof g.Thrusters){for(_.ControllerGameGlobals.clipboardParts[f].dragXOff=this.draggingPart.centerX-_.ControllerGameGlobals.clipboardParts[f].centerX,_.ControllerGameGlobals.clipboardParts[f].dragYOff=this.draggingPart.centerY-_.ControllerGameGlobals.clipboardParts[f].centerY,this.allParts.push(_.ControllerGameGlobals.clipboardParts[f]),this.selectedParts.push(_.ControllerGameGlobals.clipboardParts[f]),w=-1,A=0;A<y.length;A++)y[A]==_.ControllerGameGlobals.clipboardParts[f].shape&&(w=A);_.ControllerGameGlobals.clipboardParts[f]=_.ControllerGameGlobals.clipboardParts[f].MakeCopy(_.ControllerGameGlobals.clipboardParts[w]),y[f].Move(y[f].centerX-this.draggingPart.centerX+_.ControllerGameGlobals.mouseXWorldPhys,y[f].centerY-this.draggingPart.centerY+_.ControllerGameGlobals.mouseYWorldPhys)}this.draggingPart&&(this.initDragX=_.ControllerGameGlobals.mouseXWorldPhys,this.initDragY=_.ControllerGameGlobals.mouseYWorldPhys,this.draggingPart.Move(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),this.m_sidePanel.ShowMultiSelectPanel(this.selectedParts),this.AddAction(new k.MassCreateAction(this.selectedParts)),this.curAction=_.ControllerGameGlobals.PASTE,_.ControllerGameGlobals.curRobotID="")}}}centerBox(){_.ControllerGameGlobals.snapToCenter=!_.ControllerGameGlobals.snapToCenter}jointBox(){_.ControllerGameGlobals.showJoints=!_.ControllerGameGlobals.showJoints,this.redrawRobot=!0}globalOutlineBox(){_.ControllerGameGlobals.showOutlines=!_.ControllerGameGlobals.showOutlines,this.redrawRobot=!0}colourBox(){_.ControllerGameGlobals.showColours=!_.ControllerGameGlobals.showColours,_.ControllerGameGlobals.showColours?this.draw.m_fillAlpha=1:this.draw.m_fillAlpha=.5,this.redrawRobot=!0}centerOnSelectedBox(){_.ControllerGameGlobals.centerOnSelected=!_.ControllerGameGlobals.centerOnSelected,_.ControllerGameGlobals.centerOnSelected&&1==this.selectedParts.length&&this.CenterOnSelected()}ConfirmNewRobot(){a.Main.changeControllers=!0,a.Main.nextControllerType=-1,_.ControllerGameGlobals.playingReplay=!1,_.ControllerGameGlobals.viewingUnsavedReplay=!1}loginButton(t=!1,e=!1,s=!1){this.selectingCondition||(a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):(this.m_fader.visible=!0,this.m_loginWindow&&this.removeChild(this.m_loginWindow),this.m_loginWindow=new LoginWindow(this),t&&this.m_loginWindow.displayMessage(),this.addChild(this.m_loginWindow),this.backToSaveWindow=e))}logoutButton(){this.m_fader.visible=!0,this.ShowConfirmDialog("Are you sure you want to log "+_.ControllerGameGlobals.userName+" out?",12)}ConfirmLogout(t){a.Main.premiumMode=!1,_.ControllerGameGlobals.userName="_Public",this.m_guiPanel.ShowLogin(),this.ShowDialog3("You are now logged out."),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),this.m_fader.visible=!0}loginHidden(t,e){this.clickedSave?(this.clickedSave=!1,this.saveButton()):this.clickedSaveReplay?(this.clickedSaveReplay=!1,this.saveReplayButton()):this.clickedSaveChallenge?(this.clickedSaveChallenge=!1,this.saveButton()):this.clickedSubmitScore?(this.AddSyncPoint(),_.ControllerGameGlobals.viewingUnsavedReplay?s.Database.SaveReplay(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,_.ControllerGameGlobals.replay,"_ScoreReplay","This replay instanceof saved for a score",_.ControllerGameGlobals.curRobotID,new p.Robot(this.allParts,v.ControllerSandbox.settings),this.ChallengeOver()?this.GetScore():-1,_.ControllerGameGlobals.curChallengeID,1,this.finishSavingReplay):s.Database.SaveReplay(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,new C.Replay(this.cameraMovements,this.syncPoints,this.keyPresses,this.frameCounter,s.Database.VERSION_STRING_FOR_REPLAYS),"_ScoreReplay","This replay instanceof saved for a score",_.ControllerGameGlobals.curRobotID,new p.Robot(this.allParts,v.ControllerSandbox.settings),this.ChallengeOver()?this.GetScore():-1,_.ControllerGameGlobals.curChallengeID,1,this.finishSavingReplay),this.m_scoreWindow.ShowFader(),this.ShowDialog("Submitting score..."),a.Main.ShowHourglass()):this.clickedReport?(this.clickedReport=!1,this.reportButton()):this.backToSaveWindow&&(this.m_fader.visible=!0,this.m_chooserWindow.visible?e?this.m_chooserWindow.reportClicked():this.m_chooserWindow.HideFader():(this.m_chooserWindow.visible=!0,this.m_chooserWindow.dataType==SaveLoadWindow.HIGH_SCORE_TYPE?(s.Database.GetScoreData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,s.Database.highScoresChallenge,1==this.m_chooserWindow.m_scoreTypeBox.selectedIndex,2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex,e&&2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex?s.Database.SORT_BY_SCORE:s.Database.highScoresSortType,e&&2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex?1:s.Database.curScorePage,e&&this.m_chooserWindow.m_scoreTypeBox&&2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex?"":s.Database.curSearch,this.finishGettingScoreData),this.ShowDialog("Getting scores...")):this.m_chooserWindow.dataType==SaveLoadWindow.LOAD_ROBOT_TYPE?(s.Database.GetRobotData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,!this.m_chooserWindow.yourRobotsBox.selected,e&&this.m_chooserWindow.yourRobotsBox.selected?s.Database.SORT_BY_EDIT_TIME:s.Database.curSortType,e&&this.m_chooserWindow.yourRobotsBox.selected?s.Database.SORT_PERIOD_ALLTIME:s.Database.curSortPeriod,e&&this.m_chooserWindow.yourRobotsBox.selected?1:s.Database.curRobotPage,e&&this.m_chooserWindow.m_scoreTypeBox&&2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex?"":s.Database.curSearch,this.finishGettingLoadRobotData),this.ShowDialog("Getting robots...")):this.m_chooserWindow.dataType==SaveLoadWindow.LOAD_CHALLENGE_TYPE?(s.Database.curSortPeriod==s.Database.SORT_PERIOD_PROP&&(s.Database.curSortPeriod=s.Database.SORT_PERIOD_ALLTIME),s.Database.GetChallengeData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,!this.m_chooserWindow.yourRobotsBox.selected,e&&this.m_chooserWindow.yourRobotsBox.selected?s.Database.SORT_BY_EDIT_TIME:s.Database.curSortType,e&&this.m_chooserWindow.yourRobotsBox.selected?s.Database.SORT_PERIOD_ALLTIME:s.Database.curSortPeriod,e&&this.m_chooserWindow.yourRobotsBox.selected?1:s.Database.curReplayPage,e&&this.m_chooserWindow.m_scoreTypeBox&&2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex?"":s.Database.curSearch,this.finishGettingLoadChallengeData),this.ShowDialog("Getting challenges...")):(s.Database.curSortPeriod==s.Database.SORT_PERIOD_PROP&&(s.Database.curSortPeriod=s.Database.SORT_PERIOD_ALLTIME),s.Database.GetReplayData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,!this.m_chooserWindow.yourRobotsBox.selected,e&&this.m_chooserWindow.yourRobotsBox.selected?s.Database.SORT_BY_EDIT_TIME:s.Database.curSortType,e&&this.m_chooserWindow.yourRobotsBox.selected?s.Database.SORT_PERIOD_ALLTIME:s.Database.curSortPeriod,e&&this.m_chooserWindow.yourRobotsBox.selected?1:s.Database.curReplayPage,e&&this.m_chooserWindow.m_scoreTypeBox&&2==this.m_chooserWindow.m_scoreTypeBox.selectedIndex?"":s.Database.curSearch,this.finishGettingLoadReplayData),this.ShowDialog("Getting replays...")),this.m_chooserWindow.ShowFader(),a.Main.ShowHourglass()))}viewReplayButton(){_.ControllerGameGlobals.viewingUnsavedReplay?(this.m_fader.visible=!1,this.m_scoreWindow.visible=!1,this.resetButton()):(this.resetButton(),_.ControllerGameGlobals.replay=new C.Replay(this.cameraMovements,this.syncPoints,this.keyPresses,this.frameCounter,s.Database.VERSION_STRING_FOR_REPLAYS),_.ControllerGameGlobals.replayParts=this.allParts.filter(this.IsPartOfRobot),_.ControllerGameGlobals.playingReplay=!0,a.Main.changeControllers=!0,_.ControllerGameGlobals.viewingUnsavedReplay=!0)}newButton(){if(a.Main.inIFrame)this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7);else{for(var t=!1,e=0;e<this.allParts.length;e++)if(this.allParts[e].isEditable){t=!0;break}this instanceof ControllerTutorial||this instanceof ControllerHomeMovies||this instanceof ControllerRubeGoldberg||this instanceof ControllerNewFeatures||this instanceof ControllerChallengeEditor||""!=_.ControllerGameGlobals.curRobotID&&("challenge"!==this.controllerType||""!=_.ControllerGameGlobals.curChallengeID)||!t&&"challenge"!==this.controllerType?this.ConfirmNewRobot():(this.m_fader.visible=!0,this.m_scoreWindow&&this.m_scoreWindow.visible&&this.m_scoreWindow.ShowFader(),this.ShowConfirmDialog("Exit to main menu?     (Unsaved changes will be lost)",4))}}saveButton(){if(!this.selectingCondition)if(a.Main.inIFrame)this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7);else{if(!_.ControllerGameGlobals.curRobotEditable||_.ControllerGameGlobals.playingReplay)return;"challenge"!==this.controllerType||ControllerChallenge.playChallengeMode?s.Database.ExportRobot(new p.Robot(this.allParts.filter(this.PartIsEditable),v.ControllerSandbox.settings,this.draw.m_drawXOff,this.draw.m_drawYOff,this.m_physScale),"","",1,1,0,this.finishExporting):(this.m_restrictionsDialog&&this.removeChild(this.m_restrictionsDialog),this.m_restrictionsDialog=new RestrictionsWindow(this),this.addChild(this.m_restrictionsDialog),this.saveAfterRestrictions=!0),this.m_fader.visible=!0,this.curAction=-1}}loadAndInsertButton(){!_.ControllerGameGlobals.curRobotEditable||this.selectingCondition||_.ControllerGameGlobals.playingReplay||(_.ControllerGameGlobals.loadAndInsert=!0,this.loadRobotButton())}loadButton(t=!0){this.selectingCondition||(a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):t&&_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic&&!_.ControllerGameGlobals.ratedCurReplay&&!D.LSOManager.HasRatedReplay(_.ControllerGameGlobals.curReplayID)?(_.ControllerGameGlobals.ratedCurReplay=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,1,1),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curChallengeID||!_.ControllerGameGlobals.curChallengePublic||_.ControllerGameGlobals.ratedCurChallenge||D.LSOManager.HasRatedChallenge(_.ControllerGameGlobals.curChallengeID)?!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curRobotID||!_.ControllerGameGlobals.curRobotPublic||_.ControllerGameGlobals.ratedCurRobot||D.LSOManager.HasRatedRobot(_.ControllerGameGlobals.curRobotID)?(this.m_fader.visible=!0,this.m_loadWindow&&this.removeChild(this.m_loadWindow),this.m_loadWindow=new LoadWindow(this),this.addChild(this.m_loadWindow)):(_.ControllerGameGlobals.ratedCurRobot=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,0,1),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.simStarted&&(this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0)):(_.ControllerGameGlobals.ratedCurChallenge=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,2,1),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.simStarted&&(this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0)))}loadRobotButton(t=!0){this.selectingCondition||(a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):t&&_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic&&!_.ControllerGameGlobals.ratedCurReplay&&!D.LSOManager.HasRatedReplay(_.ControllerGameGlobals.curReplayID)?(_.ControllerGameGlobals.ratedCurReplay=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,1,2),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curChallengeID||!_.ControllerGameGlobals.curChallengePublic||_.ControllerGameGlobals.ratedCurChallenge||D.LSOManager.HasRatedChallenge(_.ControllerGameGlobals.curChallengeID)?!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curRobotID||!_.ControllerGameGlobals.curRobotPublic||_.ControllerGameGlobals.ratedCurRobot||D.LSOManager.HasRatedRobot(_.ControllerGameGlobals.curRobotID)?(s.Database.GetRobotData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,s.Database.curShared,s.Database.curSortType,s.Database.curSortPeriod,s.Database.curShared?s.Database.curRobotPage:1,"",this.finishGettingLoadRobotData),this.m_fader.visible=!0,this.ShowDialog("Getting robots..."),a.Main.ShowHourglass(),this.curAction=-1):(_.ControllerGameGlobals.ratedCurRobot=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,0,2),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):(_.ControllerGameGlobals.ratedCurChallenge=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,2,2),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.simStarted&&(this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0)))}finishSaving(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_SAVE_ROBOT){var t=s.Database.FinishSavingRobot(e);""!=t&&(_.ControllerGameGlobals.curRobotID=t,_.ControllerGameGlobals.ratedCurRobot=!0,_.ControllerGameGlobals.curRobotPublic=_.ControllerGameGlobals.potentialRobotPublic,_.ControllerGameGlobals.curRobotFeatured=_.ControllerGameGlobals.potentialRobotFeatured,this.m_progressDialog.SetMessage("Save successful!"),this.m_progressDialog.HideInXSeconds(1),this.m_chooserWindow.visible=!1,this.removeChild(this.m_chooserWindow),this.m_chooserWindow=null,this.m_fader.visible=!1)}}finishGettingSaveRobotData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_ROBOT_DATA&&s.Database.FinishGettingRobotData(e)&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.SAVE_ROBOT_TYPE),this.addChild(this.m_chooserWindow))}finishGettingLoadRobotData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_ROBOT_DATA&&s.Database.FinishGettingRobotData(e)&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_ROBOT_TYPE),this.addChild(this.m_chooserWindow))}finishLoading(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_LOAD_ROBOT){var t=s.Database.FinishLoadingRobot(e);this.processLoadedRobot(t)}}processLoadedRobot(t){if(t){var e=t.allParts;if(_.ControllerGameGlobals.loadAndInsert){_.ControllerGameGlobals.loadAndInsert=!1;for(var s=!1,i=!1,l=!1,n=!1,c=!1,m=!1,P=!1,G=!1,u=!1,C=0;C<e.length;C++)e[C].isStatic&&(u=!0),e[C]instanceof nt.Circle&&(s=!0),e[C]instanceof rt.Rectangle&&(i=!0),e[C]instanceof b.Triangle&&(l=!0),e[C]instanceof r.FixedJoint&&(n=!0),e[C]instanceof d.RevoluteJoint&&(c=!0),e[C]instanceof h.PrismaticJoint&&(m=!0),e[C]instanceof g.Thrusters&&(P=!0),e[C]instanceof o.Cannon&&(G=!0);if("challenge"===this.controllerType&&(u&&!ControllerChallenge.challenge.fixateAllowed||s&&!ControllerChallenge.challenge.circlesAllowed||i&&!ControllerChallenge.challenge.rectanglesAllowed||l&&!ControllerChallenge.challenge.trianglesAllowed||n&&!ControllerChallenge.challenge.fixedJointsAllowed||c&&!ControllerChallenge.challenge.rotatingJointsAllowed||m&&!ControllerChallenge.challenge.slidingJointsAllowed||P&&!ControllerChallenge.challenge.thrustersAllowed||G&&!ControllerChallenge.challenge.cannonsAllowed))return this.m_fader.visible=!0,_.ControllerGameGlobals.loadAndInsert=!0,this.ShowDialog3("Sorry, that robot contains parts that are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),void a.Main.ShowMouse();_.ControllerGameGlobals.curRobotID="",this.allParts=this.allParts.concat(e),this.CheckIfPartsFit(),this.m_progressDialog.SetMessage("Load successful!"),this.m_progressDialog.HideInXSeconds(1),this.m_chooserWindow&&(this.m_chooserWindow.visible=!1,this.removeChild(this.m_chooserWindow),this.m_chooserWindow=null),this.m_fader.visible=!1,_.ControllerGameGlobals.curRobotEditable=_.ControllerGameGlobals.potentialRobotEditable,_.ControllerGameGlobals.curRobotPublic=!1,_.ControllerGameGlobals.curRobotFeatured=!1,this.redrawRobot=!0,this.CenterOnLoadedRobot()}else _.ControllerGameGlobals.curRobotID=_.ControllerGameGlobals.potentialRobotID,_.ControllerGameGlobals.ratedCurRobot=!1,_.ControllerGameGlobals.curRobotEditable=_.ControllerGameGlobals.potentialRobotEditable,_.ControllerGameGlobals.curRobotPublic=_.ControllerGameGlobals.potentialRobotPublic,_.ControllerGameGlobals.curRobotFeatured=_.ControllerGameGlobals.potentialRobotFeatured,_.ControllerGameGlobals.curReplayID="",_.ControllerGameGlobals.loadedParts=e,a.Main.changeControllers=!0,_.ControllerGameGlobals.playingReplay=!1,_.ControllerGameGlobals.initX=t.cameraX,_.ControllerGameGlobals.initY=t.cameraY,_.ControllerGameGlobals.initZoom=t.zoomLevel,t.challenge?(a.Main.nextControllerType=1,ControllerChallenge.challenge=t.challenge,ControllerChallenge.playChallengeMode=!0,ControllerChallenge.playOnlyMode=!0,v.ControllerSandbox.settings=t.challenge.settings,_.ControllerGameGlobals.curChallengeID=_.ControllerGameGlobals.potentialChallengeID,_.ControllerGameGlobals.ratedCurChallenge=!1,_.ControllerGameGlobals.curChallengePublic=!1,_.ControllerGameGlobals.curChallengeFeatured=!1,_.ControllerGameGlobals.justLoadedRobotWithChallenge=!0):(a.Main.nextControllerType=0,v.ControllerSandbox.settings=t.settings,_.ControllerGameGlobals.curChallengeID="")}}finishDeleting(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_DELETE_ROBOT){var t=s.Database.FinishDeletingRobot(e);if(""!=t){_.ControllerGameGlobals.curRobotID==t&&(_.ControllerGameGlobals.curRobotID=""),this.m_progressDialog.SetMessage("Delete successful!"),this.m_progressDialog.HideInXSeconds(1);var i=this.m_chooserWindow.dataType;this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,i),this.addChild(this.m_chooserWindow),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog)}}}finishExporting(t,e){this.m_chooserWindow&&(this.m_chooserWindow.visible=!1),this.m_exportDialog&&this.removeChild(this.m_exportDialog),this.m_exportDialog=new ExportWindow(this,t,e),this.m_fader.visible=!0,this.addChild(this.m_exportDialog)}saveReplayButton(){a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):(this.pauseButton(e),this.canSaveReplay?(this.AddSyncPoint(),_.ControllerGameGlobals.viewingUnsavedReplay?s.Database.ExportReplay(_.ControllerGameGlobals.replay,"","",_.ControllerGameGlobals.curRobotID,new p.Robot(this.allParts,v.ControllerSandbox.settings),-1,"",1,this.finishExporting):s.Database.ExportReplay(new C.Replay(this.cameraMovements,this.syncPoints,this.keyPresses,this.frameCounter,s.Database.VERSION_STRING_FOR_REPLAYS),"","",_.ControllerGameGlobals.curRobotID,new p.Robot(this.allParts,v.ControllerSandbox.settings),-1,"",1,this.finishExporting)):(this.m_fader.visible=!0,this.frameCounter>=9e3?this.ShowDialog3("Sorry, you can only save replays that are under 5 minutes in length."):this.ShowDialog3("Sorry, you can only save replays that contain 500 or fewer cannonballs."),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()))}loadReplayButton(t=!0){this.selectingCondition||(a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):t&&_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic&&!_.ControllerGameGlobals.ratedCurReplay&&!D.LSOManager.HasRatedReplay(_.ControllerGameGlobals.curReplayID)?(_.ControllerGameGlobals.ratedCurReplay=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,1,3),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curChallengeID||!_.ControllerGameGlobals.curChallengePublic||_.ControllerGameGlobals.ratedCurChallenge||D.LSOManager.HasRatedChallenge(_.ControllerGameGlobals.curChallengeID)?!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curRobotID||!_.ControllerGameGlobals.curRobotPublic||_.ControllerGameGlobals.ratedCurRobot||D.LSOManager.HasRatedRobot(_.ControllerGameGlobals.curRobotID)?(s.Database.curSortPeriod==s.Database.SORT_PERIOD_PROP&&(s.Database.curSortPeriod=s.Database.SORT_PERIOD_ALLTIME),s.Database.GetReplayData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,s.Database.curShared,s.Database.curSortType,s.Database.curSortPeriod,s.Database.curShared?s.Database.curReplayPage:1,"",this.finishGettingLoadReplayData),this.ShowDialog("Getting replays..."),a.Main.ShowHourglass(),this.m_fader.visible=!0,this.curAction=-1):(_.ControllerGameGlobals.ratedCurRobot=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,0,3),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):(_.ControllerGameGlobals.ratedCurChallenge=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,2,3),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.simStarted&&(this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0)))}loadChallengeButton(t=!0){this.selectingCondition||(a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):t&&_.ControllerGameGlobals.playingReplay&&""!=_.ControllerGameGlobals.curReplayID&&_.ControllerGameGlobals.curReplayPublic&&!_.ControllerGameGlobals.ratedCurReplay&&!D.LSOManager.HasRatedReplay(_.ControllerGameGlobals.curReplayID)?(_.ControllerGameGlobals.ratedCurReplay=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,1,4),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curChallengeID||!_.ControllerGameGlobals.curChallengePublic||_.ControllerGameGlobals.ratedCurChallenge||D.LSOManager.HasRatedChallenge(_.ControllerGameGlobals.curChallengeID)?!t||_.ControllerGameGlobals.playingReplay||""==_.ControllerGameGlobals.curRobotID||!_.ControllerGameGlobals.curRobotPublic||_.ControllerGameGlobals.ratedCurRobot||D.LSOManager.HasRatedRobot(_.ControllerGameGlobals.curRobotID)?(s.Database.curSortPeriod==s.Database.SORT_PERIOD_PROP&&(s.Database.curSortPeriod=s.Database.SORT_PERIOD_ALLTIME),s.Database.GetChallengeData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,s.Database.curShared,s.Database.curSortType,s.Database.curSortPeriod,s.Database.curShared?s.Database.curReplayPage:1,"",this.finishGettingLoadChallengeData),this.ShowDialog("Getting challenges..."),a.Main.ShowHourglass(),this.m_fader.visible=!0,this.curAction=-1):(_.ControllerGameGlobals.ratedCurRobot=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,0,4),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0):(_.ControllerGameGlobals.ratedCurChallenge=!0,this.m_rateDialog&&this.removeChild(this.m_rateDialog),this.m_rateDialog=new RateWindow(this,2,4),this.addChild(this.m_rateDialog),this.m_fader.visible=!0,this.simStarted&&(this.m_guiPanel.ShowPausePanel(!_.ControllerGameGlobals.playingReplay),this.paused=!0)))}LoadReplayNow(t){s.Database.LoadReplayByID(t,this.finishLoadingReplay),this.ShowDialog("Loading Replay..."),this.m_fader.visible=!0}LoadRobotNow(t){s.Database.LoadRobotByID(t,this.finishLoading),this.ShowDialog("Loading Robot..."),this.m_fader.visible=!0}LoadChallengeNow(t){s.Database.LoadChallengeByID(t,this.finishLoadingChallenge),this.ShowDialog("Loading Challenge..."),this.m_fader.visible=!0}highScoresButton(){this.selectingCondition||(a.Main.inIFrame?(this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7)):(""==_.ControllerGameGlobals.curChallengeID?(s.Database.GetChallengeData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,!0,s.Database.curSortType,s.Database.curSortPeriod,s.Database.curChallengePage,"",this.finishGettingLoadChallengeForScoreData),this.ShowDialog("Getting challenges...")):(s.Database.GetScoreData(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,_.ControllerGameGlobals.curChallengeID,s.Database.highScoresDaily,s.Database.highScoresPersonal,s.Database.highScoresSortType,s.Database.curScorePage,"",this.finishGettingScoreData),this.ShowDialog("Getting high scores...")),a.Main.ShowHourglass(),this.m_fader.visible=!0,this.curAction=-1))}submitButton(){if(a.Main.inIFrame)this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7);else{if(!_.ControllerGameGlobals.curRobotEditable)return;"_Public"!=_.ControllerGameGlobals.userName?(this.AddSyncPoint(),_.ControllerGameGlobals.viewingUnsavedReplay?s.Database.SaveReplay(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,_.ControllerGameGlobals.replay,"_ScoreReplay","This replay instanceof saved for a score",_.ControllerGameGlobals.curRobotID,new p.Robot(this.allParts,v.ControllerSandbox.settings),this.ChallengeOver()?this.GetScore():-1,_.ControllerGameGlobals.curChallengeID,1,this.finishSavingReplay):s.Database.SaveReplay(_.ControllerGameGlobals.userName,_.ControllerGameGlobals.password,new C.Replay(this.cameraMovements,this.syncPoints,this.keyPresses,this.frameCounter,s.Database.VERSION_STRING_FOR_REPLAYS),"_ScoreReplay","This replay instanceof saved for a score",_.ControllerGameGlobals.curRobotID,new p.Robot(this.allParts,v.ControllerSandbox.settings),this.ChallengeOver()?this.GetScore():-1,_.ControllerGameGlobals.curChallengeID,1,this.finishSavingReplay),this.m_scoreWindow.ShowFader(),this.ShowDialog("Submitting score..."),this.clickedSubmitScore=!0):(this.clickedSubmitScore=!0,this.loginButton(!0,!1))}}finishAddingUser(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_ADD_USER){var t=s.Database.FinishAddingUser(e);""!=t&&(this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_loginWindow&&(this.m_loginWindow.visible=!1),this.m_newUserWindow.visible=!1,this.m_scoreWindow&&this.m_scoreWindow.visible||(this.m_fader.visible=!1),a.Main.premiumMode=!1,_.ControllerGameGlobals.userName=t.substring(t.indexOf("user: ")+6,t.indexOf("password: ")-1),_.ControllerGameGlobals.password=t.substring(t.indexOf("password: ")+10,t.indexOf("session: ")-1),_.ControllerGameGlobals.sessionID=t.substr(t.indexOf("session: ")+9),this.m_guiPanel.ShowLogout(),this.loginHidden(!0))}}finishLoggingIn(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_LOGIN){var t=s.Database.FinishLoggingIn(e);""!=t&&(this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_loginWindow.visible=!1,this.m_scoreWindow&&this.m_scoreWindow.visible||(this.m_fader.visible=!1),0==t.indexOf("premium")?a.Main.premiumMode=!0:a.Main.premiumMode=!1,_.ControllerGameGlobals.userName=t.substring(t.indexOf("user: ")+6,t.indexOf("password: ")-1),_.ControllerGameGlobals.password=t.substring(t.indexOf("password: ")+10,t.indexOf("session: ")-1),_.ControllerGameGlobals.sessionID=t.substr(t.indexOf("session: ")+9),this.m_guiPanel.ShowLogout(),this.loginHidden(!0)),a.Main.ShowMouse()}}finishSavingReplay(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_SAVE_REPLAY){var t=s.Database.FinishSavingReplay(e);""!=t&&(_.ControllerGameGlobals.curRobotID=t,_.ControllerGameGlobals.ratedCurRobot=!0,_.ControllerGameGlobals.curRobotPublic=!1,this.m_progressDialog.SetMessage("Save successful!"),this.m_progressDialog.HideInXSeconds(1),this.m_chooserWindow&&(this.m_chooserWindow.visible=!1,this.removeChild(this.m_chooserWindow),this.m_chooserWindow=null),this.m_scoreWindow&&this.m_scoreWindow.visible?this.clickedSubmitScore?(this.clickedSubmitScore=!1,this.m_progressDialog.visible=!1,this.highScoresButton(new MouseEvent(""))):(this.m_scoreWindow.HideFader(),a.Main.ShowMouse()):this.m_fader.visible=!1)}}finishGettingSaveReplayData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_REPLAY_DATA&&s.Database.FinishGettingReplayData()&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.SAVE_REPLAY_TYPE),this.addChild(this.m_chooserWindow),this.m_fader.visible=!0)}finishGettingLoadReplayData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_REPLAY_DATA&&s.Database.FinishGettingReplayData()&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_REPLAY_TYPE),this.addChild(this.m_chooserWindow),this.m_fader.visible=!0)}finishLoadingReplay(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_LOAD_REPLAY){var t=s.Database.FinishLoadingReplay(e);this.processLoadedReplay(t)}}processLoadedReplay(t){if(t)if(_.ControllerGameGlobals.replay=t[0],_.ControllerGameGlobals.replay.version!=s.Database.VERSION_STRING_FOR_REPLAYS)_.ControllerGameGlobals.replayDirectlyLinked?a.Main.inIFrame?a.Main.BrowserRedirect("http://incredibots.com/old/"+_.ControllerGameGlobals.replay.version+"/incredibots.php?replayID="+_.ControllerGameGlobals.potentialReplayID):a.Main.BrowserRedirect("http://incredibots.com/old/"+_.ControllerGameGlobals.replay.version+"/?replayID="+_.ControllerGameGlobals.potentialReplayID):(this.ShowConfirmDialog("This replay was saved using an older version of IncrediBots.  Redirect there now?",6),a.Main.ShowMouse());else{var e=t[1];_.ControllerGameGlobals.replayParts=e.allParts,v.ControllerSandbox.settings=e.settings,_.ControllerGameGlobals.playingReplay=!0,_.ControllerGameGlobals.viewingUnsavedReplay=!1,a.Main.changeControllers=!0,a.Main.nextControllerType=0,_.ControllerGameGlobals.curRobotID=_.ControllerGameGlobals.potentialRobotID,_.ControllerGameGlobals.ratedCurReplay=!0,_.ControllerGameGlobals.curReplayID=_.ControllerGameGlobals.potentialReplayID,_.ControllerGameGlobals.ratedCurReplay=!1,_.ControllerGameGlobals.curReplayPublic=_.ControllerGameGlobals.potentialReplayPublic,_.ControllerGameGlobals.curReplayFeatured=_.ControllerGameGlobals.potentialReplayFeatured,_.ControllerGameGlobals.curChallengeID="",_.ControllerGameGlobals.curChallengePublic=!1,_.ControllerGameGlobals.curChallengeFeatured=!1}}finishDeletingReplay(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_DELETE_REPLAY&&s.Database.FinishDeletingReplay()){this.m_progressDialog.SetMessage("Delete successful!"),this.m_progressDialog.HideInXSeconds(1);var t=this.m_chooserWindow.dataType;this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,t),this.addChild(this.m_chooserWindow),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog)}}finishSavingChallenge(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_SAVE_CHALLENGE){var t=s.Database.FinishSavingChallenge();""!=t&&(_.ControllerGameGlobals.curChallengeID=t,_.ControllerGameGlobals.ratedCurChallenge=!0,_.ControllerGameGlobals.curChallengePublic=!1,_.ControllerGameGlobals.curChallengeFeatured=!1,this.m_progressDialog.SetMessage("Save successful!"),this.m_progressDialog.HideInXSeconds(1),this.m_chooserWindow&&(this.m_chooserWindow.visible=!1,this.removeChild(this.m_chooserWindow),this.m_chooserWindow=null),this.m_scoreWindow&&this.m_scoreWindow.visible?(this.m_scoreWindow.HideFader(),a.Main.ShowMouse()):this.m_fader.visible=!1)}}finishLoadingChallenge(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_LOAD_CHALLENGE){var t=s.Database.FinishLoadingChallenge();this.processLoadedChallenge(t)}}processLoadedChallenge(t){t&&(a.Main.changeControllers=!0,a.Main.nextControllerType=1,_.ControllerGameGlobals.playingReplay=!1,ControllerChallenge.challenge=t,ControllerChallenge.playChallengeMode=!_.ControllerGameGlobals.potentialChallengeEditable,ControllerChallenge.playOnlyMode=!_.ControllerGameGlobals.potentialChallengeEditable,v.ControllerSandbox.settings=t.settings,_.ControllerGameGlobals.curChallengeID=_.ControllerGameGlobals.potentialChallengeID,_.ControllerGameGlobals.ratedCurChallenge=!1,_.ControllerGameGlobals.curChallengePublic=_.ControllerGameGlobals.potentialChallengePublic,_.ControllerGameGlobals.curChallengeFeatured=_.ControllerGameGlobals.potentialChallengeFeatured,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.curReplayID="",_.ControllerGameGlobals.loadedParts=t.allParts,_.ControllerGameGlobals.initX=t.cameraX,_.ControllerGameGlobals.initY=t.cameraY,_.ControllerGameGlobals.initZoom=t.zoomLevel)}finishGettingSaveChallengeData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_CHALLENGE_DATA&&s.Database.FinishGettingChallengeData()&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.SAVE_CHALLENGE_TYPE),this.addChild(this.m_chooserWindow),this.m_fader.visible=!0)}finishGettingLoadChallengeData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_CHALLENGE_DATA&&s.Database.FinishGettingChallengeData()&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_CHALLENGE_TYPE),this.addChild(this.m_chooserWindow),this.m_fader.visible=!0)}finishGettingLoadChallengeForScoreData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_CHALLENGE_DATA&&s.Database.FinishGettingChallengeData()&&(this.m_progressDialog.visible=!1,this.m_challengeWindow&&this.removeChild(this.m_challengeWindow),this.m_challengeWindow=new ChooseChallengeWindow(this),this.addChild(this.m_challengeWindow),this.m_fader.visible=!0)}finishDeletingChallenge(){if(s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_DELETE_CHALLENGE&&s.Database.FinishDeletingChallenge()){this.m_progressDialog.SetMessage("Delete successful!"),this.m_progressDialog.HideInXSeconds(1);var t=this.m_chooserWindow.dataType;this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,t),this.addChild(this.m_chooserWindow),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog)}}finishGettingScoreData(){s.Database.waitingForResponse&&s.Database.curTransactionType==s.Database.ACTION_GET_SCORE_DATA&&s.Database.FinishGettingScoreData()&&(this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.removeChild(this.m_chooserWindow),this.m_chooserWindow=new SaveLoadWindow(this,SaveLoadWindow.HIGH_SCORE_TYPE),this.addChild(this.m_chooserWindow),this.m_fader.visible=!0)}ConfirmSaveRobot(){this.m_chooserWindow.saveRobotButtonPressed(!0)}ConfirmSaveReplay(){this.m_chooserWindow.saveReplayButtonPressed(!0)}ConfirmSaveChallenge(){this.m_chooserWindow.saveChallengeButtonPressed(!0)}ConfirmDeleteRobot(){this.m_chooserWindow.deleteRobotButtonPressed(!0)}ConfirmDeleteReplay(){this.m_chooserWindow.deleteReplayButtonPressed(!0)}ConfirmDeleteChallenge(){this.m_chooserWindow.deleteChallengeButtonPressed(!0)}ShowImportWindow(t){this.m_importDialog&&this.removeChild(this.m_importDialog),this.m_importDialog=new T.ImportWindow(this,t),this.m_fader.visible=!0,this.addChild(this.m_importDialog)}ShowConfirmDialog(t,e){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,t,!0,!1,8==e),this.addChild(this.m_progressDialog),this.m_progressDialog.ShowOKAndCancelButton(e)}ShowDisabledDialog(){this.m_fader.visible=!0,this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,"That feature has been disabled for this level.",!0),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),this.addChild(this.m_progressDialog)}ShowDialog(t){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,t),this.addChild(this.m_progressDialog)}ShowDialog2(t){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,t,!0,!0),this.addChild(this.m_progressDialog)}ShowDialog3(t){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,t,!0),this.addChild(this.m_progressDialog)}ShowTutorialWindow(t,e,s,i=!1){this.m_tutorialDialog&&this.removeChild(this.m_tutorialDialog),this.m_tutorialDialog=new TutorialWindow(this,e,s,t,i),this.addChild(this.m_tutorialDialog)}CloseTutorialDialog(t){this.m_tutorialDialog.visible=!1}ShowLinkDialog(t,e,s=!1,i="",a=!1){this.m_linkDialog&&this.removeChild(this.m_linkDialog),this.m_linkDialog=new LinkWindow(this,t,e,s,i,a),this.addChild(this.m_linkDialog)}DialogOK(){this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible&&this.m_chooserWindow.HideFader(),this.m_challengeWindow&&this.m_challengeWindow.visible&&this.m_challengeWindow.HideFader(),this.m_newUserWindow&&this.m_newUserWindow.visible&&this.m_newUserWindow.HideFader(),this.m_loginWindow&&this.m_loginWindow.visible&&this.m_loginWindow.HideFader(),this.m_scoreWindow&&this.m_scoreWindow.visible&&this.m_scoreWindow.HideFader(),this.m_restrictionsDialog&&this.m_restrictionsDialog.visible&&this.m_restrictionsDialog.HideFader(),this.m_conditionsDialog&&this.m_conditionsDialog.visible&&this.m_conditionsDialog.HideFader()}HideDialog(){s.Database.nonfatalErrorOccurred?(s.Database.nonfatalErrorOccurred=!1,this.m_chooserWindow&&this.m_chooserWindow.HideFader(),this.m_challengeWindow&&this.m_challengeWindow.HideFader(),this.m_newUserWindow&&this.m_newUserWindow.visible?this.m_newUserWindow.HideFader():this.m_loginWindow&&this.m_loginWindow.HideFader()):(this.m_fader.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible&&(this.m_fader.visible=!0,this.m_chooserWindow.HideFader()),this.m_challengeWindow&&this.m_challengeWindow.visible&&(this.m_fader.visible=!0,this.m_challengeWindow.HideFader()),this.m_newUserWindow&&this.m_newUserWindow.visible?this.m_newUserWindow.visible=!1:this.m_loginWindow&&this.m_loginWindow.visible?this.m_loginWindow.visible=!1:this.m_scoreWindow&&this.m_scoreWindow.visible?(this.m_fader.visible=!0,this.m_scoreWindow.HideFader()):this.m_postReplayWindow&&this.m_postReplayWindow.visible&&(this.m_fader.visible=!0,this.m_postReplayWindow.HideFader())),this.m_progressDialog.visible=!1,_.ControllerGameGlobals.failedChallenge&&this.resetButton(new MouseEvent("")),_.ControllerGameGlobals.failedChallenge=!1}HideLinkDialog(){this.m_linkDialog.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible?this.m_chooserWindow.HideFader():this.m_fader.visible=!1}HideExportDialog(){this.m_exportDialog.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible&&this.m_chooserWindow.HideFader(),this.m_fader.visible=!1}HideImportDialog(){this.m_importDialog.visible=!1,this.m_fader.visible=!1}HideConfirmDialog(){this.m_progressDialog.visible=!1,this.m_chooserWindow&&this.m_chooserWindow.visible?this.m_chooserWindow.HideFader():this.m_scoreWindow&&this.m_scoreWindow.visible?this.m_scoreWindow.HideFader():this.m_fader.visible=!1}ShowPostReplayWindow(){this.m_postReplayWindow&&this.removeChild(this.m_postReplayWindow),this.m_postReplayWindow=new PostReplayWindow(this),this.addChild(this.m_postReplayWindow),this.m_fader.visible=!0}DeletePart(t,e=!0,s=!0){this.allParts=i.Util.RemoveFromArray(t,this.allParts),s&&(this.selectedParts=i.Util.RemoveFromArray(t,this.selectedParts)),t.isEnabled=!1;var a,l=new Array;if(t instanceof c.ShapePart)do{a=!1;for(var o=0;o<this.allParts.length;o++)if(a)o!=this.allParts.length-1&&(this.allParts[o]=this.allParts[o+1]);else if(this.allParts[o]instanceof n.JointPart){var r=this.allParts[o];r.part1!=t&&r.part2!=t||(a=!0,l.push(r),r.isEnabled=!1,s&&(this.selectedParts=i.Util.RemoveFromArray(r,this.selectedParts)),o!=this.allParts.length-1&&(this.allParts[o]=this.allParts[o+1]))}else if(this.allParts[o]instanceof g.Thrusters){var h=this.allParts[o];h.shape==t&&(a=!0,l.push(h),h.isEnabled=!1,s&&(this.selectedParts=i.Util.RemoveFromArray(h,this.selectedParts)),o!=this.allParts.length-1&&(this.allParts[o]=this.allParts[o+1]))}a&&this.allParts.pop()}while(a);else t instanceof m.TextPart&&(t.m_textField.visible=!1);e&&this.AddAction(new N.DeleteAction(t,l)),this.CheckIfPartsFit(),_.ControllerGameGlobals.curRobotID=""}CreateWorld(){var t=new x.b2AABB;t.lowerBound.Set(-300,-200),t.upperBound.Set(300,200),this.m_world=x.b2World.Create(this.GetGravity()),this.m_groundBody=this.m_world.CreateBody();var e=new lt.ContactFilter;this.m_world.SetContactFilter(e);var s=new ot.ContactListener(this);this.m_world.SetContactListener(s)}GetGravity(){return new x.b2Vec2(0,15)}TooManyShapes(){return this.allParts.filter(this.PartIsPhysical).length>500}IsPartOfRobot(t,e,s){return t.drawAnyway}PartIsEditable(t,e,s){return t.isEditable}PartIsShape(t,e,s){return t instanceof c.ShapePart}PartIsPhysical(t,e,s){return t instanceof c.ShapePart||t instanceof h.PrismaticJoint}FindCenterOfRobot(){for(var t=null,e=0,s=0;s<this.allParts.length;s++)if(this.allParts[s].isEditable&&this.allParts[s]instanceof c.ShapePart&&this.allParts[s].isEnabled&&this.allParts[s].m_collisionGroup==-(s+1)){for(var a=this.allParts[s].GetAttachedParts().filter(this.PartIsShape),l=0,o=new Array,r=new Array,n=0;n<a.length;n++)i.Util.ObjectInArray(a[n].GetBody(),o)||(l+=a[n].GetMass(),o.push(a[n].GetBody()),r.push(a[n]));l>e&&(e=l,t=r)}if(!t)return null;var h=-1,d=0;for(s=0;s<t.length;s++){var m=t[s].GetMass();m>d&&(d=m,h=s)}return-1==h?null:t[h]}Zoom(t){var e=this.m_physScale,s=(_.ControllerGameGlobals.ZOOM_FOCUS_X+this.draw.m_drawXOff)/this.m_physScale,i=(_.ControllerGameGlobals.ZOOM_FOCUS_Y+this.draw.m_drawYOff)/this.m_physScale;t?(this.m_physScale*=4/3,this.m_physScale>_.ControllerGameGlobals.MAX_ZOOM_VAL&&(this.m_physScale=_.ControllerGameGlobals.MAX_ZOOM_VAL)):(this.m_physScale*=.75,this.m_physScale<_.ControllerGameGlobals.MIN_ZOOM_VAL&&(this.m_physScale=_.ControllerGameGlobals.MIN_ZOOM_VAL)),this.draw.m_drawXOff=s*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_X,this.draw.m_drawYOff=i*this.m_physScale-_.ControllerGameGlobals.ZOOM_FOCUS_Y,e!=this.m_physScale&&(this.hasZoomed=!0),this.simStarted&&this.cameraMovements.push(new P.CameraMovement(this.frameCounter,this.autoPanning?Number.POSITIVE_INFINITY:this.draw.m_drawXOff,this.autoPanning?Number.POSITIVE_INFINITY:this.draw.m_drawYOff,this.m_physScale))}MaybeCreateJoint(){var t=new Array,e=_.ControllerGameGlobals.mouseXWorldPhys,s=_.ControllerGameGlobals.mouseYWorldPhys,i=this.FindPartToSnapTo();_.ControllerGameGlobals.snapToCenter&&i&&(e=i.centerX,s=i.centerY);for(var a=this.allParts.length-1;a>=0;a--)if(this.allParts[a]instanceof c.ShapePart&&this.allParts[a].isEditable&&this.allParts[a].isEnabled){var l=this.allParts[a];l.InsideShape(e,s,this.m_physScale)&&t.push(l)}if(2==t.length){if(this.curAction==_.ControllerGameGlobals.NEW_REVOLUTE_JOINT){var o=new d.RevoluteJoint(t[0],t[1],e,s);this.copiedJoint instanceof d.RevoluteJoint&&o.SetJointProperties(this.copiedJoint),this.allParts.push(o),this.AddAction(new J.CreateAction(o)),this.m_sidePanel.ShowJointPanel(o),this.selectedParts=new Array,this.selectedParts.push(o),this.curAction=-1,_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.PlayJointSound()}else if(this.curAction==_.ControllerGameGlobals.NEW_FIXED_JOINT){var n=new r.FixedJoint(t[0],t[1],e,s);this.allParts.push(n),this.AddAction(new J.CreateAction(n)),this.m_sidePanel.ShowJointPanel(n),this.selectedParts=new Array,this.selectedParts.push(n),this.curAction=-1,_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.PlayJointSound()}_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0}else t.length>2?(this.potentialJointPart1=t[0],this.potentialJointPart2=t[1],this.potentialJointPart1.highlightForJoint=!0,this.potentialJointPart2.highlightForJoint=!0,this.candidateJointX=e,this.candidateJointY=s,this.candidateJointType=this.curAction,this.candidateJointParts=t,this.curAction=_.ControllerGameGlobals.FINALIZING_JOINT):(this.curAction=-1,this.redrawRobot=!0)}MaybeCreateThrusters(){var t=new Array,e=_.ControllerGameGlobals.mouseXWorldPhys,s=_.ControllerGameGlobals.mouseYWorldPhys,i=this.FindPartToSnapTo();_.ControllerGameGlobals.snapToCenter&&i&&(e=i.centerX,s=i.centerY);for(var a=this.allParts.length-1;a>=0;a--)if(this.allParts[a]instanceof c.ShapePart&&this.allParts[a].isEditable&&this.allParts[a].isEnabled){var l=this.allParts[a];l.InsideShape(e,s,this.m_physScale)&&t.push(l)}if(1==t.length){var o=new g.Thrusters(t[0],e,s);this.copiedThrusters&&(o.strength=this.copiedThrusters.strength,o.angle=this.copiedThrusters.angle,o.thrustKey=this.copiedThrusters.thrustKey,o.autoOn=this.copiedThrusters.autoOn),this.allParts.push(o),this.AddAction(new J.CreateAction(o)),this.m_sidePanel.ShowThrustersPanel(o),this.selectedParts=new Array,this.selectedParts.push(o),this.curAction=-1,_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),_.ControllerGameGlobals.curRobotID="",this.redrawRobot=!0,this.PlayJointSound()}else t.length>1?(this.potentialJointPart1=t[0],this.potentialJointPart1.highlightForJoint=!0,this.candidateJointX=e,this.candidateJointY=s,this.candidateJointType=this.curAction,this.candidateJointParts=t,this.curAction=_.ControllerGameGlobals.FINALIZING_JOINT):(this.curAction=-1,this.redrawRobot=!0)}MaybeStartCreatingPrismaticJoint(){var t=new Array,e=_.ControllerGameGlobals.mouseXWorldPhys,s=_.ControllerGameGlobals.mouseYWorldPhys,i=this.FindPartToSnapTo();_.ControllerGameGlobals.snapToCenter&&i&&(e=i.centerX,s=i.centerY);for(var a=this.allParts.length-1;a>=0;a--)if(this.allParts[a]instanceof c.ShapePart&&this.allParts[a].isEditable&&this.allParts[a].isEnabled){var l=this.allParts[a];l.InsideShape(e,s,this.m_physScale)&&t.push(l)}0==t.length?(this.curAction=-1,this.redrawRobot=!0):1==t.length?(this.jointPart=t[0],this.firstClickX=e,this.firstClickY=s,this.actionStep++,this.PlayJointSound()):(this.potentialJointPart1=t[0],this.potentialJointPart1.highlightForJoint=!0,this.candidateJointX=e,this.candidateJointY=s,this.candidateJointType=this.curAction,this.candidateJointParts=t,this.curAction=_.ControllerGameGlobals.FINALIZING_JOINT)}MaybeFinishCreatingPrismaticJoint(){var t=new Array,e=_.ControllerGameGlobals.mouseXWorldPhys,s=_.ControllerGameGlobals.mouseYWorldPhys,i=this.FindPartToSnapTo();_.ControllerGameGlobals.snapToCenter&&i&&(e=i.centerX,s=i.centerY);for(var a=this.allParts.length-1;a>=0;a--)if(this.allParts[a]instanceof c.ShapePart&&this.allParts[a].isEditable&&this.allParts[a]!=this.jointPart){var l=this.allParts[a];l.InsideShape(e,s,this.m_physScale)&&t.push(l)}if(1==t.length){var o=new h.PrismaticJoint(this.jointPart,t[0],this.firstClickX,this.firstClickY,e,s);this.copiedJoint instanceof h.PrismaticJoint&&o.SetJointProperties(this.copiedJoint),this.allParts.push(o),this.AddAction(new J.CreateAction(o)),this.m_sidePanel.ShowJointPanel(o),this.selectedParts=new Array,this.selectedParts.push(o),this.curAction=-1,this.jointPart.highlightForJoint=!1,_.ControllerGameGlobals.curRobotID="",_.ControllerGameGlobals.centerOnSelected&&this.CenterOnSelected(),this.redrawRobot=!0,this.PlayJointSound()}else t.length>1?(this.potentialJointPart1=t[0],this.potentialJointPart1.highlightForJoint=!0,this.candidateJointX=e,this.candidateJointY=s,this.candidateJointType=this.curAction,this.candidateJointParts=t,this.curAction=_.ControllerGameGlobals.FINALIZING_JOINT):0==t.length&&(this.curAction=-1,this.redrawRobot=!0)}FindPartToSnapTo(t=null){for(var e=null,s=Number.MAX_VALUE,a=0;a<this.allParts.length;a++)if(this.allParts[a]instanceof c.ShapePart&&this.allParts[a]!=t&&this.allParts[a].isEditable){var l=this.allParts[a],o=i.Util.GetDist(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys,l.centerX,l.centerY);o<s&&(s=o,e=l)}return s<12/this.m_physScale?e:null}GetBodyAtMouse(){var t=new x.b2Vec2(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys),e=new x.b2AABB;e.lowerBound.Set(_.ControllerGameGlobals.mouseXWorldPhys-.001,_.ControllerGameGlobals.mouseYWorldPhys-.001),e.upperBound.Set(_.ControllerGameGlobals.mouseXWorldPhys+.001,_.ControllerGameGlobals.mouseYWorldPhys+.001);for(var s=this.m_world.QueryAllAABB(e),i=null,a=0;a<s.length;++a)if(s[a].m_body.GetType()!=x.b2BodyType.b2_staticBody&&!s[a].m_body.GetUserData().undragable&&-1==s[a].m_body.GetUserData().isPiston){var l=s[a];if(l.TestPoint(t)){i=l.GetBody();break}}return i}MouseOverSelectedPart(){for(var t=0;t<this.selectedParts.length;t++)if(this.selectedParts[t].InsideShape(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys,this.m_physScale))return!0;return!1}GetPartAtMouse(){for(var t=0;t<this.allParts.length;t++)if(this.allParts[t].isEditable&&this.allParts[t]instanceof m.TextPart&&this.allParts[t].InsideMoveBox(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys,this.m_physScale))return this.allParts[t];for(var e=new Array,s=-1,a=!0,l=!0,o=this.allParts.length-1;o>=0;o--)this.allParts[o].isEditable&&this.allParts[o].InsideShape(_.ControllerGameGlobals.mouseXWorldPhys,_.ControllerGameGlobals.mouseYWorldPhys,this.m_physScale)&&(i.Util.ObjectInArray(this.allParts[o],this.selectedParts)?(l=!1,-1==s&&(s=e.length)):a=!1,e.push(this.allParts[o]));if(0==e.length)return null;if(1==e.length||a||l)return e[0];for(o=(s+1)%e.length;o!=s;o=(o+1)%e.length)if(!i.Util.ObjectInArray(e[o],this.selectedParts))return e[o];return null}}exports.ControllerGame=ht;
},{"pixi.js":"aQiP","../General/Database":"CVYw","../General/Util":"Zvyo","../Main":"aM6Q","../Parts/Part":"eAVa","../Parts/Cannon":"vdN1","../Parts/FixedJoint":"QW19","../Parts/JointPart":"avwv","../Parts/PrismaticJoint":"nZSh","../Parts/RevoluteJoint":"AUAw","../Parts/ShapePart":"CDAe","../Parts/TextPart":"T0pq","../Parts/Thrusters":"Yw1p","../Parts/Triangle":"CRRv","./CameraMovement":"s2SF","./Controller":"T7gT","./Draw":"tHDu","./Replay":"odHz","./Robot":"H0hU","./Globals/ControllerGameGlobals":"K8aL","../General/Input":"xLqP","../Actions/Action":"xELh","../Gui/MainEditPanel":"YujO","../Gui/DropDownMenu":"qU8f","../Gui/PartEditWindow":"O6IY","../General/LSOManager":"unNJ","../Gui/AdvancedSandboxWindow":"kpwL","../Gui/ImportWindow":"F66q","./ControllerSandbox":"v13b","./KeyPress":"pdwH","./ReplaySyncPoint":"TXMb","@box2d/core":"kjbO","../Actions/CameraAction":"zJxm","../Actions/ChangeSliderAction":"wdsq","../Actions/ClearAction":"wJ8e","../Actions/ColourChangeAction":"VT9P","../Actions/ControlKeyAction":"gn4K","../Actions/CreateAction":"irRs","../Actions/DeleteAction":"cRW3","../Actions/EnterTextAction":"gzRi","../Actions/JointCheckboxAction":"BvkN","../Actions/LimitChangeAction":"a7X3","../Actions/MassCreateAction":"a0WD","../Actions/MoveAction":"fZPQ","../Actions/MoveZAction":"xG66","../Actions/MultiCollideAction":"Ta8o","../Actions/MultiColourChangeAction":"f3tu","../Actions/MultiFixateAction":"eBnP","../Actions/MultiOutlineAction":"mnQg","../Actions/MultiTerrainAction":"oMea","../Actions/MultiUndragableAction":"uT1E","../Actions/ResizeShapesAction":"l0X7","../Actions/ResizeTextAction":"VEDY","../Actions/RotateAction":"SMyw","../Actions/ShapeCheckboxAction":"V2A2","../Actions/TextCheckboxAction":"vJ2q","../Actions/TextSizeChangeAction":"c1cn","./ContactFilter":"u77w","./ContactListener":"sy4E","../Parts/Rectangle":"jYSx","../Parts/Circle":"PfXD"}],"a6nr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Gradient=void 0;const e=require("pixi.js");class t{static getLinearGradientTexture([t,r]){const o=document.createElement("canvas");o.width=1,o.height=512;const i=o.getContext("2d"),a=i.createLinearGradient(0,0,0,512);return a.addColorStop(0,t),a.addColorStop(1,r),i.fillStyle=a,i.fillRect(0,0,1,512),e.Texture.from(o)}}exports.Gradient=t;
},{"pixi.js":"aQiP"}],"cNJr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sky=void 0;const t=require("pixi.js"),s=require("@box2d/core"),i=require("../../General/Util"),e=require("../ControllerMainMenu"),o=require("../SandboxSettings"),h=require("./Gradient"),n=require("./Resource");class d{constructor(l,r,u=0,c=0,a=0){this.sClouds=new Array,this.cloudPositions=new Array,this.cloudVelocities=new Array,this.starRadii=new Array,this.cont=l,this.skyType=r,this.sky=new t.Container;const C=new t.Sprite(h.Gradient.getLinearGradientTexture(r==o.SandboxSettings.BACKGROUND_SOLID_COLOUR?[i.Util.HexColourString(u,c,a),i.Util.HexColourString(u,c,a)]:[d.topColours[r],d.bottomColours[r]]));if(C.position.set(0,0),C.width=800,C.height=600,this.sky.addChild(C),this.cont.addChild(this.sky),this.lastCloudIndex=this.cont.getChildIndex(this.sky),this.numClouds=0,0==r){this.numClouds=Math.min((this.cont.GetMaxX()-this.cont.GetMinX())/10,15);for(var x=0;x<this.numClouds;x++){var y=new t.Sprite,R=10*Math.random();0==R&&(y.texture=n.Resource.cCloud0),1==R&&(y.texture=n.Resource.cCloud1),2==R&&(y.texture=n.Resource.cCloud2),3==R&&(y.texture=n.Resource.cCloud3),4==R&&(y.texture=n.Resource.cCloud4),5==R&&(y.texture=n.Resource.cCloud5),6==R&&(y.texture=n.Resource.cCloud6),7==R&&(y.texture=n.Resource.cCloud7),8==R&&(y.texture=n.Resource.cCloud8),R>=9&&(y.texture=n.Resource.cCloud9),this.cont.addChild(y),this.lastCloudIndex=this.cont.getChildIndex(y),this.sClouds.push(y),this.cloudPositions.push(new s.b2Vec2(i.Util.RangedRandom(this.cont.GetMinX()-5,this.cont.GetMaxX()+5),i.Util.RangedRandom(-15,6))),this.cloudVelocities.push(3*Math.random()/120+1/120)}}else if(1==r){var p=this.cont.GetMaxX()-this.cont.GetMinX()+10;this.cont instanceof e.ControllerMainMenu&&(p*=1.5),this.numClouds=10*(this.cont.GetMaxX()-this.cont.GetMinX());var m=new t.Graphics;for(m.beginFill(11454938),m.drawCircle(0,0,1),m.drawCircle(90*p,0,1),m.drawCircle(0,90*p,1),m.drawCircle(90*p,90*p,1),m.endFill(),x=0;x<this.numClouds;x++)this.cloudPositions.push(i.Util.Vector(i.Util.RangedRandom(0,90*p),i.Util.RangedRandom(0,90*p))),this.cloudVelocities.push(0),this.starRadii.push(this.cont instanceof e.ControllerMainMenu?i.Util.RangedRandom(3,8):i.Util.RangedRandom(2,6)),m.beginFill(11454938),m.drawCircle(this.cloudPositions[x].x,this.cloudPositions[x].y,this.starRadii[x]),m.endFill();this.cont.addChild(m),this.lastCloudIndex=this.cont.getChildIndex(m),this.sClouds.push(m)}this.Update(!0,!0)}Update(t,s){if(t)if(0==this.skyType)for(var i=0;i<this.numClouds;i++)this.sClouds[i].width=this.sClouds[i].measuredWidth*this.cont.GetPhysScale()/90,this.sClouds[i].height=this.sClouds[i].measuredHeight*this.cont.GetPhysScale()/90;else 1==this.skyType&&(this.sClouds[0].width=this.cont.World2ScreenX(this.cont.GetMaxX()+5)-this.cont.World2ScreenX(this.cont.GetMinX()-5),this.sClouds[0].height=this.sClouds[0].width);if(0==this.skyType)for(i=0;i<this.numClouds;i++)this.cont.IsPaused()||(this.cloudPositions[i].x-=this.cloudVelocities[i],this.cloudPositions[i].x<this.cont.GetMinX()-5&&(this.cloudPositions[i].x=this.cont.GetMaxX()+5)),(!this.cont.IsPaused()||s||t)&&(this.sClouds[i].x=this.cont.World2ScreenX(this.cloudPositions[i].x)-this.sClouds[i].width/2,this.sClouds[i].y=this.cont.World2ScreenY(this.cloudPositions[i].y)-this.sClouds[i].height/2);else 1==this.skyType&&(!this.cont.IsPaused()||s||t)&&(this.sClouds[0].x=this.cont.World2ScreenX(this.cont.GetMinX()-5),this.sClouds[0].y=this.cont.World2ScreenY(this.cont.GetMinY()-5))}Delete(){if(this.cont.removeChild(this.sky),0==this.skyType)for(var t=0;t<this.numClouds;t++)this.cont.removeChild(this.sClouds[t]);else 1==this.skyType&&this.cont.removeChild(this.sClouds[0])}}exports.Sky=d,d.topColours=["#43B0F7","#171717","#292935","#22243C","#BE4A3C","#4790EC"],d.bottomColours=["#8ACEF7","#353738","#48475F","#40457E","#EB7A76","#EC8D66"];
},{"pixi.js":"aQiP","@box2d/core":"kjbO","../../General/Util":"Zvyo","../ControllerMainMenu":"rq5K","../SandboxSettings":"ZSAP","./Gradient":"a6nr","./Resource":"VWUR"}],"v13b":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ControllerSandbox=void 0;const t=require("pixi.js"),i=require("@box2d/core"),e=require("../General/Util"),r=require("../Parts/Circle"),s=require("../Parts/Rectangle"),n=require("../Parts/TextPart"),o=require("./ControllerGame"),a=require("./Graphics/Gradient"),h=require("./Graphics/Sky"),l=require("./SandboxSettings");class d extends o.ControllerGame{constructor(){super(),this.controllerType="sandbox",this.sGround=new t.Graphics,this.groundParts=new Array,this.BuildGround(!0)}BuildGround(i=!1){var e;if(this.sSky=new h.Sky(this,d.settings.background,d.settings.backgroundR,d.settings.backgroundG,d.settings.backgroundB),d.settings.terrainType==l.SandboxSettings.TERRAIN_LAND?d.settings.size==l.SandboxSettings.SIZE_LARGE?((e=new s.Rectangle(-247.7,12,495.4,12.5,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new r.Circle(-247.4,18.25,6.25,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new r.Circle(247.4,18.25,6.25,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e)):d.settings.size==l.SandboxSettings.SIZE_MEDIUM?((e=new s.Rectangle(-119.5,12,239,9,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new r.Circle(-119,16.5,4.5)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new r.Circle(119,16.5,4.5)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e)):((e=new s.Rectangle(-39.7,12,79.4,6,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new r.Circle(-39.4,15,3)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new r.Circle(39.4,15,3)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e)):d.settings.terrainType==l.SandboxSettings.TERRAIN_BOX&&(d.settings.size==l.SandboxSettings.SIZE_LARGE?((e=new s.Rectangle(-300,-180,600,40,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(-300,-180,40,230,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(260,-180,40,230,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(-300,10,600,40,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e)):d.settings.size==l.SandboxSettings.SIZE_MEDIUM?((e=new s.Rectangle(-170,-120,340,40,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(-170,-120,40,170,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(130,-120,40,170,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(-170,10,340,40,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e)):((e=new s.Rectangle(-60,-45,120,20,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(-60,-40,20,80,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(40,-40,20,80,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e),(e=new s.Rectangle(-60,10,120,20,!1)).isStatic=!0,e.isEditable=!1,e.drawAnyway=!1,e.isSandbox=!0,this.allParts.push(e),this.groundParts.push(e))),d.settings.terrainType==l.SandboxSettings.TERRAIN_LAND)if(d.settings.size==l.SandboxSettings.SIZE_LARGE){this.DrawGroundOutlineCircle(0,0,150),this.DrawGroundOutlineCircle(12e3,0,150);var n=new t.Matrix;this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(144,-6,12012,312),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(150,0,12e3,300),this.sGround.endFill(),this.DrawGroundCircle(0,0,150),this.DrawGroundCircle(12e3,0,150),this.DrawRock(0,169,200,40),this.DrawRock(0,318,44,48),this.DrawRock(2,795,195,28),this.DrawRock(0,1110,120,40),this.DrawRock(2,1440,121,69),this.DrawRock(0,1762,68,57),this.DrawRock(1,2082,11,68),this.DrawRock(0,2395,192,51),this.DrawRock(0,2727,152,39),this.DrawRock(0,3032,74,61),this.DrawRock(1,3196,18,46),this.DrawRock(0,3527,197,28),this.DrawRock(0,3842,168,18),this.DrawRock(1,4003,108,23),this.DrawRock(2,4325,47,68),this.DrawRock(0,4641,109,50),this.DrawRock(1,4806,164,27),this.DrawRock(2,5110,138,16),this.DrawRock(2,5287,199,45),this.DrawRock(2,5447,40,68),this.DrawRock(1,5605,142,22),this.DrawRock(2,5769,173,54),this.DrawRock(0,6075,169,15),this.DrawRock(1,6401,24,41),this.DrawRock(0,6569,86,59),this.DrawRock(0,6885,74,29),this.DrawRock(2,7200,153,15),this.DrawRock(0,7354,121,32),this.DrawRock(2,7722,89,61),this.DrawRock(1,7946,66,19),this.DrawRock(2,8325,47,68),this.DrawRock(0,8641,109,50),this.DrawRock(1,8806,164,27),this.DrawRock(2,9110,138,16),this.DrawRock(2,9287,199,45),this.DrawRock(2,9447,40,68),this.DrawRock(1,9605,142,22),this.DrawRock(2,9769,173,54),this.DrawRock(0,10075,169,15),this.DrawRock(1,10401,24,41),this.DrawRock(0,10569,86,59),this.DrawRock(0,10885,74,29),this.DrawRock(2,11200,153,15),this.DrawRock(0,11354,121,32),this.DrawRock(2,11722,89,61),this.DrawRock(1,11946,66,19)}else d.settings.size==l.SandboxSettings.SIZE_MEDIUM?(this.DrawGroundOutlineCircle(0,0,150),this.DrawGroundOutlineCircle(8e3,0,150),n=new t.Matrix,this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(144,-6,8012,312),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(150,0,8e3,300),this.sGround.endFill(),this.DrawGroundCircle(0,0,150),this.DrawGroundCircle(8e3,0,150),this.DrawRock(0,169,200,40),this.DrawRock(0,318,44,48),this.DrawRock(2,795,195,28),this.DrawRock(0,1110,120,40),this.DrawRock(2,1440,121,69),this.DrawRock(0,1762,68,57),this.DrawRock(1,2082,11,68),this.DrawRock(0,2395,192,51),this.DrawRock(0,2727,152,39),this.DrawRock(0,3032,74,61),this.DrawRock(1,3196,18,46),this.DrawRock(0,3527,197,28),this.DrawRock(0,3842,168,18),this.DrawRock(1,4003,108,23),this.DrawRock(2,4325,47,68),this.DrawRock(0,4641,109,50),this.DrawRock(1,4806,164,27),this.DrawRock(2,5110,138,16),this.DrawRock(2,5287,199,45),this.DrawRock(2,5447,40,68),this.DrawRock(1,5605,142,22),this.DrawRock(2,5769,173,54),this.DrawRock(0,6075,169,15),this.DrawRock(1,6401,24,41),this.DrawRock(0,6569,86,59),this.DrawRock(0,6885,74,29),this.DrawRock(2,7200,153,15),this.DrawRock(0,7354,121,32),this.DrawRock(2,7722,89,61),this.DrawRock(1,7946,66,19)):(this.DrawGroundOutlineCircle(0,0,150),this.DrawGroundOutlineCircle(4e3,0,150),n=new t.Matrix,this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(144,-6,4012,312),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(150,0,4e3,300),this.sGround.endFill(),this.DrawGroundCircle(0,0,150),this.DrawGroundCircle(4e3,0,150),this.DrawRock(0,169,200,40),this.DrawRock(0,318,44,48),this.DrawRock(2,795,195,28),this.DrawRock(0,1110,120,40),this.DrawRock(2,1440,121,69),this.DrawRock(0,1762,68,57),this.DrawRock(1,2082,11,68),this.DrawRock(0,2395,192,51),this.DrawRock(0,2727,152,39),this.DrawRock(0,3032,74,61),this.DrawRock(1,3196,18,46),this.DrawRock(0,3527,197,28),this.DrawRock(0,3842,168,18));else d.settings.terrainType==l.SandboxSettings.TERRAIN_BOX&&(d.settings.size==l.SandboxSettings.SIZE_LARGE?(n=new t.Matrix,this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,500,1264),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(3500,0,500,1264),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,4e3,200),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,1064,4e3,200),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,498.5,1264),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(3501.5,0,498.5,1264),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,4e3,198.5),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,1065.5,4e3,198.5),this.sGround.endFill(),this.DrawRocksForBox(4e3,1264,500,200,1.5)):d.settings.size==l.SandboxSettings.SIZE_MEDIUM?(n=new t.Matrix,this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,400,615),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(1600,0,400,615),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,2e3,100),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,515,2e3,100),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,399,615),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(1601,0,399,615),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,2e3,99),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,516,2e3,99),this.sGround.endFill(),this.DrawRocksForBox(2e3,615,400,100,1)):(n=new t.Matrix,this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,200,339),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(800,0,200,339),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,1e3,39),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,300,1e3,39),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,198,339),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(802,0,198,339),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,0,1e3,37),this.sGround.endFill(),this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:n}),this.sGround.drawRect(0,302,1e3,37),this.sGround.endFill(),this.DrawRocksForBox(1e3,339,200,39,2)));this.addChild(this.sGround)}RefreshSandboxSettings(){for(var i=0;i<this.groundParts.length;i++)this.allParts=e.Util.RemoveFromArray(this.groundParts[i],this.allParts);for(i=0;i<this.allParts.length;i++)if(this.allParts[i]instanceof t.Text)try{this.removeChild(this.allParts[i].m_textField)}catch(r){}for(this.groundParts=new Array,this.removeChild(this.sGround),this.sSky.Delete(),this.removeChild(this.m_canvas),this.removeChild(this.uneditableText),this.removeChild(this.rotatingText),this.removeChild(this.scalingText),this.removeChild(this.boxText),this.removeChild(this.horizLineText),this.removeChild(this.vertLineText),this.removeChild(this.shapeText),this.removeChild(this.m_guiPanel),this.removeChild(this.m_sidePanel),this.removeChild(this.m_guiMenu),this.removeChild(this.m_fader),i=0;i<this.m_buildAreas.length;i++)this.removeChild(this.m_buildAreas[i]),this.removeChild(this.m_badBuildAreas[i]),this.removeChild(this.m_selectedBuildAreas[i]);for(this.m_chooserWindow&&(this.removeChild(this.m_chooserWindow),this.m_chooserWindow=null),this.m_loginWindow&&(this.removeChild(this.m_loginWindow),this.m_loginWindow=null),this.m_newUserWindow&&(this.removeChild(this.m_newUserWindow),this.m_newUserWindow=null),this.m_scoreWindow&&(this.removeChild(this.m_scoreWindow),this.m_scoreWindow=null),this.m_progressDialog&&(this.removeChild(this.m_progressDialog),this.m_progressDialog=null),this.m_linkDialog&&(this.removeChild(this.m_linkDialog),this.m_linkDialog=null),this.m_tutorialDialog&&(this.removeChild(this.m_tutorialDialog),this.m_tutorialDialog=null),this.m_postReplayWindow&&(this.removeChild(this.m_postReplayWindow),this.m_postReplayWindow=null),this.m_rateDialog&&(this.removeChild(this.m_rateDialog),this.m_rateDialog=null),this.m_restrictionsDialog&&(this.removeChild(this.m_restrictionsDialog),this.m_restrictionsDialog=null),this.m_conditionsDialog&&(this.removeChild(this.m_conditionsDialog),this.m_conditionsDialog=null),this.m_sandboxWindow&&(this.removeChild(this.m_sandboxWindow),this.m_sandboxWindow=null),this.m_challengeWindow&&(this.removeChild(this.m_challengeWindow),this.m_challengeWindow=null),this.m_reportWindow&&(this.removeChild(this.m_reportWindow),this.m_reportWindow=null),this.m_loadWindow&&(this.removeChild(this.m_loadWindow),this.m_loadWindow=null),this.m_buildAreas=new Array,this.m_badBuildAreas=new Array,this.m_selectedBuildAreas=new Array,this.BuildGround(),this.addChild(this.m_canvas),this.addChild(this.uneditableText),this.addChild(this.rotatingText),this.addChild(this.scalingText),this.addChild(this.boxText),this.addChild(this.horizLineText),this.addChild(this.vertLineText),this.addChild(this.shapeText),this.addChild(this.m_guiPanel),this.addChild(this.m_sidePanel),this.addChild(this.m_guiMenu),this.addChild(this.m_fader),i=0;i<this.allParts.length;i++)this.allParts[i]instanceof n.TextPart&&(this.allParts[i].inFront?this.addChildAt(this.allParts[i].m_textField,this.getChildIndex(this.m_canvas)+1):this.addChildAt(this.allParts[i].m_textField,this.getChildIndex(this.m_canvas)));this.BuildBuildArea(),this.redrawRobot=!0,this.hasZoomed=!0}GetMinX(){return d.settings.size==l.SandboxSettings.SIZE_LARGE?-280:d.settings.size==l.SandboxSettings.SIZE_MEDIUM?-150:-50}GetMaxX(){return d.settings.size==l.SandboxSettings.SIZE_LARGE?280:d.settings.size==l.SandboxSettings.SIZE_MEDIUM?150:50}GetMinY(){return d.settings.size==l.SandboxSettings.SIZE_LARGE?-160:d.settings.size==l.SandboxSettings.SIZE_MEDIUM?-100:-30}GetMaxY(){return d.settings.terrainType==l.SandboxSettings.TERRAIN_BOX?d.settings.size==l.SandboxSettings.SIZE_SMALL?15:30:d.settings.size==l.SandboxSettings.SIZE_LARGE?160:d.settings.size==l.SandboxSettings.SIZE_MEDIUM?100:40}GetGravity(){return new i.b2Vec2(0,d.settings.gravity)}DrawGroundOutlineCircle(i,e,r){var s=new t.Matrix;this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopOutlines[d.settings.terrainTheme],d.terrainBottomOutlines[d.settings.terrainTheme]]),matrix:s}),this.sGround.drawCircle(i+r,e+r,r+6),this.sGround.endFill()}DrawGroundCircle(i,e,r){var s=new t.Matrix;this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture([d.terrainTopColours[d.settings.terrainTheme],d.terrainBottomColours[d.settings.terrainTheme]]),matrix:s}),this.sGround.drawCircle(i+r,e+r,r),this.sGround.endFill()}DrawRock(i,e,r,s,n=6){this.sGround.lineStyle(n,d.rockOutlines[d.settings.terrainTheme]);var o=new t.Matrix;this.sGround.beginTextureFill({texture:a.Gradient.getLinearGradientTexture(0==i?[d.rock1TopColours[d.settings.terrainTheme],d.rock1BottomColours[d.settings.terrainTheme]]:1==i?[d.rock2TopColours[d.settings.terrainTheme],d.rock2BottomColours[d.settings.terrainTheme]]:[d.rock3TopColours[d.settings.terrainTheme],d.rock3BottomColours[d.settings.terrainTheme]]),matrix:o}),this.sGround.drawCircle(e+s,r+s,s),this.sGround.endFill()}DrawRocksForBox(t,i,r,s,n){for(var o=1e3==t?60:2e3==t?200:500,a=new Array,h=0;h<o;h++){var l,d;do{if(d=!1,(l=e.Util.Vector(e.Util.RangedRandom(0,t),e.Util.RangedRandom(0,i))).x>r-32&&l.x<t-r+2&&l.y>s-32&&l.y<i-s+2||l.x>t-32||l.y>i-32)d=!0;else for(var u=0;u<a.length;u++)if(e.Util.GetDist(l.x,l.y,a[u].x,a[u].y)<32){d=!0;break}}while(d);a.push(l),this.DrawRock(e.Util.RangedRandom(0,3),l.x,l.y,e.Util.RangedRandom(5,15),n)}}Update(){super.Update(),this.sSky.Update(this.hasZoomed,this.hasPanned),d.settings.terrainType==l.SandboxSettings.TERRAIN_LAND?d.settings.size==l.SandboxSettings.SIZE_LARGE?(this.hasZoomed&&(this.sGround.width=this.World2ScreenX(507.7)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x),(this.hasZoomed||this.hasPanned)&&(this.sGround.x=this.World2ScreenX(-253.55),this.sGround.y=this.World2ScreenY(12.06))):d.settings.size==l.SandboxSettings.SIZE_MEDIUM?(this.hasZoomed&&(this.sGround.width=this.World2ScreenX(247.2)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x),(this.hasZoomed||this.hasPanned)&&(this.sGround.x=this.World2ScreenX(-123.45),this.sGround.y=this.World2ScreenY(12.06))):(this.hasZoomed&&(this.sGround.width=this.World2ScreenX(85)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x),(this.hasZoomed||this.hasPanned)&&(this.sGround.x=this.World2ScreenX(-42.36),this.sGround.y=this.World2ScreenY(12.06))):d.settings.terrainType==l.SandboxSettings.TERRAIN_BOX&&(d.settings.size==l.SandboxSettings.SIZE_LARGE?(this.hasZoomed&&(this.sGround.width=this.World2ScreenX(693)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x),(this.hasZoomed||this.hasPanned)&&(this.sGround.x=this.World2ScreenX(-346.5),this.sGround.y=this.World2ScreenY(-174.5))):d.settings.size==l.SandboxSettings.SIZE_MEDIUM?(this.hasZoomed&&(this.sGround.width=this.World2ScreenX(432.5)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x),(this.hasZoomed||this.hasPanned)&&(this.sGround.x=this.World2ScreenX(-216.25),this.sGround.y=this.World2ScreenY(-101.45))):(this.hasZoomed&&(this.sGround.width=this.World2ScreenX(132.85)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x),(this.hasZoomed||this.hasPanned)&&(this.sGround.x=this.World2ScreenX(-66.42),this.sGround.y=this.World2ScreenY(-30)))),["ControllerMonkeyBars","ControllerClimb","ControllerRace","ControllerSpaceship"].includes(this.constructor.name)||(this.hasPanned=!1,this.hasZoomed=!1)}GetBuildingArea(){var t=new b2AABB;return t.lowerBound.Set(-300,-200),t.upperBound.Set(300,200),t}NumBuildingAreas(){return 0}ChallengeOver(){return!1}GetScore(){return 1e4}submitButton(t){this.m_scoreWindow&&this.m_scoreWindow.visible&&this.m_scoreWindow.ShowFader(),this.ShowDisabledDialog()}}exports.ControllerSandbox=d,d.terrainTopColours=["#65CD4E",e.Util.HexColourString(191,131,83),e.Util.HexColourString(214,189,100),e.Util.HexColourString(181,197,201),e.Util.HexColourString(224,238,253),e.Util.HexColourString(198,196,205),e.Util.HexColourString(249,172,101)],d.terrainBottomColours=["#5AC043",e.Util.HexColourString(155,89,38),e.Util.HexColourString(187,163,78),e.Util.HexColourString(156,171,175),e.Util.HexColourString(159,196,239),e.Util.HexColourString(160,158,171),e.Util.HexColourString(240,70,45)],d.terrainTopOutlines=["#2DA12E",e.Util.HexColourString(144,99,62),e.Util.HexColourString(185,163,86),e.Util.HexColourString(153,166,169),e.Util.HexColourString(247,251,255),e.Util.HexColourString(139,138,144),e.Util.HexColourString(177,102,46)],d.terrainBottomOutlines=["#2DA12E",e.Util.HexColourString(117,67,29),e.Util.HexColourString(161,141,67),e.Util.HexColourString(132,144,148),e.Util.HexColourString(247,251,255),e.Util.HexColourString(115,114,122),e.Util.HexColourString(171,59,34)],d.rock1TopColours=["#8EDB82",e.Util.HexColourString(210,157,111),e.Util.HexColourString(219,206,135),e.Util.HexColourString(178,187,191),e.Util.HexColourString(217,230,245),e.Util.HexColourString(180,180,189),e.Util.HexColourString(194,130,87)],d.rock1BottomColours=["#7FBF72",e.Util.HexColourString(183,133,96),e.Util.HexColourString(190,176,119),e.Util.HexColourString(164,173,174),e.Util.HexColourString(201,210,225),e.Util.HexColourString(158,158,167),e.Util.HexColourString(172,114,77)],d.rock2TopColours=["#80D970",e.Util.HexColourString(206,148,90),e.Util.HexColourString(215,202,116),e.Util.HexColourString(169,177,182),e.Util.HexColourString(204,217,236),e.Util.HexColourString(170,165,179),e.Util.HexColourString(197,115,66)],d.rock2BottomColours=["#6DBE5D",e.Util.HexColourString(183,122,72),e.Util.HexColourString(188,175,97),e.Util.HexColourString(153,162,166),e.Util.HexColourString(183,196,217),e.Util.HexColourString(149,145,154),e.Util.HexColourString(175,103,58)],d.rock3TopColours=["#70C160",e.Util.HexColourString(207,150,92),e.Util.HexColourString(216,203,117),e.Util.HexColourString(173,182,186),e.Util.HexColourString(205,217,237),e.Util.HexColourString(172,168,181),e.Util.HexColourString(198,121,69)],d.rock3BottomColours=["#63AB52",e.Util.HexColourString(184,123,76),e.Util.HexColourString(189,176,98),e.Util.HexColourString(157,166,170),e.Util.HexColourString(186,198,218),e.Util.HexColourString(148,148,157),e.Util.HexColourString(179,105,57)],d.rockOutlines=[7057498,10906450,11640920,10003624,12438487,9737117,12215357];
},{"pixi.js":"aQiP","@box2d/core":"kjbO","../General/Util":"Zvyo","../Parts/Circle":"PfXD","../Parts/Rectangle":"jYSx","../Parts/TextPart":"T0pq","./ControllerGame":"Cq9K","./Graphics/Gradient":"a6nr","./Graphics/Sky":"cNJr","./SandboxSettings":"ZSAP"}],"kpwL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AdvancedSandboxWindow=void 0;const e=require("pixi.js"),t=require("../Game/ControllerMainMenu"),i=require("../Game/ControllerSandbox"),a=require("../Game/SandboxSettings"),s=require("../Main"),n=require("./GuiButton"),l=require("./GuiCombobox"),d=require("./GuiSlider"),h=require("./GuiTextInput"),r=require("./GuiWindow");class o extends r.GuiWindow{constructor(t,i=null){super(276,90,248,430),this.cont=t,this.sortableChildren=!0;var a=new e.TextStyle,r=new e.Text("");r.text="Advanced Sandbox\nSetup",r.x=124,r.y=32,a.align="center",a.fontFamily=s.Main.GLOBAL_FONT,a.fontSize=18,a.fill="#242930",r.style=a,r.anchor.set(.5),this.addChild(r),(r=new e.Text("")).text="Sandbox Size:",r.x=20,r.y=77,a.fontSize=12,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Terrain Shape:",r.x=20,r.y=112,a.fontSize=12,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Terrain Theme:",r.x=20,r.y=147,a.fontSize=12,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Background:",r.x=20,r.y=182,a.fontSize=12,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Red:",r.x=130,r.y=210,a.fontSize=11,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Green:",r.x=130,r.y=230,a.fontSize=11,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Blue:",r.x=130,r.y=250,a.fontSize=11,a.align="left",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),(r=new e.Text("")).text="Gravity:",r.x=45,r.y=280,a.fontSize=12,a.align="center",a.fontFamily=s.Main.GLOBAL_FONT,a.fill="#242930",r.style=a,this.addChild(r),this.sizeBox=new l.GuiCombobox(110,70,130,32),this.sizeBox.addItem({label:"  Small"}),this.sizeBox.addItem({label:"  Medium"}),this.sizeBox.addItem({label:"  Large"}),(a=new e.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=12,a.fill="#573D40",this.sizeBox.label.style=a,i&&(this.sizeBox.selectedIndex=i.size),this.addChild(this.sizeBox),this.shapeBox=new l.GuiCombobox(110,105,130,32),this.shapeBox.addItem({label:"  Flat Land"}),this.shapeBox.addItem({label:"  Box"}),this.shapeBox.addItem({label:"  Empty"}),(a=new e.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=12,a.fill="#573D40",this.shapeBox.label.style=a,i&&(this.shapeBox.selectedIndex=i.terrainType),this.addChild(this.shapeBox),this.themeBox=new l.GuiCombobox(110,140,130,32),this.themeBox.addItem({label:"  Grass"}),this.themeBox.addItem({label:"  Dirt"}),this.themeBox.addItem({label:"  Sand"}),this.themeBox.addItem({label:"  Rock"}),this.themeBox.addItem({label:"  Snow"}),this.themeBox.addItem({label:"  Moon"}),this.themeBox.addItem({label:"  Mars"}),(a=new e.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=12,a.fill="#573D40",this.themeBox.label.style=a,i&&(this.themeBox.selectedIndex=i.terrainTheme),this.addChild(this.themeBox),this.bgBox=new l.GuiCombobox(110,175,130,32),this.bgBox.addItem({label:"  Sky"}),this.bgBox.addItem({label:"  Space"}),this.bgBox.addItem({label:"  Night"}),this.bgBox.addItem({label:"  Dusk"}),this.bgBox.addItem({label:"  Mars"}),this.bgBox.addItem({label:"  Sunset"}),this.bgBox.addItem({label:"  Solid Color"}),(a=new e.TextStyle).fontFamily=s.Main.GLOBAL_FONT,a.fontSize=12,a.fill="#573D40",this.bgBox.label.style=a,i&&(this.bgBox.selectedIndex=i.background),this.bgBox.on("change",()=>this.bgBoxChanged()),this.addChild(this.bgBox),(a=new e.TextStyle).fontSize=10,this.redArea=new h.GuiTextInput(170,210,30,20,a),this.redArea.text="125",this.redArea.maxLength=3,this.redArea.on("change",e=>this.redText(e)),this.redArea.enabled=6==this.bgBox.selectedIndex,this.redArea.editable=6==this.bgBox.selectedIndex,i&&6==this.bgBox.selectedIndex&&(this.redArea.text=i.backgroundR+""),this.addChild(this.redArea),this.greenArea=new h.GuiTextInput(170,230,30,20,a),this.greenArea.text="125",this.greenArea.maxLength=3,this.greenArea.on("change",e=>this.greenText(e)),this.greenArea.enabled=6==this.bgBox.selectedIndex,this.greenArea.editable=6==this.bgBox.selectedIndex,i&&6==this.bgBox.selectedIndex&&(this.greenArea.text=i.backgroundG+""),this.addChild(this.greenArea),this.blueArea=new h.GuiTextInput(170,250,30,20,a),this.blueArea.text="255",this.blueArea.maxLength=3,this.blueArea.on("change",e=>this.blueText(e)),this.blueArea.enabled=6==this.bgBox.selectedIndex,this.blueArea.editable=6==this.bgBox.selectedIndex,i&&6==this.bgBox.selectedIndex&&(this.blueArea.text=i.backgroundB+""),this.addChild(this.blueArea),this.gravitySlider=new d.GuiSlider,this.gravitySlider.x=78,this.gravitySlider.y=302,this.gravitySlider.minValue=0,this.gravitySlider.maxValue=30,this.gravitySlider.value=15,this.gravitySlider.on("change",e=>this.sliderChange(e)),i&&(this.gravitySlider.value=i.gravity),this.addChild(this.gravitySlider),(a=new e.TextStyle).fontSize=10,this.gravityArea=new h.GuiTextInput(114,320,30,20,a),this.gravityArea.text="15",i&&(this.gravityArea.text=i.gravity+""),this.gravityArea.maxLength=5,this.gravityArea.height=20,this.gravityArea.on("change",e=>this.gravityText(e)),this.addChild(this.gravityArea),(a=new e.TextStyle).fontSize=15,this.okButton=new n.GuiButton("Okay!",49,340,150,50,this.okButtonPressed.bind(this),n.GuiButton.PURPLE,a),this.addChild(this.okButton),(a=new e.TextStyle).fontSize=13,this.cancelButton=new n.GuiButton("Cancel",74,385,100,35,this.cancelButtonPressed.bind(this),n.GuiButton.PURPLE,a),this.addChild(this.cancelButton)}cancelButtonPressed(e){this.cont instanceof t.ControllerMainMenu?this.cont.fader2.visible=!1:this.cont.m_fader.visible=!1,this.visible=!1,this.cont.removeChild(this)}okButtonPressed(e){var n=new a.SandboxSettings(this.gravitySlider.value,this.sizeBox.selectedIndex,this.shapeBox.selectedIndex,this.themeBox.selectedIndex,this.bgBox.selectedIndex,parseInt(this.redArea.text),parseInt(this.greenArea.text),parseInt(this.blueArea.text));i.ControllerSandbox.settings=n,this.cont instanceof t.ControllerMainMenu?s.Main.changeControllers=!0:("challenge"===this.cont.controllerType&&(ControllerChallenge.challenge.settings=n),this.cont.RefreshSandboxSettings(),this.cont.m_fader.visible=!1)}bgBoxChanged(){this.redArea.enabled=6==this.bgBox.selectedIndex,this.greenArea.enabled=6==this.bgBox.selectedIndex,this.blueArea.enabled=6==this.bgBox.selectedIndex,this.redArea.editable=6==this.bgBox.selectedIndex,this.greenArea.editable=6==this.bgBox.selectedIndex,this.blueArea.editable=6==this.bgBox.selectedIndex}redText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),this.redArea.text=t+""}greenText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),this.greenArea.text=t+""}blueText(e){var t=parseInt(e);t<0&&(t=0),t>255&&(t=255),isNaN(t)&&(t=0),this.blueArea.text=t+""}gravityText(e){var t=parseInt(e);t<0&&(t=0),t>30&&(t=30),isNaN(t)&&(t=15),this.gravityArea.text=e,this.gravitySlider.value=t}sliderChange(e){this.gravityArea.text=e.toString()}refreshMouse(e){e.target!=this.bgBox.dropdown&&e.target!=this.themeBox.dropdown||(e.target.height=140),s.Main.RefreshMouse(stage,e.target)}}exports.AdvancedSandboxWindow=o;
},{"pixi.js":"aQiP","../Game/ControllerMainMenu":"rq5K","../Game/ControllerSandbox":"v13b","../Game/SandboxSettings":"ZSAP","../Main":"aM6Q","./GuiButton":"IBBZ","./GuiCombobox":"a9Q3","./GuiSlider":"qnZ8","./GuiTextInput":"h4Qg","./GuiWindow":"BOXT"}],"V2jW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ControllerChallenge=void 0;const e=require("./ControllerSandbox"),l=require("../General/Database"),i=require("../Main"),t=require("../Parts/TextPart"),s=require("./Challenge"),a=require("./Replay"),n=require("./Robot");class o extends e.ControllerSandbox{constructor(){super(),this.controllerType="challenge",o.challenge||(o.challenge=new s.Challenge),this.BuildBuildArea()}Update(){if(super.Update(),this.simStarted&&!this.paused){for(var e=0;e<o.challenge.winConditions.length;e++)o.challenge.winConditions[e].Update(this.allParts,cannonballs);for(e=0;e<o.challenge.lossConditions.length;e++)o.challenge.lossConditions[e].Update(this.allParts,cannonballs)}o.playChallengeMode?this.m_guiPanel.ShowEditButton():this.m_guiPanel.HideEditButton()}playButton(e,l=!0){if(o.playChallengeMode){if(!this.simStarted){for(i=0;i<o.challenge.winConditions.length;i++)o.challenge.winConditions[i].isSatisfied=!1;for(i=0;i<o.challenge.lossConditions.length;i++)o.challenge.lossConditions[i].isSatisfied=!1}super.playButton(e,l)}else{o.challenge.allParts=this.allParts.filter(this.PartIsEditable),o.playChallengeMode=!0;for(var i=0;i<o.challenge.allParts.length;i++)o.challenge.allParts[i].isEditable=!1;this.m_sidePanel.visible=!1,this.CheckIfPartsFit(),this.selectedParts=new Array,this.actions=new Array,this.lastAction=-1}}editButton(e,l=!1){if(l){this.m_fader.visible=!1,this.m_progressDialog.visible=!1,o.playChallengeMode=!1,this.allParts=new Array,this.RefreshSandboxSettings();for(var i=0;i<o.challenge.allParts.length;i++)this.allParts.push(o.challenge.allParts[i]),o.challenge.allParts[i].isEditable=!0,o.challenge.allParts[i]&&is,t.TextPart,o.challenge.allParts[i].inFront?this.addChildAt(o.challenge.allParts[i].m_textField,this.getChildIndex(this.m_canvas)+1):this.addChildAt(o.challenge.allParts[i].m_textField,this.getChildIndex(this.m_canvas))}else this.m_fader.visible=!0,o.playOnlyMode?(this.ShowDialog3("This challenge is uneditable!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):this.ShowConfirmDialog("Are you sure you want to edit this challenge?          (Your current robot will be lost)",11)}circleButton(e){o.playChallengeMode&&!o.challenge.circlesAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Circles are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.circleButton(e)}rectButton(e){o.playChallengeMode&&!o.challenge.rectanglesAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Rectangles are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.rectButton(e)}triangleButton(e){o.playChallengeMode&&!o.challenge.trianglesAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Triangles are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.triangleButton(e)}fjButton(e){o.playChallengeMode&&!o.challenge.fixedJointsAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Fixed Joints are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.fjButton(e)}rjButton(e){o.playChallengeMode&&!o.challenge.rotatingJointsAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Rotating Joints are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.rjButton(e)}pjButton(e){o.playChallengeMode&&!o.challenge.slidingJointsAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Sliding Joints are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.pjButton(e)}thrustersButton(e){o.playChallengeMode&&!o.challenge.thrustersAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Thrusters are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.thrustersButton(e)}cannonButton(e){o.playChallengeMode&&!o.challenge.cannonsAllowed?(this.m_fader.visible=!0,this.ShowDialog3("Cannons are not allowed in this challenge!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer()):super.cannonButton(e)}GetBuildingArea(){return o.challenge.buildAreas[0]}GetBuildingAreaNumber(e){return o.challenge.buildAreas[e]}NumBuildingAreas(){return o.challenge.buildAreas.length}DeleteBuildBoxes(e){this.m_fader.visible=!1,this.m_progressDialog.visible=!1;for(var l=0;l<this.m_buildAreas.length;l++)this.removeChild(this.m_buildAreas[l]),this.removeChild(this.m_badBuildAreas[l]),this.removeChild(this.m_selectedBuildAreas[l]);this.m_buildAreas=new Array,this.m_badBuildAreas=new Array,this.m_selectedBuildAreas=new Array,o.challenge.buildAreas=new Array,this.redrawBuildArea=!0}ContactAdded(e){for(var l=0;l<o.challenge.winConditions.length;l++)o.challenge.winConditions[l].ContactAdded(e,this.allParts,cannonballs);for(l=0;l<o.challenge.lossConditions.length;l++)o.challenge.lossConditions[l].ContactAdded(e,this.allParts,cannonballs)}ChallengeOver(){return this.WonChallenge()||this.LostChallenge()}WonChallenge(){if(0==o.challenge.winConditions.length)return!1;for(var e=0;e<o.challenge.lossConditions.length;e++)if(o.challenge.lossConditions[e].isSatisfied)return!1;if(o.challenge.winConditionsAnded){for(e=0;e<o.challenge.winConditions.length;e++)if(!o.challenge.winConditions[e].isSatisfied)return!1;return!0}for(e=0;e<o.challenge.winConditions.length;e++)if(o.challenge.winConditions[e].isSatisfied)return!0;return!1}LostChallenge(){for(var e=0;e<o.challenge.lossConditions.length;e++)if(o.challenge.lossConditions[e].isSatisfied&&o.challenge.lossConditions[e].immediate)return!0;return!1}GetScore(){return 1e4-this.frameCounter}submitButton(t){if(i.Main.inIFrame)this.m_fader.visible=!0,this.ShowConfirmDialog("Redirect to incredibots2.com?",7);else{if(!curRobotEditable)return;""==curChallengeID?(this.m_scoreWindow.ShowFader(),this.ShowDialog2("You must save your challenge publicly first!")):"_Public"!=userName?(this.AddSyncPoint(),viewingUnsavedReplay?l.Database.SaveReplay(userName,password,replay,"_ScoreReplay","This replay is saved for a score",curRobotID,new n.Robot(this.allParts,e.ControllerSandbox.settings),this.ChallengeOver()?this.GetScore():-1,curChallengeID,1,this.finishSavingReplay):l.Database.SaveReplay(userName,password,new a.Replay(this.cameraMovements,this.syncPoints,this.keyPresses,this.frameCounter,l.Database.VERSION_STRING_FOR_REPLAYS),"_ScoreReplay","This replay is saved for a score",curRobotID,new n.Robot(this.allParts,e.ControllerSandbox.settings),this.ChallengeOver()?this.GetScore():-1,curChallengeID,1,this.finishSavingReplay),this.m_scoreWindow.ShowFader(),this.ShowDialog("Submitting score..."),this.clickedSubmitScore=!0):(this.clickedSubmitScore=!0,this.loginButton(t,!0,!1))}}}exports.ControllerChallenge=o,o.playChallengeMode=!1,o.playOnlyMode=!1;
},{"./ControllerSandbox":"v13b","../General/Database":"CVYw","../Main":"aM6Q","../Parts/TextPart":"T0pq","./Challenge":"yWA3","./Replay":"odHz","./Robot":"H0hU"}],"rq5K":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.ControllerMainMenu=void 0;const e=require("pixi.js"),t=require("@box2d/core"),o=require("../General/Database"),i=require("../General/LSOManager"),a=require("../General/Util"),l=require("../Gui/AdvancedSandboxWindow"),s=require("../Gui/GuiButton"),r=require("../Gui/ImportWindow"),n=require("../Main"),h=require("../Parts/Cannon"),d=require("../Parts/JointPart"),u=require("../Parts/ShapePart"),g=require("../Parts/Thrusters"),m=require("./ContactFilter"),b=require("./Controller"),c=require("./ControllerChallenge"),p=require("./ControllerSandbox"),C=require("./Draw"),G=require("./Globals/ControllerGameGlobals"),w=require("./Graphics/Gradient"),D=require("./Graphics/Resource"),S=require("./Graphics/Sky"),y=require("./SandboxSettings");class _ extends b.Controller{constructor(o=!1){super(),this.frameCounter=0,this.m_physScale=30,this.gamesButton=null,this.subscribeButton=null,this.logoFrame=0,this.startHereText=null,this.startHereArrow=null,this.arrowVel=0,this.arrowAccel=0,this.logoShrinking=!1,this.m_progressDialog=null,this.m_linkDialog=null,this.m_exportDialog=null,this.m_importDialog=null,this.m_loadWindow=null,this.m_loginWindow=null,this.m_newUserWindow=null,this.m_goldLoginWindow=null,this.m_sandboxWindow=null,this.m_tutorialWindow=null,this.m_challengeWindow=null,this.backToSaveWindow=!1,this.draw=new C.Draw,this.allParts=new Array,this.sSky=new S.Sky(this,1),_.cannonballs=new Array,n.Main.enableSound&&(G.ControllerGameGlobals.introVolume=o?.4:.5,_.introSong.volume=G.ControllerGameGlobals.introVolume,_.introSong.play()),this.sGround=new e.Graphics,this.DrawGroundOutlineCircle(0,0,150),this.DrawGroundOutlineCircle(4e3,0,150);const l=w.Gradient.getLinearGradientTexture([a.Util.HexColourString(177,102,46),a.Util.HexColourString(171,59,34)]),r=w.Gradient.getLinearGradientTexture([a.Util.HexColourString(249,172,101),a.Util.HexColourString(240,70,45)]);this.sGround.beginTextureFill({texture:l}),this.sGround.drawRect(144,-6,4012,312),this.sGround.endFill(),this.sGround.beginTextureFill({texture:r}),this.sGround.drawRect(150,0,4e3,300),this.sGround.endFill(),this.addChild(this.sGround),this.DrawGroundCircle(0,0,150),this.DrawGroundCircle(4e3,0,150),this.DrawRock(0,169,200,40),this.DrawRock(0,318,44,48),this.DrawRock(2,795,195,28),this.DrawRock(0,1110,120,40),this.DrawRock(2,1440,121,69),this.DrawRock(0,1762,68,57),this.DrawRock(1,2082,11,68),this.DrawRock(0,2395,192,51),this.DrawRock(0,2727,152,39),this.DrawRock(0,3032,74,61),this.DrawRock(1,3196,18,46),this.DrawRock(0,3527,197,28),this.DrawRock(0,3842,168,18),this.addChild(this.sGround),this.sGround.width=this.World2ScreenX(85)-this.World2ScreenX(0),this.sGround.scale.y=this.sGround.scale.x,this.sCanvas=new e.Graphics,this.draw.m_sprite=this.sCanvas,this.addChild(this.sCanvas);var h=new e.TextStyle({fontFamily:n.Main.GLOBAL_FONT,fontSize:11,align:"right",fill:"#ffffff"});this.versionText=new e.Text("Version "+n.Main.VERSION_STRING),this.versionText.x=700,this.versionText.y=580,this.versionText.style=h,this.addChild(this.versionText),this.fader=new e.Graphics,this.fader.beginFill(0,.2),this.fader.lineStyle(0,0,.2),this.fader.moveTo(0,0),this.fader.lineTo(800,0),this.fader.lineTo(800,600),this.fader.lineTo(0,600),this.fader.lineTo(0,0),this.fader.endFill(),this.fader.visible=o||n.Main.premiumMode,this.addChild(this.fader),this.sLogo=new e.Sprite(D.Resource.cMainMenuLogo),this.sLogo.smoothing=!0,o&&(this.sLogo.width=.6*this.sLogo.measuredWidth,this.sLogo.height=.6*this.sLogo.measuredHeight,this.sLogo.x=215,this.sLogo.y=10),this.addChild(this.sLogo),o||((h=new e.TextStyle).fontSize=24,this.playButton=new s.GuiButton("Play!",320,184,160,70,this.playButtonPressed.bind(this),s.GuiButton.PLAY,h),this.addChild(this.playButton)),n.Main.premiumMode&&_.firstLoad&&(this.m_goldLoginWindow=new GoldLoginWindow(this),this.addChild(this.m_goldLoginWindow),this.playButton.visible=!1),_.firstLoad=!1,this.levelSelectGui=new e.Sprite,this.levelSelectGui.visible=o;var b=new e.Sprite(D.Resource.cLevelSelectBox1L);b.x=210,b.y=105,this.levelSelectGui.addChild(b),(b=new e.Sprite(D.Resource.cLevelSelectBox1R)).x=576,b.y=105,this.levelSelectGui.addChild(b);var c=new e.Graphics;this.levelSelectGui.addChild(c);let p=new e.Matrix;p.translate(0,105),c.beginTextureFill({texture:D.Resource.cLevelSelectBox1M,matrix:p}),c.drawRect(234,105,342,135),(b=new e.Sprite(D.Resource.cLevelSelectBox2L)).x=315,b.y=260,this.levelSelectGui.addChild(b),(b=new e.Sprite(D.Resource.cLevelSelectBox2R)).x=472,b.y=260,this.levelSelectGui.addChild(b),(p=new e.Matrix).translate(0,260),c.beginTextureFill({texture:D.Resource.cLevelSelectBox2M,matrix:p}),c.drawRect(339,260,133,194),(b=new e.Sprite(D.Resource.cLevelSelectOtherBoxL)).x=617,b.y=449,this.levelSelectGui.addChild(b),(b=new e.Sprite(D.Resource.cLevelSelectOtherBoxR)).x=763,b.y=449,this.levelSelectGui.addChild(b),(p=new e.Matrix).translate(0,449),c.beginTextureFill({texture:D.Resource.cLevelSelectOtherBoxM,matrix:p}),c.drawRect(641,449,122,144),(h=new e.TextStyle).fontSize=17;var y=new s.GuiButton("Tutorial Levels",210,109,200,65,this.tutorialButton.bind(this),s.GuiButton.PINK,h);y.disabled=!0,this.levelSelectGui.addChild(y),y=new s.GuiButton("Sandbox Mode",390,109,200,65,this.sandboxButton.bind(this),s.GuiButton.PINK,h),this.levelSelectGui.addChild(y),(y=new s.GuiButton("Challenge Editor",210,158,200,65,this.editorButton.bind(this),s.GuiButton.PINK,h)).disabled=!0,this.levelSelectGui.addChild(y),y=new s.GuiButton(" Advanced Sandbox ",390,158,200,65,this.advancedButton.bind(this),s.GuiButton.PINK,h),this.levelSelectGui.addChild(y),this.logInButton=new s.GuiButton("Log In",675,-5,120,60,this.loginButton.bind(this),s.GuiButton.BLUE,h),this.logInButton.disabled=!0,this.logInButton.visible="_Public"==G.ControllerGameGlobals.userName,this.levelSelectGui.addChild(this.logInButton),this.logOutButton=new s.GuiButton("Log Out",675,-5,120,60,this.logout.bind(this),s.GuiButton.BLUE,h),this.logOutButton.disabled=!0,this.logOutButton.visible="_Public"!=G.ControllerGameGlobals.userName,this.levelSelectGui.addChild(this.logOutButton),this.enableSoundButton=new s.GuiButton("Enable Sound",5,535,150,60,this.enableSoundButtonPressed.bind(this),s.GuiButton.BLUE,h),this.enableSoundButton.visible=!n.Main.enableSound,this.disableSoundButton=new s.GuiButton("Disable Sound",5,535,150,60,this.disableSoundButtonPressed.bind(this),s.GuiButton.BLUE,h),this.disableSoundButton.visible=n.Main.enableSound,o?(this.levelSelectGui.addChild(this.enableSoundButton),this.levelSelectGui.addChild(this.disableSoundButton)):(this.addChild(this.enableSoundButton),this.addChild(this.disableSoundButton)),(y=new s.GuiButton("Load Challenge",315,263,171,59,this.loadChallengeButton,s.GuiButton.BLUE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Load Replay",315,303,171,59,this.loadReplayButton,s.GuiButton.BLUE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Load Bot",315,343,171,59,this.loadRobotButton,s.GuiButton.BLUE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("High Scores",315,383,171,59,this.highScoresButton,s.GuiButton.RED,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Import Challenge",145,263,171,59,this.importChallengeButton.bind(this),s.GuiButton.ORANGE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Import Replay",145,303,171,59,this.importReplayButton.bind(this),s.GuiButton.ORANGE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Import Bot",145,343,171,59,this.importRobotButton.bind(this),s.GuiButton.ORANGE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Instructions",620,454,153,50,this.instructionsButton,s.GuiButton.BLUE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Credits",620,489,153,50,this.creditsButton,s.GuiButton.BLUE,h)).disabled=!0,this.levelSelectGui.addChild(y),(y=new s.GuiButton("Suggestions?",620,524,153,50,this.suggestionsButton,s.GuiButton.BLUE,h)).disabled=!0,this.levelSelectGui.addChild(y),(h=new e.TextStyle).fontFamily=n.Main.GLOBAL_FONT,h.fontSize=12,h.fill="#FFFFFF",this.userText=new e.Text("Welcome, "+("_Public"==G.ControllerGameGlobals.userName?"Guest":G.ControllerGameGlobals.userName)),this.userText.x=10,this.userText.y=20,this.userText.style=h,this.levelSelectGui.addChild(this.userText),i.LSOManager.IsAnythingDone()||(this.startHereArrow=new e.Sprite(D.Resource.cLevelSelectStartHereArrow),this.startHereArrow.smoothing=!0,this.startHereArrow.x=130,this.startHereArrow.y=117,this.levelSelectGui.addChild(this.startHereArrow),this.arrowX=130,this.startHereText=new e.Sprite(D.Resource.cLevelSelectStartHereText),this.startHereText.smoothing=!0,this.startHereText.x=75,this.startHereText.y=145,this.levelSelectGui.addChild(this.startHereText)),this.addChild(this.levelSelectGui),this.fader2=new e.Graphics,this.fader2.beginFill(0,.2),this.fader2.lineStyle(0,0,.2),this.fader2.moveTo(0,0),this.fader2.lineTo(800,0),this.fader2.lineTo(800,600),this.fader2.lineTo(0,600),this.fader2.lineTo(0,0),this.fader2.endFill(),this.fader2.visible=!1,this.addChild(this.fader2),this.draw.m_drawScale=23.73;var f=new t.b2AABB;f.lowerBound.Set(-100,-100),f.upperBound.Set(100,100),this.world=t.b2World.Create(new t.b2Vec2(0,15));var v=new m.ContactFilter;this.world.SetContactFilter(v);for(var T=0;T<this.allParts.length;T++)this.allParts[T]instanceof u.ShapePart&&this.allParts[T].isCameraFocus&&(this.cameraPart=this.allParts[T]);for(T=0;T<this.allParts.length;T++)this.allParts[T].checkedCollisionGroup=!1;for(T=0;T<this.allParts.length;T++)this.allParts[T]instanceof u.ShapePart&&this.allParts[T].SetCollisionGroup(-(T+1));for(T=this.allParts.length;T>=0;T--)this.allParts[T]instanceof u.ShapePart&&this.allParts[T].Init(this.world);for(T=0;T<this.allParts.length;T++)(this.allParts[T]instanceof d.JointPart||this.allParts[T]instanceof g.Thrusters)&&this.allParts[T].Init(this.world);G.ControllerGameGlobals.curRobotID="",G.ControllerGameGlobals.curReplayID="",G.ControllerGameGlobals.curChallengeID="",this.Update()}async LoadReplay(){var e=D.Resource.cReplay;this.replay=await o.Database.ExtractReplayFromByteArray(e),this.replay.cont=this,e=D.Resource.cRobot;var t=await o.Database.ExtractRobotFromByteArray(e);this.allParts=t.allParts,this.replaySplineXs=this.ComputeReplaySplines(0),this.replaySplineYs=this.ComputeReplaySplines(1),this.replaySplineAngles=this.ComputeReplaySplines(2)}DrawGroundOutlineCircle(e,t,o){const i=w.Gradient.getLinearGradientTexture([a.Util.HexColourString(177,102,46),a.Util.HexColourString(171,59,34)]);this.sGround.beginTextureFill({texture:i}),this.sGround.drawCircle(e+o,t+o,o+6),this.sGround.endFill()}DrawGroundCircle(e,t,o){const i=w.Gradient.getLinearGradientTexture([a.Util.HexColourString(249,172,101),a.Util.HexColourString(240,70,45)]);this.sGround.beginTextureFill({texture:i}),this.sGround.drawCircle(e+o,t+o,o),this.sGround.endFill()}DrawRock(e,t,o,i,l=6){this.sGround.lineStyle(l,12215357);const s=w.Gradient.getLinearGradientTexture(0==e?[a.Util.HexColourString(194,130,87),a.Util.HexColourString(172,114,77)]:1==e?[a.Util.HexColourString(197,115,66),a.Util.HexColourString(175,103,58)]:[a.Util.HexColourString(198,121,69),a.Util.HexColourString(179,105,57)]);this.sGround.beginTextureFill({texture:s}),this.sGround.drawCircle(t+i,o+i,i),this.sGround.endFill()}loadRobotButton(e){o.Database.GetRobotData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,o.Database.curShared,o.Database.curSortType,o.Database.curSortPeriod,o.Database.curShared?o.Database.curRobotPage:1,"",this.finishGettingLoadRobotData),this.ShowDialog("Getting robots..."),n.Main.ShowHourglass(),this.fader2.visible=!0}loadReplayButton(e){o.Database.curSortPeriod==o.Database.SORT_PERIOD_PROP&&(o.Database.curSortPeriod=o.Database.SORT_PERIOD_ALLTIME),o.Database.GetReplayData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,o.Database.curShared,o.Database.curSortType,o.Database.curSortPeriod,o.Database.curShared?o.Database.curReplayPage:1,"",this.finishGettingLoadReplayData),this.ShowDialog("Getting replays..."),n.Main.ShowHourglass(),this.fader2.visible=!0}loadChallengeButton(e){o.Database.curSortPeriod==o.Database.SORT_PERIOD_PROP&&(o.Database.curSortPeriod=o.Database.SORT_PERIOD_ALLTIME),o.Database.GetChallengeData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,o.Database.curShared,o.Database.curSortType,o.Database.curSortPeriod,o.Database.curShared?o.Database.curChallengePage:1,"",this.finishGettingLoadChallengeData),this.ShowDialog("Getting challenges..."),n.Main.ShowHourglass(),this.fader2.visible=!0}importRobotButton(e){this.ShowImportWindow(r.ImportWindow.TYPE_ROBOT)}importReplayButton(e){this.ShowImportWindow(r.ImportWindow.TYPE_REPLAY)}importChallengeButton(e){this.ShowImportWindow(r.ImportWindow.TYPE_CHALLENGE)}highScoresButton(e){o.Database.GetChallengeData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,!0,o.Database.curSortType,o.Database.curSortPeriod,o.Database.curChallengePage,"",this.finishGettingLoadChallengeForScoreData),this.ShowDialog("Getting challenges..."),n.Main.ShowHourglass(),this.fader2.visible=!0}finishGettingLoadRobotData(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_GET_ROBOT_DATA&&o.Database.FinishGettingRobotData(e)&&(this.m_progressDialog.visible=!1,this.m_loadWindow&&this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_ROBOT_TYPE),this.addChild(this.m_loadWindow))}finishGettingLoadReplayData(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_GET_REPLAY_DATA&&o.Database.FinishGettingReplayData(e)&&(this.m_progressDialog.visible=!1,this.m_loadWindow&&this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_REPLAY_TYPE),this.addChild(this.m_loadWindow))}finishGettingLoadChallengeData(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_GET_CHALLENGE_DATA&&o.Database.FinishGettingChallengeData(e)&&(this.m_progressDialog.visible=!1,this.m_loadWindow&&this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_CHALLENGE_TYPE),this.addChild(this.m_loadWindow))}finishGettingLoadChallengeForScoreData(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_GET_CHALLENGE_DATA&&o.Database.FinishGettingChallengeData(e)&&(this.m_progressDialog.visible=!1,this.m_challengeWindow&&this.removeChild(this.m_challengeWindow),this.m_challengeWindow=new ChooseChallengeWindow(this),this.addChild(this.m_challengeWindow))}finishGettingScoreData(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_GET_SCORE_DATA&&o.Database.FinishGettingScoreData(e)&&(this.m_progressDialog.visible=!1,this.m_loadWindow&&this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.HIGH_SCORE_TYPE),this.addChild(this.m_loadWindow))}processLoadedRobot(e){for(var t=e.allParts,o=0;o<t.length;o++)(t[o]instanceof g.Thrusters||t[o]instanceof h.Cannon)&&!0;G.ControllerGameGlobals.loadedParts=t,G.ControllerGameGlobals.curRobotID=G.ControllerGameGlobals.potentialRobotID,G.ControllerGameGlobals.ratedCurRobot=!1,G.ControllerGameGlobals.curRobotEditable=G.ControllerGameGlobals.potentialRobotEditable,G.ControllerGameGlobals.curRobotPublic=G.ControllerGameGlobals.potentialRobotPublic,G.ControllerGameGlobals.curRobotFeatured=G.ControllerGameGlobals.potentialRobotFeatured,G.ControllerGameGlobals.curReplayID="",G.ControllerGameGlobals.initX=e.cameraX,G.ControllerGameGlobals.initY=e.cameraY,G.ControllerGameGlobals.initZoom=e.zoomLevel,n.Main.changeControllers=!0,e.challenge?(n.Main.nextControllerType=1,c.ControllerChallenge.challenge=e.challenge,c.ControllerChallenge.playChallengeMode=!0,c.ControllerChallenge.playOnlyMode=!0,p.ControllerSandbox.settings=e.challenge.settings,G.ControllerGameGlobals.curChallengeID=G.ControllerGameGlobals.potentialChallengeID,G.ControllerGameGlobals.ratedCurChallenge=!1,G.ControllerGameGlobals.curChallengePublic=!1,G.ControllerGameGlobals.curChallengeFeatured=!1,G.ControllerGameGlobals.justLoadedRobotWithChallenge=!0):(n.Main.nextControllerType=0,p.ControllerSandbox.settings=e.settings,G.ControllerGameGlobals.curChallengeID="")}finishLoading(e){if(o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_LOAD_ROBOT){var t=o.Database.FinishLoadingRobot(e);if(t){for(var i=t.allParts,a=0;a<i.length;a++)(i[a]instanceof g.Thrusters||i[a]instanceof h.Cannon)&&!0;G.ControllerGameGlobals.loadedParts=i,G.ControllerGameGlobals.curRobotID=G.ControllerGameGlobals.potentialRobotID,G.ControllerGameGlobals.ratedCurRobot=!1,G.ControllerGameGlobals.curRobotEditable=G.ControllerGameGlobals.potentialRobotEditable,G.ControllerGameGlobals.curRobotPublic=G.ControllerGameGlobals.potentialRobotPublic,G.ControllerGameGlobals.curRobotFeatured=G.ControllerGameGlobals.potentialRobotFeatured,G.ControllerGameGlobals.curReplayID="",G.ControllerGameGlobals.initX=t.cameraX,G.ControllerGameGlobals.initY=t.cameraY,G.ControllerGameGlobals.initZoom=t.zoomLevel,n.Main.changeControllers=!0,t.challenge?(n.Main.nextControllerType=1,c.ControllerChallenge.challenge=t.challenge,c.ControllerChallenge.playChallengeMode=!0,c.ControllerChallenge.playOnlyMode=!0,p.ControllerSandbox.settings=t.challenge.settings,G.ControllerGameGlobals.curChallengeID=G.ControllerGameGlobals.potentialChallengeID,G.ControllerGameGlobals.ratedCurChallenge=!1,G.ControllerGameGlobals.curChallengePublic=!1,G.ControllerGameGlobals.curChallengeFeatured=!1,G.ControllerGameGlobals.justLoadedRobotWithChallenge=!0):(n.Main.nextControllerType=0,p.ControllerSandbox.settings=t.settings,G.ControllerGameGlobals.curChallengeID="")}}}finishLoadingReplay(e){if(o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_LOAD_REPLAY){var t=o.Database.FinishLoadingReplay(e);if(t)if(G.ControllerGameGlobals.replay=t[0],G.ControllerGameGlobals.replay.version!=o.Database.VERSION_STRING_FOR_REPLAYS)this.ShowConfirmDialog("This replay was saved using an older version of IncrediBots.  Redirect there now?",6),n.Main.ShowMouse();else{var i=t[1];G.ControllerGameGlobals.replayParts=i.allParts,p.ControllerSandbox.settings=i.settings,G.ControllerGameGlobals.playingReplay=!0,n.Main.changeControllers=!0,n.Main.nextControllerType=0,G.ControllerGameGlobals.curRobotID=G.ControllerGameGlobals.potentialRobotID,G.ControllerGameGlobals.ratedCurRobot=!1,G.ControllerGameGlobals.curReplayID=G.ControllerGameGlobals.potentialReplayID,G.ControllerGameGlobals.ratedCurReplay=!1,G.ControllerGameGlobals.curReplayPublic=G.ControllerGameGlobals.potentialReplayPublic,G.ControllerGameGlobals.curReplayFeatured=G.ControllerGameGlobals.potentialReplayFeatured,G.ControllerGameGlobals.curChallengeID="",G.ControllerGameGlobals.curChallengePublic=!1,G.ControllerGameGlobals.curChallengeFeatured=!1}}}processLoadedReplay(e){if(G.ControllerGameGlobals.replay=e[0],G.ControllerGameGlobals.replay.version!=o.Database.VERSION_STRING_FOR_REPLAYS)this.ShowConfirmDialog("This replay was saved using an older version of IncrediBots.  Redirect there now?",6),n.Main.ShowMouse();else{var t=e[1];G.ControllerGameGlobals.replayParts=t.allParts,p.ControllerSandbox.settings=t.settings,G.ControllerGameGlobals.playingReplay=!0,n.Main.changeControllers=!0,n.Main.nextControllerType=0,G.ControllerGameGlobals.curRobotID=G.ControllerGameGlobals.potentialRobotID,G.ControllerGameGlobals.ratedCurRobot=!1,G.ControllerGameGlobals.curReplayID=G.ControllerGameGlobals.potentialReplayID,G.ControllerGameGlobals.ratedCurReplay=!1,G.ControllerGameGlobals.curReplayPublic=G.ControllerGameGlobals.potentialReplayPublic,G.ControllerGameGlobals.curReplayFeatured=G.ControllerGameGlobals.potentialReplayFeatured,G.ControllerGameGlobals.curChallengeID="",G.ControllerGameGlobals.curChallengePublic=!1,G.ControllerGameGlobals.curChallengeFeatured=!1}}processLoadedChallenge(e){n.Main.changeControllers=!0,n.Main.nextControllerType=1,c.ControllerChallenge.challenge=e,c.ControllerChallenge.playChallengeMode=!G.ControllerGameGlobals.potentialChallengeEditable,c.ControllerChallenge.playOnlyMode=!G.ControllerGameGlobals.potentialChallengeEditable,p.ControllerSandbox.settings=e.settings,G.ControllerGameGlobals.curChallengeID=G.ControllerGameGlobals.potentialChallengeID,G.ControllerGameGlobals.ratedCurChallenge=!1,G.ControllerGameGlobals.curChallengePublic=G.ControllerGameGlobals.potentialChallengePublic,G.ControllerGameGlobals.curChallengeFeatured=G.ControllerGameGlobals.potentialChallengeFeatured,G.ControllerGameGlobals.curRobotID="",G.ControllerGameGlobals.curReplayID="",G.ControllerGameGlobals.loadedParts=e.allParts,G.ControllerGameGlobals.initX=e.cameraX,G.ControllerGameGlobals.initY=e.cameraY,G.ControllerGameGlobals.initZoom=e.zoomLevel}finishLoadingChallenge(e){if(o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_LOAD_CHALLENGE){var t=o.Database.FinishLoadingChallenge(e);t&&(n.Main.changeControllers=!0,n.Main.nextControllerType=1,c.ControllerChallenge.challenge=t,c.ControllerChallenge.playChallengeMode=!G.ControllerGameGlobals.potentialChallengeEditable,c.ControllerChallenge.playOnlyMode=!G.ControllerGameGlobals.potentialChallengeEditable,p.ControllerSandbox.settings=t.settings,G.ControllerGameGlobals.curChallengeID=G.ControllerGameGlobals.potentialChallengeID,G.ControllerGameGlobals.ratedCurChallenge=!1,G.ControllerGameGlobals.curChallengePublic=G.ControllerGameGlobals.potentialChallengePublic,G.ControllerGameGlobals.curChallengeFeatured=G.ControllerGameGlobals.potentialChallengeFeatured,G.ControllerGameGlobals.curRobotID="",G.ControllerGameGlobals.curReplayID="",G.ControllerGameGlobals.loadedParts=t.allParts,G.ControllerGameGlobals.initX=t.cameraX,G.ControllerGameGlobals.initY=t.cameraY,G.ControllerGameGlobals.initZoom=t.zoomLevel)}}finishDeleting(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_DELETE_ROBOT&&(""!=o.Database.FinishDeletingRobot(e)&&(this.m_progressDialog.SetMessage("Delete successful!"),this.m_progressDialog.HideInXSeconds(1),this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_ROBOT_TYPE),this.addChild(this.m_loadWindow),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog)))}finishDeletingReplay(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_DELETE_REPLAY&&o.Database.FinishDeletingReplay(e)&&(this.m_progressDialog.SetMessage("Delete successful!"),this.m_progressDialog.HideInXSeconds(1),this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_REPLAY_TYPE),this.addChild(this.m_loadWindow),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog))}finishDeletingChallenge(e){o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_DELETE_CHALLENGE&&o.Database.FinishDeletingChallenge(e)&&(this.m_progressDialog.SetMessage("Delete successful!"),this.m_progressDialog.HideInXSeconds(1),this.removeChild(this.m_loadWindow),this.m_loadWindow=new SaveLoadWindow(this,SaveLoadWindow.LOAD_CHALLENGE_TYPE),this.addChild(this.m_loadWindow),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog))}enableSoundButtonPressed(e){n.Main.enableSound=!0,this.enableSoundButton.visible=!1,this.disableSoundButton.visible=!0,_.introSong.resume()}disableSoundButtonPressed(e){n.Main.enableSound=!1,_.introSong.pause(),this.enableSoundButton.visible=!0,this.disableSoundButton.visible=!1}loginButton(e,t=!1,o=!1,i=!1){this.saveLoadOpen=i,this.m_loginWindow&&this.removeChild(this.m_loginWindow),this.m_loginWindow=new LoginWindow(this),t&&this.m_loginWindow.displayMessage(),this.addChild(this.m_loginWindow),this.fader2.visible=!0,this.backToSaveWindow=o}finishLoggingInGold(e){if(o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_LOGIN_GOLD){var t=o.Database.FinishLoggingIn(e);""!=t&&(this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_goldLoginWindow.visible=!1,G.ControllerGameGlobals.userName=t.substring(t.indexOf("user: ")+6,t.indexOf("password: ")-1),G.ControllerGameGlobals.password=t.substring(t.indexOf("password: ")+10,t.indexOf("session: ")-1),G.ControllerGameGlobals.sessionID=t.substr(t.indexOf("session: ")+9),this.fader.visible=!1,this.playButton.visible=!0,this.logInButton.visible=!1,this.logOutButton.visible=!0),n.Main.ShowMouse();var i=new TextFormat;i.font=n.Main.GLOBAL_FONT,i.color=16777215,this.userText.text="Welcome, "+("_Public"==G.ControllerGameGlobals.userName?"Guest":G.ControllerGameGlobals.userName),this.userText.setTextFormat(i)}}finishLoggingIn(e){if(o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_LOGIN){var t=o.Database.FinishLoggingIn(e);""!=t&&(this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_loginWindow&&(this.m_loginWindow.visible=!1),0==t.indexOf("premium")?n.Main.premiumMode=!0:n.Main.premiumMode=!1,G.ControllerGameGlobals.userName=t.substring(t.indexOf("user: ")+6,t.indexOf("password: ")-1),G.ControllerGameGlobals.password=t.substring(t.indexOf("password: ")+10,t.indexOf("session: ")-1),G.ControllerGameGlobals.sessionID=t.substr(t.indexOf("session: ")+9),this.m_loadWindow&&this.m_loadWindow.visible&&(this.m_loadWindow.HideFader(),this.m_loadWindow.reportClicked(new MouseEvent(""))),this.saveLoadOpen?this.ReloadLoadWindow():this.fader2.visible=!1,this.logInButton.visible=!1,this.logOutButton.visible=!0),n.Main.ShowMouse();var i=new TextFormat;i.font=n.Main.GLOBAL_FONT,i.color=16777215,this.userText.text="Welcome, "+("_Public"==G.ControllerGameGlobals.userName?"Guest":G.ControllerGameGlobals.userName),this.userText.setTextFormat(i)}}finishAddingUser(e){if(o.Database.waitingForResponse&&o.Database.curTransactionType==o.Database.ACTION_ADD_USER){var t=o.Database.FinishAddingUser(e);""!=t&&(this.m_progressDialog.SetMessage("Success!"),this.m_progressDialog.HideInXSeconds(1),this.m_loginWindow&&(this.m_loginWindow.visible=!1),this.m_newUserWindow.visible=!1,n.Main.premiumMode=!1,G.ControllerGameGlobals.userName=t.substring(t.indexOf("user: ")+6,t.indexOf("password: ")-1),G.ControllerGameGlobals.password=t.substring(t.indexOf("password: ")+10,t.indexOf("session: ")-1),G.ControllerGameGlobals.sessionID=t.substr(t.indexOf("session: ")+9),this.m_loadWindow&&this.m_loadWindow.visible&&(this.m_loadWindow.HideFader(),this.m_loadWindow.reportClicked(new MouseEvent(""))),this.saveLoadOpen?this.ReloadLoadWindow():this.fader2.visible=!1,this.logInButton.visible=!1,this.logOutButton.visible=!0);var i=new TextFormat;i.font=n.Main.GLOBAL_FONT,i.color=16777215,this.userText.text="Welcome, "+("_Public"==G.ControllerGameGlobals.userName?"Guest":G.ControllerGameGlobals.userName),this.userText.setTextFormat(i)}}ReloadLoadWindow(){this.m_loadWindow.visible=!0,this.m_loadWindow.dataType!=SaveLoadWindow.HIGH_SCORE_TYPE&&this.m_loadWindow.yourRobotsBox.selected?(this.m_loadWindow.dataType==SaveLoadWindow.LOAD_ROBOT_TYPE?(o.Database.GetRobotData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,!1,o.Database.SORT_BY_EDIT_TIME,o.Database.SORT_PERIOD_ALLTIME,1,"",this.finishGettingLoadRobotData),this.ShowDialog("Getting robots...")):this.m_loadWindow.dataType==SaveLoadWindow.LOAD_REPLAY_TYPE?(o.Database.GetReplayData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,!1,o.Database.SORT_BY_EDIT_TIME,o.Database.SORT_PERIOD_ALLTIME,1,"",this.finishGettingLoadReplayData),this.ShowDialog("Getting replays...")):(o.Database.GetChallengeData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,!1,o.Database.SORT_BY_EDIT_TIME,o.Database.SORT_PERIOD_ALLTIME,1,"",this.finishGettingLoadChallengeData),this.ShowDialog("Getting challenges...")),this.m_loadWindow.ShowFader(),n.Main.ShowHourglass()):this.m_loadWindow.dataType==SaveLoadWindow.HIGH_SCORE_TYPE&&(o.Database.GetScoreData(G.ControllerGameGlobals.userName,G.ControllerGameGlobals.password,o.Database.highScoresChallenge,1==this.m_loadWindow.m_scoreTypeBox.selectedIndex,2==this.m_loadWindow.m_scoreTypeBox.selectedIndex,o.Database.SORT_BY_SCORE,1,"",this.finishGettingScoreData),this.ShowDialog("Getting high scores..."),this.m_loadWindow.ShowFader(),n.Main.ShowHourglass())}commentButton(e,t="",i=!1){i?(o.Database.CommentOnRobot(t,this.finishCommenting),this.ShowDialog("Connecting to forum..."),n.Main.ShowHourglass()):(this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}finishCommenting(e){if(o.Database.waitingForResponse&&(o.Database.curTransactionType==o.Database.ACTION_COMMENT_ROBOT||o.Database.curTransactionType==o.Database.ACTION_COMMENT_REPLAY||o.Database.curTransactionType==o.Database.ACTION_COMMENT_CHALLENGE)){var t=o.Database.FinishCommenting(e);-1!=t&&(this.m_loadWindow.HideFader(),this.m_progressDialog.visible=!1,n.Main.BrowserRedirect("http://incredibots.com/forums/posting.php?mode=reply&t="+t+("_Public"==G.ControllerGameGlobals.userName?"":"&sid="+G.ControllerGameGlobals.sessionID),!0),n.Main.ShowMouse())}}finishExporting(e,t){this.m_loadWindow.visible=!1,this.m_exportDialog&&this.removeChild(this.m_exportDialog),this.m_exportDialog=new ExportWindow(this,e,t),this.fader2.visible=!0,this.addChild(this.m_exportDialog)}linkButton(e,t="",o=!1){o?this.ShowLinkDialog("     Use the link below to\n        link to this robot.","http://incredibots2.com/?robotID="+t):(this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}embedButton(e,t="",o=!1){o?this.ShowLinkDialog("Copy the HTML below into your\n  website to embed this robot.",null,!1,t):(this.ShowDialog3("You need to save your robot publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}commentReplayButton(e,t="",i=!1){i?(o.Database.CommentOnReplay(t,this.finishCommenting),this.ShowDialog("Connecting to forum..."),n.Main.ShowHourglass()):(this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}linkReplayButton(e,t="",o=!1){o?this.ShowLinkDialog("     Use the link below to\n       link to this replay.","http://incredibots2.com/?replayID="+t):(this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}embedReplayButton(e,t="",o=!1){o?this.ShowLinkDialog("Copy the HTML below into your\n  website to embed this replay.",null,!1,t,!0):(this.ShowDialog3("You need to save your replay publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}commentChallengeButton(e,t="",i=!1){i?(o.Database.CommentOnChallenge(t,this.finishCommenting),this.ShowDialog("Connecting to forum..."),n.Main.ShowHourglass()):(this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}linkChallengeButton(e,t="",o=!1){o?this.ShowLinkDialog("     Use the link below to\n       link to this challenge.","http://incredibots2.com/?challengeID="+t):(this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}embedChallengeButton(e,t="",o=!1){o?this.ShowLinkDialog("Copy the HTML below into your\n  website to embed this challenge.",null,!0,t):(this.ShowDialog3("You need to save your challenge publicly first!"),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer())}ShowDialog(e){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,e),this.addChild(this.m_progressDialog)}ShowDialog2(e){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,e,!0,!0),this.addChild(this.m_progressDialog)}ShowDialog3(e){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,e,!0),this.addChild(this.m_progressDialog)}ShowLinkDialog(e,t,o=!1,i="",a=!1){this.m_linkDialog&&this.removeChild(this.m_linkDialog),this.m_linkDialog=new LinkWindow(this,e,t,o,i,a),this.addChild(this.m_linkDialog)}HideDialog(e){o.Database.nonfatalErrorOccurred=!1,this.m_loadWindow&&this.m_loadWindow.HideFader(),this.m_challengeWindow&&this.m_challengeWindow.HideFader(),this.m_newUserWindow&&this.m_newUserWindow.visible?this.m_newUserWindow.HideFader():this.m_loginWindow?this.m_loginWindow.HideFader():this.m_goldLoginWindow&&this.m_goldLoginWindow.HideFader(),this.m_progressDialog.visible=!1,this.m_loadWindow&&this.m_loadWindow.visible||this.m_newUserWindow&&this.m_newUserWindow.visible||this.m_loginWindow&&this.m_loginWindow.visible||this.m_challengeWindow&&this.m_challengeWindow.visible||(this.fader2.visible=!1)}HideLinkDialog(e){this.m_linkDialog.visible=!1,this.m_loadWindow.HideFader()}HideExportDialog(e){this.m_exportDialog.visible=!1,this.m_loadWindow&&this.m_loadWindow.visible&&this.m_loadWindow.HideFader(),this.fader2.visible=!1}HideImportDialog(e){this.m_importDialog.visible=!1,this.fader2.visible=!1}ShowImportWindow(e){this.m_importDialog&&this.removeChild(this.m_importDialog),this.m_importDialog=new r.ImportWindow(this,e),this.fader2.visible=!0,this.addChild(this.m_importDialog)}ShowConfirmDialog(e,t){this.m_progressDialog&&this.removeChild(this.m_progressDialog),this.m_progressDialog=new DialogWindow(this,e,!0),this.addChild(this.m_progressDialog),this.m_progressDialog.ShowOKAndCancelButton(t)}HideConfirmDialog(e){this.m_progressDialog.visible=!1,this.m_loadWindow?this.m_loadWindow.HideFader():this.fader2.visible=!1}DialogOK(e){this.m_progressDialog.visible=!1,this.m_loadWindow&&this.m_loadWindow.visible&&this.m_loadWindow.HideFader(),this.m_challengeWindow&&this.m_challengeWindow.visible&&this.m_challengeWindow.HideFader(),this.m_loginWindow&&this.m_loginWindow.visible&&this.m_loginWindow.HideFader(),this.m_goldLoginWindow&&this.m_goldLoginWindow.visible&&this.m_goldLoginWindow.HideFader(),this.m_newUserWindow&&this.m_newUserWindow.visible&&this.m_newUserWindow.HideFader()}ConfirmDeleteRobot(e){this.m_loadWindow.deleteRobotButtonPressed(e,!0)}ConfirmDeleteReplay(e){this.m_loadWindow.deleteReplayButtonPressed(e,!0)}ConfirmDeleteChallenge(e){this.m_loadWindow.deleteChallengeButtonPressed(e,!0)}playButtonPressed(e){n.Main.premiumMode&&""==G.ControllerGameGlobals.userName||(this.playButton.visible=!1,this.fader.visible=!0,this.levelSelectGui.visible=!0,this.logoShrinking=!0,this.subscribeButton&&(this.subscribeButton.visible=!1),this.gamesButton&&(this.gamesButton.visible=!1),this.removeChild(this.enableSoundButton),this.removeChild(this.disableSoundButton),this.levelSelectGui.addChild(this.enableSoundButton),this.levelSelectGui.addChild(this.disableSoundButton))}contestButtonPressed(e){n.Main.BrowserRedirect("http://incredibots.com/forums/viewtopic.php?t=119105",!0)}forumPostButtonPressed(e){n.Main.BrowserRedirect("http://incredibots.com/forums/viewtopic.php?p=1269792",!0)}tankButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=10}shapeButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=11}carButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=12}jumpBotButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=13}dumpBotButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=14}catapultButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=15}homeMovieButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=16}rubeGoldbergButton(e){n.Main.changeControllers=!0,n.Main.nextControllerType=17}tutorialButton(e){this.m_tutorialWindow&&this.removeChild(this.m_tutorialWindow),this.m_tutorialWindow=new TutorialSelectWindow(this),this.fader2.visible=!0,this.addChild(this.m_tutorialWindow)}sandboxButton(e){var t=new y.SandboxSettings(15,1,0,0,0);p.ControllerSandbox.settings=t,n.Main.changeControllers=!0,n.Main.nextControllerType=0}advancedButton(e){n.Main.nextControllerType=0,this.m_sandboxWindow=new l.AdvancedSandboxWindow(this),this.fader2.visible=!0,this.addChild(this.m_sandboxWindow)}editorButton(e){c.ControllerChallenge.challenge=null,c.ControllerChallenge.playChallengeMode=!1,c.ControllerChallenge.playOnlyMode=!1,n.Main.nextControllerType=1,this.m_sandboxWindow=new l.AdvancedSandboxWindow(this),this.fader2.visible=!0,this.addChild(this.m_sandboxWindow)}logout(e){this.fader2.visible=!0,this.ShowConfirmDialog("Are you sure you want to log "+G.ControllerGameGlobals.userName+" out?",12)}ConfirmLogout(e){n.Main.premiumMode=!1,G.ControllerGameGlobals.userName="_Public",this.logInButton.visible=!0,this.logOutButton.visible=!1,this.ShowDialog3("You are now logged out."),this.m_progressDialog.ShowOKButton(),this.m_progressDialog.StopTimer(),this.fader2.visible=!0;var t=new TextFormat;t.font=n.Main.GLOBAL_FONT,t.color=16777215,this.userText.text="Welcome, Guest",this.userText.setTextFormat(t)}instructionsButton(e){n.Main.BrowserRedirect("http://www.incredifriends.com/",!0)}creditsButton(e){n.Main.BrowserRedirect("http://www.incredifriends.com/",!0)}suggestionsButton(e){n.Main.BrowserRedirect("http://www.incredifriends.com/",!0)}Update(){if(_.channel&&!n.Main.enableSound){G.ControllerGameGlobals.introVolume-=.01;var e=new SoundTransform(G.ControllerGameGlobals.introVolume);_.channel.soundTransform=e,G.ControllerGameGlobals.introVolume<=0&&(_.channel.stop(),_.channel=null)}var t=window.performance.now();this.HandleCamera();for(var i=0;i<this.allParts.length;i++)this.allParts[i].Update(this.world);if(this.replay&&this.replay.Update(this.frameCounter)){for(this.frameCounter=0,this.replay.syncPointIndex=0,this.replay.cameraMovementIndex=0,this.replay.keyPressIndex=0,_.cannonballs=new Array,i=0;i<this.allParts.length;i++)this.allParts[i].UnInit(this.world);for(i=this.allParts.length;i>=0;i--)this.allParts[i]instanceof u.ShapePart&&this.allParts[i].Init(this.world);for(i=0;i<this.allParts.length;i++)(this.allParts[i]instanceof d.JointPart||this.allParts[i]instanceof g.Thrusters)&&this.allParts[i].Init(this.world)}else this.frameCounter++;this.draw.DrawWorld(this.allParts,new Array,this.world,!1,!1,!1,!0),this.sSky.Update(!1,this.hasPanned),n.Main.m_fpsCounter.updatePhys(t),this.levelSelectGui.visible?(this.logoShrinking&&(this.logoShrinking=!1,this.sLogo.scale.x!=this.sLogo.scale.y?(this.sLogo.scale.x=Math.min(this.sLogo.scale.x,this.sLogo.scale.y),this.sLogo.scale.y=this.sLogo.scale.x,this.logoShrinking=!0):this.sLogo.scale.x>.6&&(this.sLogo.width-=25,this.sLogo.scale.x<.6&&(this.sLogo.scale.x=.6),this.sLogo.scale.y=this.sLogo.scale.x,this.logoShrinking=!0),this.sLogo.x<215&&(this.sLogo.x+=11.7,this.sLogo.x>215&&(this.sLogo.x=215),this.logoShrinking=!0),this.sLogo.y>10&&(this.sLogo.y-=2,this.sLogo.y<10&&(this.sLogo.y=10),this.logoShrinking=!0)),this.startHereArrow&&(this.arrowAccel=.12*(118-this.arrowX),this.arrowVel+=this.arrowAccel,this.arrowX+=this.arrowVel,this.startHereArrow.x=this.arrowX)):(this.sLogo.width=this.sLogo.texture.width*_.LOGO_STRETCH_WIDTHS[this.logoFrame]/100,this.sLogo.height=this.sLogo.texture.height*_.LOGO_STRETCH_HEIGHTS[this.logoFrame]/100,this.sLogo.x=400-this.sLogo.width/2,this.sLogo.y=92.5-this.sLogo.height/2,this.logoFrame=(this.logoFrame+1)%48),o.Database.errorOccurred&&(this.m_progressDialog.StopTimer(),this.m_progressDialog.SetMessage(o.Database.lastErrorMsg,!0),o.Database.errorOccurred=!1,o.Database.versionErrorOccurred?(o.Database.versionErrorOccurred=!1,this.m_progressDialog.ShowOKAndCancelButton(5)):this.m_progressDialog.ShowOKButton(),this.removeChild(this.m_progressDialog),this.addChild(this.m_progressDialog),n.Main.ShowMouse())}keyInput(e,t){for(var o=0;o<this.allParts.length;o++)this.allParts[o].KeyInput(e,t,!0)}SyncReplay(e){for(var t=new Array,o=0,i=0;i<this.allParts.length;i++)this.allParts[i]instanceof u.ShapePart&&!this.allParts[i].isStatic&&!a.Util.ObjectInArray(this.allParts[i].GetBody(),t)&&(this.allParts[i].GetBody().SetXForm(a.Util.Vector(e.positions[o].x,e.positions[o].y),e.angles[o]),o++,t.push(this.allParts[i].GetBody()));for(i=0;i<_.cannonballs.length;i++)_.cannonballs[i].SetXForm(e.cannonballPositions[i],0)}SyncReplay2(e,t){for(var o=this.replay.syncPoints.indexOf(e),i=new Array,l=0,s=0;s<this.allParts.length;s++)this.allParts[s]instanceof u.ShapePart&&!this.allParts[s].isStatic&&!a.Util.ObjectInArray(this.allParts[s].GetBody(),i)&&(this.allParts[s].GetBody().SetXForm(a.Util.Vector(this.replaySplineXs[0][o][l]+(this.frameCounter-e.frame)*(this.replaySplineXs[1][o][l]+(this.frameCounter-e.frame)*(this.replaySplineXs[2][o][l]+(this.frameCounter-e.frame)*this.replaySplineXs[3][o][l])),this.replaySplineYs[0][o][l]+(this.frameCounter-e.frame)*(this.replaySplineYs[1][o][l]+(this.frameCounter-e.frame)*(this.replaySplineYs[2][o][l]+(this.frameCounter-e.frame)*this.replaySplineYs[3][o][l]))),this.replaySplineAngles[0][o][l]+(this.frameCounter-e.frame)*(this.replaySplineAngles[1][o][l]+(this.frameCounter-e.frame)*(this.replaySplineAngles[2][o][l]+(this.frameCounter-e.frame)*this.replaySplineAngles[3][o][l]))),l++,i.push(this.allParts[s].GetBody()));for(s=0;s<_.cannonballs.length;s++)if(e.cannonballPositions.length>s){var r=t.frame-e.frame,n=(e.cannonballPositions[s].x*(t.frame-this.frameCounter)+t.cannonballPositions[s].x*(this.frameCounter-e.frame))/r,h=(e.cannonballPositions[s].y*(t.frame-this.frameCounter)+t.cannonballPositions[s].y*(this.frameCounter-e.frame))/r;_.cannonballs[s].SetXForm(a.Util.Vector(n,h),0)}else _.cannonballs[s].SetXForm(t.cannonballPositions[s],0)}MoveCameraForReplay(e){}World2ScreenX(e){return e*this.m_physScale-this.draw.m_drawXOff}World2ScreenY(e){return e*this.m_physScale-this.draw.m_drawYOff}HandleCamera(){if(this.cameraPart){var e=this.draw.m_drawXOff,t=this.draw.m_drawYOff;this.draw.m_drawXOff=this.cameraPart.GetBody().GetWorldCenter().x*this.m_physScale-_.ZOOM_FOCUS_X,this.draw.m_drawYOff=this.cameraPart.GetBody().GetWorldCenter().y*this.m_physScale-_.ZOOM_FOCUS_Y,this.draw.m_drawYOff<-760&&(this.draw.m_drawYOff=-760),e==this.draw.m_drawXOff&&t==this.draw.m_drawYOff||(this.hasPanned=!0,this.sGround.x=this.World2ScreenX(-42.36),this.sGround.y=this.World2ScreenY(9.55))}}ComputeReplaySplines(e){for(var t=new Array,o=new Array,i=0;i<this.replay.syncPoints.length-1;i++){t.push(this.replay.syncPoints[i+1].frame-this.replay.syncPoints[i].frame);for(var l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)if(0==e)l.push((this.replay.syncPoints[i+1].positions[s].x-this.replay.syncPoints[i].positions[s].x)/t[i]);else if(1==e)l.push((this.replay.syncPoints[i+1].positions[s].y-this.replay.syncPoints[i].positions[s].y)/t[i]);else{var r=this.replay.syncPoints[i+1].angles[s]-this.replay.syncPoints[i].angles[s];if(Math.abs(r)>300){var n=a.Util.NormalizeAngle(this.replay.syncPoints[i].angles[s]),h=a.Util.NormalizeAngle(this.replay.syncPoints[i+1].angles[s]);r=Math.abs(n-h)<Math.PI?h-n:n>h?h+2*Math.PI-n:h-(n+2*Math.PI)}l.push(r/t[i])}o.push(l)}var d=new Array,u=new Array;for(d.push(0),d.push(2*(t[0]+t[1])),l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)l.push(0);for(u.push(l),l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)l.push(6*(o[1][s]-o[0][s]));for(u.push(l),i=2;i<this.replay.syncPoints.length-1;i++){for(d.push(2*(t[i-1]+t[i])-t[i-1]*t[i-1]/d[i-1]),l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)l.push(6*(o[i][s]-o[i-1][s])-t[i-1]*u[i-1][s]/d[i-1]);u.push(l)}var g=new Array;for(l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)l.push(0);for(g[this.replay.syncPoints.length-1]=l,i=this.replay.syncPoints.length-2;i>0;i--){for(l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)l.push((u[i][s]-t[i]*g[i+1][s])/d[i]);g[i]=l}for(l=new Array,s=0;s<this.replay.syncPoints[0].positions.length;s++)l.push(0);g[0]=l;var m=new Array,b=new Array,c=new Array,p=new Array,C=new Array;for(i=0;i<this.replay.syncPoints.length-1;i++){var G=new Array,w=new Array,D=new Array,S=new Array;for(s=0;s<this.replay.syncPoints[0].positions.length;s++)G.push(0==e?this.replay.syncPoints[i].positions[s].x:1==e?this.replay.syncPoints[i].positions[s].y:this.replay.syncPoints[i].angles[s]),r=this.replay.syncPoints[i+1].angles[s]-this.replay.syncPoints[i].angles[s],Math.abs(r)>300&&(n=a.Util.NormalizeAngle(this.replay.syncPoints[i].angles[s]),h=a.Util.NormalizeAngle(this.replay.syncPoints[i+1].angles[s]),r=Math.abs(n-h)<Math.PI?h-n:n>h?h+2*Math.PI-n:h-(n+2*Math.PI)),w.push(-t[i]*g[i+1][s]/6-t[i]*g[i][s]/3+(0==e?this.replay.syncPoints[i+1].positions[s].x-G[s]:1==e?this.replay.syncPoints[i+1].positions[s].y-G[s]:r)/t[i]),D.push(g[i][s]/2),S.push((g[i+1][s]-g[i][s])/(6*t[i]));b.push(G),c.push(w),p.push(D),C.push(S)}return m.push(b),m.push(c),m.push(p),m.push(C),m}}exports.ControllerMainMenu=_,_.LOGO_STRETCH_WIDTHS=[101.2,101,100.7,100.5,100.2,100,99.7,99.4,99.1,98.9,98.6,98.4,98.2,98,97.8,97.7,97.5,97.5,97.4,97.4,97.4,97.5,97.6,97.8,98.1,98.3,98.6,99,99.3,99.6,100,100.3,100.7,101,101.3,101.6,101.8,102,102.1,102.2,102.3,102.2,102.2,102.1,102,101.8,101.6,101.4],_.LOGO_STRETCH_HEIGHTS=[97.7,97.6,97.7,97.7,97.7,97.8,97.9,98,98.2,98.4,98.7,99,99.3,99.6,100,100.3,100.6,100.9,101.2,101.5,101.7,101.8,101.9,102,102,101.9,101.8,101.7,101.5,101.3,101.1,100.8,100.6,100.3,100.1,99.8,99.5,99.3,99,98.8,98.5,98.4,98.2,98,97.9,97.8,97.8,97.7],_.ZOOM_FOCUS_X=440,_.ZOOM_FOCUS_Y=280,_.firstLoad=!0,_.introSong=D.Resource.cIntro,_.cannonballs=new Array;
},{"pixi.js":"aQiP","@box2d/core":"kjbO","../General/Database":"CVYw","../General/LSOManager":"unNJ","../General/Util":"Zvyo","../Gui/AdvancedSandboxWindow":"kpwL","../Gui/GuiButton":"IBBZ","../Gui/ImportWindow":"F66q","../Main":"aM6Q","../Parts/Cannon":"vdN1","../Parts/JointPart":"avwv","../Parts/ShapePart":"CDAe","../Parts/Thrusters":"Yw1p","./ContactFilter":"u77w","./Controller":"T7gT","./ControllerChallenge":"V2jW","./ControllerSandbox":"v13b","./Draw":"tHDu","./Globals/ControllerGameGlobals":"K8aL","./Graphics/Gradient":"a6nr","./Graphics/Resource":"VWUR","./Graphics/Sky":"cNJr","./SandboxSettings":"ZSAP"}],"bdNa":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FpsCounter=void 0;const t=require("pixi.js");class s extends t.Container{constructor(){super(),this.mfpsCount=0,this.mfpsCount2=0,this.avgCount=30,this.avgCount2=30,this.textBox=new t.Text("..."),this.textBox.style.fill="#aa1144",this.textBox2=new t.Text("..."),this.textBox2.width=150,this.textBox2.style.fill="#aa1144",this.textBox2.y=15,this.textBox3=new t.Text("..."),this.textBox3.style.fill="#aa1144",this.textBox3.y=30,this.oldT=window.performance.now(),this.addChild(this.textBox),this.addChild(this.textBox2),this.addChild(this.textBox3)}update(){var t=window.performance.now()-this.oldT;this.mfpsCount+=t,this.avgCount<1&&(this.textBox.text=String(Math.round(1e3/(this.mfpsCount/30))+" fps average"),this.avgCount=30,this.mfpsCount=0),this.avgCount--,this.oldT=window.performance.now(),this.textBox3.text=Math.round(window.performance.memory.usedJSHeapSize/1048576)+" MB used"}updatePhys(t){var s=window.performance.now()-t;this.mfpsCount2+=s,this.avgCount2<1&&(this.textBox2.text=String("Physics step: "+Math.round(this.mfpsCount2/30)+" ms ("+Math.round(1e3/(this.mfpsCount2/30))+" fps)"),this.avgCount2=30,this.mfpsCount2=0),this.avgCount2--}}exports.FpsCounter=s;
},{"pixi.js":"aQiP"}],"aM6Q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Main=void 0;const e=require("./Game/Globals/ControllerGameGlobals"),o=require("./Game/ControllerMainMenu"),r=require("./Game/ControllerSandbox"),l=require("./Game/SandboxSettings"),t=require("./General/FpsCounter"),n=require("./General/LSOManager"),a=require("./General/Input");class C{constructor(e){this.renderer=e,C.theRoot=this.renderer.stage,C.theRoot.interactive=!0;var o=window.location.href,r=o.indexOf("://")+3,l=o.indexOf("/",r),t=o.substring(r,l),a=t.lastIndexOf(".")-1,i=t.lastIndexOf(".",a)+1;"incredibotsgold.com"==(t=t.substring(i,t.length))&&(C.premiumMode=!0),e.ticker.maxFPS=30,e.ticker.add(e=>this.update()),addEventListener(Event.ADDED_TO_STAGE,this.Init,!1,0,!0),n.LSOManager.Init(),this.Init(),C.DEBUG_VERSION&&(C.m_fpsCounter.x=7,C.m_fpsCounter.y=525,C.theRoot.addChild(C.m_fpsCounter))}static BrowserRedirect(e=null,o=!1,r=!1){let l="_self";o&&(l="_blank"),r&&(l="_top"),window.open(e,l)}Init(){a.Input.Init()}rehideMouse(e){Mouse.hide()}update(){if(C.frameCounter++,C.firstFrame){var t=new URLSearchParams(window.location.search);if(t.get("replayID")){C.loadReplayMode=!0;var n=t.get("replayID")}if(t.get("robotID")){C.loadRobotMode=!0;var i=t.get("robotID")}if(t.get("challengeID")){C.loadChallengeMode=!0;var d=t.get("challengeID")}t.get("iframe")&&(C.inIFrame=!0),C.loadReplayMode&&!C.premiumMode?(r.ControllerSandbox.settings=new l.SandboxSettings(15,0,0,0,0),C.m_curController=new r.ControllerSandbox,C.m_curController.LoadReplayNow(n),e.ControllerGameGlobals.potentialReplayID=n,e.ControllerGameGlobals.potentialReplayPublic=!0,e.ControllerGameGlobals.replayDirectlyLinked=!0,C.theRoot.addChild(C.m_curController),C.nextControllerType=0):C.loadRobotMode&&!C.premiumMode?(r.ControllerSandbox.settings=new l.SandboxSettings(15,0,0,0,0),C.m_curController=new r.ControllerSandbox,C.m_curController.LoadRobotNow(i),e.ControllerGameGlobals.potentialRobotID=i,e.ControllerGameGlobals.potentialRobotPublic=!0,C.theRoot.addChild(C.m_curController),C.nextControllerType=0):C.loadChallengeMode&&!C.premiumMode?(r.ControllerSandbox.settings=new l.SandboxSettings(15,0,0,0,0),C.m_curController=new r.ControllerSandbox,C.m_curController.LoadChallengeNow(d),e.ControllerGameGlobals.potentialChallengeID=d,e.ControllerGameGlobals.potentialChallengePublic=!0,C.theRoot.addChild(C.m_curController),C.nextControllerType=0):(C.m_curController=new o.ControllerMainMenu,C.theRoot.addChild(C.m_curController)),C.firstFrame=!1}C.changeControllers&&(C.theRoot.removeChild(C.m_curController),-1==C.nextControllerType?C.m_curController=new o.ControllerMainMenu(!0):10==C.nextControllerType?C.m_curController=new ControllerTank:11==C.nextControllerType?C.m_curController=new ControllerShapes:12==C.nextControllerType?C.m_curController=new ControllerCar:13==C.nextControllerType?C.m_curController=new ControllerJumpbot:14==C.nextControllerType?C.m_curController=new ControllerDumpbot:15==C.nextControllerType?C.m_curController=new ControllerCatapult:16==C.nextControllerType?C.m_curController=new ControllerHomeMovies:17==C.nextControllerType?C.m_curController=new ControllerRubeGoldberg:18==C.nextControllerType?C.m_curController=new ControllerNewFeatures:19==C.nextControllerType?C.m_curController=new ControllerChallengeEditor:1==C.nextControllerType?C.m_curController=new ControllerChallenge:2==C.nextControllerType?C.m_curController=new ControllerMonkeyBars:3==C.nextControllerType?C.m_curController=new ControllerClimb:4==C.nextControllerType?C.m_curController=new ControllerRace:5==C.nextControllerType?C.m_curController=new ControllerSpaceship:C.m_curController=new r.ControllerSandbox,C.theRoot.addChild(C.m_curController),C.changeControllers=!1),C.m_curController.Update(),a.Input.update(),C.DEBUG_VERSION&&C.m_fpsCounter.update()}static ShowMouse(){}static ShowHourglass(){}}exports.Main=C,C.m_fpsCounter=new t.FpsCounter,C.m_curController=null,C.changeControllers=!1,C.nextControllerType=-1,C.firstFrame=!0,C.frameCounter=0,C.inIFrame=!1,C.theRoot=null,C.loadRobotMode=!1,C.loadReplayMode=!1,C.loadChallengeMode=!1,C.premiumMode=!1,C.enableSound=!0,C.VERSION_STRING="2.23 CE",C.DEBUG_VERSION=!0,C.ENABLE_SITE_LOCK=643-(C.DEBUG_VERSION?2:1),C._mochiads_game_id="50feb50977299858",C.lastAdTime=0,C.GLOBAL_FONT="Arial";
},{"./Game/Globals/ControllerGameGlobals":"K8aL","./Game/ControllerMainMenu":"rq5K","./Game/ControllerSandbox":"v13b","./Game/SandboxSettings":"ZSAP","./General/FpsCounter":"bdNa","./General/LSOManager":"unNJ","./General/Input":"xLqP"}],"B6dB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=require("pixi.js"),i=require("./Main"),n=require("./Game/Graphics/Resource");async function a(){await n.Resource.load();const a=new e.Application({transparent:!1,antialias:!0,width:800,height:600}),r=(new i.Main(a),document.getElementById("game_wrapper"));r&&(r.innerHTML="",r.appendChild(a.view))}a();
},{"pixi.js":"aQiP","./Main":"aM6Q","./Game/Graphics/Resource":"VWUR"}]},{},["B6dB"], null)
//# sourceMappingURL=/Incredibots-2-HTML5-Open-Source/src.701e892c.js.map